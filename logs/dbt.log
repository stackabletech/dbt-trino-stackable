[0m11:46:24.696645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb54ad6aa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb54ad68e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb54ad69210>]}


============================== 11:46:24.700406 | 18d7614a-2665-45ba-a86e-0b21f2626cf7 ==============================
[0m11:46:24.700406 [info ] [MainThread]: Running with dbt=1.7.3
[0m11:46:24.700817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m11:46:24.772985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18d7614a-2665-45ba-a86e-0b21f2626cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb54ad5b2d0>]}
[0m11:46:24.773857 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ky7dzzr6'
[0m11:46:24.774204 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:46:24.895671 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:46:24.896980 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:46:24.986239 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:46:24.991659 [info ] [MainThread]: Updating lock file in file path: /home/vadim/dbt_trino_iceberg/package-lock.yml
[0m11:46:24.993220 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1_sv0bs2'
[0m11:46:24.995140 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m11:46:25.356310 [info ] [MainThread]: Installed from version 1.1.1
[0m11:46:25.356683 [info ] [MainThread]: Up to date!
[0m11:46:25.357105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '18d7614a-2665-45ba-a86e-0b21f2626cf7', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb54abc9150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb54ad593d0>]}
[0m11:46:25.358885 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7010975, "process_user_time": 1.405263, "process_kernel_time": 0.23592, "process_mem_max_rss": "101108", "process_in_blocks": "97440", "process_out_blocks": "2032"}
[0m11:46:25.359267 [debug] [MainThread]: Command `dbt deps` succeeded at 11:46:25.359180 after 0.70 seconds
[0m11:46:25.359482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb54f385190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb54ad52890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb54f413710>]}
[0m11:46:25.359699 [debug] [MainThread]: Flushing usage events
[0m12:01:08.100847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6773d57150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6773d83fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6774578450>]}


============================== 12:01:08.102662 | 3e338cec-42d6-4a7c-98d6-ee4d7aeb432a ==============================
[0m12:01:08.102662 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:01:08.103018 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:01:08.238526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e338cec-42d6-4a7c-98d6-ee4d7aeb432a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6773d82950>]}
[0m12:01:08.290149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e338cec-42d6-4a7c-98d6-ee4d7aeb432a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6773b6fa50>]}
[0m12:01:08.290598 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m12:01:08.298883 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:01:08.299220 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:01:08.299468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3e338cec-42d6-4a7c-98d6-ee4d7aeb432a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67739ee750>]}
[0m12:01:09.067823 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_trino_iceberg.stg_tpch_part_suppliers' (models/staging/stg_tpch_part_suppliers.sql) depends on a source named 'tpch.partsupp' which was not found
[0m12:01:09.068626 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.99215895, "process_user_time": 1.935565, "process_kernel_time": 0.188593, "process_mem_max_rss": "107576", "process_in_blocks": "2240", "process_out_blocks": "16", "command_success": false}
[0m12:01:09.068975 [debug] [MainThread]: Command `dbt run` failed at 12:01:09.068898 after 0.99 seconds
[0m12:01:09.069193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6773d881d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f677275ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6773d2e450>]}
[0m12:01:09.069429 [debug] [MainThread]: Flushing usage events
[0m12:03:05.851487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd8ff2bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd8ff2af50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd8ff2aa90>]}


============================== 12:03:05.853151 | f6c329f2-e816-483a-a059-44f0faca092d ==============================
[0m12:03:05.853151 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:03:05.853508 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:03:05.967166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6c329f2-e816-483a-a059-44f0faca092d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd8fd67d90>]}
[0m12:03:06.017855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6c329f2-e816-483a-a059-44f0faca092d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd91374dd0>]}
[0m12:03:06.018288 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m12:03:06.025237 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:03:06.025553 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:03:06.025800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f6c329f2-e816-483a-a059-44f0faca092d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd8fc086d0>]}
[0m12:03:06.758387 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_trino_iceberg.stg_tpch_part_suppliers' (models/staging/stg_tpch_part_suppliers.sql) depends on a source named 'tpch_raw.partsupp' which was not found
[0m12:03:06.759320 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.93225706, "process_user_time": 1.891569, "process_kernel_time": 0.080066, "process_mem_max_rss": "107632", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m12:03:06.759684 [debug] [MainThread]: Command `dbt run` failed at 12:03:06.759596 after 0.93 seconds
[0m12:03:06.759932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd903b0dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd8f86ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd8fabbbd0>]}
[0m12:03:06.760170 [debug] [MainThread]: Flushing usage events
[0m12:24:04.318931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6172cb050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6172cbe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff617728350>]}


============================== 12:24:04.320729 | 2261e247-965c-4a6a-9f76-c6f066b366cb ==============================
[0m12:24:04.320729 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:24:04.321098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:24:04.433431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2261e247-965c-4a6a-9f76-c6f066b366cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff617044650>]}
[0m12:24:04.483991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2261e247-965c-4a6a-9f76-c6f066b366cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6177281d0>]}
[0m12:24:04.484430 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m12:24:04.491137 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:24:04.491457 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:24:04.491751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2261e247-965c-4a6a-9f76-c6f066b366cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff616f5e210>]}
[0m12:24:05.266675 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_trino_iceberg.stg_tpch_part_suppliers' (models/staging/stg_tpch_part_suppliers.sql) depends on a source named 'tpch_raw.partsupp' which was not found
[0m12:24:05.267332 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.9727916, "process_user_time": 1.929457, "process_kernel_time": 0.099971, "process_mem_max_rss": "108464", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m12:24:05.267686 [debug] [MainThread]: Command `dbt run` failed at 12:24:05.267608 after 0.97 seconds
[0m12:24:05.267908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff61727f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff615bb2610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6172caa50>]}
[0m12:24:05.268128 [debug] [MainThread]: Flushing usage events
[0m12:24:37.170973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2204f81b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2204fb3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2205410e10>]}


============================== 12:24:37.172565 | 75bb2951-d8f6-451a-bf7c-d00bab9c20f6 ==============================
[0m12:24:37.172565 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:24:37.172899 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:24:37.285296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75bb2951-d8f6-451a-bf7c-d00bab9c20f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2204d09b10>]}
[0m12:24:37.334875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75bb2951-d8f6-451a-bf7c-d00bab9c20f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2204db5ad0>]}
[0m12:24:37.335289 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m12:24:37.341877 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:24:37.342251 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:24:37.342522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '75bb2951-d8f6-451a-bf7c-d00bab9c20f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2204ca3f90>]}
[0m12:24:38.229696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75bb2951-d8f6-451a-bf7c-d00bab9c20f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21ff93fd90>]}
[0m12:24:38.243729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75bb2951-d8f6-451a-bf7c-d00bab9c20f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21ff9d2750>]}
[0m12:24:38.244034 [info ] [MainThread]: Found 3 models, 4 tests, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m12:24:38.244263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75bb2951-d8f6-451a-bf7c-d00bab9c20f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2204be1d10>]}
[0m12:24:38.245337 [info ] [MainThread]: 
[0m12:24:38.245867 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m12:24:38.246784 [debug] [ThreadPool]: Acquiring new trino connection 'list_tpch'
[0m12:24:38.256658 [debug] [ThreadPool]: Using trino connection "list_tpch"
[0m12:24:38.256856 [debug] [ThreadPool]: On list_tpch: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_tpch"} */

    select schema_name
    from "tpch".INFORMATION_SCHEMA.schemata
[0m12:24:38.257008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:38.925758 [debug] [ThreadPool]: Trino adapter: Trino error: failed to execute: ('Connection aborted.', BadStatusLine('\x15\x03\x03\x00\x02\x02P'))
[0m12:24:38.926878 [debug] [ThreadPool]: On list_tpch: Close
[0m12:24:38.928601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:24:38.928770 [debug] [MainThread]: Connection 'list_tpch' was properly closed.
[0m12:24:38.928930 [info ] [MainThread]: 
[0m12:24:38.929143 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m12:24:38.929473 [error] [MainThread]: Encountered an error:
Database Error
  failed to execute: ('Connection aborted.', BadStatusLine('\x15\x03\x03\x00\x02\x02P'))
[0m12:24:38.930031 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.7823567, "process_user_time": 2.097006, "process_kernel_time": 0.0699, "process_mem_max_rss": "113844", "process_in_blocks": "8", "process_out_blocks": "2208", "command_success": false}
[0m12:24:38.930459 [debug] [MainThread]: Command `dbt run` failed at 12:24:38.930298 after 1.78 seconds
[0m12:24:38.930851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2204fbdd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21ff9e9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2209677710>]}
[0m12:24:38.931210 [debug] [MainThread]: Flushing usage events
[0m12:25:57.270182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9daf0f9990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9daf58c490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9daf0fa810>]}


============================== 12:25:57.271848 | 57756e42-4fbb-43e5-86a8-d675b51e7683 ==============================
[0m12:25:57.271848 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:25:57.272189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:25:57.272506 [info ] [MainThread]: dbt version: 1.7.3
[0m12:25:57.272757 [info ] [MainThread]: python version: 3.11.6
[0m12:25:57.273014 [info ] [MainThread]: python path: /usr/sbin/python
[0m12:25:57.273231 [info ] [MainThread]: os info: Linux-5.15.133.1-microsoft-standard-WSL2-x86_64-with-glibc2.38
[0m12:25:57.338940 [info ] [MainThread]: Using profiles dir at /home/vadim/.dbt
[0m12:25:57.339295 [info ] [MainThread]: Using profiles.yml file at /home/vadim/.dbt/profiles.yml
[0m12:25:57.339513 [info ] [MainThread]: Using dbt_project.yml file at /home/vadim/dbt_trino_iceberg/dbt_project.yml
[0m12:25:57.339751 [info ] [MainThread]: adapter type: trino
[0m12:25:57.339939 [info ] [MainThread]: adapter version: 1.7.0
[0m12:25:57.385222 [info ] [MainThread]: Configuration:
[0m12:25:57.385564 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:25:57.385795 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:25:57.386063 [info ] [MainThread]: Required dependencies:
[0m12:25:57.386306 [debug] [MainThread]: Executing "git --help"
[0m12:25:57.407594 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:25:57.407933 [debug] [MainThread]: STDERR: "b''"
[0m12:25:57.408115 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:25:57.408331 [info ] [MainThread]: Connection:
[0m12:25:57.408583 [info ] [MainThread]:   host: 34.38.30.160
[0m12:25:57.408803 [info ] [MainThread]:   port: 8443
[0m12:25:57.408992 [info ] [MainThread]:   user: admin
[0m12:25:57.409190 [info ] [MainThread]:   database: tpch
[0m12:25:57.409425 [info ] [MainThread]:   schema: dbt
[0m12:25:57.409659 [info ] [MainThread]:   cert: None
[0m12:25:57.409853 [info ] [MainThread]:   prepared_statements_enabled: True
[0m12:25:57.410137 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m12:25:57.410581 [debug] [MainThread]: Acquiring new trino connection 'debug'
[0m12:25:57.413650 [debug] [MainThread]: Using trino connection "debug"
[0m12:25:57.413835 [debug] [MainThread]: On debug: select 1 as id
[0m12:25:57.413984 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:25:58.401175 [debug] [MainThread]: Trino adapter: Trino error: failed to execute: ('Connection aborted.', BadStatusLine('\x15\x03\x03\x00\x02\x02P'))
[0m12:25:58.402103 [debug] [MainThread]: On debug: Close
[0m12:25:58.402777 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m12:25:58.403593 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:25:58.404327 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  failed to execute: ('Connection aborted.', BadStatusLine('\x15\x03\x03\x00\x02\x02P'))

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m12:25:58.405735 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.1596493, "process_user_time": 1.185087, "process_kernel_time": 0.039834, "process_mem_max_rss": "99952", "process_out_blocks": "24", "command_success": false, "process_in_blocks": "0"}
[0m12:25:58.406507 [debug] [MainThread]: Command `dbt debug` failed at 12:25:58.406340 after 1.16 seconds
[0m12:25:58.406912 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:25:58.407311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9daf0fa810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9db37a3710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9db3627350>]}
[0m12:25:58.407719 [debug] [MainThread]: Flushing usage events
[0m12:29:50.276171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88544a7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88544a4ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88544a6490>]}


============================== 12:29:50.277826 | 4ef0b16f-3153-4450-82c6-b50013f23e1a ==============================
[0m12:29:50.277826 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:29:50.278165 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:29:50.278423 [info ] [MainThread]: dbt version: 1.7.3
[0m12:29:50.279880 [info ] [MainThread]: python version: 3.11.6
[0m12:29:50.280132 [info ] [MainThread]: python path: /usr/sbin/python
[0m12:29:50.280447 [info ] [MainThread]: os info: Linux-5.15.133.1-microsoft-standard-WSL2-x86_64-with-glibc2.38
[0m12:29:50.346355 [info ] [MainThread]: Using profiles dir at /home/vadim/.dbt
[0m12:29:50.346690 [info ] [MainThread]: Using profiles.yml file at /home/vadim/.dbt/profiles.yml
[0m12:29:50.346951 [info ] [MainThread]: Using dbt_project.yml file at /home/vadim/dbt_trino_iceberg/dbt_project.yml
[0m12:29:50.347177 [info ] [MainThread]: adapter type: trino
[0m12:29:50.347384 [info ] [MainThread]: adapter version: 1.7.0
[0m12:29:50.394412 [info ] [MainThread]: Configuration:
[0m12:29:50.394770 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:29:50.395047 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:29:50.395323 [info ] [MainThread]: Required dependencies:
[0m12:29:50.395612 [debug] [MainThread]: Executing "git --help"
[0m12:29:50.397708 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:29:50.397944 [debug] [MainThread]: STDERR: "b''"
[0m12:29:50.398097 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:29:50.398279 [info ] [MainThread]: Connection:
[0m12:29:50.398496 [info ] [MainThread]:   host: 34.38.30.160
[0m12:29:50.398731 [info ] [MainThread]:   port: 8443
[0m12:29:50.398913 [info ] [MainThread]:   user: admin
[0m12:29:50.399112 [info ] [MainThread]:   database: tpch
[0m12:29:50.399289 [info ] [MainThread]:   schema: dbt
[0m12:29:50.399475 [info ] [MainThread]:   cert: None
[0m12:29:50.399657 [info ] [MainThread]:   prepared_statements_enabled: True
[0m12:29:50.399924 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m12:29:50.400271 [debug] [MainThread]: Acquiring new trino connection 'debug'
[0m12:29:50.403272 [debug] [MainThread]: Using trino connection "debug"
[0m12:29:50.403462 [debug] [MainThread]: On debug: select 1 as id
[0m12:29:50.403610 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:29:51.064247 [debug] [MainThread]: Trino adapter: Trino error: failed to execute: ('Connection aborted.', BadStatusLine('\x15\x03\x03\x00\x02\x02P'))
[0m12:29:51.065141 [debug] [MainThread]: On debug: Close
[0m12:29:51.065899 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m12:29:51.066740 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:29:51.067599 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  failed to execute: ('Connection aborted.', BadStatusLine('\x15\x03\x03\x00\x02\x02P'))

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m12:29:51.068462 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.8160946, "process_user_time": 1.184935, "process_kernel_time": 0.040167, "process_mem_max_rss": "99892", "process_out_blocks": "24", "command_success": false, "process_in_blocks": "0"}
[0m12:29:51.068756 [debug] [MainThread]: Command `dbt debug` failed at 12:29:51.068688 after 0.82 seconds
[0m12:29:51.068932 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:29:51.069098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8858b538d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f885449a8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f885449be10>]}
[0m12:29:51.069302 [debug] [MainThread]: Flushing usage events
[0m12:41:41.681677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe77866be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe77866bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe778837410>]}


============================== 12:41:41.683523 | 5e451de6-10eb-4a45-87d8-a9181c25ce3e ==============================
[0m12:41:41.683523 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:41:41.683876 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models dbt_trino_iceberg/models/staging', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:41:41.796950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e451de6-10eb-4a45-87d8-a9181c25ce3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7785ce190>]}
[0m12:41:41.847823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e451de6-10eb-4a45-87d8-a9181c25ce3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7787466d0>]}
[0m12:41:41.848233 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m12:41:41.855179 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:41:41.870846 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:41:41.871122 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:41:41.874795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e451de6-10eb-4a45-87d8-a9181c25ce3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe77845cb10>]}
[0m12:41:41.885900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e451de6-10eb-4a45-87d8-a9181c25ce3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe778396d50>]}
[0m12:41:41.886263 [info ] [MainThread]: Found 3 models, 4 tests, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m12:41:41.886519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e451de6-10eb-4a45-87d8-a9181c25ce3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7784cbc90>]}
[0m12:41:41.887179 [warn ] [MainThread]: The selection criterion 'dbt_trino_iceberg/models/staging' does not match any nodes
[0m12:41:41.887853 [info ] [MainThread]: 
[0m12:41:41.888061 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:41:41.888402 [debug] [MainThread]: Command end result
[0m12:41:41.894232 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.2368638, "process_user_time": 1.238386, "process_kernel_time": 0.02996, "process_mem_max_rss": "105912", "process_out_blocks": "2216", "process_in_blocks": "0"}
[0m12:41:41.894599 [debug] [MainThread]: Command `dbt run` succeeded at 12:41:41.894513 after 0.24 seconds
[0m12:41:41.894817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe77cee51d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7785f4b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe77cdf7410>]}
[0m12:41:41.895022 [debug] [MainThread]: Flushing usage events
[0m12:48:36.403889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02fd8b7310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02fd896b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02fd6eb510>]}


============================== 12:48:36.405597 | 871df8ce-cddd-4b70-86cd-3e9a2a69c279 ==============================
[0m12:48:36.405597 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:48:36.405948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models dbt_trino_iceberg/models/staging', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:48:36.520153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '871df8ce-cddd-4b70-86cd-3e9a2a69c279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02fd6b2c90>]}
[0m12:48:36.570222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '871df8ce-cddd-4b70-86cd-3e9a2a69c279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02fd8974d0>]}
[0m12:48:36.570651 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m12:48:36.577320 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:48:36.586419 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_trino_iceberg: staging/test.yml - Runtime Error
    Syntax error near line 6
    ------------------------------
    3  |         materialized = 'ephemeral'
    4  |     )
    5  | }}
    6  | select
    7  |     ps_partkey as part_key,
    8  |     ps_suppkey as supplier_key,
    9  |     ps_availqty as supplier_availabe_quantity,
    
    Raw Error:
    ------------------------------
    did not find expected <document start>
      in "<unicode string>", line 6, column 1
[0m12:48:36.587104 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.20760716, "process_user_time": 1.264682, "process_mem_max_rss": "103468", "process_out_blocks": "16", "command_success": false, "process_kernel_time": 0.0, "process_in_blocks": "0"}
[0m12:48:36.587472 [debug] [MainThread]: Command `dbt run` failed at 12:48:36.587396 after 0.21 seconds
[0m12:48:36.587689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02fd89b8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02fd89a450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0301e73590>]}
[0m12:48:36.587935 [debug] [MainThread]: Flushing usage events
[0m12:50:03.972897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a713556d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a71357390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a71356a90>]}


============================== 12:50:03.974652 | c58a637c-1ff4-41b4-a6b5-a24480327b9c ==============================
[0m12:50:03.974652 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:50:03.975001 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models dbt_trino_iceberg/models/staging', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:50:04.088549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c58a637c-1ff4-41b4-a6b5-a24480327b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a713471d0>]}
[0m12:50:04.139125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c58a637c-1ff4-41b4-a6b5-a24480327b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a713b2bd0>]}
[0m12:50:04.139628 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m12:50:04.146274 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:50:04.154486 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_trino_iceberg: staging/test.yml - Runtime Error
    Syntax error near line 6
    ------------------------------
    3  |         materialized = 'ephemeral'
    4  |     )
    5  | }}
    6  | select
    7  |     ps_partkey as part_key,
    8  |     ps_suppkey as supplier_key,
    9  |     ps_availqty as supplier_availabe_quantity,
    
    Raw Error:
    ------------------------------
    did not find expected <document start>
      in "<unicode string>", line 6, column 1
[0m12:50:04.155118 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.2069702, "process_user_time": 1.218303, "process_kernel_time": 0.04993, "process_mem_max_rss": "103200", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m12:50:04.155483 [debug] [MainThread]: Command `dbt run` failed at 12:50:04.155407 after 0.21 seconds
[0m12:50:04.155700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a70fbf0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a713a4dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a75ad7990>]}
[0m12:50:04.155910 [debug] [MainThread]: Flushing usage events
[0m12:51:57.302878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa38893ae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3889398d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa38893be10>]}


============================== 12:51:57.304576 | 08245f01-c458-44f3-8ebb-32ac4238fc33 ==============================
[0m12:51:57.304576 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:51:57.304922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models dbt_trino_iceberg/models/staging', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:51:57.418198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08245f01-c458-44f3-8ebb-32ac4238fc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3886d09d0>]}
[0m12:51:57.469452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08245f01-c458-44f3-8ebb-32ac4238fc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3886bf250>]}
[0m12:51:57.469912 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m12:51:57.476669 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:51:57.484431 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_trino_iceberg: staging/test.yml - Runtime Error
    Syntax error near line 6
    ------------------------------
    3  |         materialized = 'ephemeral'
    4  |     )
    5  | }}
    6  | select
    7  |     ps_partkey as part_key,
    8  |     ps_suppkey as supplier_key,
    9  |     ps_availqty as supplier_availabe_quantity,
    
    Raw Error:
    ------------------------------
    did not find expected <document start>
      in "<unicode string>", line 6, column 1
[0m12:51:57.485019 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.20560066, "process_user_time": 1.205864, "process_kernel_time": 0.029897, "process_mem_max_rss": "103512", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m12:51:57.485337 [debug] [MainThread]: Command `dbt run` failed at 12:51:57.485264 after 0.21 seconds
[0m12:51:57.485541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa389a4bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa38cefb590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa38891fe10>]}
[0m12:51:57.485777 [debug] [MainThread]: Flushing usage events
[0m12:56:03.129441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b8346bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b8329ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b8329f050>]}


============================== 12:56:03.131192 | 87cceffa-520a-4f8a-ab75-192ea40df596 ==============================
[0m12:56:03.131192 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:56:03.131532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models dbt_trino_iceberg/models/staging', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:56:03.243774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87cceffa-520a-4f8a-ab75-192ea40df596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b832c3190>]}
[0m12:56:03.293974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87cceffa-520a-4f8a-ab75-192ea40df596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b83a90810>]}
[0m12:56:03.294377 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m12:56:03.301112 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:56:03.309271 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_trino_iceberg: staging/test.yml - Runtime Error
    Syntax error near line 6
    ------------------------------
    3  |         materialized = 'ephemeral'
    4  |     )
    5  | }}
    6  | select
    7  |     ps_partkey as part_key,
    8  |     ps_suppkey as supplier_key,
    9  |     ps_availqty as supplier_availabe_quantity,
    
    Raw Error:
    ------------------------------
    did not find expected <document start>
      in "<unicode string>", line 6, column 1
[0m12:56:03.309882 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.2047532, "process_user_time": 1.184067, "process_kernel_time": 0.070241, "process_mem_max_rss": "103420", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m12:56:03.310213 [debug] [MainThread]: Command `dbt run` failed at 12:56:03.310127 after 0.21 seconds
[0m12:56:03.310447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b82ee72d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b831f0610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b87a2b410>]}
[0m12:56:03.310657 [debug] [MainThread]: Flushing usage events
[0m12:56:46.009977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb138ec74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb138ef3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb138ec7350>]}


============================== 12:56:46.011624 | ae5fbbde-b501-4156-96f9-45203d44e217 ==============================
[0m12:56:46.011624 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:56:46.011967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models dbt_trino_iceberg/models/staging', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:56:46.126325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae5fbbde-b501-4156-96f9-45203d44e217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb138cc3f50>]}
[0m12:56:46.176780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae5fbbde-b501-4156-96f9-45203d44e217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb138e01b50>]}
[0m12:56:46.177180 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m12:56:46.183956 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:56:46.199760 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:56:46.200157 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/staging/stg_tpch_part_suppliers.sql
[0m12:56:46.284916 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_trino_iceberg.stg_tpch_part_suppliers' (models/staging/stg_tpch_part_suppliers.sql) depends on a source named 'tpch.partsupp' which was not found
[0m12:56:46.285564 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.29950383, "process_user_time": 1.279606, "process_kernel_time": 0.039987, "process_mem_max_rss": "105112", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m12:56:46.285927 [debug] [MainThread]: Command `dbt run` failed at 12:56:46.285849 after 0.30 seconds
[0m12:56:46.286143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb138ef4250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb139348d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb138e9a810>]}
[0m12:56:46.286350 [debug] [MainThread]: Flushing usage events
[0m12:57:44.320074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a2380b510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a2433e7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a23809ad0>]}


============================== 12:57:44.321728 | 79551b84-5c8f-40a0-bed6-4717b74e8165 ==============================
[0m12:57:44.321728 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:57:44.322186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --models dbt_trino_iceberg/models/staging', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:57:44.435790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79551b84-5c8f-40a0-bed6-4717b74e8165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a2364c210>]}
[0m12:57:44.486895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79551b84-5c8f-40a0-bed6-4717b74e8165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a235a0e50>]}
[0m12:57:44.487305 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m12:57:44.493980 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:57:44.510501 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:57:44.510967 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/staging/stg_tpch_part_suppliers.sql
[0m12:57:44.605142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79551b84-5c8f-40a0-bed6-4717b74e8165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a231eafd0>]}
[0m12:57:44.613335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79551b84-5c8f-40a0-bed6-4717b74e8165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a234eea90>]}
[0m12:57:44.613672 [info ] [MainThread]: Found 3 models, 4 tests, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m12:57:44.613950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79551b84-5c8f-40a0-bed6-4717b74e8165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a23342d90>]}
[0m12:57:44.614664 [warn ] [MainThread]: The selection criterion 'dbt_trino_iceberg/models/staging' does not match any nodes
[0m12:57:44.615400 [info ] [MainThread]: 
[0m12:57:44.615627 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:57:44.616022 [debug] [MainThread]: Command end result
[0m12:57:44.621201 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.32459763, "process_user_time": 1.306014, "process_kernel_time": 0.100462, "process_mem_max_rss": "108320", "process_out_blocks": "3296", "process_in_blocks": "0"}
[0m12:57:44.621600 [debug] [MainThread]: Command `dbt run` succeeded at 12:57:44.621517 after 0.33 seconds
[0m12:57:44.621850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a23809ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a24358f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a23643110>]}
[0m12:57:44.622065 [debug] [MainThread]: Flushing usage events
[0m13:12:37.948665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a3c763a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a3c763950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a3c763b10>]}


============================== 13:12:37.950354 | cbfb80a8-b06b-4691-9d83-14f647ffb4a0 ==============================
[0m13:12:37.950354 [info ] [MainThread]: Running with dbt=1.7.3
[0m13:12:37.950755 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --models dbt_trino_iceberg/models/staging', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:12:38.066816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbfb80a8-b06b-4691-9d83-14f647ffb4a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a3c5534d0>]}
[0m13:12:38.117527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbfb80a8-b06b-4691-9d83-14f647ffb4a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a3cd58910>]}
[0m13:12:38.117955 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m13:12:38.124766 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m13:12:38.131316 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:12:38.131614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cbfb80a8-b06b-4691-9d83-14f647ffb4a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a3c40d7d0>]}
[0m13:12:38.923482 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_trino_iceberg.models
[0m13:12:38.927013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbfb80a8-b06b-4691-9d83-14f647ffb4a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a3c10fdd0>]}
[0m13:12:38.934751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbfb80a8-b06b-4691-9d83-14f647ffb4a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a3c090050>]}
[0m13:12:38.935372 [info ] [MainThread]: Found 3 models, 4 tests, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m13:12:38.935804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbfb80a8-b06b-4691-9d83-14f647ffb4a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a3c2037d0>]}
[0m13:12:38.936593 [warn ] [MainThread]: The selection criterion 'dbt_trino_iceberg/models/staging' does not match any nodes
[0m13:12:38.937287 [info ] [MainThread]: 
[0m13:12:38.937499 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:12:38.937881 [debug] [MainThread]: Command end result
[0m13:12:38.943306 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.018677, "process_user_time": 2.003349, "process_kernel_time": 0.079735, "process_mem_max_rss": "111696", "process_out_blocks": "3280", "process_in_blocks": "0"}
[0m13:12:38.943692 [debug] [MainThread]: Command `dbt run` succeeded at 13:12:38.943600 after 1.02 seconds
[0m13:12:38.943918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a3cdfdc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a3c1307d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a3b073450>]}
[0m13:12:38.944132 [debug] [MainThread]: Flushing usage events
[0m13:16:05.696862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7864197e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78651b3950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7864196d50>]}


============================== 13:16:05.698538 | 3099c7c8-d275-4d1c-abc1-e634a7f9700f ==============================
[0m13:16:05.698538 [info ] [MainThread]: Running with dbt=1.7.3
[0m13:16:05.698882 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models dbt_trino_iceberg/models/staging', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:16:05.810272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3099c7c8-d275-4d1c-abc1-e634a7f9700f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7863f0da10>]}
[0m13:16:05.860165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3099c7c8-d275-4d1c-abc1-e634a7f9700f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7863dc6650>]}
[0m13:16:05.860602 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m13:16:05.867423 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m13:16:05.873920 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:16:05.874235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3099c7c8-d275-4d1c-abc1-e634a7f9700f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7863c18310>]}
[0m13:16:06.661111 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_trino_iceberg.models2
[0m13:16:06.664644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3099c7c8-d275-4d1c-abc1-e634a7f9700f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f786297d6d0>]}
[0m13:16:06.671392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3099c7c8-d275-4d1c-abc1-e634a7f9700f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78629d9690>]}
[0m13:16:06.671704 [info ] [MainThread]: Found 3 models, 4 tests, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m13:16:06.671949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3099c7c8-d275-4d1c-abc1-e634a7f9700f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7863be0550>]}
[0m13:16:06.672626 [warn ] [MainThread]: The selection criterion 'dbt_trino_iceberg/models/staging' does not match any nodes
[0m13:16:06.673290 [info ] [MainThread]: 
[0m13:16:06.673512 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:16:06.673884 [debug] [MainThread]: Command end result
[0m13:16:06.679553 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0058172, "process_user_time": 1.993787, "process_kernel_time": 0.060114, "process_mem_max_rss": "111672", "process_out_blocks": "3272", "process_in_blocks": "0"}
[0m13:16:06.679954 [debug] [MainThread]: Command `dbt run` succeeded at 13:16:06.679861 after 1.01 seconds
[0m13:16:06.680173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78641a1d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78688410d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7863eef650>]}
[0m13:16:06.680408 [debug] [MainThread]: Flushing usage events
[0m13:16:59.931340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5737d96310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5737d967d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5737d94750>]}


============================== 13:16:59.933042 | 75d66859-2835-4f4a-a4b1-4fa4428c350c ==============================
[0m13:16:59.933042 [info ] [MainThread]: Running with dbt=1.7.3
[0m13:16:59.933402 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models dbt_trino_iceberg/models/staging', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:17:00.052401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75d66859-2835-4f4a-a4b1-4fa4428c350c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5737b2c950>]}
[0m13:17:00.102130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75d66859-2835-4f4a-a4b1-4fa4428c350c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5737b1fa10>]}
[0m13:17:00.102722 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m13:17:00.110368 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m13:17:00.117004 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:17:00.117333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '75d66859-2835-4f4a-a4b1-4fa4428c350c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5737bb7490>]}
[0m13:17:00.912817 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_trino_iceberg
[0m13:17:00.916437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75d66859-2835-4f4a-a4b1-4fa4428c350c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57376f7510>]}
[0m13:17:00.923731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75d66859-2835-4f4a-a4b1-4fa4428c350c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5736404b10>]}
[0m13:17:00.924058 [info ] [MainThread]: Found 3 models, 4 tests, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m13:17:00.924346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75d66859-2835-4f4a-a4b1-4fa4428c350c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573791abd0>]}
[0m13:17:00.924990 [warn ] [MainThread]: The selection criterion 'dbt_trino_iceberg/models/staging' does not match any nodes
[0m13:17:00.925626 [info ] [MainThread]: 
[0m13:17:00.925840 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:17:00.926204 [debug] [MainThread]: Command end result
[0m13:17:00.931433 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0241601, "process_user_time": 2.005967, "process_kernel_time": 0.060179, "process_mem_max_rss": "112164", "process_out_blocks": "3280", "process_in_blocks": "0"}
[0m13:17:00.931789 [debug] [MainThread]: Command `dbt run` succeeded at 13:17:00.931706 after 1.02 seconds
[0m13:17:00.932009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5737bd4ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573c357350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573c357390>]}
[0m13:17:00.932222 [debug] [MainThread]: Flushing usage events
[0m13:17:17.969960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4bc43b290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4bc46b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4bc43a750>]}


============================== 13:17:17.971599 | 9eb3780a-e6e2-4ab4-9dee-8a28a94746c2 ==============================
[0m13:17:17.971599 [info ] [MainThread]: Running with dbt=1.7.3
[0m13:17:17.971966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:17:18.086400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9eb3780a-e6e2-4ab4-9dee-8a28a94746c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4bc2793d0>]}
[0m13:17:18.136634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9eb3780a-e6e2-4ab4-9dee-8a28a94746c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4bcf6bb10>]}
[0m13:17:18.137097 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m13:17:18.144265 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m13:17:18.158879 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:17:18.159132 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:17:18.159521 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_trino_iceberg
[0m13:17:18.162963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9eb3780a-e6e2-4ab4-9dee-8a28a94746c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4bc058c10>]}
[0m13:17:18.170124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9eb3780a-e6e2-4ab4-9dee-8a28a94746c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4bbf96c10>]}
[0m13:17:18.170475 [info ] [MainThread]: Found 3 models, 4 tests, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m13:17:18.170709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9eb3780a-e6e2-4ab4-9dee-8a28a94746c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4bc436290>]}
[0m13:17:18.171927 [info ] [MainThread]: 
[0m13:17:18.172538 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:17:18.173739 [debug] [ThreadPool]: Acquiring new trino connection 'list_tpch'
[0m13:17:18.184106 [debug] [ThreadPool]: Using trino connection "list_tpch"
[0m13:17:18.184366 [debug] [ThreadPool]: On list_tpch: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_tpch"} */

    select schema_name
    from "tpch".INFORMATION_SCHEMA.schemata
[0m13:17:18.184539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:17:19.504121 [debug] [ThreadPool]: Trino adapter: Trino error: failed to execute: ('Connection aborted.', BadStatusLine('\x15\x03\x03\x00\x02\x02P'))
[0m13:17:19.505250 [debug] [ThreadPool]: On list_tpch: Close
[0m13:17:19.507596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:17:19.507765 [debug] [MainThread]: Connection 'list_tpch' was properly closed.
[0m13:17:19.507934 [info ] [MainThread]: 
[0m13:17:19.508153 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.34 seconds (1.34s).
[0m13:17:19.508477 [error] [MainThread]: Encountered an error:
Database Error
  failed to execute: ('Connection aborted.', BadStatusLine('\x15\x03\x03\x00\x02\x02P'))
[0m13:17:19.509102 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.5629334, "process_user_time": 1.214021, "process_kernel_time": 0.070817, "process_mem_max_rss": "105448", "process_out_blocks": "1112", "command_success": false, "process_in_blocks": "0"}
[0m13:17:19.509382 [debug] [MainThread]: Command `dbt run` failed at 13:17:19.509315 after 1.56 seconds
[0m13:17:19.509574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4bc8c0dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c0a612d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c0a61290>]}
[0m13:17:19.509858 [debug] [MainThread]: Flushing usage events
[0m13:17:38.839079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f287f1fa1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f287f24b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f287f6a89d0>]}


============================== 13:17:38.840728 | 20c49b1c-c04b-4297-a51b-ef3707c8722b ==============================
[0m13:17:38.840728 [info ] [MainThread]: Running with dbt=1.7.3
[0m13:17:38.841108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:17:38.841398 [info ] [MainThread]: dbt version: 1.7.3
[0m13:17:38.841672 [info ] [MainThread]: python version: 3.11.6
[0m13:17:38.841935 [info ] [MainThread]: python path: /usr/sbin/python
[0m13:17:38.842236 [info ] [MainThread]: os info: Linux-5.15.133.1-microsoft-standard-WSL2-x86_64-with-glibc2.38
[0m13:17:38.908309 [info ] [MainThread]: Using profiles dir at /home/vadim/.dbt
[0m13:17:38.908714 [info ] [MainThread]: Using profiles.yml file at /home/vadim/.dbt/profiles.yml
[0m13:17:38.908962 [info ] [MainThread]: Using dbt_project.yml file at /home/vadim/dbt_trino_iceberg/dbt_project.yml
[0m13:17:38.909194 [info ] [MainThread]: adapter type: trino
[0m13:17:38.909455 [info ] [MainThread]: adapter version: 1.7.0
[0m13:17:38.955430 [info ] [MainThread]: Configuration:
[0m13:17:38.955772 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:17:38.956038 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:17:38.956370 [info ] [MainThread]: Required dependencies:
[0m13:17:38.956626 [debug] [MainThread]: Executing "git --help"
[0m13:17:38.959525 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:17:38.959759 [debug] [MainThread]: STDERR: "b''"
[0m13:17:38.959911 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:17:38.960089 [info ] [MainThread]: Connection:
[0m13:17:38.960322 [info ] [MainThread]:   host: 34.38.30.160
[0m13:17:38.960613 [info ] [MainThread]:   port: 8443
[0m13:17:38.960830 [info ] [MainThread]:   user: admin
[0m13:17:38.961123 [info ] [MainThread]:   database: tpch
[0m13:17:38.961402 [info ] [MainThread]:   schema: dbt
[0m13:17:38.961605 [info ] [MainThread]:   cert: None
[0m13:17:38.961808 [info ] [MainThread]:   prepared_statements_enabled: True
[0m13:17:38.962123 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m13:17:38.962561 [debug] [MainThread]: Acquiring new trino connection 'debug'
[0m13:17:38.965311 [debug] [MainThread]: Using trino connection "debug"
[0m13:17:38.965510 [debug] [MainThread]: On debug: select 1 as id
[0m13:17:38.965658 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:17:40.173066 [debug] [MainThread]: Trino adapter: Trino error: failed to execute: ('Connection aborted.', BadStatusLine('\x15\x03\x03\x00\x02\x02P'))
[0m13:17:40.174068 [debug] [MainThread]: On debug: Close
[0m13:17:40.174803 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m13:17:40.175576 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:17:40.176402 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  failed to execute: ('Connection aborted.', BadStatusLine('\x15\x03\x03\x00\x02\x02P'))

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m13:17:40.177662 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.3624871, "process_user_time": 1.147883, "process_kernel_time": 0.049907, "process_mem_max_rss": "99968", "process_out_blocks": "24", "command_success": false, "process_in_blocks": "0"}
[0m13:17:40.177943 [debug] [MainThread]: Command `dbt debug` failed at 13:17:40.177878 after 1.36 seconds
[0m13:17:40.178114 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:17:40.178280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f287f23e010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f287f03c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f287f1fa290>]}
[0m13:17:40.178476 [debug] [MainThread]: Flushing usage events
[0m13:18:56.904562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f231abb4d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f231abc6c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f231c11fed0>]}


============================== 13:18:56.906217 | 17cf428f-115b-4eb5-a428-2931a017ee1a ==============================
[0m13:18:56.906217 [info ] [MainThread]: Running with dbt=1.7.3
[0m13:18:56.906551 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:18:56.906861 [info ] [MainThread]: dbt version: 1.7.3
[0m13:18:56.907148 [info ] [MainThread]: python version: 3.11.6
[0m13:18:56.907405 [info ] [MainThread]: python path: /usr/sbin/python
[0m13:18:56.907622 [info ] [MainThread]: os info: Linux-5.15.133.1-microsoft-standard-WSL2-x86_64-with-glibc2.38
[0m13:18:56.974932 [info ] [MainThread]: Using profiles dir at /home/vadim/.dbt
[0m13:18:56.975317 [info ] [MainThread]: Using profiles.yml file at /home/vadim/.dbt/profiles.yml
[0m13:18:56.975556 [info ] [MainThread]: Using dbt_project.yml file at /home/vadim/dbt_trino_iceberg/dbt_project.yml
[0m13:18:56.975819 [info ] [MainThread]: adapter type: trino
[0m13:18:56.976107 [info ] [MainThread]: adapter version: 1.7.0
[0m13:18:57.021086 [info ] [MainThread]: Configuration:
[0m13:18:57.021423 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:18:57.021672 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:18:57.021993 [info ] [MainThread]: Required dependencies:
[0m13:18:57.022251 [debug] [MainThread]: Executing "git --help"
[0m13:18:57.024196 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:18:57.024496 [debug] [MainThread]: STDERR: "b''"
[0m13:18:57.024652 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:18:57.024839 [info ] [MainThread]: Connection:
[0m13:18:57.025059 [info ] [MainThread]:   host: 34.38.30.160
[0m13:18:57.025342 [info ] [MainThread]:   port: 8443
[0m13:18:57.025564 [info ] [MainThread]:   user: admin
[0m13:18:57.025783 [info ] [MainThread]:   database: tpch
[0m13:18:57.026007 [info ] [MainThread]:   schema: dbt
[0m13:18:57.026220 [info ] [MainThread]:   cert: None
[0m13:18:57.026415 [info ] [MainThread]:   prepared_statements_enabled: True
[0m13:18:57.026690 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m13:18:57.027086 [debug] [MainThread]: Acquiring new trino connection 'debug'
[0m13:18:57.029815 [debug] [MainThread]: Using trino connection "debug"
[0m13:18:57.029998 [debug] [MainThread]: On debug: select 1 as id
[0m13:18:57.030149 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:18:57.974197 [debug] [MainThread]: Trino adapter: Trino error: failed to execute: ('Connection aborted.', BadStatusLine('\x15\x03\x03\x00\x02\x02P'))
[0m13:18:57.975102 [debug] [MainThread]: On debug: Close
[0m13:18:57.975767 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m13:18:57.976503 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:18:57.977195 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  failed to execute: ('Connection aborted.', BadStatusLine('\x15\x03\x03\x00\x02\x02P'))

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m13:18:57.978699 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.0977501, "process_user_time": 1.152495, "process_kernel_time": 0.040086, "process_mem_max_rss": "99860", "process_out_blocks": "24", "command_success": false, "process_in_blocks": "0"}
[0m13:18:57.978974 [debug] [MainThread]: Command `dbt debug` failed at 13:18:57.978908 after 1.10 seconds
[0m13:18:57.979140 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:18:57.979305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f231abc6c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f231ad6e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f231b3f8850>]}
[0m13:18:57.979501 [debug] [MainThread]: Flushing usage events
[0m13:20:53.699397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8927aefd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8927afe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8927ae510>]}


============================== 13:20:53.701206 | e423c2e5-08a3-49d8-a60b-96d2208f53bf ==============================
[0m13:20:53.701206 [info ] [MainThread]: Running with dbt=1.7.3
[0m13:20:53.701556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:20:53.701866 [info ] [MainThread]: dbt version: 1.7.3
[0m13:20:53.702164 [info ] [MainThread]: python version: 3.11.6
[0m13:20:53.702395 [info ] [MainThread]: python path: /usr/sbin/python
[0m13:20:53.702633 [info ] [MainThread]: os info: Linux-5.15.133.1-microsoft-standard-WSL2-x86_64-with-glibc2.38
[0m13:20:53.769778 [info ] [MainThread]: Using profiles dir at /home/vadim/.dbt
[0m13:20:53.770160 [info ] [MainThread]: Using profiles.yml file at /home/vadim/.dbt/profiles.yml
[0m13:20:53.770384 [info ] [MainThread]: Using dbt_project.yml file at /home/vadim/dbt_trino_iceberg/dbt_project.yml
[0m13:20:53.770705 [info ] [MainThread]: adapter type: trino
[0m13:20:53.770985 [info ] [MainThread]: adapter version: 1.7.0
[0m13:20:53.817562 [info ] [MainThread]: Configuration:
[0m13:20:53.817923 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:20:53.818170 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:20:53.818481 [info ] [MainThread]: Required dependencies:
[0m13:20:53.818749 [debug] [MainThread]: Executing "git --help"
[0m13:20:53.820656 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:20:53.820893 [debug] [MainThread]: STDERR: "b''"
[0m13:20:53.821049 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:20:53.821236 [info ] [MainThread]: Connection:
[0m13:20:53.821449 [info ] [MainThread]:   host: 34.38.30.160
[0m13:20:53.821675 [info ] [MainThread]:   port: 8443
[0m13:20:53.821893 [info ] [MainThread]:   user: admin
[0m13:20:53.822073 [info ] [MainThread]:   database: tpch
[0m13:20:53.822268 [info ] [MainThread]:   schema: dbt
[0m13:20:53.822456 [info ] [MainThread]:   cert: None
[0m13:20:53.822681 [info ] [MainThread]:   prepared_statements_enabled: True
[0m13:20:53.822927 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m13:20:53.823341 [debug] [MainThread]: Acquiring new trino connection 'debug'
[0m13:20:53.826056 [debug] [MainThread]: Using trino connection "debug"
[0m13:20:53.826238 [debug] [MainThread]: On debug: select 1 as id
[0m13:20:53.826382 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:20:54.985052 [debug] [MainThread]: Trino adapter: Trino error: failed to execute: ('Connection aborted.', BadStatusLine('\x15\x03\x03\x00\x02\x02P'))
[0m13:20:54.986024 [debug] [MainThread]: On debug: Close
[0m13:20:54.986756 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m13:20:54.987493 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:20:54.988240 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  failed to execute: ('Connection aborted.', BadStatusLine('\x15\x03\x03\x00\x02\x02P'))

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m13:20:54.989867 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.3144139, "process_user_time": 1.147466, "process_kernel_time": 0.049889, "process_mem_max_rss": "100068", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m13:20:54.990352 [debug] [MainThread]: Command `dbt debug` failed at 13:20:54.990284 after 1.32 seconds
[0m13:20:54.990526 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:20:54.990691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8927999d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc89279a610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc892799a90>]}
[0m13:20:54.990895 [debug] [MainThread]: Flushing usage events
[0m14:21:43.649453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8233f46ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8233f47450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8233f47750>]}


============================== 14:21:43.651219 | b6581a78-cdd7-46ff-8457-6226b2d50d29 ==============================
[0m14:21:43.651219 [info ] [MainThread]: Running with dbt=1.7.3
[0m14:21:43.651569 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:21:43.651839 [info ] [MainThread]: dbt version: 1.7.3
[0m14:21:43.652116 [info ] [MainThread]: python version: 3.11.6
[0m14:21:43.652353 [info ] [MainThread]: python path: /usr/sbin/python
[0m14:21:43.652609 [info ] [MainThread]: os info: Linux-5.15.133.1-microsoft-standard-WSL2-x86_64-with-glibc2.38
[0m14:21:43.719356 [info ] [MainThread]: Using profiles dir at /home/vadim/.dbt
[0m14:21:43.719709 [info ] [MainThread]: Using profiles.yml file at /home/vadim/.dbt/profiles.yml
[0m14:21:43.719933 [info ] [MainThread]: Using dbt_project.yml file at /home/vadim/dbt_trino_iceberg/dbt_project.yml
[0m14:21:43.720250 [info ] [MainThread]: adapter type: trino
[0m14:21:43.720476 [info ] [MainThread]: adapter version: 1.7.0
[0m14:21:43.764646 [info ] [MainThread]: Configuration:
[0m14:21:43.764967 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:21:43.765185 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:21:43.765459 [info ] [MainThread]: Required dependencies:
[0m14:21:43.765689 [debug] [MainThread]: Executing "git --help"
[0m14:21:43.768236 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:21:43.768571 [debug] [MainThread]: STDERR: "b''"
[0m14:21:43.768748 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:21:43.768930 [info ] [MainThread]: Connection:
[0m14:21:43.769127 [info ] [MainThread]:   host: 34.38.30.160
[0m14:21:43.769330 [info ] [MainThread]:   port: 8443
[0m14:21:43.769561 [info ] [MainThread]:   user: admin
[0m14:21:43.769764 [info ] [MainThread]:   database: tpch
[0m14:21:43.769961 [info ] [MainThread]:   schema: dbt
[0m14:21:43.770213 [info ] [MainThread]:   cert: None
[0m14:21:43.770418 [info ] [MainThread]:   prepared_statements_enabled: True
[0m14:21:43.770751 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m14:21:43.771229 [debug] [MainThread]: Acquiring new trino connection 'debug'
[0m14:21:43.773946 [debug] [MainThread]: Using trino connection "debug"
[0m14:21:43.774123 [debug] [MainThread]: On debug: select 1 as id
[0m14:21:43.774267 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:21:44.851025 [debug] [MainThread]: Trino adapter: Trino error: failed to execute: ('Connection aborted.', BadStatusLine('\x15\x03\x03\x00\x02\x02P'))
[0m14:21:44.852006 [debug] [MainThread]: On debug: Close
[0m14:21:44.852678 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:21:44.853516 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:21:44.854208 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  failed to execute: ('Connection aborted.', BadStatusLine('\x15\x03\x03\x00\x02\x02P'))

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:21:44.855732 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.2309738, "process_user_time": 1.13946, "process_kernel_time": 0.119943, "process_mem_max_rss": "99944", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m14:21:44.856403 [debug] [MainThread]: Command `dbt debug` failed at 14:21:44.856238 after 1.23 seconds
[0m14:21:44.856815 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:21:44.857230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8233f32550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8233f86710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82384a7450>]}
[0m14:21:44.857553 [debug] [MainThread]: Flushing usage events
[0m14:22:19.544584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42fe5bf6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42fe40a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42fe935910>]}


============================== 14:22:19.546217 | 46e8b120-e372-4779-ba7c-fc4bf8499720 ==============================
[0m14:22:19.546217 [info ] [MainThread]: Running with dbt=1.7.3
[0m14:22:19.546548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:22:19.546806 [info ] [MainThread]: dbt version: 1.7.3
[0m14:22:19.547046 [info ] [MainThread]: python version: 3.11.6
[0m14:22:19.547255 [info ] [MainThread]: python path: /usr/sbin/python
[0m14:22:19.547447 [info ] [MainThread]: os info: Linux-5.15.133.1-microsoft-standard-WSL2-x86_64-with-glibc2.38
[0m14:22:19.549409 [info ] [MainThread]: Using profiles dir at /home/vadim/.dbt
[0m14:22:19.549632 [info ] [MainThread]: Using profiles.yml file at /home/vadim/.dbt/profiles.yml
[0m14:22:19.549839 [info ] [MainThread]: Using dbt_project.yml file at /home/vadim/dbt_trino_iceberg/dbt_project.yml
[0m14:22:19.594656 [info ] [MainThread]: Configuration:
[0m14:22:19.594989 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m14:22:19.595204 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:22:19.595476 [info ] [MainThread]: Required dependencies:
[0m14:22:19.595756 [debug] [MainThread]: Executing "git --help"
[0m14:22:19.597576 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:22:19.597811 [debug] [MainThread]: STDERR: "b''"
[0m14:22:19.597962 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:22:19.598140 [info ] [MainThread]: Connection test skipped since no profile was found
[0m14:22:19.598337 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:22:19.598538 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'dbt_trino_iceberg'


[0m14:22:19.599037 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.07928498, "process_user_time": 1.084632, "process_kernel_time": 0.029852, "process_mem_max_rss": "97768", "process_out_blocks": "24", "command_success": false, "process_in_blocks": "0"}
[0m14:22:19.599327 [debug] [MainThread]: Command `dbt debug` failed at 14:22:19.599254 after 0.08 seconds
[0m14:22:19.599585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42fe5aeed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4302b07490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42fea54cd0>]}
[0m14:22:19.599800 [debug] [MainThread]: Flushing usage events
[0m14:23:03.328209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe405f1f2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe405f1f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe405f1f410>]}


============================== 14:23:03.329870 | 7c9d1cff-bb84-4766-8e2b-ecb302540e39 ==============================
[0m14:23:03.329870 [info ] [MainThread]: Running with dbt=1.7.3
[0m14:23:03.330215 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:23:03.330484 [info ] [MainThread]: dbt version: 1.7.3
[0m14:23:03.330775 [info ] [MainThread]: python version: 3.11.6
[0m14:23:03.331016 [info ] [MainThread]: python path: /usr/sbin/python
[0m14:23:03.331287 [info ] [MainThread]: os info: Linux-5.15.133.1-microsoft-standard-WSL2-x86_64-with-glibc2.38
[0m14:23:03.397847 [info ] [MainThread]: Using profiles dir at /home/vadim/.dbt
[0m14:23:03.398247 [info ] [MainThread]: Using profiles.yml file at /home/vadim/.dbt/profiles.yml
[0m14:23:03.398495 [info ] [MainThread]: Using dbt_project.yml file at /home/vadim/dbt_trino_iceberg/dbt_project.yml
[0m14:23:03.398726 [info ] [MainThread]: adapter type: trino
[0m14:23:03.398917 [info ] [MainThread]: adapter version: 1.7.0
[0m14:23:03.445623 [info ] [MainThread]: Configuration:
[0m14:23:03.445972 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:23:03.446239 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:23:03.446527 [info ] [MainThread]: Required dependencies:
[0m14:23:03.446759 [debug] [MainThread]: Executing "git --help"
[0m14:23:03.448546 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:23:03.448840 [debug] [MainThread]: STDERR: "b''"
[0m14:23:03.448989 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:23:03.449167 [info ] [MainThread]: Connection:
[0m14:23:03.449373 [info ] [MainThread]:   host: 34.38.30.160
[0m14:23:03.449665 [info ] [MainThread]:   port: 8443
[0m14:23:03.449907 [info ] [MainThread]:   user: admin
[0m14:23:03.450096 [info ] [MainThread]:   database: tpch
[0m14:23:03.450375 [info ] [MainThread]:   schema: dbt
[0m14:23:03.450593 [info ] [MainThread]:   cert: None
[0m14:23:03.450854 [info ] [MainThread]:   prepared_statements_enabled: True
[0m14:23:03.451116 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m14:23:03.451540 [debug] [MainThread]: Acquiring new trino connection 'debug'
[0m14:23:03.454323 [debug] [MainThread]: Using trino connection "debug"
[0m14:23:03.454507 [debug] [MainThread]: On debug: select 1 as id
[0m14:23:03.454656 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:23:04.627027 [debug] [MainThread]: Trino adapter: Trino error: failed to execute: ('Connection aborted.', BadStatusLine('\x15\x03\x03\x00\x02\x02P'))
[0m14:23:04.628095 [debug] [MainThread]: On debug: Close
[0m14:23:04.628833 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:23:04.629414 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:23:04.629865 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  failed to execute: ('Connection aborted.', BadStatusLine('\x15\x03\x03\x00\x02\x02P'))

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:23:04.630480 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.3262607, "process_user_time": 1.181275, "process_kernel_time": 0.019853, "process_mem_max_rss": "99764", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m14:23:04.630760 [debug] [MainThread]: Command `dbt debug` failed at 14:23:04.630694 after 1.33 seconds
[0m14:23:04.630949 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:23:04.631156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe405f21c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe405f22590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe405f20190>]}
[0m14:23:04.631367 [debug] [MainThread]: Flushing usage events
[0m14:25:10.362112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef04094b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef04096b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef04097c10>]}


============================== 14:25:10.363768 | 20fd79dc-b96d-47d7-8b07-c0b545427227 ==============================
[0m14:25:10.363768 [info ] [MainThread]: Running with dbt=1.7.3
[0m14:25:10.364112 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:25:10.364375 [info ] [MainThread]: dbt version: 1.7.3
[0m14:25:10.364637 [info ] [MainThread]: python version: 3.11.6
[0m14:25:10.364885 [info ] [MainThread]: python path: /usr/sbin/python
[0m14:25:10.365148 [info ] [MainThread]: os info: Linux-5.15.133.1-microsoft-standard-WSL2-x86_64-with-glibc2.38
[0m14:25:10.435439 [info ] [MainThread]: Using profiles dir at /home/vadim/.dbt
[0m14:25:10.435829 [info ] [MainThread]: Using profiles.yml file at /home/vadim/.dbt/profiles.yml
[0m14:25:10.436088 [info ] [MainThread]: Using dbt_project.yml file at /home/vadim/dbt_trino_iceberg/dbt_project.yml
[0m14:25:10.436310 [info ] [MainThread]: adapter type: trino
[0m14:25:10.436517 [info ] [MainThread]: adapter version: 1.7.0
[0m14:25:10.487830 [info ] [MainThread]: Configuration:
[0m14:25:10.488181 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:25:10.488466 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:25:10.488728 [info ] [MainThread]: Required dependencies:
[0m14:25:10.489014 [debug] [MainThread]: Executing "git --help"
[0m14:25:10.491089 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:25:10.491403 [debug] [MainThread]: STDERR: "b''"
[0m14:25:10.491585 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:25:10.491833 [info ] [MainThread]: Connection:
[0m14:25:10.492083 [info ] [MainThread]:   host: 34.38.30.160
[0m14:25:10.492294 [info ] [MainThread]:   port: 8443
[0m14:25:10.492544 [info ] [MainThread]:   user: admin
[0m14:25:10.492852 [info ] [MainThread]:   database: tpch
[0m14:25:10.493203 [info ] [MainThread]:   schema: dbt
[0m14:25:10.493498 [info ] [MainThread]:   cert: None
[0m14:25:10.493710 [info ] [MainThread]:   prepared_statements_enabled: True
[0m14:25:10.493995 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m14:25:10.494486 [debug] [MainThread]: Acquiring new trino connection 'debug'
[0m14:25:10.498372 [debug] [MainThread]: Using trino connection "debug"
[0m14:25:10.498581 [debug] [MainThread]: On debug: select 1 as id
[0m14:25:10.498744 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:25:11.679877 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m14:25:11.681220 [debug] [MainThread]: On debug: Close
[0m14:25:11.683192 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:25:11.683516 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:25:11.684150 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.3466064, "process_user_time": 1.251845, "process_kernel_time": 0.050888, "process_mem_max_rss": "101332", "process_out_blocks": "16", "process_in_blocks": "0"}
[0m14:25:11.684528 [debug] [MainThread]: Command `dbt debug` succeeded at 14:25:11.684436 after 1.35 seconds
[0m14:25:11.684753 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:25:11.684990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef03f04590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef03cc6550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef086b0fd0>]}
[0m14:25:11.685266 [debug] [MainThread]: Flushing usage events
[0m14:25:38.881763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa208b281d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa208b2a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa208b29d50>]}


============================== 14:25:38.883406 | cfcfbb71-0de7-4696-9775-d4aa67e1cdd3 ==============================
[0m14:25:38.883406 [info ] [MainThread]: Running with dbt=1.7.3
[0m14:25:38.883744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:25:39.002475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cfcfbb71-0de7-4696-9775-d4aa67e1cdd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2088bec10>]}
[0m14:25:39.053625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cfcfbb71-0de7-4696-9775-d4aa67e1cdd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa209198ad0>]}
[0m14:25:39.054098 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m14:25:39.060904 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m14:25:39.067644 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:25:39.067937 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:25:39.068195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cfcfbb71-0de7-4696-9775-d4aa67e1cdd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa208918c10>]}
[0m14:25:39.864571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cfcfbb71-0de7-4696-9775-d4aa67e1cdd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa207466850>]}
[0m14:25:39.871834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cfcfbb71-0de7-4696-9775-d4aa67e1cdd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2074f1690>]}
[0m14:25:39.872170 [info ] [MainThread]: Found 3 models, 4 tests, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m14:25:39.872474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfcfbb71-0de7-4696-9775-d4aa67e1cdd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2085d9150>]}
[0m14:25:39.873672 [info ] [MainThread]: 
[0m14:25:39.874175 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:25:39.875009 [debug] [ThreadPool]: Acquiring new trino connection 'list_tpch'
[0m14:25:39.885411 [debug] [ThreadPool]: Using trino connection "list_tpch"
[0m14:25:39.885672 [debug] [ThreadPool]: On list_tpch: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_tpch"} */

    select schema_name
    from "tpch".INFORMATION_SCHEMA.schemata
[0m14:25:39.885839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:41.320176 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:25:41.322126 [debug] [ThreadPool]: On list_tpch: Close
[0m14:25:41.323671 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tpch, now create_tpch_dbt)
[0m14:25:41.324169 [debug] [ThreadPool]: Creating schema "database: "tpch"
schema: "dbt"
"
[0m14:25:41.327257 [debug] [ThreadPool]: Using trino connection "create_tpch_dbt"
[0m14:25:41.327460 [debug] [ThreadPool]: On create_tpch_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "create_tpch_dbt"} */
create schema if not exists "tpch"."dbt"
[0m14:25:41.327610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:25:41.708911 [debug] [ThreadPool]: Trino adapter: Trino query id: 20231212_132544_00016_htwji
[0m14:25:41.709701 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="This connector does not support creating schemas", query_id=20231212_132544_00016_htwji)
[0m14:25:41.710254 [debug] [ThreadPool]: On create_tpch_dbt: ROLLBACK
[0m14:25:41.710622 [debug] [ThreadPool]: On create_tpch_dbt: Close
[0m14:25:41.712053 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:41.712233 [debug] [MainThread]: Connection 'create_tpch_dbt' was properly closed.
[0m14:25:41.712398 [info ] [MainThread]: 
[0m14:25:41.712653 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.84 seconds (1.84s).
[0m14:25:41.713037 [error] [MainThread]: Encountered an error:
Database Error
  TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="This connector does not support creating schemas", query_id=20231212_132544_00016_htwji)
[0m14:25:41.713621 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.855784, "process_user_time": 2.097885, "process_kernel_time": 0.04015, "process_mem_max_rss": "116936", "process_out_blocks": "2208", "command_success": false, "process_in_blocks": "0"}
[0m14:25:41.713939 [debug] [MainThread]: Command `dbt run` failed at 14:25:41.713870 after 2.86 seconds
[0m14:25:41.714133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa20d1510d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2074fc6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa20d063550>]}
[0m14:25:41.714336 [debug] [MainThread]: Flushing usage events
[0m14:27:38.561539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf9825d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf98263890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf9822e290>]}


============================== 14:27:38.563219 | 508c32f5-cc8d-40c5-ae44-096c7b4559e8 ==============================
[0m14:27:38.563219 [info ] [MainThread]: Running with dbt=1.7.3
[0m14:27:38.563563 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:27:38.611711 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "dbt_trino_demo", target "dev" invalid: 'schema' is a required property
[0m14:27:38.612455 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.074831165, "process_user_time": 1.08579, "process_kernel_time": 0.03016, "process_mem_max_rss": "98508", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m14:27:38.612853 [debug] [MainThread]: Command `dbt run` failed at 14:27:38.612771 after 0.08 seconds
[0m14:27:38.613092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf98216550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf98263c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf9c927750>]}
[0m14:27:38.613320 [debug] [MainThread]: Flushing usage events
[0m14:28:17.840674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f135854b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13583a3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f135a3c6b90>]}


============================== 14:28:17.842312 | 14caec14-e195-4edb-8318-4af31c79d906 ==============================
[0m14:28:17.842312 [info ] [MainThread]: Running with dbt=1.7.3
[0m14:28:17.842654 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:28:17.962839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14caec14-e195-4edb-8318-4af31c79d906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13582de650>]}
[0m14:28:18.014158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14caec14-e195-4edb-8318-4af31c79d906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1358463110>]}
[0m14:28:18.014595 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m14:28:18.021079 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m14:28:18.035484 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:28:18.036088 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/sources.yml
[0m14:28:18.175146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14caec14-e195-4edb-8318-4af31c79d906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1357ecd6d0>]}
[0m14:28:18.182252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14caec14-e195-4edb-8318-4af31c79d906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1357fd1550>]}
[0m14:28:18.182620 [info ] [MainThread]: Found 3 models, 4 tests, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m14:28:18.182869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14caec14-e195-4edb-8318-4af31c79d906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1357f53310>]}
[0m14:28:18.184000 [info ] [MainThread]: 
[0m14:28:18.184530 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:28:18.185456 [debug] [ThreadPool]: Acquiring new trino connection 'list_tpch'
[0m14:28:18.196759 [debug] [ThreadPool]: Using trino connection "list_tpch"
[0m14:28:18.197033 [debug] [ThreadPool]: On list_tpch: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_tpch"} */

    select schema_name
    from "tpch".INFORMATION_SCHEMA.schemata
[0m14:28:18.197199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:19.456865 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:28:19.458673 [debug] [ThreadPool]: On list_tpch: Close
[0m14:28:19.461211 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tpch, now create_tpch_dbt)
[0m14:28:19.461769 [debug] [ThreadPool]: Creating schema "database: "tpch"
schema: "dbt"
"
[0m14:28:19.465050 [debug] [ThreadPool]: Using trino connection "create_tpch_dbt"
[0m14:28:19.465256 [debug] [ThreadPool]: On create_tpch_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "create_tpch_dbt"} */
create schema if not exists "tpch"."dbt"
[0m14:28:19.465446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:19.820451 [debug] [ThreadPool]: Trino adapter: Trino query id: 20231212_132822_00018_htwji
[0m14:28:19.821393 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="This connector does not support creating schemas", query_id=20231212_132822_00018_htwji)
[0m14:28:19.822184 [debug] [ThreadPool]: On create_tpch_dbt: ROLLBACK
[0m14:28:19.822487 [debug] [ThreadPool]: On create_tpch_dbt: Close
[0m14:28:19.826008 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:19.826285 [debug] [MainThread]: Connection 'create_tpch_dbt' was properly closed.
[0m14:28:19.826523 [info ] [MainThread]: 
[0m14:28:19.826822 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.64 seconds (1.64s).
[0m14:28:19.827224 [error] [MainThread]: Encountered an error:
Database Error
  TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="This connector does not support creating schemas", query_id=20231212_132822_00018_htwji)
[0m14:28:19.827862 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.0111678, "process_user_time": 1.465219, "process_kernel_time": 0.040419, "process_mem_max_rss": "113104", "process_out_blocks": "2216", "command_success": false, "process_in_blocks": "0"}
[0m14:28:19.828298 [debug] [MainThread]: Command `dbt run` failed at 14:28:19.828192 after 2.01 seconds
[0m14:28:19.828549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1358548250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f135854a690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1357de0a50>]}
[0m14:28:19.828749 [debug] [MainThread]: Flushing usage events
[0m14:40:22.010045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4b98cf050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4b989a650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4b9898050>]}


============================== 14:40:22.012030 | be93d3cc-a535-4b94-99da-e25624fdacba ==============================
[0m14:40:22.012030 [info ] [MainThread]: Running with dbt=1.7.3
[0m14:40:22.012371 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:40:22.126638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be93d3cc-a535-4b94-99da-e25624fdacba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4b98ced90>]}
[0m14:40:22.176951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be93d3cc-a535-4b94-99da-e25624fdacba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4b9649450>]}
[0m14:40:22.177396 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m14:40:22.184312 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m14:40:22.199548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:40:22.200032 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/sources.yml
[0m14:40:22.340660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be93d3cc-a535-4b94-99da-e25624fdacba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4b915dbd0>]}
[0m14:40:22.347364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be93d3cc-a535-4b94-99da-e25624fdacba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4b94b8b50>]}
[0m14:40:22.347681 [info ] [MainThread]: Found 3 models, 4 tests, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m14:40:22.347931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be93d3cc-a535-4b94-99da-e25624fdacba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4b9296410>]}
[0m14:40:22.349115 [info ] [MainThread]: 
[0m14:40:22.349627 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:40:22.350518 [debug] [ThreadPool]: Acquiring new trino connection 'list_tpch'
[0m14:40:22.360963 [debug] [ThreadPool]: Using trino connection "list_tpch"
[0m14:40:22.361180 [debug] [ThreadPool]: On list_tpch: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_tpch"} */

    select schema_name
    from "tpch".INFORMATION_SCHEMA.schemata
[0m14:40:22.361337 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:23.401312 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:40:23.403614 [debug] [ThreadPool]: On list_tpch: Close
[0m14:40:23.405477 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tpch, now create_tpch_dbt)
[0m14:40:23.406066 [debug] [ThreadPool]: Creating schema "database: "tpch"
schema: "dbt"
"
[0m14:40:23.408948 [debug] [ThreadPool]: Using trino connection "create_tpch_dbt"
[0m14:40:23.409147 [debug] [ThreadPool]: On create_tpch_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "create_tpch_dbt"} */
create schema if not exists "tpch"."dbt"
[0m14:40:23.409294 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:23.850508 [debug] [ThreadPool]: Trino adapter: Trino query id: 20231212_134026_00022_htwji
[0m14:40:23.851076 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="This connector does not support creating schemas", query_id=20231212_134026_00022_htwji)
[0m14:40:23.851768 [debug] [ThreadPool]: On create_tpch_dbt: ROLLBACK
[0m14:40:23.852178 [debug] [ThreadPool]: On create_tpch_dbt: Close
[0m14:40:23.853994 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:40:23.854250 [debug] [MainThread]: Connection 'create_tpch_dbt' was properly closed.
[0m14:40:23.854490 [info ] [MainThread]: 
[0m14:40:23.854738 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.51 seconds (1.51s).
[0m14:40:23.855102 [error] [MainThread]: Encountered an error:
Database Error
  TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="This connector does not support creating schemas", query_id=20231212_134026_00022_htwji)
[0m14:40:23.855721 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.8701187, "process_user_time": 1.362666, "process_kernel_time": 0.148115, "process_mem_max_rss": "113084", "process_out_blocks": "2208", "command_success": false, "process_in_blocks": "0"}
[0m14:40:23.856028 [debug] [MainThread]: Command `dbt run` failed at 14:40:23.855949 after 1.87 seconds
[0m14:40:23.856232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4b94d4950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4bdf73bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4bdf73850>]}
[0m14:40:23.856445 [debug] [MainThread]: Flushing usage events
[0m14:41:40.921679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55d042cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55d042c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55d042f910>]}


============================== 14:41:40.923425 | e790d13b-99cb-49ee-b55d-6fa33e336294 ==============================
[0m14:41:40.923425 [info ] [MainThread]: Running with dbt=1.7.3
[0m14:41:40.923831 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:41:41.084793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e790d13b-99cb-49ee-b55d-6fa33e336294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55d03a6210>]}
[0m14:41:41.155622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e790d13b-99cb-49ee-b55d-6fa33e336294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55d0b1dd50>]}
[0m14:41:41.156287 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m14:41:41.173957 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m14:41:41.185118 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:41:41.186726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e790d13b-99cb-49ee-b55d-6fa33e336294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55d0336f50>]}
[0m14:41:42.133348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e790d13b-99cb-49ee-b55d-6fa33e336294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ceed3510>]}
[0m14:41:42.140319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e790d13b-99cb-49ee-b55d-6fa33e336294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55cee9d250>]}
[0m14:41:42.140662 [info ] [MainThread]: Found 3 models, 4 tests, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m14:41:42.140976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e790d13b-99cb-49ee-b55d-6fa33e336294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55d01b01d0>]}
[0m14:41:42.142114 [info ] [MainThread]: 
[0m14:41:42.142678 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:41:42.143665 [debug] [ThreadPool]: Acquiring new trino connection 'list_tpch'
[0m14:41:42.154101 [debug] [ThreadPool]: Using trino connection "list_tpch"
[0m14:41:42.154376 [debug] [ThreadPool]: On list_tpch: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_tpch"} */

    select schema_name
    from "tpch".INFORMATION_SCHEMA.schemata
[0m14:41:42.154561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:43.167412 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:41:43.168484 [debug] [ThreadPool]: On list_tpch: Close
[0m14:41:43.170112 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tpch, now create_tpch_dbt)
[0m14:41:43.170645 [debug] [ThreadPool]: Creating schema "database: "tpch"
schema: "dbt"
"
[0m14:41:43.173703 [debug] [ThreadPool]: Using trino connection "create_tpch_dbt"
[0m14:41:43.173909 [debug] [ThreadPool]: On create_tpch_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "create_tpch_dbt"} */
create schema if not exists "tpch"."dbt"
[0m14:41:43.174061 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:41:43.522107 [debug] [ThreadPool]: Trino adapter: Trino query id: 20231212_134146_00024_htwji
[0m14:41:43.522391 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="This connector does not support creating schemas", query_id=20231212_134146_00024_htwji)
[0m14:41:43.522649 [debug] [ThreadPool]: On create_tpch_dbt: ROLLBACK
[0m14:41:43.522819 [debug] [ThreadPool]: On create_tpch_dbt: Close
[0m14:41:43.524305 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:43.524502 [debug] [MainThread]: Connection 'create_tpch_dbt' was properly closed.
[0m14:41:43.524678 [info ] [MainThread]: 
[0m14:41:43.524924 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.38 seconds (1.38s).
[0m14:41:43.525353 [error] [MainThread]: Encountered an error:
Database Error
  TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="This connector does not support creating schemas", query_id=20231212_134146_00024_htwji)
[0m14:41:43.525967 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.6292763, "process_user_time": 2.379106, "process_kernel_time": 0.048952, "process_mem_max_rss": "113664", "process_out_blocks": "2208", "command_success": false, "process_in_blocks": "0"}
[0m14:41:43.526269 [debug] [MainThread]: Command `dbt run` failed at 14:41:43.526196 after 2.63 seconds
[0m14:41:43.526491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55d042e550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55d04879d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55d0487590>]}
[0m14:41:43.526719 [debug] [MainThread]: Flushing usage events
[0m14:43:01.293978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d6a455550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d6a4550d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d6a283b10>]}


============================== 14:43:01.295654 | 22034cc7-f819-46f4-bf4d-832fabf8faf0 ==============================
[0m14:43:01.295654 [info ] [MainThread]: Running with dbt=1.7.3
[0m14:43:01.296069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:43:01.409678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22034cc7-f819-46f4-bf4d-832fabf8faf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d6a07db10>]}
[0m14:43:01.460478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22034cc7-f819-46f4-bf4d-832fabf8faf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d6a438250>]}
[0m14:43:01.460903 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m14:43:01.468042 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m14:43:01.474482 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:43:01.474797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '22034cc7-f819-46f4-bf4d-832fabf8faf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d6a283dd0>]}
[0m14:43:02.263103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22034cc7-f819-46f4-bf4d-832fabf8faf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d69db70d0>]}
[0m14:43:02.270052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22034cc7-f819-46f4-bf4d-832fabf8faf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d68cb9d10>]}
[0m14:43:02.270399 [info ] [MainThread]: Found 3 models, 4 tests, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m14:43:02.270641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22034cc7-f819-46f4-bf4d-832fabf8faf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d6a018750>]}
[0m14:43:02.271752 [info ] [MainThread]: 
[0m14:43:02.272287 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:43:02.273371 [debug] [ThreadPool]: Acquiring new trino connection 'list_tpch'
[0m14:43:02.284000 [debug] [ThreadPool]: Using trino connection "list_tpch"
[0m14:43:02.284214 [debug] [ThreadPool]: On list_tpch: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_tpch"} */

    select schema_name
    from "tpch".INFORMATION_SCHEMA.schemata
[0m14:43:02.284374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:03.426454 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:43:03.428920 [debug] [ThreadPool]: On list_tpch: Close
[0m14:43:03.431421 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tpch, now create_tpch_TPCH_SF1)
[0m14:43:03.432035 [debug] [ThreadPool]: Creating schema "database: "tpch"
schema: "TPCH_SF1"
"
[0m14:43:03.435132 [debug] [ThreadPool]: Using trino connection "create_tpch_TPCH_SF1"
[0m14:43:03.435339 [debug] [ThreadPool]: On create_tpch_TPCH_SF1: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "create_tpch_TPCH_SF1"} */
create schema if not exists "tpch"."TPCH_SF1"
[0m14:43:03.435491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:43:03.812850 [debug] [ThreadPool]: Trino adapter: Trino query id: 20231212_134306_00026_htwji
[0m14:43:03.813594 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="This connector does not support creating schemas", query_id=20231212_134306_00026_htwji)
[0m14:43:03.814328 [debug] [ThreadPool]: On create_tpch_TPCH_SF1: ROLLBACK
[0m14:43:03.814854 [debug] [ThreadPool]: On create_tpch_TPCH_SF1: Close
[0m14:43:03.816218 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:43:03.816403 [debug] [MainThread]: Connection 'create_tpch_TPCH_SF1' was properly closed.
[0m14:43:03.816571 [info ] [MainThread]: 
[0m14:43:03.816795 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.54 seconds (1.54s).
[0m14:43:03.817163 [error] [MainThread]: Encountered an error:
Database Error
  TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="This connector does not support creating schemas", query_id=20231212_134306_00026_htwji)
[0m14:43:03.817910 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.5484807, "process_user_time": 2.087567, "process_kernel_time": 0.060509, "process_mem_max_rss": "114900", "process_out_blocks": "2216", "command_success": false, "process_in_blocks": "0"}
[0m14:43:03.818226 [debug] [MainThread]: Command `dbt run` failed at 14:43:03.818143 after 2.55 seconds
[0m14:43:03.818448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d6a438c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d68c426d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d6a438b50>]}
[0m14:43:03.818666 [debug] [MainThread]: Flushing usage events
[0m14:47:50.705419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc297f94650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc29864dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc298ad1490>]}


============================== 14:47:50.707075 | def715b0-bb7d-45f6-89f6-51e96777529c ==============================
[0m14:47:50.707075 [info ] [MainThread]: Running with dbt=1.7.3
[0m14:47:50.707431 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:47:50.820459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'def715b0-bb7d-45f6-89f6-51e96777529c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc297d5a090>]}
[0m14:47:50.870844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'def715b0-bb7d-45f6-89f6-51e96777529c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc297ce9f90>]}
[0m14:47:50.871262 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m14:47:50.877959 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m14:47:50.884210 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:47:50.884501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'def715b0-bb7d-45f6-89f6-51e96777529c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc297bc3f90>]}
[0m14:47:51.700936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'def715b0-bb7d-45f6-89f6-51e96777529c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2968a0d90>]}
[0m14:47:51.708072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'def715b0-bb7d-45f6-89f6-51e96777529c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc29674cc10>]}
[0m14:47:51.708451 [info ] [MainThread]: Found 3 models, 4 tests, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m14:47:51.708764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'def715b0-bb7d-45f6-89f6-51e96777529c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc297907e50>]}
[0m14:47:51.709828 [info ] [MainThread]: 
[0m14:47:51.710403 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:47:51.711545 [debug] [ThreadPool]: Acquiring new trino connection 'list_tpch'
[0m14:47:51.721524 [debug] [ThreadPool]: Using trino connection "list_tpch"
[0m14:47:51.721730 [debug] [ThreadPool]: On list_tpch: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_tpch"} */

    select schema_name
    from "tpch".INFORMATION_SCHEMA.schemata
[0m14:47:51.721891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:52.781668 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:47:52.784211 [debug] [ThreadPool]: On list_tpch: Close
[0m14:47:52.787248 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tpch, now list_tpch_sf1)
[0m14:47:52.793708 [debug] [ThreadPool]: Using trino connection "list_tpch_sf1"
[0m14:47:52.793917 [debug] [ThreadPool]: On list_tpch_sf1: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_tpch_sf1"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "tpch".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'tpch'
              and schema_name = 'sf1') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'sf1'
[0m14:47:52.794079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:47:53.921972 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:47:53.924821 [debug] [ThreadPool]: On list_tpch_sf1: ROLLBACK
[0m14:47:53.925277 [debug] [ThreadPool]: On list_tpch_sf1: Close
[0m14:47:53.928658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'def715b0-bb7d-45f6-89f6-51e96777529c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc297c4dc50>]}
[0m14:47:53.928971 [debug] [MainThread]: On master: COMMIT
[0m14:47:53.929396 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:47:53.929645 [info ] [MainThread]: 
[0m14:47:53.941406 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.my_first_dbt_model
[0m14:47:53.941830 [info ] [Thread-1 (]: 1 of 2 START sql table model sf1.my_first_dbt_model ............................ [RUN]
[0m14:47:53.942545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_tpch_sf1, now model.dbt_trino_demo.my_first_dbt_model)
[0m14:47:53.943043 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.my_first_dbt_model
[0m14:47:53.945896 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.my_first_dbt_model"
[0m14:47:53.947649 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.my_first_dbt_model (compile): 14:47:53.943235 => 14:47:53.947507
[0m14:47:53.947847 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.my_first_dbt_model
[0m14:47:53.964893 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.my_first_dbt_model"
[0m14:47:53.966830 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.my_first_dbt_model"
[0m14:47:53.967279 [debug] [Thread-1 (]: On model.dbt_trino_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.my_first_dbt_model"} */

  
    

    create table "tpch"."sf1"."my_first_dbt_model"
      
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m14:47:53.967551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:54.421639 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231212_134757_00029_htwji
[0m14:47:54.422478 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="This connector does not support creating tables with data", query_id=20231212_134757_00029_htwji)
[0m14:47:54.423323 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.my_first_dbt_model (execute): 14:47:53.947954 => 14:47:54.422999
[0m14:47:54.423844 [debug] [Thread-1 (]: On model.dbt_trino_demo.my_first_dbt_model: ROLLBACK
[0m14:47:54.424303 [debug] [Thread-1 (]: On model.dbt_trino_demo.my_first_dbt_model: Close
[0m14:47:54.444508 [debug] [Thread-1 (]: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="This connector does not support creating tables with data", query_id=20231212_134757_00029_htwji)
  compiled Code at target/run/dbt_trino_demo/models/example/my_first_dbt_model.sql
[0m14:47:54.445587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'def715b0-bb7d-45f6-89f6-51e96777529c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2978f6ed0>]}
[0m14:47:54.445975 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model sf1.my_first_dbt_model ................... [[31mERROR[0m in 0.50s]
[0m14:47:54.446412 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.my_first_dbt_model
[0m14:47:54.446707 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:47:54.447142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.my_first_dbt_model, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m14:47:54.447387 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:47:54.450469 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m14:47:54.451338 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 14:47:54.447523 => 14:47:54.451146
[0m14:47:54.452056 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:47:54.452589 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.my_second_dbt_model
[0m14:47:54.453130 [info ] [Thread-1 (]: 2 of 2 SKIP relation sf1.my_second_dbt_model ................................... [[33mSKIP[0m]
[0m14:47:54.453770 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.my_second_dbt_model
[0m14:47:54.455480 [debug] [MainThread]: On master: COMMIT
[0m14:47:54.455856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:47:54.456011 [debug] [MainThread]: Connection 'model.dbt_trino_demo.stg_tpch_part_suppliers' was properly closed.
[0m14:47:54.456179 [info ] [MainThread]: 
[0m14:47:54.456374 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 2.75 seconds (2.75s).
[0m14:47:54.456771 [debug] [MainThread]: Command end result
[0m14:47:54.467644 [info ] [MainThread]: 
[0m14:47:54.468090 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:47:54.468356 [info ] [MainThread]: 
[0m14:47:54.468654 [error] [MainThread]:   Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="This connector does not support creating tables with data", query_id=20231212_134757_00029_htwji)
  compiled Code at target/run/dbt_trino_demo/models/example/my_first_dbt_model.sql
[0m14:47:54.468883 [info ] [MainThread]: 
[0m14:47:54.469111 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m14:47:54.469737 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.7880225, "process_user_time": 2.214201, "process_kernel_time": 0.080884, "process_mem_max_rss": "116208", "process_in_blocks": "712", "process_out_blocks": "3328", "command_success": false}
[0m14:47:54.470053 [debug] [MainThread]: Command `dbt run` failed at 14:47:54.469981 after 3.79 seconds
[0m14:47:54.470274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc297f75150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc297f76210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2967506d0>]}
[0m14:47:54.470476 [debug] [MainThread]: Flushing usage events
[0m14:50:31.007419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8df509e1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8df507fa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8df507db10>]}


============================== 14:50:31.009273 | f253e3b5-bfcf-4695-930d-b34e7f643d48 ==============================
[0m14:50:31.009273 [info ] [MainThread]: Running with dbt=1.7.3
[0m14:50:31.009618 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:50:31.124085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f253e3b5-bfcf-4695-930d-b34e7f643d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8df4ec7490>]}
[0m14:50:31.174037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f253e3b5-bfcf-4695-930d-b34e7f643d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8df4f8be50>]}
[0m14:50:31.174436 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m14:50:31.181731 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m14:50:31.196881 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 0 files changed.
[0m14:50:31.197244 [debug] [MainThread]: Partial parsing: deleted file: dbt_trino_demo://models/example/my_first_dbt_model.sql
[0m14:50:31.197429 [debug] [MainThread]: Partial parsing: deleted file: dbt_trino_demo://models/example/my_second_dbt_model.sql
[0m14:50:31.228237 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models/example/schema.yml'
[0m14:50:31.229197 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models/example/schema.yml'
[0m14:50:31.290585 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_trino_demo.unique_my_first_dbt_model_id.16e066b321' (models/example/schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m14:50:31.290964 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_trino_demo.not_null_my_first_dbt_model_id.5fb22c2710' (models/example/schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m14:50:31.291248 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_trino_demo.unique_my_second_dbt_model_id.57a0f8c493' (models/example/schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m14:50:31.291597 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_trino_demo.not_null_my_second_dbt_model_id.151b76d778' (models/example/schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m14:50:31.298417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f253e3b5-bfcf-4695-930d-b34e7f643d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8df4f8bcd0>]}
[0m14:50:31.305976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f253e3b5-bfcf-4695-930d-b34e7f643d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8df4dd9690>]}
[0m14:50:31.306323 [info ] [MainThread]: Found 1 model, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m14:50:31.306573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f253e3b5-bfcf-4695-930d-b34e7f643d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8df4d00b50>]}
[0m14:50:31.307547 [info ] [MainThread]: 
[0m14:50:31.308057 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:50:31.308373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f253e3b5-bfcf-4695-930d-b34e7f643d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8df4a69fd0>]}
[0m14:50:31.308594 [debug] [MainThread]: On master: COMMIT
[0m14:50:31.308960 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:50:31.309154 [info ] [MainThread]: 
[0m14:50:31.311494 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:50:31.311980 [debug] [Thread-1 (]: Acquiring new trino connection 'model.dbt_trino_demo.stg_tpch_part_suppliers'
[0m14:50:31.312174 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:50:31.323871 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m14:50:31.324527 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 14:50:31.312282 => 14:50:31.324286
[0m14:50:31.325127 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:50:31.326588 [debug] [MainThread]: On master: COMMIT
[0m14:50:31.326955 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:31.327134 [debug] [MainThread]: Connection 'model.dbt_trino_demo.stg_tpch_part_suppliers' was properly closed.
[0m14:50:31.327286 [info ] [MainThread]: 
[0m14:50:31.327577 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m14:50:31.327968 [debug] [MainThread]: Command end result
[0m14:50:31.334108 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.3504977, "process_user_time": 1.340552, "process_kernel_time": 0.05958, "process_mem_max_rss": "109284", "process_out_blocks": "3256", "process_in_blocks": "0"}
[0m14:50:31.334480 [debug] [MainThread]: Command `dbt run` succeeded at 14:50:31.334393 after 0.35 seconds
[0m14:50:31.334715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8df509d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8df4ceadd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8df508a750>]}
[0m14:50:31.334932 [debug] [MainThread]: Flushing usage events
[0m14:52:02.883338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57309fba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573201aa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5730a0ec50>]}


============================== 14:52:02.884971 | 41f6c14f-9cec-419b-99b5-e9c654159f5c ==============================
[0m14:52:02.884971 [info ] [MainThread]: Running with dbt=1.7.3
[0m14:52:02.885323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:52:02.998917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41f6c14f-9cec-419b-99b5-e9c654159f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5730a62650>]}
[0m14:52:03.049741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41f6c14f-9cec-419b-99b5-e9c654159f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573078c1d0>]}
[0m14:52:03.050157 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m14:52:03.057046 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m14:52:03.071809 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m14:52:03.079044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41f6c14f-9cec-419b-99b5-e9c654159f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57305abd50>]}
[0m14:52:03.085717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41f6c14f-9cec-419b-99b5-e9c654159f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573062f990>]}
[0m14:52:03.086072 [info ] [MainThread]: Found 1 model, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m14:52:03.086348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41f6c14f-9cec-419b-99b5-e9c654159f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5730490710>]}
[0m14:52:03.087354 [info ] [MainThread]: 
[0m14:52:03.087944 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:52:03.088304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41f6c14f-9cec-419b-99b5-e9c654159f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573061bdd0>]}
[0m14:52:03.088528 [debug] [MainThread]: On master: COMMIT
[0m14:52:03.088896 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:52:03.089098 [info ] [MainThread]: 
[0m14:52:03.091591 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:52:03.092063 [debug] [Thread-1 (]: Acquiring new trino connection 'model.dbt_trino_demo.stg_tpch_part_suppliers'
[0m14:52:03.092257 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:52:03.104915 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m14:52:03.105525 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 14:52:03.092365 => 14:52:03.105362
[0m14:52:03.106067 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:52:03.107519 [debug] [MainThread]: On master: COMMIT
[0m14:52:03.107873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:03.108022 [debug] [MainThread]: Connection 'model.dbt_trino_demo.stg_tpch_part_suppliers' was properly closed.
[0m14:52:03.108171 [info ] [MainThread]: 
[0m14:52:03.108375 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m14:52:03.108723 [debug] [MainThread]: Command end result
[0m14:52:03.115018 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.255778, "process_user_time": 1.221805, "process_kernel_time": 0.080118, "process_mem_max_rss": "106452", "process_out_blocks": "3216", "process_in_blocks": "0"}
[0m14:52:03.115393 [debug] [MainThread]: Command `dbt run` succeeded at 14:52:03.115309 after 0.26 seconds
[0m14:52:03.115604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573505d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57350e7790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57350e78d0>]}
[0m14:52:03.115813 [debug] [MainThread]: Flushing usage events
[0m14:54:31.052905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794a75d350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794ac04bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794b2cccd0>]}


============================== 14:54:31.054530 | 0a43eafe-e977-49e2-8660-58608888d369 ==============================
[0m14:54:31.054530 [info ] [MainThread]: Running with dbt=1.7.3
[0m14:54:31.054864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:54:31.166963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a43eafe-e977-49e2-8660-58608888d369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794a6787d0>]}
[0m14:54:31.217801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a43eafe-e977-49e2-8660-58608888d369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794a4d3f10>]}
[0m14:54:31.218256 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m14:54:31.225347 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m14:54:31.239420 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:54:31.239797 [debug] [MainThread]: Partial parsing: added file: dbt_trino_demo://models/staging/stg_customers.sql
[0m14:54:31.321969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a43eafe-e977-49e2-8660-58608888d369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794a4c1550>]}
[0m14:54:31.328331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a43eafe-e977-49e2-8660-58608888d369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794a1cbe90>]}
[0m14:54:31.328661 [info ] [MainThread]: Found 2 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m14:54:31.328904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a43eafe-e977-49e2-8660-58608888d369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794a45bdd0>]}
[0m14:54:31.329923 [info ] [MainThread]: 
[0m14:54:31.330546 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:54:31.330849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a43eafe-e977-49e2-8660-58608888d369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794a3e0790>]}
[0m14:54:31.331071 [debug] [MainThread]: On master: COMMIT
[0m14:54:31.331434 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:54:31.331637 [info ] [MainThread]: 
[0m14:54:31.334275 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_customers
[0m14:54:31.334742 [debug] [Thread-1 (]: Acquiring new trino connection 'model.dbt_trino_demo.stg_customers'
[0m14:54:31.334943 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_customers
[0m14:54:31.339289 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_customers"
[0m14:54:31.339631 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_customers (compile): 14:54:31.335054 => 14:54:31.339502
[0m14:54:31.340124 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_customers
[0m14:54:31.340406 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:54:31.340765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_customers, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m14:54:31.340976 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:54:31.349937 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m14:54:31.350580 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 14:54:31.341104 => 14:54:31.350373
[0m14:54:31.351235 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:54:31.352712 [debug] [MainThread]: On master: COMMIT
[0m14:54:31.353230 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:31.353390 [debug] [MainThread]: Connection 'model.dbt_trino_demo.stg_tpch_part_suppliers' was properly closed.
[0m14:54:31.353545 [info ] [MainThread]: 
[0m14:54:31.353758 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m14:54:31.354132 [debug] [MainThread]: Command end result
[0m14:54:31.359775 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.33114088, "process_user_time": 1.405711, "process_kernel_time": 0.030122, "process_mem_max_rss": "110308", "process_out_blocks": "3240", "process_in_blocks": "0"}
[0m14:54:31.360129 [debug] [MainThread]: Command `dbt run` succeeded at 14:54:31.360049 after 0.33 seconds
[0m14:54:31.360331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794b2cd950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794ecd3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794ecd3450>]}
[0m14:54:31.360544 [debug] [MainThread]: Flushing usage events
[0m14:55:41.289951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d58543ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d58ba4b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d58543810>]}


============================== 14:55:41.291584 | 0521dd37-59f0-4ed0-89a6-ce48da4597d9 ==============================
[0m14:55:41.291584 [info ] [MainThread]: Running with dbt=1.7.3
[0m14:55:41.291927 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:55:41.406863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0521dd37-59f0-4ed0-89a6-ce48da4597d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d582fe550>]}
[0m14:55:41.456968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0521dd37-59f0-4ed0-89a6-ce48da4597d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d58167650>]}
[0m14:55:41.457398 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m14:55:41.464151 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m14:55:41.478041 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m14:55:41.478396 [debug] [MainThread]: Partial parsing: added file: dbt_trino_demo://models/staging/stg_tpch_customers.sql
[0m14:55:41.478580 [debug] [MainThread]: Partial parsing: deleted file: dbt_trino_demo://models/staging/stg_customers.sql
[0m14:55:41.560310 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_trino_demo.stg_tpch_customers' (models/staging/stg_tpch_customers.sql) depends on a source named 'tpch.customer' which was not found
[0m14:55:41.561051 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.2950068, "process_user_time": 1.303612, "process_kernel_time": 0.030083, "process_mem_max_rss": "105324", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m14:55:41.561412 [debug] [MainThread]: Command `dbt run` failed at 14:55:41.561318 after 0.30 seconds
[0m14:55:41.561639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d5851a910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d58522510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d58523390>]}
[0m14:55:41.561850 [debug] [MainThread]: Flushing usage events
[0m14:56:21.568701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb14145f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1418f8ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1412a7390>]}


============================== 14:56:21.570384 | 2f873e67-9272-4b5d-ae24-a5fc75a38675 ==============================
[0m14:56:21.570384 [info ] [MainThread]: Running with dbt=1.7.3
[0m14:56:21.570731 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:56:21.689690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f873e67-9272-4b5d-ae24-a5fc75a38675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1410ac450>]}
[0m14:56:21.749526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f873e67-9272-4b5d-ae24-a5fc75a38675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1410ac150>]}
[0m14:56:21.750025 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m14:56:21.757787 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m14:56:21.775995 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m14:56:21.776390 [debug] [MainThread]: Partial parsing: added file: dbt_trino_demo://models/staging/stg_tpch_customers.sql
[0m14:56:21.776785 [debug] [MainThread]: Partial parsing: deleted file: dbt_trino_demo://models/staging/stg_customers.sql
[0m14:56:21.870646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f873e67-9272-4b5d-ae24-a5fc75a38675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1418f8b10>]}
[0m14:56:21.878241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f873e67-9272-4b5d-ae24-a5fc75a38675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb140ee4a90>]}
[0m14:56:21.878605 [info ] [MainThread]: Found 2 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m14:56:21.878893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f873e67-9272-4b5d-ae24-a5fc75a38675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb14108bb10>]}
[0m14:56:21.880032 [info ] [MainThread]: 
[0m14:56:21.880700 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:56:21.881016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f873e67-9272-4b5d-ae24-a5fc75a38675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb140ed9e90>]}
[0m14:56:21.881322 [debug] [MainThread]: On master: COMMIT
[0m14:56:21.881790 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:56:21.882028 [info ] [MainThread]: 
[0m14:56:21.884741 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m14:56:21.885339 [debug] [Thread-1 (]: Acquiring new trino connection 'model.dbt_trino_demo.stg_tpch_customers'
[0m14:56:21.885573 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m14:56:21.890795 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m14:56:21.891540 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 14:56:21.885701 => 14:56:21.891315
[0m14:56:21.892208 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m14:56:21.892527 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:56:21.893280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m14:56:21.893547 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:56:21.902925 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m14:56:21.903509 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 14:56:21.893701 => 14:56:21.903358
[0m14:56:21.904022 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:56:21.905623 [debug] [MainThread]: On master: COMMIT
[0m14:56:21.905991 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:56:21.906152 [debug] [MainThread]: Connection 'model.dbt_trino_demo.stg_tpch_part_suppliers' was properly closed.
[0m14:56:21.906339 [info ] [MainThread]: 
[0m14:56:21.906603 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.03 seconds (0.03s).
[0m14:56:21.907018 [debug] [MainThread]: Command end result
[0m14:56:21.913581 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.36860678, "process_user_time": 1.333724, "process_kernel_time": 0.088261, "process_mem_max_rss": "111108", "process_out_blocks": "3248", "process_in_blocks": "0"}
[0m14:56:21.914036 [debug] [MainThread]: Command `dbt run` succeeded at 14:56:21.913940 after 0.37 seconds
[0m14:56:21.914278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1412a7f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb145997390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb145a84fd0>]}
[0m14:56:21.914541 [debug] [MainThread]: Flushing usage events
[0m16:42:03.054648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3466fbcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3466fa910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3466f9fd0>]}


============================== 16:42:03.057758 | ec642428-3f3d-4f5a-b957-52e7a39dc34f ==============================
[0m16:42:03.057758 [info ] [MainThread]: Running with dbt=1.7.3
[0m16:42:03.058312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:42:03.248804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec642428-3f3d-4f5a-b957-52e7a39dc34f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3464f8890>]}
[0m16:42:03.319710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec642428-3f3d-4f5a-b957-52e7a39dc34f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe346479490>]}
[0m16:42:03.320253 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m16:42:03.330043 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m16:42:03.364263 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 6 files added, 0 files changed.
[0m16:42:03.364718 [debug] [MainThread]: Partial parsing: added file: dbt_trino_demo://models/staging/stg_tpch_part.sql
[0m16:42:03.364950 [debug] [MainThread]: Partial parsing: added file: dbt_trino_demo://models/staging/stg_tpch_orders.sql
[0m16:42:03.365185 [debug] [MainThread]: Partial parsing: added file: dbt_trino_demo://models/staging/stg_tpch_supplier.sql
[0m16:42:03.365375 [debug] [MainThread]: Partial parsing: added file: dbt_trino_demo://models/staging/stg_tpch_line_item.sql
[0m16:42:03.365557 [debug] [MainThread]: Partial parsing: added file: dbt_trino_demo://models/staging/stg_tpch_nation.sql
[0m16:42:03.365815 [debug] [MainThread]: Partial parsing: added file: dbt_trino_demo://models/staging/stg_tpch_region.sql
[0m16:42:03.485037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec642428-3f3d-4f5a-b957-52e7a39dc34f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe346434fd0>]}
[0m16:42:03.497429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec642428-3f3d-4f5a-b957-52e7a39dc34f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe34631c4d0>]}
[0m16:42:03.497861 [info ] [MainThread]: Found 8 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m16:42:03.498168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec642428-3f3d-4f5a-b957-52e7a39dc34f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3462d1250>]}
[0m16:42:03.499803 [info ] [MainThread]: 
[0m16:42:03.500528 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:42:03.500850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec642428-3f3d-4f5a-b957-52e7a39dc34f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe34609a4d0>]}
[0m16:42:03.501095 [debug] [MainThread]: On master: COMMIT
[0m16:42:03.501623 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:42:03.501872 [info ] [MainThread]: 
[0m16:42:03.505784 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m16:42:03.506538 [debug] [Thread-1 (]: Acquiring new trino connection 'model.dbt_trino_demo.stg_tpch_customers'
[0m16:42:03.506850 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m16:42:03.512305 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m16:42:03.513034 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 16:42:03.506980 => 16:42:03.512848
[0m16:42:03.513735 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m16:42:03.514084 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m16:42:03.514567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m16:42:03.514858 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m16:42:03.517584 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m16:42:03.518298 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 16:42:03.515040 => 16:42:03.518109
[0m16:42:03.518909 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m16:42:03.519223 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m16:42:03.519727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m16:42:03.519987 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m16:42:03.522239 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m16:42:03.522790 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 16:42:03.520129 => 16:42:03.522633
[0m16:42:03.523321 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m16:42:03.523621 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m16:42:03.524282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m16:42:03.524832 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m16:42:03.527306 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m16:42:03.527746 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 16:42:03.525013 => 16:42:03.527577
[0m16:42:03.528269 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m16:42:03.528630 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m16:42:03.529124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m16:42:03.529371 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m16:42:03.531545 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m16:42:03.532148 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 16:42:03.529524 => 16:42:03.531990
[0m16:42:03.532665 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m16:42:03.532946 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m16:42:03.533476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m16:42:03.533730 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m16:42:03.544798 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m16:42:03.545568 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 16:42:03.533916 => 16:42:03.545343
[0m16:42:03.546257 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m16:42:03.546807 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m16:42:03.547567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m16:42:03.547849 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m16:42:03.550255 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m16:42:03.550676 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 16:42:03.548000 => 16:42:03.550523
[0m16:42:03.551253 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m16:42:03.551624 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m16:42:03.552126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m16:42:03.552413 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m16:42:03.554806 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m16:42:03.555443 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 16:42:03.552603 => 16:42:03.555285
[0m16:42:03.556032 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m16:42:03.557742 [debug] [MainThread]: On master: COMMIT
[0m16:42:03.558241 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:42:03.558440 [debug] [MainThread]: Connection 'model.dbt_trino_demo.stg_tpch_supplier' was properly closed.
[0m16:42:03.558674 [info ] [MainThread]: 
[0m16:42:03.558940 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m16:42:03.559301 [debug] [MainThread]: Command end result
[0m16:42:03.569699 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5496164, "process_user_time": 1.64882, "process_kernel_time": 0.428507, "process_mem_max_rss": "109936", "process_out_blocks": "3400", "process_in_blocks": "0"}
[0m16:42:03.570109 [debug] [MainThread]: Command `dbt run` succeeded at 16:42:03.570019 after 0.55 seconds
[0m16:42:03.570341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe34ad31250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe34ac432d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe34ac43410>]}
[0m16:42:03.570575 [debug] [MainThread]: Flushing usage events
[0m09:52:00.837743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55def1b250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55df5fe250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55def181d0>]}


============================== 09:52:00.842161 | b8fba24a-9f1e-49fd-9a7f-173c92d022be ==============================
[0m09:52:00.842161 [info ] [MainThread]: Running with dbt=1.7.3
[0m09:52:00.842542 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --models /home/vadim/dbt_trino_iceberg/models/mart', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:52:00.988514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8fba24a-9f1e-49fd-9a7f-173c92d022be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55def63c90>]}
[0m09:52:01.040904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8fba24a-9f1e-49fd-9a7f-173c92d022be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55dec99610>]}
[0m09:52:01.041440 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m09:52:01.051702 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m09:52:01.108567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:52:01.109030 [debug] [MainThread]: Partial parsing: added file: dbt_trino_demo://models/mart/dim_supplier.sql
[0m09:52:01.189558 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_trino_demo.dim_supplier' (models/mart/dim_supplier.sql) depends on a node named 'stg_tpch_nations' which was not found
[0m09:52:01.191382 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.38094124, "process_user_time": 1.278988, "process_kernel_time": 0.080566, "process_mem_max_rss": "105168", "process_in_blocks": "5064", "process_out_blocks": "8", "command_success": false}
[0m09:52:01.191759 [debug] [MainThread]: Command `dbt run` failed at 09:52:01.191674 after 0.38 seconds
[0m09:52:01.191980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55def1a8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55dfa81a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55de8969d0>]}
[0m09:52:01.192193 [debug] [MainThread]: Flushing usage events
[0m09:52:31.250619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b015af10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b015b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b015b0d0>]}


============================== 09:52:31.252288 | 2b7ef84a-d5e4-4017-85bd-eb07af50164c ==============================
[0m09:52:31.252288 [info ] [MainThread]: Running with dbt=1.7.3
[0m09:52:31.252640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:52:31.367989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b7ef84a-d5e4-4017-85bd-eb07af50164c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b0217b10>]}
[0m09:52:31.418973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b7ef84a-d5e4-4017-85bd-eb07af50164c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b0e70e10>]}
[0m09:52:31.419393 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m09:52:31.426877 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m09:52:31.444469 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:52:31.444862 [debug] [MainThread]: Partial parsing: added file: dbt_trino_demo://models/mart/dim_supplier.sql
[0m09:52:31.521807 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_trino_demo.dim_supplier' (models/mart/dim_supplier.sql) depends on a node named 'stg_tpch_nations' which was not found
[0m09:52:31.522439 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.29576603, "process_user_time": 1.327404, "process_kernel_time": 0.099804, "process_mem_max_rss": "105456", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m09:52:31.522806 [debug] [MainThread]: Command `dbt run` failed at 09:52:31.522727 after 0.30 seconds
[0m09:52:31.523032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b015bf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b0308f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b030a5d0>]}
[0m09:52:31.523252 [debug] [MainThread]: Flushing usage events
[0m09:55:40.107044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f5800a250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f57fdf950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f57fbeed0>]}


============================== 09:55:40.108776 | 1ba64b7f-e452-4c7a-a5fb-a2bc894b1fd6 ==============================
[0m09:55:40.108776 [info ] [MainThread]: Running with dbt=1.7.3
[0m09:55:40.109122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:55:40.225894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ba64b7f-e452-4c7a-a5fb-a2bc894b1fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f57dfdbd0>]}
[0m09:55:40.277009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ba64b7f-e452-4c7a-a5fb-a2bc894b1fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f57fde290>]}
[0m09:55:40.277456 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m09:55:40.284317 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m09:55:40.299388 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:55:40.299743 [debug] [MainThread]: Partial parsing: added file: dbt_trino_demo://models/mart/dim_supplier.sql
[0m09:55:40.386684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ba64b7f-e452-4c7a-a5fb-a2bc894b1fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f57dc7f10>]}
[0m09:55:40.395073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ba64b7f-e452-4c7a-a5fb-a2bc894b1fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f57a48cd0>]}
[0m09:55:40.395460 [info ] [MainThread]: Found 9 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m09:55:40.395711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ba64b7f-e452-4c7a-a5fb-a2bc894b1fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f57caf050>]}
[0m09:55:40.396985 [info ] [MainThread]: 
[0m09:55:40.397516 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m09:55:40.398452 [debug] [ThreadPool]: Acquiring new trino connection 'list_tpch'
[0m09:55:40.409496 [debug] [ThreadPool]: Using trino connection "list_tpch"
[0m09:55:40.409716 [debug] [ThreadPool]: On list_tpch: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_tpch"} */

    select schema_name
    from "tpch".INFORMATION_SCHEMA.schemata
[0m09:55:40.409877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:41.921257 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m09:55:41.923676 [debug] [ThreadPool]: On list_tpch: Close
[0m09:55:41.926771 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tpch, now list_tpch_sf1)
[0m09:55:41.932120 [debug] [ThreadPool]: Using trino connection "list_tpch_sf1"
[0m09:55:41.932472 [debug] [ThreadPool]: On list_tpch_sf1: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_tpch_sf1"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "tpch".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'tpch'
              and schema_name = 'sf1') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'sf1'
[0m09:55:41.932647 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:55:43.272384 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m09:55:43.275015 [debug] [ThreadPool]: On list_tpch_sf1: ROLLBACK
[0m09:55:43.275314 [debug] [ThreadPool]: On list_tpch_sf1: Close
[0m09:55:43.278144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ba64b7f-e452-4c7a-a5fb-a2bc894b1fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f57bc7fd0>]}
[0m09:55:43.278441 [debug] [MainThread]: On master: COMMIT
[0m09:55:43.278848 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:55:43.279089 [info ] [MainThread]: 
[0m09:55:43.284798 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m09:55:43.285296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_tpch_sf1, now model.dbt_trino_demo.stg_tpch_customers)
[0m09:55:43.285498 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m09:55:43.287527 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m09:55:43.288335 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 09:55:43.285625 => 09:55:43.288195
[0m09:55:43.288830 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m09:55:43.289072 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m09:55:43.289479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m09:55:43.289710 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m09:55:43.291661 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m09:55:43.292211 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 09:55:43.289838 => 09:55:43.292077
[0m09:55:43.292791 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m09:55:43.293159 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m09:55:43.293595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m09:55:43.293809 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m09:55:43.295768 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m09:55:43.296402 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 09:55:43.293950 => 09:55:43.296208
[0m09:55:43.296896 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m09:55:43.297131 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m09:55:43.297501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m09:55:43.297710 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m09:55:43.299467 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m09:55:43.300028 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 09:55:43.297833 => 09:55:43.299876
[0m09:55:43.300502 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m09:55:43.300738 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m09:55:43.301133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m09:55:43.301343 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m09:55:43.303010 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m09:55:43.303483 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 09:55:43.301467 => 09:55:43.303335
[0m09:55:43.303951 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m09:55:43.304185 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m09:55:43.304661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m09:55:43.304873 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m09:55:43.314098 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m09:55:43.314690 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 09:55:43.305001 => 09:55:43.314524
[0m09:55:43.315214 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m09:55:43.315519 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m09:55:43.315953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m09:55:43.316169 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m09:55:43.318024 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m09:55:43.318491 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 09:55:43.316309 => 09:55:43.318347
[0m09:55:43.318969 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m09:55:43.319205 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m09:55:43.319563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m09:55:43.319770 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m09:55:43.321587 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m09:55:43.322097 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 09:55:43.319895 => 09:55:43.321925
[0m09:55:43.322610 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m09:55:43.323297 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_supplier
[0m09:55:43.323651 [info ] [Thread-1 (]: 1 of 1 START sql table model sf1.dim_supplier .................................. [RUN]
[0m09:55:43.324116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_supplier, now model.dbt_trino_demo.dim_supplier)
[0m09:55:43.324366 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_supplier
[0m09:55:43.330299 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_supplier"
[0m09:55:43.330987 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_supplier (compile): 09:55:43.324499 => 09:55:43.330833
[0m09:55:43.331207 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_supplier
[0m09:55:43.347973 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_supplier"
[0m09:55:43.350380 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_supplier"
[0m09:55:43.350671 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_supplier: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_supplier"} */

  
    

    create table "tpch"."sf1"."dim_supplier"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    s_suppkey as supplier_key,
    s_name as supplier_name,
    s_address as supplier_address,
    s_nationkey as nation_key,
    s_phone as supplier_phone_number,
    s_acctbal as supplier_account_balance,
    s_comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    n_nationkey as nation_key,
    n_name as nation_name,
    n_regionkey as region_key,
    n_comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    r_regionkey as region_key,
    r_name as region_name,
    r_comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (


)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    f.supplier_key
    )
[0m09:55:43.350888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:43.630120 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231213_085544_00007_scdwh
[0m09:55:43.630643 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 56:1: mismatched input ')'. Expecting: <query>", query_id=20231213_085544_00007_scdwh)
[0m09:55:43.631191 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_supplier (execute): 09:55:43.331313 => 09:55:43.630982
[0m09:55:43.631517 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_supplier: ROLLBACK
[0m09:55:43.631827 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_supplier: Close
[0m09:55:43.651360 [debug] [Thread-1 (]: Database Error in model dim_supplier (models/mart/dim_supplier.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 56:1: mismatched input ')'. Expecting: <query>", query_id=20231213_085544_00007_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_supplier.sql
[0m09:55:43.652433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba64b7f-e452-4c7a-a5fb-a2bc894b1fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f57b5ff10>]}
[0m09:55:43.652860 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model sf1.dim_supplier ......................... [[31mERROR[0m in 0.33s]
[0m09:55:43.653306 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_supplier
[0m09:55:43.654620 [debug] [MainThread]: On master: COMMIT
[0m09:55:43.655015 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:55:43.655168 [debug] [MainThread]: Connection 'model.dbt_trino_demo.dim_supplier' was properly closed.
[0m09:55:43.655334 [info ] [MainThread]: 
[0m09:55:43.655585 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.26 seconds (3.26s).
[0m09:55:43.656050 [debug] [MainThread]: Command end result
[0m09:55:43.664266 [info ] [MainThread]: 
[0m09:55:43.664666 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:55:43.664939 [info ] [MainThread]: 
[0m09:55:43.665217 [error] [MainThread]:   Database Error in model dim_supplier (models/mart/dim_supplier.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 56:1: mismatched input ')'. Expecting: <query>", query_id=20231213_085544_00007_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_supplier.sql
[0m09:55:43.665474 [info ] [MainThread]: 
[0m09:55:43.665724 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:55:43.666348 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.583129, "process_user_time": 1.511828, "process_kernel_time": 0.129301, "process_mem_max_rss": "115144", "process_in_blocks": "1664", "process_out_blocks": "3456", "command_success": false}
[0m09:55:43.666637 [debug] [MainThread]: Command `dbt run` failed at 09:55:43.666571 after 3.58 seconds
[0m09:55:43.666842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f58460c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f5c68ec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f5c68f810>]}
[0m09:55:43.667034 [debug] [MainThread]: Flushing usage events
[0m09:56:05.112469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf783e35d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf783e2410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf783e2790>]}


============================== 09:56:05.114215 | fce6f779-401e-42bf-b966-908555656972 ==============================
[0m09:56:05.114215 [info ] [MainThread]: Running with dbt=1.7.3
[0m09:56:05.114575 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:56:05.114915 [info ] [MainThread]: dbt version: 1.7.3
[0m09:56:05.115141 [info ] [MainThread]: python version: 3.11.6
[0m09:56:05.115379 [info ] [MainThread]: python path: /usr/sbin/python
[0m09:56:05.115583 [info ] [MainThread]: os info: Linux-5.15.133.1-microsoft-standard-WSL2-x86_64-with-glibc2.38
[0m09:56:05.181834 [info ] [MainThread]: Using profiles dir at /home/vadim/.dbt
[0m09:56:05.182237 [info ] [MainThread]: Using profiles.yml file at /home/vadim/.dbt/profiles.yml
[0m09:56:05.182471 [info ] [MainThread]: Using dbt_project.yml file at /home/vadim/dbt_trino_iceberg/dbt_project.yml
[0m09:56:05.182746 [info ] [MainThread]: adapter type: trino
[0m09:56:05.183067 [info ] [MainThread]: adapter version: 1.7.0
[0m09:56:05.228661 [info ] [MainThread]: Configuration:
[0m09:56:05.229003 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:56:05.229271 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:56:05.229558 [info ] [MainThread]: Required dependencies:
[0m09:56:05.229939 [debug] [MainThread]: Executing "git --help"
[0m09:56:05.251581 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:56:05.251954 [debug] [MainThread]: STDERR: "b''"
[0m09:56:05.252141 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:56:05.252376 [info ] [MainThread]: Connection:
[0m09:56:05.252624 [info ] [MainThread]:   host: 34.38.30.160
[0m09:56:05.252828 [info ] [MainThread]:   port: 8443
[0m09:56:05.253015 [info ] [MainThread]:   user: admin
[0m09:56:05.253196 [info ] [MainThread]:   database: tpch
[0m09:56:05.253375 [info ] [MainThread]:   schema: sf1
[0m09:56:05.253551 [info ] [MainThread]:   cert: None
[0m09:56:05.253729 [info ] [MainThread]:   prepared_statements_enabled: True
[0m09:56:05.253964 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m09:56:05.254331 [debug] [MainThread]: Acquiring new trino connection 'debug'
[0m09:56:05.257407 [debug] [MainThread]: Using trino connection "debug"
[0m09:56:05.257616 [debug] [MainThread]: On debug: select 1 as id
[0m09:56:05.257780 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:56:06.420344 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m09:56:06.422489 [debug] [MainThread]: On debug: Close
[0m09:56:06.424243 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:56:06.424538 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:56:06.425164 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.3366094, "process_user_time": 1.123033, "process_kernel_time": 0.111291, "process_mem_max_rss": "101692", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m09:56:06.425456 [debug] [MainThread]: Command `dbt debug` succeeded at 09:56:06.425385 after 1.34 seconds
[0m09:56:06.425627 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:56:06.425801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf783e0c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf7c923550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf7ca110d0>]}
[0m09:56:06.426039 [debug] [MainThread]: Flushing usage events
[0m09:58:23.127895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b69aacd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b751c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b69aa4d0>]}


============================== 09:58:23.129602 | 2afb879c-92ad-46b7-ab4c-b0a77591fe71 ==============================
[0m09:58:23.129602 [info ] [MainThread]: Running with dbt=1.7.3
[0m09:58:23.129942 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:58:23.247423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2afb879c-92ad-46b7-ab4c-b0a77591fe71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b679d950>]}
[0m09:58:23.298176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2afb879c-92ad-46b7-ab4c-b0a77591fe71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b674f890>]}
[0m09:58:23.298585 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m09:58:23.305411 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m09:58:23.320637 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m09:58:23.320996 [debug] [MainThread]: Partial parsing: deleted file: dbt_trino_demo://models/mart/dim_supplier.sql
[0m09:58:23.328423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2afb879c-92ad-46b7-ab4c-b0a77591fe71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b69ab2d0>]}
[0m09:58:23.336127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2afb879c-92ad-46b7-ab4c-b0a77591fe71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b6716c90>]}
[0m09:58:23.336481 [info ] [MainThread]: Found 8 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m09:58:23.336720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2afb879c-92ad-46b7-ab4c-b0a77591fe71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b69effd0>]}
[0m09:58:23.337921 [info ] [MainThread]: 
[0m09:58:23.338477 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m09:58:23.338755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2afb879c-92ad-46b7-ab4c-b0a77591fe71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b66784d0>]}
[0m09:58:23.338976 [debug] [MainThread]: On master: COMMIT
[0m09:58:23.339345 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:58:23.339549 [info ] [MainThread]: 
[0m09:58:23.341976 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m09:58:23.342483 [debug] [Thread-1 (]: Acquiring new trino connection 'model.dbt_trino_demo.stg_tpch_customers'
[0m09:58:23.342692 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m09:58:23.347141 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m09:58:23.347578 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 09:58:23.342802 => 09:58:23.347434
[0m09:58:23.348104 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m09:58:23.348349 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m09:58:23.348707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m09:58:23.348915 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m09:58:23.350713 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m09:58:23.351128 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 09:58:23.349043 => 09:58:23.350934
[0m09:58:23.351640 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m09:58:23.351871 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m09:58:23.352321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m09:58:23.352532 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m09:58:23.354579 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m09:58:23.354961 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 09:58:23.352658 => 09:58:23.354809
[0m09:58:23.355479 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m09:58:23.355711 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m09:58:23.356064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m09:58:23.356300 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m09:58:23.358023 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m09:58:23.358363 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 09:58:23.356428 => 09:58:23.358240
[0m09:58:23.359030 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m09:58:23.359280 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m09:58:23.359650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m09:58:23.359856 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m09:58:23.361553 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m09:58:23.361930 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 09:58:23.359981 => 09:58:23.361782
[0m09:58:23.362455 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m09:58:23.362684 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m09:58:23.363043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m09:58:23.363258 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m09:58:23.372028 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m09:58:23.372456 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 09:58:23.363510 => 09:58:23.372290
[0m09:58:23.373385 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m09:58:23.373751 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m09:58:23.374204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m09:58:23.374433 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m09:58:23.376442 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m09:58:23.377018 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 09:58:23.374586 => 09:58:23.376864
[0m09:58:23.377521 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m09:58:23.377769 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m09:58:23.378134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m09:58:23.378340 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m09:58:23.380159 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m09:58:23.380620 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 09:58:23.378465 => 09:58:23.380480
[0m09:58:23.381103 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m09:58:23.382404 [debug] [MainThread]: On master: COMMIT
[0m09:58:23.382748 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:58:23.382900 [debug] [MainThread]: Connection 'model.dbt_trino_demo.stg_tpch_supplier' was properly closed.
[0m09:58:23.383053 [info ] [MainThread]: 
[0m09:58:23.383292 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m09:58:23.383658 [debug] [MainThread]: Command end result
[0m09:58:23.390171 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.28609046, "process_user_time": 1.272801, "process_kernel_time": 0.060132, "process_mem_max_rss": "107340", "process_out_blocks": "3392", "process_in_blocks": "0"}
[0m09:58:23.390561 [debug] [MainThread]: Command `dbt run` succeeded at 09:58:23.390467 after 0.29 seconds
[0m09:58:23.390819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b69bf190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b6618b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14bb011050>]}
[0m09:58:23.391130 [debug] [MainThread]: Flushing usage events
[0m10:06:22.461193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516f273cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516f26e150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516f22ded0>]}


============================== 10:06:22.463060 | d4557235-97a8-4070-9336-3f3af0600fc6 ==============================
[0m10:06:22.463060 [info ] [MainThread]: Running with dbt=1.7.3
[0m10:06:22.463425 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:06:22.577194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4557235-97a8-4070-9336-3f3af0600fc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516efc8f50>]}
[0m10:06:22.628059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4557235-97a8-4070-9336-3f3af0600fc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516f0663d0>]}
[0m10:06:22.628457 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m10:06:22.635411 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m10:06:22.652008 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:06:22.652271 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:06:22.656167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4557235-97a8-4070-9336-3f3af0600fc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516f227bd0>]}
[0m10:06:22.663961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4557235-97a8-4070-9336-3f3af0600fc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516ef82a50>]}
[0m10:06:22.664320 [info ] [MainThread]: Found 8 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m10:06:22.664553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4557235-97a8-4070-9336-3f3af0600fc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516f05cf50>]}
[0m10:06:22.665751 [info ] [MainThread]: 
[0m10:06:22.666309 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m10:06:22.666595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4557235-97a8-4070-9336-3f3af0600fc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516ef81ed0>]}
[0m10:06:22.666817 [debug] [MainThread]: On master: COMMIT
[0m10:06:22.667174 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:06:22.667406 [info ] [MainThread]: 
[0m10:06:22.669696 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m10:06:22.670226 [debug] [Thread-1 (]: Acquiring new trino connection 'model.dbt_trino_demo.stg_tpch_customers'
[0m10:06:22.670443 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m10:06:22.674968 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m10:06:22.675379 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 10:06:22.670579 => 10:06:22.675244
[0m10:06:22.675861 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m10:06:22.676130 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m10:06:22.676531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m10:06:22.676741 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m10:06:22.678536 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m10:06:22.679007 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 10:06:22.676870 => 10:06:22.678859
[0m10:06:22.679506 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m10:06:22.679739 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m10:06:22.680099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m10:06:22.680309 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m10:06:22.681997 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m10:06:22.682374 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 10:06:22.680436 => 10:06:22.682236
[0m10:06:22.682860 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m10:06:22.683125 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m10:06:22.683618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m10:06:22.683826 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m10:06:22.685866 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m10:06:22.686542 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 10:06:22.683955 => 10:06:22.686339
[0m10:06:22.687490 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m10:06:22.687772 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m10:06:22.688189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m10:06:22.688407 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m10:06:22.690248 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m10:06:22.690640 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 10:06:22.688540 => 10:06:22.690488
[0m10:06:22.691255 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m10:06:22.691502 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m10:06:22.691901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m10:06:22.692118 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m10:06:22.702106 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m10:06:22.702602 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 10:06:22.692251 => 10:06:22.702428
[0m10:06:22.703209 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m10:06:22.703734 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m10:06:22.704463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m10:06:22.704723 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m10:06:22.707213 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m10:06:22.707565 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 10:06:22.704840 => 10:06:22.707441
[0m10:06:22.708056 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m10:06:22.708373 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m10:06:22.708746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m10:06:22.708963 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m10:06:22.710738 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m10:06:22.711148 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 10:06:22.709098 => 10:06:22.710987
[0m10:06:22.711673 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m10:06:22.713065 [debug] [MainThread]: On master: COMMIT
[0m10:06:22.713423 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:06:22.713622 [debug] [MainThread]: Connection 'model.dbt_trino_demo.stg_tpch_supplier' was properly closed.
[0m10:06:22.713785 [info ] [MainThread]: 
[0m10:06:22.714002 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m10:06:22.714398 [debug] [MainThread]: Command end result
[0m10:06:22.720227 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.28290734, "process_user_time": 1.268749, "process_kernel_time": 0.100694, "process_mem_max_rss": "107008", "process_out_blocks": "2312", "process_in_blocks": "0"}
[0m10:06:22.720740 [debug] [MainThread]: Command `dbt run` succeeded at 10:06:22.720628 after 0.28 seconds
[0m10:06:22.721013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51737bb350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51737bb390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5173937a90>]}
[0m10:06:22.721265 [debug] [MainThread]: Flushing usage events
[0m10:25:55.085811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f905ef09150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f905eeebdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f905eee98d0>]}


============================== 10:25:55.087535 | 519595d5-e38f-45db-8d7a-8bb8c45ffbe5 ==============================
[0m10:25:55.087535 [info ] [MainThread]: Running with dbt=1.7.3
[0m10:25:55.087874 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:25:55.203203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '519595d5-e38f-45db-8d7a-8bb8c45ffbe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f905ed57a50>]}
[0m10:25:55.257291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '519595d5-e38f-45db-8d7a-8bb8c45ffbe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f905ed3bdd0>]}
[0m10:25:55.257743 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m10:25:55.264753 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m10:25:55.271757 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:25:55.272077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '519595d5-e38f-45db-8d7a-8bb8c45ffbe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f905e98e590>]}
[0m10:25:55.999654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '519595d5-e38f-45db-8d7a-8bb8c45ffbe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f905d8ab090>]}
[0m10:25:56.007333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '519595d5-e38f-45db-8d7a-8bb8c45ffbe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f905d8e5690>]}
[0m10:25:56.007763 [info ] [MainThread]: Found 8 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m10:25:56.008001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '519595d5-e38f-45db-8d7a-8bb8c45ffbe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f905eaf5450>]}
[0m10:25:56.009206 [info ] [MainThread]: 
[0m10:25:56.009726 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m10:25:56.010018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '519595d5-e38f-45db-8d7a-8bb8c45ffbe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f905d7a1190>]}
[0m10:25:56.010253 [debug] [MainThread]: On master: COMMIT
[0m10:25:56.010655 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:25:56.010853 [info ] [MainThread]: 
[0m10:25:56.013685 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m10:25:56.014223 [debug] [Thread-1 (]: Acquiring new trino connection 'model.dbt_trino_demo.stg_tpch_customers'
[0m10:25:56.014426 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m10:25:56.018752 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m10:25:56.019310 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 10:25:56.014538 => 10:25:56.019171
[0m10:25:56.019806 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m10:25:56.020095 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m10:25:56.020469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m10:25:56.020675 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m10:25:56.022788 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m10:25:56.023400 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 10:25:56.020798 => 10:25:56.023185
[0m10:25:56.024023 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m10:25:56.024277 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m10:25:56.024714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m10:25:56.024947 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m10:25:56.026916 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m10:25:56.027518 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 10:25:56.025084 => 10:25:56.027377
[0m10:25:56.027999 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m10:25:56.028251 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m10:25:56.028664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m10:25:56.028875 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m10:25:56.030729 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m10:25:56.031237 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 10:25:56.029001 => 10:25:56.030982
[0m10:25:56.031728 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m10:25:56.031966 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m10:25:56.032434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m10:25:56.032640 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m10:25:56.034428 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m10:25:56.034924 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 10:25:56.032763 => 10:25:56.034764
[0m10:25:56.035469 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m10:25:56.035702 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m10:25:56.036097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m10:25:56.036302 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m10:25:56.039534 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m10:25:56.040412 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 10:25:56.036426 => 10:25:56.040257
[0m10:25:56.040921 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m10:25:56.041209 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m10:25:56.041625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m10:25:56.041837 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m10:25:56.043810 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m10:25:56.044348 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 10:25:56.041964 => 10:25:56.044205
[0m10:25:56.044948 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m10:25:56.045290 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m10:25:56.045672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m10:25:56.045884 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m10:25:56.047720 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m10:25:56.048258 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 10:25:56.046011 => 10:25:56.048102
[0m10:25:56.048732 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m10:25:56.050490 [debug] [MainThread]: On master: COMMIT
[0m10:25:56.050843 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:25:56.051058 [debug] [MainThread]: Connection 'model.dbt_trino_demo.stg_tpch_supplier' was properly closed.
[0m10:25:56.051228 [info ] [MainThread]: 
[0m10:25:56.051429 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m10:25:56.051771 [debug] [MainThread]: Command end result
[0m10:25:56.058201 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9965249, "process_user_time": 2.001216, "process_kernel_time": 0.060036, "process_mem_max_rss": "113304", "process_in_blocks": "8", "process_out_blocks": "3384"}
[0m10:25:56.058562 [debug] [MainThread]: Command `dbt run` succeeded at 10:25:56.058481 after 1.00 seconds
[0m10:25:56.058766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f905eef6710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f905f38cbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f906343f510>]}
[0m10:25:56.058972 [debug] [MainThread]: Flushing usage events
[0m10:28:27.515295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d17b471d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d1798ec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d186b5750>]}


============================== 10:28:27.516975 | 4ca68f7d-60ac-4085-861f-b76995b8e2eb ==============================
[0m10:28:27.516975 [info ] [MainThread]: Running with dbt=1.7.3
[0m10:28:27.517358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:28:27.631939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ca68f7d-60ac-4085-861f-b76995b8e2eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d17786cd0>]}
[0m10:28:27.682955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ca68f7d-60ac-4085-861f-b76995b8e2eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d178b9f50>]}
[0m10:28:27.683417 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m10:28:27.690034 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m10:28:27.696785 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:28:27.697171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4ca68f7d-60ac-4085-861f-b76995b8e2eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d1799d050>]}
[0m10:28:28.425278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ca68f7d-60ac-4085-861f-b76995b8e2eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d174f0950>]}
[0m10:28:28.432336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ca68f7d-60ac-4085-861f-b76995b8e2eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d17897f10>]}
[0m10:28:28.432650 [info ] [MainThread]: Found 8 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m10:28:28.432926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ca68f7d-60ac-4085-861f-b76995b8e2eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d1784f210>]}
[0m10:28:28.434208 [info ] [MainThread]: 
[0m10:28:28.434766 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m10:28:28.435067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ca68f7d-60ac-4085-861f-b76995b8e2eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d17806b10>]}
[0m10:28:28.435289 [debug] [MainThread]: On master: COMMIT
[0m10:28:28.435662 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:28:28.435866 [info ] [MainThread]: 
[0m10:28:28.438148 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m10:28:28.438625 [debug] [Thread-1 (]: Acquiring new trino connection 'model.dbt_trino_demo.stg_tpch_customers'
[0m10:28:28.438829 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m10:28:28.443258 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m10:28:28.443616 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 10:28:28.438939 => 10:28:28.443487
[0m10:28:28.444216 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m10:28:28.444460 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m10:28:28.444826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m10:28:28.445036 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m10:28:28.447035 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m10:28:28.447392 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 10:28:28.445171 => 10:28:28.447259
[0m10:28:28.447935 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m10:28:28.448168 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m10:28:28.448530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m10:28:28.448739 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m10:28:28.450414 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m10:28:28.450760 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 10:28:28.448863 => 10:28:28.450629
[0m10:28:28.451286 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m10:28:28.451536 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m10:28:28.452009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m10:28:28.452214 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m10:28:28.454484 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m10:28:28.455150 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 10:28:28.452337 => 10:28:28.454966
[0m10:28:28.455796 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m10:28:28.456052 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m10:28:28.456492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m10:28:28.456698 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m10:28:28.458550 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m10:28:28.458914 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 10:28:28.456824 => 10:28:28.458778
[0m10:28:28.459438 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m10:28:28.459682 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m10:28:28.460106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m10:28:28.460310 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m10:28:28.463184 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m10:28:28.463541 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 10:28:28.460432 => 10:28:28.463407
[0m10:28:28.464091 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m10:28:28.464343 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m10:28:28.464758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m10:28:28.464964 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m10:28:28.466692 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m10:28:28.467054 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 10:28:28.465089 => 10:28:28.466924
[0m10:28:28.467544 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m10:28:28.467776 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m10:28:28.468165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m10:28:28.468534 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m10:28:28.472131 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m10:28:28.472820 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 10:28:28.468901 => 10:28:28.472589
[0m10:28:28.473487 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m10:28:28.474761 [debug] [MainThread]: On master: COMMIT
[0m10:28:28.475178 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:28:28.475360 [debug] [MainThread]: Connection 'model.dbt_trino_demo.stg_tpch_supplier' was properly closed.
[0m10:28:28.475554 [info ] [MainThread]: 
[0m10:28:28.475799 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m10:28:28.476157 [debug] [MainThread]: Command end result
[0m10:28:28.483690 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.99177593, "process_user_time": 1.932154, "process_kernel_time": 0.150167, "process_mem_max_rss": "111896", "process_out_blocks": "3392", "process_in_blocks": "0"}
[0m10:28:28.484065 [debug] [MainThread]: Command `dbt run` succeeded at 10:28:28.483982 after 0.99 seconds
[0m10:28:28.484273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d18c74950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d17b4db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d178590d0>]}
[0m10:28:28.484528 [debug] [MainThread]: Flushing usage events
[0m10:46:26.652244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3a106ba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd39fcbb050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd39fcb9c90>]}


============================== 10:46:26.653984 | 22fbf76e-e3fc-4cfd-84f7-1653c06e5146 ==============================
[0m10:46:26.653984 [info ] [MainThread]: Running with dbt=1.7.3
[0m10:46:26.654338 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:46:26.695488 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "dbt_trino_demo", target "dev" invalid: Runtime Error
    Got duplicate keys: (catalog) all map to "database"
[0m10:46:26.696214 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.068065315, "process_user_time": 1.108912, "process_kernel_time": 0.02997, "process_mem_max_rss": "98328", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m10:46:26.696601 [debug] [MainThread]: Command `dbt run` failed at 10:46:26.696521 after 0.07 seconds
[0m10:46:26.696809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd39fcc64d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3a015cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3a438b810>]}
[0m10:46:26.697041 [debug] [MainThread]: Flushing usage events
[0m10:48:14.453031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f4186f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f41e94a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f41857dd0>]}


============================== 10:48:14.455477 | b29f0556-676a-40aa-8d6c-c5c2063ccf4e ==============================
[0m10:48:14.455477 [info ] [MainThread]: Running with dbt=1.7.3
[0m10:48:14.455818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:48:14.568478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b29f0556-676a-40aa-8d6c-c5c2063ccf4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f41cf52d0>]}
[0m10:48:14.619053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b29f0556-676a-40aa-8d6c-c5c2063ccf4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f420fcd90>]}
[0m10:48:14.619514 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m10:48:14.626307 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m10:48:14.633217 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:48:14.633599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b29f0556-676a-40aa-8d6c-c5c2063ccf4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f412f6e50>]}
[0m10:48:15.359118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b29f0556-676a-40aa-8d6c-c5c2063ccf4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f41219350>]}
[0m10:48:15.367186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b29f0556-676a-40aa-8d6c-c5c2063ccf4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f413d4790>]}
[0m10:48:15.367531 [info ] [MainThread]: Found 8 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m10:48:15.367771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b29f0556-676a-40aa-8d6c-c5c2063ccf4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f41647450>]}
[0m10:48:15.369062 [info ] [MainThread]: 
[0m10:48:15.369576 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m10:48:15.369903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b29f0556-676a-40aa-8d6c-c5c2063ccf4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f417988d0>]}
[0m10:48:15.370139 [debug] [MainThread]: On master: COMMIT
[0m10:48:15.370502 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:48:15.370696 [info ] [MainThread]: 
[0m10:48:15.373456 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m10:48:15.373936 [debug] [Thread-1 (]: Acquiring new trino connection 'model.dbt_trino_demo.stg_tpch_customers'
[0m10:48:15.374136 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m10:48:15.378444 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m10:48:15.378867 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 10:48:15.374245 => 10:48:15.378709
[0m10:48:15.379376 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m10:48:15.379673 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m10:48:15.380037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m10:48:15.380247 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m10:48:15.382702 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m10:48:15.383383 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 10:48:15.380375 => 10:48:15.383194
[0m10:48:15.383920 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m10:48:15.384218 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m10:48:15.384613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m10:48:15.384835 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m10:48:15.386753 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m10:48:15.387170 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 10:48:15.384963 => 10:48:15.387031
[0m10:48:15.387693 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m10:48:15.387932 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m10:48:15.388308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m10:48:15.388520 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m10:48:15.390321 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m10:48:15.390821 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 10:48:15.388647 => 10:48:15.390661
[0m10:48:15.391353 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m10:48:15.391589 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m10:48:15.392050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m10:48:15.392261 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m10:48:15.393870 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m10:48:15.394217 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 10:48:15.392389 => 10:48:15.394087
[0m10:48:15.394821 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m10:48:15.395059 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m10:48:15.395419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m10:48:15.395637 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m10:48:15.398318 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m10:48:15.399032 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 10:48:15.395762 => 10:48:15.398844
[0m10:48:15.399742 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m10:48:15.400039 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m10:48:15.400499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m10:48:15.400710 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m10:48:15.402789 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m10:48:15.403166 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 10:48:15.400867 => 10:48:15.403033
[0m10:48:15.403674 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m10:48:15.403914 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m10:48:15.404264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m10:48:15.404474 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m10:48:15.406289 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m10:48:15.406930 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 10:48:15.404600 => 10:48:15.406731
[0m10:48:15.407470 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m10:48:15.409192 [debug] [MainThread]: On master: COMMIT
[0m10:48:15.409541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:48:15.409705 [debug] [MainThread]: Connection 'model.dbt_trino_demo.stg_tpch_supplier' was properly closed.
[0m10:48:15.409870 [info ] [MainThread]: 
[0m10:48:15.410067 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m10:48:15.410444 [debug] [MainThread]: Command end result
[0m10:48:15.416613 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.98871636, "process_user_time": 1.97696, "process_kernel_time": 0.039938, "process_mem_max_rss": "112976", "process_out_blocks": "3392", "process_in_blocks": "0"}
[0m10:48:15.416967 [debug] [MainThread]: Command `dbt run` succeeded at 10:48:15.416885 after 0.99 seconds
[0m10:48:15.417179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f4186f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f45e990d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f414e8850>]}
[0m10:48:15.417385 [debug] [MainThread]: Flushing usage events
[0m10:53:47.628389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b33ee4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b3858bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b33b5910>]}


============================== 10:53:47.630062 | d64bfe3d-0d57-4b0f-808a-315074c9b303 ==============================
[0m10:53:47.630062 [info ] [MainThread]: Running with dbt=1.7.3
[0m10:53:47.630405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:53:47.744813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd64bfe3d-0d57-4b0f-808a-315074c9b303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b317ff90>]}
[0m10:53:47.795421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd64bfe3d-0d57-4b0f-808a-315074c9b303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b3400c90>]}
[0m10:53:47.795883 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m10:53:47.802520 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m10:53:47.809086 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:53:47.809392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd64bfe3d-0d57-4b0f-808a-315074c9b303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b2e4ec10>]}
[0m10:53:48.530323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd64bfe3d-0d57-4b0f-808a-315074c9b303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b2eb5090>]}
[0m10:53:48.538326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd64bfe3d-0d57-4b0f-808a-315074c9b303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b1c2d690>]}
[0m10:53:48.538634 [info ] [MainThread]: Found 8 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m10:53:48.538932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd64bfe3d-0d57-4b0f-808a-315074c9b303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b2eb4510>]}
[0m10:53:48.540212 [info ] [MainThread]: 
[0m10:53:48.540837 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m10:53:48.541157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd64bfe3d-0d57-4b0f-808a-315074c9b303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b2e65b90>]}
[0m10:53:48.541383 [debug] [MainThread]: On master: COMMIT
[0m10:53:48.541737 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:53:48.541934 [info ] [MainThread]: 
[0m10:53:48.544688 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m10:53:48.545221 [debug] [Thread-1 (]: Acquiring new trino connection 'model.dbt_trino_demo.stg_tpch_customers'
[0m10:53:48.545421 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m10:53:48.549900 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m10:53:48.550492 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 10:53:48.545532 => 10:53:48.550291
[0m10:53:48.551128 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m10:53:48.551412 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m10:53:48.551853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m10:53:48.552091 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m10:53:48.554305 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m10:53:48.554836 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 10:53:48.552225 => 10:53:48.554680
[0m10:53:48.555327 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m10:53:48.555575 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m10:53:48.555935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m10:53:48.556138 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m10:53:48.557934 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m10:53:48.558277 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 10:53:48.556264 => 10:53:48.558147
[0m10:53:48.558787 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m10:53:48.559018 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m10:53:48.559379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m10:53:48.559584 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m10:53:48.561408 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m10:53:48.562014 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 10:53:48.559710 => 10:53:48.561874
[0m10:53:48.562467 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m10:53:48.562737 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m10:53:48.563424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m10:53:48.563632 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m10:53:48.565472 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m10:53:48.565968 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 10:53:48.563745 => 10:53:48.565793
[0m10:53:48.566706 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m10:53:48.566969 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m10:53:48.567376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m10:53:48.567590 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m10:53:48.570462 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m10:53:48.571172 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 10:53:48.567722 => 10:53:48.570925
[0m10:53:48.571792 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m10:53:48.572044 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m10:53:48.572467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m10:53:48.572677 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m10:53:48.574508 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m10:53:48.574863 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 10:53:48.572811 => 10:53:48.574728
[0m10:53:48.575377 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m10:53:48.575614 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m10:53:48.575964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m10:53:48.576170 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m10:53:48.577935 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m10:53:48.578340 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 10:53:48.576296 => 10:53:48.578207
[0m10:53:48.578867 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m10:53:48.580250 [debug] [MainThread]: On master: COMMIT
[0m10:53:48.580594 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:53:48.580744 [debug] [MainThread]: Connection 'model.dbt_trino_demo.stg_tpch_supplier' was properly closed.
[0m10:53:48.580920 [info ] [MainThread]: 
[0m10:53:48.581224 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m10:53:48.581534 [debug] [MainThread]: Command end result
[0m10:53:48.588037 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9837566, "process_user_time": 1.947268, "process_kernel_time": 0.099859, "process_mem_max_rss": "111504", "process_out_blocks": "3384", "process_in_blocks": "0"}
[0m10:53:48.588399 [debug] [MainThread]: Command `dbt run` succeeded at 10:53:48.588316 after 0.98 seconds
[0m10:53:48.588605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b3400390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b7a0d210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b791f510>]}
[0m10:53:48.588803 [debug] [MainThread]: Flushing usage events
[0m10:57:14.715661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5131c47fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5131a9bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5131a9b0d0>]}


============================== 10:57:14.717281 | f1641683-3be9-439b-bf98-71e7dfdd564d ==============================
[0m10:57:14.717281 [info ] [MainThread]: Running with dbt=1.7.3
[0m10:57:14.717631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:57:14.831401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1641683-3be9-439b-bf98-71e7dfdd564d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51320ec650>]}
[0m10:57:14.882802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1641683-3be9-439b-bf98-71e7dfdd564d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5131c47250>]}
[0m10:57:14.883221 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m10:57:14.889882 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m10:57:14.897229 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:57:14.897568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f1641683-3be9-439b-bf98-71e7dfdd564d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51316eee50>]}
[0m10:57:15.624276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1641683-3be9-439b-bf98-71e7dfdd564d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51317fe550>]}
[0m10:57:15.631899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1641683-3be9-439b-bf98-71e7dfdd564d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51304ce650>]}
[0m10:57:15.632219 [info ] [MainThread]: Found 8 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m10:57:15.632463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1641683-3be9-439b-bf98-71e7dfdd564d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51317ecdd0>]}
[0m10:57:15.633800 [info ] [MainThread]: 
[0m10:57:15.634339 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m10:57:15.634653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1641683-3be9-439b-bf98-71e7dfdd564d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5131a3aa50>]}
[0m10:57:15.634881 [debug] [MainThread]: On master: COMMIT
[0m10:57:15.635252 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:57:15.635464 [info ] [MainThread]: 
[0m10:57:15.638535 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m10:57:15.639046 [debug] [Thread-1 (]: Acquiring new trino connection 'model.dbt_trino_demo.stg_tpch_customers'
[0m10:57:15.639252 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m10:57:15.643724 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m10:57:15.644192 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 10:57:15.639365 => 10:57:15.644024
[0m10:57:15.644798 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m10:57:15.645067 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m10:57:15.645487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m10:57:15.645716 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m10:57:15.648030 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m10:57:15.648510 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 10:57:15.645873 => 10:57:15.648366
[0m10:57:15.649007 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m10:57:15.649252 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m10:57:15.649644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m10:57:15.649864 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m10:57:15.651696 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m10:57:15.652054 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 10:57:15.649994 => 10:57:15.651924
[0m10:57:15.652578 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m10:57:15.652867 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m10:57:15.653250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m10:57:15.653458 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m10:57:15.655165 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m10:57:15.655649 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 10:57:15.653584 => 10:57:15.655510
[0m10:57:15.656112 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m10:57:15.656346 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m10:57:15.656867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m10:57:15.657078 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m10:57:15.659311 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m10:57:15.660091 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 10:57:15.657216 => 10:57:15.659893
[0m10:57:15.660891 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m10:57:15.661268 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m10:57:15.661685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m10:57:15.662119 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m10:57:15.665841 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m10:57:15.666268 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 10:57:15.662264 => 10:57:15.666134
[0m10:57:15.666753 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m10:57:15.667011 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m10:57:15.667461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m10:57:15.667679 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m10:57:15.669549 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m10:57:15.670131 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 10:57:15.667830 => 10:57:15.669977
[0m10:57:15.670605 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m10:57:15.670874 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m10:57:15.671318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m10:57:15.671528 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m10:57:15.673327 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m10:57:15.673695 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 10:57:15.671682 => 10:57:15.673562
[0m10:57:15.674196 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m10:57:15.675560 [debug] [MainThread]: On master: COMMIT
[0m10:57:15.675923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:15.676078 [debug] [MainThread]: Connection 'model.dbt_trino_demo.stg_tpch_supplier' was properly closed.
[0m10:57:15.676240 [info ] [MainThread]: 
[0m10:57:15.676442 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m10:57:15.676746 [debug] [MainThread]: Command end result
[0m10:57:15.682890 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.99112135, "process_user_time": 2.015071, "process_kernel_time": 0.079804, "process_mem_max_rss": "113576", "process_out_blocks": "3392", "process_in_blocks": "0"}
[0m10:57:15.683276 [debug] [MainThread]: Command `dbt run` succeeded at 10:57:15.683192 after 0.99 seconds
[0m10:57:15.683488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5131c52d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5131a9a210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5131a9a1d0>]}
[0m10:57:15.683688 [debug] [MainThread]: Flushing usage events
[0m10:58:43.121107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacf03ca50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacf05ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad0ef76d0>]}


============================== 10:58:43.122712 | 579a3c75-1976-4a11-85a9-f276cd17fab4 ==============================
[0m10:58:43.122712 [info ] [MainThread]: Running with dbt=1.7.3
[0m10:58:43.123053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:58:43.238919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '579a3c75-1976-4a11-85a9-f276cd17fab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacf4c0510>]}
[0m10:58:43.289052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '579a3c75-1976-4a11-85a9-f276cd17fab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacee6ef10>]}
[0m10:58:43.289492 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m10:58:43.296482 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m10:58:43.313634 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:58:43.314033 [debug] [MainThread]: Partial parsing: added file: dbt_trino_demo://models/mart/dim_suppliers.sql
[0m10:58:43.404972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '579a3c75-1976-4a11-85a9-f276cd17fab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaced0ed50>]}
[0m10:58:43.414600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '579a3c75-1976-4a11-85a9-f276cd17fab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacea90510>]}
[0m10:58:43.414923 [info ] [MainThread]: Found 9 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m10:58:43.415212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '579a3c75-1976-4a11-85a9-f276cd17fab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaced21a10>]}
[0m10:58:43.416434 [info ] [MainThread]: 
[0m10:58:43.417019 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m10:58:43.417917 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m10:58:43.428343 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m10:58:43.428621 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m10:58:43.428805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:44.684101 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m10:58:44.686238 [debug] [ThreadPool]: On list_lakehouse: Close
[0m10:58:44.687737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now create_lakehouse_dbt_dbt)
[0m10:58:44.688237 [debug] [ThreadPool]: Creating schema "database: "lakehouse"
schema: "dbt_dbt"
"
[0m10:58:44.691519 [debug] [ThreadPool]: Using trino connection "create_lakehouse_dbt_dbt"
[0m10:58:44.691707 [debug] [ThreadPool]: On create_lakehouse_dbt_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "create_lakehouse_dbt_dbt"} */
create schema if not exists "lakehouse"."dbt_dbt"
[0m10:58:44.691858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:58:45.559513 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m10:58:45.560230 [debug] [ThreadPool]: On create_lakehouse_dbt_dbt: COMMIT
[0m10:58:45.560428 [debug] [ThreadPool]: On create_lakehouse_dbt_dbt: Close
[0m10:58:45.562686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lakehouse_dbt_dbt, now list_lakehouse_dbt_dbt)
[0m10:58:45.567711 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt_dbt"
[0m10:58:45.567954 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt_dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt_dbt'
[0m10:58:45.568246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:58:46.332265 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m10:58:46.335107 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: ROLLBACK
[0m10:58:46.335606 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: Close
[0m10:58:46.337373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '579a3c75-1976-4a11-85a9-f276cd17fab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacebb2a90>]}
[0m10:58:46.337654 [debug] [MainThread]: On master: COMMIT
[0m10:58:46.338018 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:58:46.338235 [info ] [MainThread]: 
[0m10:58:46.341816 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m10:58:46.342286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt_dbt, now model.dbt_trino_demo.stg_tpch_customers)
[0m10:58:46.342512 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m10:58:46.345399 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m10:58:46.345830 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 10:58:46.342632 => 10:58:46.345688
[0m10:58:46.346356 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m10:58:46.346643 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m10:58:46.347052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m10:58:46.347290 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m10:58:46.349198 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m10:58:46.349731 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 10:58:46.347427 => 10:58:46.349586
[0m10:58:46.350205 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m10:58:46.350463 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m10:58:46.351024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m10:58:46.351280 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m10:58:46.353074 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m10:58:46.353581 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 10:58:46.351409 => 10:58:46.353430
[0m10:58:46.354179 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m10:58:46.354418 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m10:58:46.354775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m10:58:46.354989 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m10:58:46.356704 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m10:58:46.357239 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 10:58:46.355117 => 10:58:46.357090
[0m10:58:46.357709 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m10:58:46.357954 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m10:58:46.358304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m10:58:46.358506 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m10:58:46.360861 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m10:58:46.361795 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 10:58:46.358630 => 10:58:46.361624
[0m10:58:46.362402 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m10:58:46.362654 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m10:58:46.363049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m10:58:46.363262 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m10:58:46.371952 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m10:58:46.372677 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 10:58:46.363388 => 10:58:46.372441
[0m10:58:46.373372 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m10:58:46.373770 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m10:58:46.374246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m10:58:46.374481 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m10:58:46.376421 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m10:58:46.376875 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 10:58:46.374623 => 10:58:46.376745
[0m10:58:46.377415 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m10:58:46.377724 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m10:58:46.378104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m10:58:46.378342 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m10:58:46.380460 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m10:58:46.380998 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 10:58:46.378641 => 10:58:46.380712
[0m10:58:46.381521 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m10:58:46.382768 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_suppliers
[0m10:58:46.383040 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_dbt.dim_suppliers ............................. [RUN]
[0m10:58:46.384468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_supplier, now model.dbt_trino_demo.dim_suppliers)
[0m10:58:46.384669 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_suppliers
[0m10:58:46.389320 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_suppliers"
[0m10:58:46.389779 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (compile): 10:58:46.384777 => 10:58:46.389651
[0m10:58:46.389974 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_suppliers
[0m10:58:46.406992 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_suppliers"
[0m10:58:46.409400 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m10:58:46.409662 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_suppliers"
      
      
    as (
      
with  __dbt__cte__stg_tpch_supplier as (

select
    s_suppkey as supplier_key,
    s_name as supplier_name,
    s_address as supplier_address,
    s_nationkey as nation_key,
    s_phone as supplier_phone_number,
    s_acctbal as supplier_account_balance,
    s_comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    n_nationkey as nation_key,
    n_name as nation_name,
    n_regionkey as region_key,
    n_comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    r_regionkey as region_key,
    r_name as region_name,
    r_comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    f.supplier_key
    )
[0m10:58:46.409881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:46.849694 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231213_095847_00118_scdwh
[0m10:58:46.850589 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 14:5: Column 's_suppkey' cannot be resolved", query_id=20231213_095847_00118_scdwh)
[0m10:58:46.851855 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (execute): 10:58:46.390090 => 10:58:46.851267
[0m10:58:46.852729 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: ROLLBACK
[0m10:58:46.853455 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: Close
[0m10:58:46.858596 [debug] [Thread-1 (]: Database Error in model dim_suppliers (models/mart/dim_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 14:5: Column 's_suppkey' cannot be resolved", query_id=20231213_095847_00118_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_suppliers.sql
[0m10:58:46.859591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '579a3c75-1976-4a11-85a9-f276cd17fab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacea607d0>]}
[0m10:58:46.859975 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_dbt.dim_suppliers .................... [[31mERROR[0m in 0.48s]
[0m10:58:46.860345 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_suppliers
[0m10:58:46.861991 [debug] [MainThread]: On master: COMMIT
[0m10:58:46.862368 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:58:46.862522 [debug] [MainThread]: Connection 'model.dbt_trino_demo.dim_suppliers' was properly closed.
[0m10:58:46.862683 [info ] [MainThread]: 
[0m10:58:46.862896 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.45 seconds (3.45s).
[0m10:58:46.863370 [debug] [MainThread]: Command end result
[0m10:58:46.871743 [info ] [MainThread]: 
[0m10:58:46.872078 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:58:46.872344 [info ] [MainThread]: 
[0m10:58:46.872591 [error] [MainThread]:   Database Error in model dim_suppliers (models/mart/dim_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 14:5: Column 's_suppkey' cannot be resolved", query_id=20231213_095847_00118_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_suppliers.sql
[0m10:58:46.872845 [info ] [MainThread]: 
[0m10:58:46.873123 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:58:46.873705 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.7764885, "process_user_time": 1.587227, "process_kernel_time": 0.059151, "process_mem_max_rss": "113304", "process_out_blocks": "3456", "command_success": false, "process_in_blocks": "0"}
[0m10:58:46.874006 [debug] [MainThread]: Command `dbt run` failed at 10:58:46.873934 after 3.78 seconds
[0m10:58:46.874215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacf029890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacf01a650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacfb89950>]}
[0m10:58:46.874414 [debug] [MainThread]: Flushing usage events
[0m11:12:26.297920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f5abaac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f5b041090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f5ababbd0>]}


============================== 11:12:26.299615 | 9ae9350c-ac4f-4987-9540-f52242a86fbc ==============================
[0m11:12:26.299615 [info ] [MainThread]: Running with dbt=1.7.3
[0m11:12:26.299955 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:12:26.414795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ae9350c-ac4f-4987-9540-f52242a86fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f5a930a90>]}
[0m11:12:26.466165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ae9350c-ac4f-4987-9540-f52242a86fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f5a967dd0>]}
[0m11:12:26.466636 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m11:12:26.473335 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m11:12:26.488677 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:12:26.489097 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/staging/stg_tpch_supplier.sql
[0m11:12:26.573771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ae9350c-ac4f-4987-9540-f52242a86fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f5aa0a910>]}
[0m11:12:26.581043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ae9350c-ac4f-4987-9540-f52242a86fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f5a626710>]}
[0m11:12:26.581407 [info ] [MainThread]: Found 9 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m11:12:26.581655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ae9350c-ac4f-4987-9540-f52242a86fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f5bcaf050>]}
[0m11:12:26.582977 [info ] [MainThread]: 
[0m11:12:26.583500 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m11:12:26.584412 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m11:12:26.594994 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m11:12:26.595271 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m11:12:26.595449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:27.952920 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m11:12:27.955008 [debug] [ThreadPool]: On list_lakehouse: Close
[0m11:12:27.957577 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt_dbt)
[0m11:12:27.962982 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt_dbt"
[0m11:12:27.963362 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt_dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt_dbt'
[0m11:12:27.963544 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:12:28.669004 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m11:12:28.671533 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: ROLLBACK
[0m11:12:28.672027 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: Close
[0m11:12:28.674176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ae9350c-ac4f-4987-9540-f52242a86fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f5abeae50>]}
[0m11:12:28.674623 [debug] [MainThread]: On master: COMMIT
[0m11:12:28.675140 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:12:28.675382 [info ] [MainThread]: 
[0m11:12:28.678619 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m11:12:28.679122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt_dbt, now model.dbt_trino_demo.stg_tpch_customers)
[0m11:12:28.679378 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m11:12:28.681649 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m11:12:28.682057 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 11:12:28.679518 => 11:12:28.681918
[0m11:12:28.682558 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m11:12:28.682810 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m11:12:28.683185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m11:12:28.683410 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m11:12:28.685221 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m11:12:28.685865 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 11:12:28.683536 => 11:12:28.685684
[0m11:12:28.686406 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m11:12:28.686662 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m11:12:28.687065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m11:12:28.687285 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m11:12:28.689320 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m11:12:28.689678 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 11:12:28.687574 => 11:12:28.689545
[0m11:12:28.690149 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m11:12:28.690384 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m11:12:28.690770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m11:12:28.691011 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m11:12:28.692772 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m11:12:28.693235 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 11:12:28.691146 => 11:12:28.693094
[0m11:12:28.693684 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m11:12:28.693914 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m11:12:28.694284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m11:12:28.694490 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m11:12:28.696172 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m11:12:28.696514 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 11:12:28.694612 => 11:12:28.696385
[0m11:12:28.697006 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m11:12:28.697248 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m11:12:28.697612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m11:12:28.697815 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m11:12:28.707048 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m11:12:28.707542 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 11:12:28.697936 => 11:12:28.707382
[0m11:12:28.708079 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m11:12:28.708352 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m11:12:28.708725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m11:12:28.708937 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m11:12:28.710704 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m11:12:28.711331 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 11:12:28.709066 => 11:12:28.711173
[0m11:12:28.711794 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m11:12:28.712046 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m11:12:28.712650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m11:12:28.712858 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m11:12:28.714559 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m11:12:28.714873 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 11:12:28.712968 => 11:12:28.714754
[0m11:12:28.715312 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m11:12:28.716087 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_suppliers
[0m11:12:28.716393 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_dbt.dim_suppliers ............................. [RUN]
[0m11:12:28.716800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_supplier, now model.dbt_trino_demo.dim_suppliers)
[0m11:12:28.717006 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_suppliers
[0m11:12:28.721692 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_suppliers"
[0m11:12:28.722027 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (compile): 11:12:28.717159 => 11:12:28.721902
[0m11:12:28.722221 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_suppliers
[0m11:12:28.739682 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_suppliers"
[0m11:12:28.742191 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m11:12:28.742473 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_suppliers"
      
      
    as (
      
with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    n_nationkey as nation_key,
    n_name as nation_name,
    n_regionkey as region_key,
    n_comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    r_regionkey as region_key,
    r_name as region_name,
    r_comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    f.supplier_key
    )
[0m11:12:28.742688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:29.159657 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231213_101229_00124_scdwh
[0m11:12:29.160549 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 26:5: Column 'n_nationkey' cannot be resolved", query_id=20231213_101229_00124_scdwh)
[0m11:12:29.162101 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (execute): 11:12:28.722330 => 11:12:29.161705
[0m11:12:29.162792 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: ROLLBACK
[0m11:12:29.163345 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: Close
[0m11:12:29.167426 [debug] [Thread-1 (]: Database Error in model dim_suppliers (models/mart/dim_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 26:5: Column 'n_nationkey' cannot be resolved", query_id=20231213_101229_00124_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_suppliers.sql
[0m11:12:29.168388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ae9350c-ac4f-4987-9540-f52242a86fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f5a7082d0>]}
[0m11:12:29.168771 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_dbt.dim_suppliers .................... [[31mERROR[0m in 0.45s]
[0m11:12:29.169133 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_suppliers
[0m11:12:29.170565 [debug] [MainThread]: On master: COMMIT
[0m11:12:29.170995 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:12:29.171194 [debug] [MainThread]: Connection 'model.dbt_trino_demo.dim_suppliers' was properly closed.
[0m11:12:29.171357 [info ] [MainThread]: 
[0m11:12:29.171569 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.59 seconds (2.59s).
[0m11:12:29.172011 [debug] [MainThread]: Command end result
[0m11:12:29.177236 [info ] [MainThread]: 
[0m11:12:29.177581 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:12:29.177833 [info ] [MainThread]: 
[0m11:12:29.178134 [error] [MainThread]:   Database Error in model dim_suppliers (models/mart/dim_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 26:5: Column 'n_nationkey' cannot be resolved", query_id=20231213_101229_00124_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_suppliers.sql
[0m11:12:29.178415 [info ] [MainThread]: 
[0m11:12:29.178704 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:12:29.179591 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.9057338, "process_user_time": 1.487969, "process_kernel_time": 0.118249, "process_mem_max_rss": "113760", "process_out_blocks": "3456", "command_success": false, "process_in_blocks": "0"}
[0m11:12:29.180070 [debug] [MainThread]: Command `dbt run` failed at 11:12:29.179963 after 2.91 seconds
[0m11:12:29.180452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f5b040dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f5b040bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f5f0f3510>]}
[0m11:12:29.180779 [debug] [MainThread]: Flushing usage events
[0m11:13:20.980103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa85dc1d210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa85dc3b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa85dc1fc50>]}


============================== 11:13:20.981929 | c5309e8e-7209-4e53-9ef5-cb6dfed49573 ==============================
[0m11:13:20.981929 [info ] [MainThread]: Running with dbt=1.7.3
[0m11:13:20.982295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:13:21.099606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5309e8e-7209-4e53-9ef5-cb6dfed49573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa85d9dc190>]}
[0m11:13:21.151360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5309e8e-7209-4e53-9ef5-cb6dfed49573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa85e755690>]}
[0m11:13:21.151847 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m11:13:21.158605 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m11:13:21.174291 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:13:21.174778 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/staging/stg_tpch_region.sql
[0m11:13:21.259732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5309e8e-7209-4e53-9ef5-cb6dfed49573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa85d915d10>]}
[0m11:13:21.266770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5309e8e-7209-4e53-9ef5-cb6dfed49573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa85d8e3c90>]}
[0m11:13:21.267100 [info ] [MainThread]: Found 9 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m11:13:21.267344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5309e8e-7209-4e53-9ef5-cb6dfed49573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa85dbec650>]}
[0m11:13:21.268584 [info ] [MainThread]: 
[0m11:13:21.269115 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m11:13:21.270708 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m11:13:21.281768 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m11:13:21.281988 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m11:13:21.282150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:22.457511 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m11:13:22.458498 [debug] [ThreadPool]: On list_lakehouse: Close
[0m11:13:22.460453 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt_dbt)
[0m11:13:22.465825 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt_dbt"
[0m11:13:22.466202 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt_dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt_dbt'
[0m11:13:22.466375 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:13:23.229632 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m11:13:23.231621 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: ROLLBACK
[0m11:13:23.232126 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: Close
[0m11:13:23.233995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5309e8e-7209-4e53-9ef5-cb6dfed49573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa85d9b68d0>]}
[0m11:13:23.234284 [debug] [MainThread]: On master: COMMIT
[0m11:13:23.234707 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:13:23.234938 [info ] [MainThread]: 
[0m11:13:23.237839 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m11:13:23.238247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt_dbt, now model.dbt_trino_demo.stg_tpch_customers)
[0m11:13:23.238453 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m11:13:23.240448 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m11:13:23.240930 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 11:13:23.238567 => 11:13:23.240760
[0m11:13:23.242972 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m11:13:23.243222 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m11:13:23.243584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m11:13:23.243800 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m11:13:23.245586 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m11:13:23.245962 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 11:13:23.243930 => 11:13:23.245819
[0m11:13:23.246569 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m11:13:23.246799 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m11:13:23.247145 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m11:13:23.247346 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m11:13:23.249042 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m11:13:23.249392 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 11:13:23.247469 => 11:13:23.249264
[0m11:13:23.249997 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m11:13:23.250250 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m11:13:23.250626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m11:13:23.250831 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m11:13:23.252595 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m11:13:23.252946 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 11:13:23.250973 => 11:13:23.252816
[0m11:13:23.253696 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m11:13:23.254145 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m11:13:23.254715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m11:13:23.254934 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m11:13:23.257013 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m11:13:23.257500 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 11:13:23.255118 => 11:13:23.257351
[0m11:13:23.257980 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m11:13:23.258227 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m11:13:23.258589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m11:13:23.258795 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m11:13:23.267390 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m11:13:23.267800 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 11:13:23.258922 => 11:13:23.267667
[0m11:13:23.268273 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m11:13:23.268514 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m11:13:23.269172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m11:13:23.269446 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m11:13:23.271848 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m11:13:23.272321 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 11:13:23.269597 => 11:13:23.272171
[0m11:13:23.272824 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m11:13:23.273134 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m11:13:23.273559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m11:13:23.273773 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m11:13:23.275581 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m11:13:23.275933 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 11:13:23.273904 => 11:13:23.275804
[0m11:13:23.276436 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m11:13:23.277246 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_suppliers
[0m11:13:23.277511 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_dbt.dim_suppliers ............................. [RUN]
[0m11:13:23.277923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_supplier, now model.dbt_trino_demo.dim_suppliers)
[0m11:13:23.278130 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_suppliers
[0m11:13:23.284053 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_suppliers"
[0m11:13:23.284585 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (compile): 11:13:23.278262 => 11:13:23.284442
[0m11:13:23.284783 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_suppliers
[0m11:13:23.301936 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_suppliers"
[0m11:13:23.304983 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m11:13:23.305340 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_suppliers"
      
      
    as (
      
with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    n_nationkey as nation_key,
    n_name as nation_name,
    n_regionkey as region_key,
    n_comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    f.supplier_key
    )
[0m11:13:23.305618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:23.792736 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231213_101324_00127_scdwh
[0m11:13:23.793632 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 26:5: Column 'n_nationkey' cannot be resolved", query_id=20231213_101324_00127_scdwh)
[0m11:13:23.795064 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (execute): 11:13:23.284895 => 11:13:23.794602
[0m11:13:23.795633 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: ROLLBACK
[0m11:13:23.795805 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: Close
[0m11:13:23.798202 [debug] [Thread-1 (]: Database Error in model dim_suppliers (models/mart/dim_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 26:5: Column 'n_nationkey' cannot be resolved", query_id=20231213_101324_00127_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_suppliers.sql
[0m11:13:23.799176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5309e8e-7209-4e53-9ef5-cb6dfed49573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa85d8abf50>]}
[0m11:13:23.799541 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_dbt.dim_suppliers .................... [[31mERROR[0m in 0.52s]
[0m11:13:23.799891 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_suppliers
[0m11:13:23.801395 [debug] [MainThread]: On master: COMMIT
[0m11:13:23.801784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:13:23.801952 [debug] [MainThread]: Connection 'model.dbt_trino_demo.dim_suppliers' was properly closed.
[0m11:13:23.802116 [info ] [MainThread]: 
[0m11:13:23.802315 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.53 seconds (2.53s).
[0m11:13:23.802725 [debug] [MainThread]: Command end result
[0m11:13:23.808431 [info ] [MainThread]: 
[0m11:13:23.808841 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:13:23.809114 [info ] [MainThread]: 
[0m11:13:23.809325 [error] [MainThread]:   Database Error in model dim_suppliers (models/mart/dim_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 26:5: Column 'n_nationkey' cannot be resolved", query_id=20231213_101324_00127_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_suppliers.sql
[0m11:13:23.809521 [info ] [MainThread]: 
[0m11:13:23.809722 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:13:23.810245 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.8539467, "process_user_time": 1.484201, "process_kernel_time": 0.087305, "process_mem_max_rss": "113360", "process_out_blocks": "3456", "command_success": false, "process_in_blocks": "0"}
[0m11:13:23.810616 [debug] [MainThread]: Command `dbt run` failed at 11:13:23.810524 after 2.85 seconds
[0m11:13:23.810877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa85dbfbbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa85dbee950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa85e278bd0>]}
[0m11:13:23.811122 [debug] [MainThread]: Flushing usage events
[0m11:16:29.994274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75bff2a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c060a050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75bff2a310>]}


============================== 11:16:29.995947 | 72d75fb9-18d8-4ea3-b47a-ec236cddbab4 ==============================
[0m11:16:29.995947 [info ] [MainThread]: Running with dbt=1.7.3
[0m11:16:29.996282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:16:30.110685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72d75fb9-18d8-4ea3-b47a-ec236cddbab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75bfd18bd0>]}
[0m11:16:30.162093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72d75fb9-18d8-4ea3-b47a-ec236cddbab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75bfca6810>]}
[0m11:16:30.162568 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m11:16:30.169375 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m11:16:30.185257 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 6 files changed.
[0m11:16:30.185692 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/staging/stg_tpch_customers.sql
[0m11:16:30.185932 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/staging/stg_tpch_part.sql
[0m11:16:30.186131 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/staging/stg_tpch_nation.sql
[0m11:16:30.186485 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/staging/stg_tpch_orders.sql
[0m11:16:30.186897 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/staging/stg_tpch_line_item.sql
[0m11:16:30.187281 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/staging/stg_tpch_part_suppliers.sql
[0m11:16:30.292326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72d75fb9-18d8-4ea3-b47a-ec236cddbab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75bfd0fc50>]}
[0m11:16:30.300794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72d75fb9-18d8-4ea3-b47a-ec236cddbab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75bf9b9450>]}
[0m11:16:30.301247 [info ] [MainThread]: Found 9 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m11:16:30.301539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72d75fb9-18d8-4ea3-b47a-ec236cddbab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75bfd1b3d0>]}
[0m11:16:30.302838 [info ] [MainThread]: 
[0m11:16:30.303352 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m11:16:30.304244 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m11:16:30.314837 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m11:16:30.315107 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m11:16:30.315267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:16:31.568880 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m11:16:31.571607 [debug] [ThreadPool]: On list_lakehouse: Close
[0m11:16:31.575722 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt_dbt)
[0m11:16:31.583027 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt_dbt"
[0m11:16:31.583242 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt_dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt_dbt'
[0m11:16:31.583411 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:16:32.113531 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m11:16:32.116266 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: ROLLBACK
[0m11:16:32.117006 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: Close
[0m11:16:32.118837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72d75fb9-18d8-4ea3-b47a-ec236cddbab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75bfd1b3d0>]}
[0m11:16:32.119112 [debug] [MainThread]: On master: COMMIT
[0m11:16:32.119497 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:16:32.119721 [info ] [MainThread]: 
[0m11:16:32.122333 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m11:16:32.122793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt_dbt, now model.dbt_trino_demo.stg_tpch_customers)
[0m11:16:32.123020 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m11:16:32.125134 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m11:16:32.125565 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 11:16:32.123143 => 11:16:32.125397
[0m11:16:32.126172 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m11:16:32.126486 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m11:16:32.126890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m11:16:32.127131 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m11:16:32.128949 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m11:16:32.129461 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 11:16:32.127256 => 11:16:32.129320
[0m11:16:32.129922 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m11:16:32.130220 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m11:16:32.130613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m11:16:32.130814 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m11:16:32.132611 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m11:16:32.133079 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 11:16:32.130958 => 11:16:32.132937
[0m11:16:32.133542 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m11:16:32.133988 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m11:16:32.134541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m11:16:32.134771 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m11:16:32.136722 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m11:16:32.137198 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 11:16:32.134912 => 11:16:32.137054
[0m11:16:32.137753 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m11:16:32.137989 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m11:16:32.138350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m11:16:32.138551 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m11:16:32.140292 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m11:16:32.140763 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 11:16:32.138674 => 11:16:32.140623
[0m11:16:32.141311 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m11:16:32.141593 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m11:16:32.142034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m11:16:32.142245 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m11:16:32.144769 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m11:16:32.145301 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 11:16:32.142375 => 11:16:32.145144
[0m11:16:32.145829 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m11:16:32.146067 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m11:16:32.146440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m11:16:32.146647 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m11:16:32.148381 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m11:16:32.148820 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 11:16:32.146772 => 11:16:32.148679
[0m11:16:32.149475 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m11:16:32.149996 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m11:16:32.150825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m11:16:32.151446 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m11:16:32.154543 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m11:16:32.155043 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 11:16:32.151629 => 11:16:32.154852
[0m11:16:32.155642 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m11:16:32.156596 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_suppliers
[0m11:16:32.156865 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_dbt.dim_suppliers ............................. [RUN]
[0m11:16:32.157290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_supplier, now model.dbt_trino_demo.dim_suppliers)
[0m11:16:32.157492 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_suppliers
[0m11:16:32.162343 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_suppliers"
[0m11:16:32.162745 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (compile): 11:16:32.157629 => 11:16:32.162617
[0m11:16:32.162937 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_suppliers
[0m11:16:32.180016 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_suppliers"
[0m11:16:32.182635 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m11:16:32.182935 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_suppliers"
      
      
    as (
      
with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    f.supplier_key
    )
[0m11:16:32.183149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:16:32.624192 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231213_101633_00130_scdwh
[0m11:16:32.625106 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 73:5: Column 'f.supplier_key' cannot be resolved", query_id=20231213_101633_00130_scdwh)
[0m11:16:32.626110 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (execute): 11:16:32.163045 => 11:16:32.625730
[0m11:16:32.626760 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: ROLLBACK
[0m11:16:32.627343 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: Close
[0m11:16:32.629736 [debug] [Thread-1 (]: Database Error in model dim_suppliers (models/mart/dim_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 73:5: Column 'f.supplier_key' cannot be resolved", query_id=20231213_101633_00130_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_suppliers.sql
[0m11:16:32.630779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72d75fb9-18d8-4ea3-b47a-ec236cddbab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75bf971790>]}
[0m11:16:32.631193 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_dbt.dim_suppliers .................... [[31mERROR[0m in 0.47s]
[0m11:16:32.631557 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_suppliers
[0m11:16:32.632983 [debug] [MainThread]: On master: COMMIT
[0m11:16:32.633368 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:16:32.633523 [debug] [MainThread]: Connection 'model.dbt_trino_demo.dim_suppliers' was properly closed.
[0m11:16:32.633683 [info ] [MainThread]: 
[0m11:16:32.633881 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.33 seconds (2.33s).
[0m11:16:32.634280 [debug] [MainThread]: Command end result
[0m11:16:32.639921 [info ] [MainThread]: 
[0m11:16:32.640248 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:16:32.640534 [info ] [MainThread]: 
[0m11:16:32.640853 [error] [MainThread]:   Database Error in model dim_suppliers (models/mart/dim_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 73:5: Column 'f.supplier_key' cannot be resolved", query_id=20231213_101633_00130_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_suppliers.sql
[0m11:16:32.641189 [info ] [MainThread]: 
[0m11:16:32.641421 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:16:32.641997 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.6726823, "process_user_time": 1.496693, "process_kernel_time": 0.109757, "process_mem_max_rss": "113308", "process_out_blocks": "3464", "command_success": false, "process_in_blocks": "0"}
[0m11:16:32.642284 [debug] [MainThread]: Command `dbt run` failed at 11:16:32.642215 after 2.67 seconds
[0m11:16:32.642491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c0a911d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c446b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c446b390>]}
[0m11:16:32.642683 [debug] [MainThread]: Flushing usage events
[0m11:18:12.452696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dcba9acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dcba9bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dcba9b410>]}


============================== 11:18:12.454357 | ec3bb28b-cc3e-48be-b3df-53a67c602ef5 ==============================
[0m11:18:12.454357 [info ] [MainThread]: Running with dbt=1.7.3
[0m11:18:12.454696 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:18:12.569230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec3bb28b-cc3e-48be-b3df-53a67c602ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dcba9c850>]}
[0m11:18:12.619137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec3bb28b-cc3e-48be-b3df-53a67c602ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dcbf40d10>]}
[0m11:18:12.619543 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m11:18:12.626252 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m11:18:12.641520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:18:12.641949 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/mart/dim_suppliers.sql
[0m11:18:12.725731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec3bb28b-cc3e-48be-b3df-53a67c602ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dcb73be10>]}
[0m11:18:12.732837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec3bb28b-cc3e-48be-b3df-53a67c602ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dcb5ca210>]}
[0m11:18:12.733184 [info ] [MainThread]: Found 9 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m11:18:12.733485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec3bb28b-cc3e-48be-b3df-53a67c602ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dcb5fa150>]}
[0m11:18:12.734803 [info ] [MainThread]: 
[0m11:18:12.735382 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m11:18:12.736265 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m11:18:12.746493 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m11:18:12.746745 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m11:18:12.746905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:14.004329 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m11:18:14.006799 [debug] [ThreadPool]: On list_lakehouse: Close
[0m11:18:14.009207 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt_dbt)
[0m11:18:14.014370 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt_dbt"
[0m11:18:14.014609 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt_dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt_dbt'
[0m11:18:14.014805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:18:14.737939 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m11:18:14.740446 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: ROLLBACK
[0m11:18:14.740976 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: Close
[0m11:18:14.743139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec3bb28b-cc3e-48be-b3df-53a67c602ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dcb7b3fd0>]}
[0m11:18:14.743593 [debug] [MainThread]: On master: COMMIT
[0m11:18:14.744178 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:18:14.744406 [info ] [MainThread]: 
[0m11:18:14.746981 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m11:18:14.747473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt_dbt, now model.dbt_trino_demo.stg_tpch_customers)
[0m11:18:14.747720 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m11:18:14.749826 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m11:18:14.750185 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 11:18:14.747857 => 11:18:14.750057
[0m11:18:14.750765 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m11:18:14.751134 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m11:18:14.751510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m11:18:14.751733 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m11:18:14.753617 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m11:18:14.754122 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 11:18:14.751867 => 11:18:14.753979
[0m11:18:14.754583 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m11:18:14.754879 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m11:18:14.755260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m11:18:14.755467 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m11:18:14.757184 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m11:18:14.757531 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 11:18:14.755591 => 11:18:14.757398
[0m11:18:14.758009 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m11:18:14.758238 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m11:18:14.758582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m11:18:14.758797 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m11:18:14.760444 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m11:18:14.760801 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 11:18:14.758923 => 11:18:14.760656
[0m11:18:14.761376 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m11:18:14.761609 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m11:18:14.761975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m11:18:14.762190 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m11:18:14.763851 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m11:18:14.764250 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 11:18:14.762313 => 11:18:14.764067
[0m11:18:14.764769 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m11:18:14.764998 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m11:18:14.765353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m11:18:14.765555 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m11:18:14.774589 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m11:18:14.775117 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 11:18:14.765679 => 11:18:14.774942
[0m11:18:14.775697 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m11:18:14.775963 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m11:18:14.776342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m11:18:14.776557 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m11:18:14.778313 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m11:18:14.778656 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 11:18:14.776688 => 11:18:14.778526
[0m11:18:14.779143 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m11:18:14.779383 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m11:18:14.779741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m11:18:14.779948 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m11:18:14.782286 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m11:18:14.783192 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 11:18:14.780073 => 11:18:14.782932
[0m11:18:14.783765 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m11:18:14.784624 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_suppliers
[0m11:18:14.784899 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_dbt.dim_suppliers ............................. [RUN]
[0m11:18:14.785319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_supplier, now model.dbt_trino_demo.dim_suppliers)
[0m11:18:14.785539 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_suppliers
[0m11:18:14.790274 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_suppliers"
[0m11:18:14.790704 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (compile): 11:18:14.785658 => 11:18:14.790569
[0m11:18:14.791004 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_suppliers
[0m11:18:14.808825 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_suppliers"
[0m11:18:14.811190 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m11:18:14.811461 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_suppliers"
      
      
    as (
      
with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m11:18:14.811670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:18:18.948040 [debug] [Thread-1 (]: SQL status: SUCCESS in 4.0 seconds
[0m11:18:18.958372 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (execute): 11:18:14.791195 => 11:18:18.958245
[0m11:18:18.958595 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: ROLLBACK
[0m11:18:18.958784 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: Close
[0m11:18:18.959781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec3bb28b-cc3e-48be-b3df-53a67c602ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dca378390>]}
[0m11:18:18.960135 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_dbt.dim_suppliers ........................ [[32mSUCCESS[0m in 4.17s]
[0m11:18:18.960529 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_suppliers
[0m11:18:18.961895 [debug] [MainThread]: On master: COMMIT
[0m11:18:18.962251 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:18:18.962407 [debug] [MainThread]: Connection 'model.dbt_trino_demo.dim_suppliers' was properly closed.
[0m11:18:18.962569 [info ] [MainThread]: 
[0m11:18:18.962773 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.23 seconds (6.23s).
[0m11:18:18.963204 [debug] [MainThread]: Command end result
[0m11:18:18.968325 [info ] [MainThread]: 
[0m11:18:18.968665 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:18:18.968894 [info ] [MainThread]: 
[0m11:18:18.969141 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:18:18.969763 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.540466, "process_user_time": 1.499639, "process_kernel_time": 0.111459, "process_mem_max_rss": "112644", "process_out_blocks": "3464", "process_in_blocks": "0"}
[0m11:18:18.970056 [debug] [MainThread]: Command `dbt run` succeeded at 11:18:18.969986 after 6.54 seconds
[0m11:18:18.970246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dd00cd190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dcffdf2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dcffdf410>]}
[0m11:18:18.970440 [debug] [MainThread]: Flushing usage events
[0m11:33:09.018753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e2ee70d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e2eb6d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e2ede610>]}


============================== 11:33:09.020382 | d3718e71-3075-481f-b987-bca7cbf3a864 ==============================
[0m11:33:09.020382 [info ] [MainThread]: Running with dbt=1.7.3
[0m11:33:09.020734 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:33:09.135434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3718e71-3075-481f-b987-bca7cbf3a864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e3750c90>]}
[0m11:33:09.186298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3718e71-3075-481f-b987-bca7cbf3a864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e3750c90>]}
[0m11:33:09.186718 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m11:33:09.193237 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m11:33:09.199839 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:33:09.200341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd3718e71-3075-481f-b987-bca7cbf3a864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e2e97cd0>]}
[0m11:33:09.931373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3718e71-3075-481f-b987-bca7cbf3a864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e2be7790>]}
[0m11:33:09.938831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3718e71-3075-481f-b987-bca7cbf3a864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e1831750>]}
[0m11:33:09.939157 [info ] [MainThread]: Found 9 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m11:33:09.939450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3718e71-3075-481f-b987-bca7cbf3a864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e299b090>]}
[0m11:33:09.940762 [info ] [MainThread]: 
[0m11:33:09.941382 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m11:33:09.942336 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m11:33:09.952665 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m11:33:09.952904 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m11:33:09.953291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:11.076774 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m11:33:11.078784 [debug] [ThreadPool]: On list_lakehouse: Close
[0m11:33:11.080256 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now create_lakehouse_trino_dbt)
[0m11:33:11.080712 [debug] [ThreadPool]: Creating schema "database: "lakehouse"
schema: "trino_dbt"
"
[0m11:33:11.083581 [debug] [ThreadPool]: Using trino connection "create_lakehouse_trino_dbt"
[0m11:33:11.083763 [debug] [ThreadPool]: On create_lakehouse_trino_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "create_lakehouse_trino_dbt"} */
create schema if not exists "lakehouse"."trino_dbt"
[0m11:33:11.083914 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:11.609777 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m11:33:11.612109 [debug] [ThreadPool]: On create_lakehouse_trino_dbt: COMMIT
[0m11:33:11.612793 [debug] [ThreadPool]: On create_lakehouse_trino_dbt: Close
[0m11:33:11.616562 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lakehouse_trino_dbt, now list_lakehouse_trino_dbt)
[0m11:33:11.622099 [debug] [ThreadPool]: Using trino connection "list_lakehouse_trino_dbt"
[0m11:33:11.622458 [debug] [ThreadPool]: On list_lakehouse_trino_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_trino_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'trino_dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'trino_dbt'
[0m11:33:11.622647 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:12.261577 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m11:33:12.262459 [debug] [ThreadPool]: On list_lakehouse_trino_dbt: ROLLBACK
[0m11:33:12.262650 [debug] [ThreadPool]: On list_lakehouse_trino_dbt: Close
[0m11:33:12.264258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3718e71-3075-481f-b987-bca7cbf3a864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e29311d0>]}
[0m11:33:12.264583 [debug] [MainThread]: On master: COMMIT
[0m11:33:12.264993 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:33:12.265213 [info ] [MainThread]: 
[0m11:33:12.268010 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m11:33:12.268403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_trino_dbt, now model.dbt_trino_demo.stg_tpch_customers)
[0m11:33:12.268606 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m11:33:12.270682 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m11:33:12.271402 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 11:33:12.268761 => 11:33:12.271182
[0m11:33:12.271980 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m11:33:12.272247 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m11:33:12.272648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m11:33:12.272869 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m11:33:12.274752 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m11:33:12.275293 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 11:33:12.273011 => 11:33:12.275147
[0m11:33:12.275816 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m11:33:12.276048 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m11:33:12.276404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m11:33:12.276610 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m11:33:12.278346 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m11:33:12.278864 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 11:33:12.276734 => 11:33:12.278672
[0m11:33:12.279422 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m11:33:12.279659 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m11:33:12.280009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m11:33:12.280274 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m11:33:12.282115 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m11:33:12.282468 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 11:33:12.280410 => 11:33:12.282339
[0m11:33:12.283001 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m11:33:12.283235 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m11:33:12.283669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m11:33:12.283892 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m11:33:12.286025 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m11:33:12.286843 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 11:33:12.284152 => 11:33:12.286612
[0m11:33:12.287479 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m11:33:12.287747 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m11:33:12.288114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m11:33:12.288337 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m11:33:12.291283 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m11:33:12.291904 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 11:33:12.288476 => 11:33:12.291692
[0m11:33:12.292435 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m11:33:12.292687 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m11:33:12.293064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m11:33:12.293281 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m11:33:12.295219 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m11:33:12.295850 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 11:33:12.293408 => 11:33:12.295686
[0m11:33:12.296322 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m11:33:12.296564 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m11:33:12.296971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m11:33:12.297181 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m11:33:12.299867 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m11:33:12.300224 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 11:33:12.297308 => 11:33:12.300095
[0m11:33:12.300740 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m11:33:12.301596 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_suppliers
[0m11:33:12.301879 [info ] [Thread-1 (]: 1 of 1 START sql table model trino_dbt.dim_suppliers ........................... [RUN]
[0m11:33:12.302333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_supplier, now model.dbt_trino_demo.dim_suppliers)
[0m11:33:12.302583 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_suppliers
[0m11:33:12.307598 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_suppliers"
[0m11:33:12.308319 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (compile): 11:33:12.302733 => 11:33:12.308145
[0m11:33:12.308599 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_suppliers
[0m11:33:12.326303 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_suppliers"
[0m11:33:12.328718 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m11:33:12.328997 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

  
    

    create table "lakehouse"."trino_dbt"."dim_suppliers"
      
      
    as (
      
with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m11:33:12.329224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:13.883784 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m11:33:13.896204 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (execute): 11:33:12.308755 => 11:33:13.896064
[0m11:33:13.896425 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: ROLLBACK
[0m11:33:13.896604 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: Close
[0m11:33:13.897590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3718e71-3075-481f-b987-bca7cbf3a864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e3a89410>]}
[0m11:33:13.897942 [info ] [Thread-1 (]: 1 of 1 OK created sql table model trino_dbt.dim_suppliers ...................... [[32mSUCCESS[0m in 1.60s]
[0m11:33:13.898315 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_suppliers
[0m11:33:13.899558 [debug] [MainThread]: On master: COMMIT
[0m11:33:13.899907 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:33:13.900059 [debug] [MainThread]: Connection 'model.dbt_trino_demo.dim_suppliers' was properly closed.
[0m11:33:13.900217 [info ] [MainThread]: 
[0m11:33:13.900414 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.96 seconds (3.96s).
[0m11:33:13.900831 [debug] [MainThread]: Command end result
[0m11:33:13.906463 [info ] [MainThread]: 
[0m11:33:13.906803 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:33:13.907158 [info ] [MainThread]: 
[0m11:33:13.907494 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:33:13.908045 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.9128795, "process_user_time": 2.190013, "process_kernel_time": 0.090413, "process_mem_max_rss": "114656", "process_out_blocks": "3464", "process_in_blocks": "0"}
[0m11:33:13.908334 [debug] [MainThread]: Command `dbt run` succeeded at 11:33:13.908265 after 4.91 seconds
[0m11:33:13.908527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e2eb5e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e2ee6a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e74fd050>]}
[0m11:33:13.908720 [debug] [MainThread]: Flushing usage events
[0m12:25:27.336450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2432700cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2432bb0b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2432747f90>]}


============================== 12:25:27.338221 | b3b3431e-1353-4db4-8f87-8553da65151b ==============================
[0m12:25:27.338221 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:25:27.338569 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --model dim_part_suppliers.sql', 'send_anonymous_usage_stats': 'True'}
[0m12:25:27.455369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3b3431e-1353-4db4-8f87-8553da65151b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f243250e9d0>]}
[0m12:25:27.506669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3b3431e-1353-4db4-8f87-8553da65151b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2432782a50>]}
[0m12:25:27.507081 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m12:25:27.514301 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:25:27.531652 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:25:27.532050 [debug] [MainThread]: Partial parsing: added file: dbt_trino_demo://models/mart/dim_part_suppliers.sql
[0m12:25:27.618343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3b3431e-1353-4db4-8f87-8553da65151b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24320a4d50>]}
[0m12:25:27.625897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3b3431e-1353-4db4-8f87-8553da65151b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2432371850>]}
[0m12:25:27.626222 [info ] [MainThread]: Found 10 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m12:25:27.626465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3b3431e-1353-4db4-8f87-8553da65151b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24327472d0>]}
[0m12:25:27.627491 [info ] [MainThread]: 
[0m12:25:27.628015 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m12:25:27.628824 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m12:25:27.639059 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m12:25:27.639299 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m12:25:27.639462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:28.967292 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m12:25:28.970240 [debug] [ThreadPool]: On list_lakehouse: Close
[0m12:25:28.974174 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_trino_dbt)
[0m12:25:28.980510 [debug] [ThreadPool]: Using trino connection "list_lakehouse_trino_dbt"
[0m12:25:28.980823 [debug] [ThreadPool]: On list_lakehouse_trino_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_trino_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'trino_dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'trino_dbt'
[0m12:25:28.981097 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:29.770786 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m12:25:29.773642 [debug] [ThreadPool]: On list_lakehouse_trino_dbt: ROLLBACK
[0m12:25:29.773915 [debug] [ThreadPool]: On list_lakehouse_trino_dbt: Close
[0m12:25:29.775603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3b3431e-1353-4db4-8f87-8553da65151b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24323a4d90>]}
[0m12:25:29.775870 [debug] [MainThread]: On master: COMMIT
[0m12:25:29.776232 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:25:29.776454 [info ] [MainThread]: 
[0m12:25:29.779080 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_part_suppliers
[0m12:25:29.779383 [info ] [Thread-1 (]: 1 of 1 START sql table model trino_dbt.dim_part_suppliers ...................... [RUN]
[0m12:25:29.779838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_trino_dbt, now model.dbt_trino_demo.dim_part_suppliers)
[0m12:25:29.780073 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_part_suppliers
[0m12:25:29.784176 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:25:29.792666 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:25:29.794550 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:25:29.796424 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:25:29.798203 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:25:29.802499 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:25:29.803099 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (compile): 12:25:29.780219 => 12:25:29.802924
[0m12:25:29.803332 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_part_suppliers
[0m12:25:29.821861 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:25:29.825708 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m12:25:29.826024 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

  
    

    create table "lakehouse"."trino_dbt"."dim_part_suppliers"
      
      
    as (
      with __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
) select 
	ps.part_supplier_key,
	p.part_key,
	p.part_name,
	p.part_manufacturer_name,
	p.part_brand_name,
	p.part_type_name,
	p.part_size,
	p.part_container_desc,
	p.retail_price,

	s.supplier_key,
	s.supplier_name,
	supplier_address,
	s.supplier_phone_number,
	s.supplier_account_balance,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,

	ps.supplier_availabe_quantity,
	ps.supplier_cost_amount
from
	__dbt__cte__stg_tpch_part p
	join
	__dbt__cte__stg_tpch_part_suppliers ps
		on p.part_key = ps.part_key
	join
   __dbt__cte__stg_tpch_supplier s
		on ps.supplier_key = s.supplier_key
	join
	__dbt__cte__stg_tpch_nation n
		on s.nation_key = n.nation_key
	join
	__dbt__cte__stg_tpch_region r
		on n.region_key = r.region_key
from
    final f
order by
    f.part_key,
    f.supplier_key
    )
[0m12:25:29.826270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:30.091396 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231213_112530_00176_scdwh
[0m12:25:30.092325 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 101:1: mismatched input 'from'. Expecting: '%', ')', '*', '+', ',', '-', '.', '/', 'AND', 'AT', 'CROSS', 'EXCEPT', 'FETCH', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'NATURAL', 'OFFSET', 'OR', 'ORDER', 'RIGHT', 'UNION', 'WHERE', 'WINDOW', '[', '||'", query_id=20231213_112530_00176_scdwh)
[0m12:25:30.093445 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (execute): 12:25:29.803447 => 12:25:30.092999
[0m12:25:30.093932 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: ROLLBACK
[0m12:25:30.094104 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: Close
[0m12:25:30.096867 [debug] [Thread-1 (]: Database Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 101:1: mismatched input 'from'. Expecting: '%', ')', '*', '+', ',', '-', '.', '/', 'AND', 'AT', 'CROSS', 'EXCEPT', 'FETCH', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'NATURAL', 'OFFSET', 'OR', 'ORDER', 'RIGHT', 'UNION', 'WHERE', 'WINDOW', '[', '||'", query_id=20231213_112530_00176_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_part_suppliers.sql
[0m12:25:30.097798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3b3431e-1353-4db4-8f87-8553da65151b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2432459b50>]}
[0m12:25:30.098207 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model trino_dbt.dim_part_suppliers ............. [[31mERROR[0m in 0.32s]
[0m12:25:30.098581 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_part_suppliers
[0m12:25:30.100117 [debug] [MainThread]: On master: COMMIT
[0m12:25:30.100476 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:25:30.100646 [debug] [MainThread]: Connection 'model.dbt_trino_demo.dim_part_suppliers' was properly closed.
[0m12:25:30.100830 [info ] [MainThread]: 
[0m12:25:30.101112 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.47 seconds (2.47s).
[0m12:25:30.101632 [debug] [MainThread]: Command end result
[0m12:25:30.107346 [info ] [MainThread]: 
[0m12:25:30.107697 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:25:30.107905 [info ] [MainThread]: 
[0m12:25:30.108131 [error] [MainThread]:   Database Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 101:1: mismatched input 'from'. Expecting: '%', ')', '*', '+', ',', '-', '.', '/', 'AND', 'AT', 'CROSS', 'EXCEPT', 'FETCH', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'NATURAL', 'OFFSET', 'OR', 'ORDER', 'RIGHT', 'UNION', 'WHERE', 'WINDOW', '[', '||'", query_id=20231213_112530_00176_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_part_suppliers.sql
[0m12:25:30.108374 [info ] [MainThread]: 
[0m12:25:30.108667 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:25:30.109291 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.79795, "process_user_time": 1.442845, "process_kernel_time": 0.170335, "process_mem_max_rss": "115304", "process_out_blocks": "3472", "command_success": false, "process_in_blocks": "0"}
[0m12:25:30.109587 [debug] [MainThread]: Command `dbt run` failed at 12:25:30.109518 after 2.80 seconds
[0m12:25:30.109799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2432758bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f243270eb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f243270dcd0>]}
[0m12:25:30.109994 [debug] [MainThread]: Flushing usage events
[0m12:26:39.655505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c95f5cd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c95f5d090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c95f5ddd0>]}


============================== 12:26:39.657308 | 430b3c01-00c5-467e-844f-2859872ac04e ==============================
[0m12:26:39.657308 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:26:39.657718 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --model dim_part_suppliers.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:26:39.771861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '430b3c01-00c5-467e-844f-2859872ac04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c95d9d890>]}
[0m12:26:39.821819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '430b3c01-00c5-467e-844f-2859872ac04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c95cffbd0>]}
[0m12:26:39.822220 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m12:26:39.829029 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:26:39.843814 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:26:39.844329 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/mart/dim_part_suppliers.sql
[0m12:26:39.929585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '430b3c01-00c5-467e-844f-2859872ac04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c95befcd0>]}
[0m12:26:39.936568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '430b3c01-00c5-467e-844f-2859872ac04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c959e1bd0>]}
[0m12:26:39.936888 [info ] [MainThread]: Found 10 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m12:26:39.937262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '430b3c01-00c5-467e-844f-2859872ac04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c95c704d0>]}
[0m12:26:39.938552 [info ] [MainThread]: 
[0m12:26:39.939155 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m12:26:39.940500 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m12:26:39.950821 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m12:26:39.951103 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m12:26:39.951277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:41.922746 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m12:26:41.925469 [debug] [ThreadPool]: On list_lakehouse: Close
[0m12:26:41.927616 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_trino_dbt)
[0m12:26:41.933331 [debug] [ThreadPool]: Using trino connection "list_lakehouse_trino_dbt"
[0m12:26:41.933567 [debug] [ThreadPool]: On list_lakehouse_trino_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_trino_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'trino_dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'trino_dbt'
[0m12:26:41.933732 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:26:42.963171 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m12:26:42.965877 [debug] [ThreadPool]: On list_lakehouse_trino_dbt: ROLLBACK
[0m12:26:42.966064 [debug] [ThreadPool]: On list_lakehouse_trino_dbt: Close
[0m12:26:42.967575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '430b3c01-00c5-467e-844f-2859872ac04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c95c73590>]}
[0m12:26:42.967852 [debug] [MainThread]: On master: COMMIT
[0m12:26:42.968224 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:26:42.968440 [info ] [MainThread]: 
[0m12:26:42.970839 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_part_suppliers
[0m12:26:42.971235 [info ] [Thread-1 (]: 1 of 1 START sql table model trino_dbt.dim_part_suppliers ...................... [RUN]
[0m12:26:42.971759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_trino_dbt, now model.dbt_trino_demo.dim_part_suppliers)
[0m12:26:42.972007 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_part_suppliers
[0m12:26:42.975974 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:26:42.985115 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:26:42.987101 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:26:42.988926 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:26:42.990766 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:26:42.994576 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:26:42.994988 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (compile): 12:26:42.972139 => 12:26:42.994780
[0m12:26:42.995284 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_part_suppliers
[0m12:26:43.013804 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:26:43.017394 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m12:26:43.017692 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

  
    

    create table "lakehouse"."trino_dbt"."dim_part_suppliers"
      
      
    as (
      with __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
) select 
	ps.part_supplier_key,
	p.part_key,
	p.part_name,
	p.part_manufacturer_name,
	p.part_brand_name,
	p.part_type_name,
	p.part_size,
	p.part_container_desc,
	p.retail_price,

	s.supplier_key,
	s.supplier_name,
	supplier_address,
	s.supplier_phone_number,
	s.supplier_account_balance,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,

	ps.supplier_availabe_quantity,
	ps.supplier_cost_amount
from
	__dbt__cte__stg_tpch_part p
	join
	__dbt__cte__stg_tpch_part_suppliers ps
		on p.part_key = ps.part_key
	join
   __dbt__cte__stg_tpch_supplier s
		on ps.supplier_key = s.supplier_key
	join
	__dbt__cte__stg_tpch_nation n
		on s.nation_key = n.nation_key
	join
	__dbt__cte__stg_tpch_region r
		on n.region_key = r.region_key´
order by
    p.part_key,
    s.supplier_key
    )
[0m12:26:43.017941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:43.290765 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231213_112643_00179_scdwh
[0m12:26:43.291802 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 100:33: mismatched input '´'. Expecting: '%', ')', '*', '+', ',', '-', '.', '/', 'AND', 'AT', 'CROSS', 'EXCEPT', 'FETCH', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'NATURAL', 'OFFSET', 'OR', 'ORDER', 'RIGHT', 'UNION', 'WHERE', 'WINDOW', '[', '||'", query_id=20231213_112643_00179_scdwh)
[0m12:26:43.292920 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (execute): 12:26:42.995438 => 12:26:43.292483
[0m12:26:43.293121 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: ROLLBACK
[0m12:26:43.293288 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: Close
[0m12:26:43.295597 [debug] [Thread-1 (]: Database Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 100:33: mismatched input '´'. Expecting: '%', ')', '*', '+', ',', '-', '.', '/', 'AND', 'AT', 'CROSS', 'EXCEPT', 'FETCH', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'NATURAL', 'OFFSET', 'OR', 'ORDER', 'RIGHT', 'UNION', 'WHERE', 'WINDOW', '[', '||'", query_id=20231213_112643_00179_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_part_suppliers.sql
[0m12:26:43.296562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '430b3c01-00c5-467e-844f-2859872ac04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c94829e90>]}
[0m12:26:43.296920 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model trino_dbt.dim_part_suppliers ............. [[31mERROR[0m in 0.32s]
[0m12:26:43.297295 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_part_suppliers
[0m12:26:43.298687 [debug] [MainThread]: On master: COMMIT
[0m12:26:43.299099 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:26:43.299256 [debug] [MainThread]: Connection 'model.dbt_trino_demo.dim_part_suppliers' was properly closed.
[0m12:26:43.299413 [info ] [MainThread]: 
[0m12:26:43.299609 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.36 seconds (3.36s).
[0m12:26:43.300045 [debug] [MainThread]: Command end result
[0m12:26:43.305704 [info ] [MainThread]: 
[0m12:26:43.306022 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:26:43.306320 [info ] [MainThread]: 
[0m12:26:43.306625 [error] [MainThread]:   Database Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 100:33: mismatched input '´'. Expecting: '%', ')', '*', '+', ',', '-', '.', '/', 'AND', 'AT', 'CROSS', 'EXCEPT', 'FETCH', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'NATURAL', 'OFFSET', 'OR', 'ORDER', 'RIGHT', 'UNION', 'WHERE', 'WINDOW', '[', '||'", query_id=20231213_112643_00179_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_part_suppliers.sql
[0m12:26:43.306884 [info ] [MainThread]: 
[0m12:26:43.307154 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:26:43.307757 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.6757522, "process_user_time": 1.507516, "process_kernel_time": 0.039156, "process_mem_max_rss": "113368", "process_out_blocks": "3464", "command_success": false, "process_in_blocks": "0"}
[0m12:26:43.308050 [debug] [MainThread]: Command `dbt run` failed at 12:26:43.307981 after 3.68 seconds
[0m12:26:43.308271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c9a4b34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c9a5a1150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c95f5ead0>]}
[0m12:26:43.308481 [debug] [MainThread]: Flushing usage events
[0m12:31:22.354667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8be9d2cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8be9d10d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8be9d1310>]}


============================== 12:31:22.356333 | 5afd7330-373e-41c0-ad93-03b9f4ad5268 ==============================
[0m12:31:22.356333 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:31:22.356675 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --model dim_part_suppliers.sql', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:31:22.471063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5afd7330-373e-41c0-ad93-03b9f4ad5268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8be8cc310>]}
[0m12:31:22.520910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5afd7330-373e-41c0-ad93-03b9f4ad5268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8be839350>]}
[0m12:31:22.521388 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m12:31:22.528080 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:31:22.543871 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:31:22.544345 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/mart/dim_part_suppliers.sql
[0m12:31:22.621452 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_trino_demo.dim_part_suppliers' (models/mart/dim_part_suppliers.sql) depends on a node named 'suppliers' which was not found
[0m12:31:22.622094 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.2910016, "process_user_time": 1.27019, "process_kernel_time": 0.080011, "process_mem_max_rss": "105284", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m12:31:22.622455 [debug] [MainThread]: Command `dbt run` failed at 12:31:22.622374 after 0.29 seconds
[0m12:31:22.622712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8be9b7150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8be52bc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8be9b44d0>]}
[0m12:31:22.622924 [debug] [MainThread]: Flushing usage events
[0m12:32:58.551516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeb343f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeb348a190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeb343f390>]}


============================== 12:32:58.553145 | 6770e1ab-50c7-4596-9f67-dd0a4ed9440c ==============================
[0m12:32:58.553145 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:32:58.553494 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --model dim_part_suppliers.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:32:58.668402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6770e1ab-50c7-4596-9f67-dd0a4ed9440c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeb32c1550>]}
[0m12:32:58.718829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6770e1ab-50c7-4596-9f67-dd0a4ed9440c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeb31dd3d0>]}
[0m12:32:58.719242 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m12:32:58.725955 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:32:58.741580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:32:58.741985 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/mart/dim_part_suppliers.sql
[0m12:32:58.829401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6770e1ab-50c7-4596-9f67-dd0a4ed9440c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeb2ec9810>]}
[0m12:32:58.836636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6770e1ab-50c7-4596-9f67-dd0a4ed9440c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeb307d890>]}
[0m12:32:58.837004 [info ] [MainThread]: Found 10 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m12:32:58.837296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6770e1ab-50c7-4596-9f67-dd0a4ed9440c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeb344b810>]}
[0m12:32:58.838338 [info ] [MainThread]: 
[0m12:32:58.838876 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m12:32:58.839751 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m12:32:58.850133 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m12:32:58.850379 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m12:32:58.850544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:59.844566 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m12:32:59.846554 [debug] [ThreadPool]: On list_lakehouse: Close
[0m12:32:59.849019 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_trino_dbt)
[0m12:32:59.853796 [debug] [ThreadPool]: Using trino connection "list_lakehouse_trino_dbt"
[0m12:32:59.854055 [debug] [ThreadPool]: On list_lakehouse_trino_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_trino_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'trino_dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'trino_dbt'
[0m12:32:59.854257 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:00.687902 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m12:33:00.690595 [debug] [ThreadPool]: On list_lakehouse_trino_dbt: ROLLBACK
[0m12:33:00.691178 [debug] [ThreadPool]: On list_lakehouse_trino_dbt: Close
[0m12:33:00.693027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6770e1ab-50c7-4596-9f67-dd0a4ed9440c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeb2fc6c10>]}
[0m12:33:00.693293 [debug] [MainThread]: On master: COMMIT
[0m12:33:00.693662 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:33:00.693878 [info ] [MainThread]: 
[0m12:33:00.696074 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_part_suppliers
[0m12:33:00.696360 [info ] [Thread-1 (]: 1 of 1 START sql table model trino_dbt.dim_part_suppliers ...................... [RUN]
[0m12:33:00.696804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_trino_dbt, now model.dbt_trino_demo.dim_part_suppliers)
[0m12:33:00.697017 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_part_suppliers
[0m12:33:00.706747 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (compile): 12:33:00.697123 => 12:33:00.706515
[0m12:33:00.711834 [debug] [Thread-1 (]: Compilation Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  'dbt_housekeeping' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:33:00.712172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6770e1ab-50c7-4596-9f67-dd0a4ed9440c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeb2e53390>]}
[0m12:33:00.712542 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model trino_dbt.dim_part_suppliers ............. [[31mERROR[0m in 0.02s]
[0m12:33:00.712930 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_part_suppliers
[0m12:33:00.714477 [debug] [MainThread]: On master: COMMIT
[0m12:33:00.714866 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:00.715022 [debug] [MainThread]: Connection 'model.dbt_trino_demo.dim_part_suppliers' was properly closed.
[0m12:33:00.715185 [info ] [MainThread]: 
[0m12:33:00.715389 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.88 seconds (1.88s).
[0m12:33:00.715809 [debug] [MainThread]: Command end result
[0m12:33:00.721518 [info ] [MainThread]: 
[0m12:33:00.721881 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:33:00.722121 [info ] [MainThread]: 
[0m12:33:00.722352 [error] [MainThread]:   Compilation Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  'dbt_housekeeping' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:33:00.722620 [info ] [MainThread]: 
[0m12:33:00.722872 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:33:00.723450 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.1953647, "process_user_time": 1.406004, "process_kernel_time": 0.070805, "process_mem_max_rss": "114492", "process_in_blocks": "200", "process_out_blocks": "3376", "command_success": false}
[0m12:33:00.723756 [debug] [MainThread]: Command `dbt run` failed at 12:33:00.723686 after 2.20 seconds
[0m12:33:00.723967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeb344be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeb314afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeb3fac9d0>]}
[0m12:33:00.724168 [debug] [MainThread]: Flushing usage events
[0m12:33:22.846582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29b939fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29b9352c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29b9351d90>]}


============================== 12:33:22.848339 | dc6aa179-e7bd-433f-ba12-9558c13f07f9 ==============================
[0m12:33:22.848339 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:33:22.848899 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --model dim_part_suppliers.sql', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:33:22.963866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc6aa179-e7bd-433f-ba12-9558c13f07f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29b92534d0>]}
[0m12:33:23.015981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc6aa179-e7bd-433f-ba12-9558c13f07f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29b9394810>]}
[0m12:33:23.016447 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m12:33:23.023396 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:33:23.038474 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:33:23.038908 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/mart/dim_part_suppliers.sql
[0m12:33:23.124626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc6aa179-e7bd-433f-ba12-9558c13f07f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29b8d05b50>]}
[0m12:33:23.131632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc6aa179-e7bd-433f-ba12-9558c13f07f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29b8f22a50>]}
[0m12:33:23.131952 [info ] [MainThread]: Found 10 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m12:33:23.132251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc6aa179-e7bd-433f-ba12-9558c13f07f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29b92d06d0>]}
[0m12:33:23.133300 [info ] [MainThread]: 
[0m12:33:23.133831 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m12:33:23.134638 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m12:33:23.144975 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m12:33:23.145214 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m12:33:23.145379 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:24.202633 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m12:33:24.205084 [debug] [ThreadPool]: On list_lakehouse: Close
[0m12:33:24.208121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_trino_dbt)
[0m12:33:24.213355 [debug] [ThreadPool]: Using trino connection "list_lakehouse_trino_dbt"
[0m12:33:24.213584 [debug] [ThreadPool]: On list_lakehouse_trino_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_trino_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'trino_dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'trino_dbt'
[0m12:33:24.213774 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:24.808952 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m12:33:24.811071 [debug] [ThreadPool]: On list_lakehouse_trino_dbt: ROLLBACK
[0m12:33:24.811262 [debug] [ThreadPool]: On list_lakehouse_trino_dbt: Close
[0m12:33:24.812627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc6aa179-e7bd-433f-ba12-9558c13f07f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29b9047290>]}
[0m12:33:24.812894 [debug] [MainThread]: On master: COMMIT
[0m12:33:24.813260 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:33:24.813471 [info ] [MainThread]: 
[0m12:33:24.815721 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_part_suppliers
[0m12:33:24.816006 [info ] [Thread-1 (]: 1 of 1 START sql table model trino_dbt.dim_part_suppliers ...................... [RUN]
[0m12:33:24.816436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_trino_dbt, now model.dbt_trino_demo.dim_part_suppliers)
[0m12:33:24.816654 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_part_suppliers
[0m12:33:24.820747 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:33:24.822852 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:33:24.831784 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:33:24.833953 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:33:24.835764 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:33:24.842399 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:33:24.842747 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (compile): 12:33:24.816770 => 12:33:24.842602
[0m12:33:24.842961 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_part_suppliers
[0m12:33:24.861633 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:33:24.866299 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m12:33:24.866628 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

  
    

    create table "lakehouse"."trino_dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
order by
    f.part_key,
    f.supplier_key
    )
[0m12:33:24.866882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:25.221384 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231213_113325_00184_scdwh
[0m12:33:25.222293 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 121:16: Column 'ps.supplier_key' cannot be resolved", query_id=20231213_113325_00184_scdwh)
[0m12:33:25.223317 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (execute): 12:33:24.843070 => 12:33:25.222935
[0m12:33:25.223867 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: ROLLBACK
[0m12:33:25.224125 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: Close
[0m12:33:25.226478 [debug] [Thread-1 (]: Database Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 121:16: Column 'ps.supplier_key' cannot be resolved", query_id=20231213_113325_00184_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_part_suppliers.sql
[0m12:33:25.227389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc6aa179-e7bd-433f-ba12-9558c13f07f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29b7ae4250>]}
[0m12:33:25.227740 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model trino_dbt.dim_part_suppliers ............. [[31mERROR[0m in 0.41s]
[0m12:33:25.228113 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_part_suppliers
[0m12:33:25.229787 [debug] [MainThread]: On master: COMMIT
[0m12:33:25.230147 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:25.230300 [debug] [MainThread]: Connection 'model.dbt_trino_demo.dim_part_suppliers' was properly closed.
[0m12:33:25.230459 [info ] [MainThread]: 
[0m12:33:25.230659 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.10 seconds (2.10s).
[0m12:33:25.231145 [debug] [MainThread]: Command end result
[0m12:33:25.236765 [info ] [MainThread]: 
[0m12:33:25.237244 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:33:25.237539 [info ] [MainThread]: 
[0m12:33:25.237799 [error] [MainThread]:   Database Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 121:16: Column 'ps.supplier_key' cannot be resolved", query_id=20231213_113325_00184_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_part_suppliers.sql
[0m12:33:25.238059 [info ] [MainThread]: 
[0m12:33:25.238275 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:33:25.238838 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.416305, "process_user_time": 1.516762, "process_kernel_time": 0.051241, "process_mem_max_rss": "113172", "process_out_blocks": "3464", "command_success": false, "process_in_blocks": "0"}
[0m12:33:25.239123 [debug] [MainThread]: Command `dbt run` failed at 12:33:25.239058 after 2.42 seconds
[0m12:33:25.239340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29bda5b790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29b8de6b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29bda5b750>]}
[0m12:33:25.239531 [debug] [MainThread]: Flushing usage events
[0m12:34:47.442555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9bcc34b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9bc7a85d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9bc7ce190>]}


============================== 12:34:47.444200 | 28a320ba-2d91-490e-9215-a1b3a4dc51eb ==============================
[0m12:34:47.444200 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:34:47.444543 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --model dim_part_suppliers.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:34:47.556476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28a320ba-2d91-490e-9215-a1b3a4dc51eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9bc7e0610>]}
[0m12:34:47.607323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28a320ba-2d91-490e-9215-a1b3a4dc51eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9bc4fdf50>]}
[0m12:34:47.607753 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m12:34:47.614438 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:34:47.629777 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:34:47.630183 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/mart/dim_part_suppliers.sql
[0m12:34:47.713906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28a320ba-2d91-490e-9215-a1b3a4dc51eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9bc155990>]}
[0m12:34:47.720718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28a320ba-2d91-490e-9215-a1b3a4dc51eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9bc20ab90>]}
[0m12:34:47.721199 [info ] [MainThread]: Found 10 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m12:34:47.721471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28a320ba-2d91-490e-9215-a1b3a4dc51eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9bc697910>]}
[0m12:34:47.722446 [info ] [MainThread]: 
[0m12:34:47.722955 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m12:34:47.723750 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m12:34:47.734311 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m12:34:47.734561 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m12:34:47.734742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:34:48.821912 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m12:34:48.822762 [debug] [ThreadPool]: On list_lakehouse: Close
[0m12:34:48.824703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_trino_dbt)
[0m12:34:48.829386 [debug] [ThreadPool]: Using trino connection "list_lakehouse_trino_dbt"
[0m12:34:48.829613 [debug] [ThreadPool]: On list_lakehouse_trino_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_trino_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'trino_dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'trino_dbt'
[0m12:34:48.829808 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:34:49.500834 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m12:34:49.503018 [debug] [ThreadPool]: On list_lakehouse_trino_dbt: ROLLBACK
[0m12:34:49.503189 [debug] [ThreadPool]: On list_lakehouse_trino_dbt: Close
[0m12:34:49.504638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28a320ba-2d91-490e-9215-a1b3a4dc51eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9bc47ba10>]}
[0m12:34:49.504903 [debug] [MainThread]: On master: COMMIT
[0m12:34:49.505351 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:34:49.505564 [info ] [MainThread]: 
[0m12:34:49.507737 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_part_suppliers
[0m12:34:49.508082 [info ] [Thread-1 (]: 1 of 1 START sql table model trino_dbt.dim_part_suppliers ...................... [RUN]
[0m12:34:49.508600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_trino_dbt, now model.dbt_trino_demo.dim_part_suppliers)
[0m12:34:49.508840 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_part_suppliers
[0m12:34:49.512806 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:34:49.516111 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:34:49.524933 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:34:49.527189 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:34:49.529014 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:34:49.535796 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:34:49.536162 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (compile): 12:34:49.508973 => 12:34:49.536019
[0m12:34:49.536373 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_part_suppliers
[0m12:34:49.554283 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:34:49.559165 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m12:34:49.559513 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

  
    

    create table "lakehouse"."trino_dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        stg_tpch_part_suppliers ps
            on p.part_key = ps.part_key
        join
        stg_tpch_supplier s
            on ps.supplier_key = s.supplier_key
        join
        stg_tpch_nation n
            on s.nation_key = n.nation_key
        join
        stg_tpch_region r
            on n.region_key = r.region_key
)
select *

from
    final f
order by
    f.part_key,
    f.supplier_key
    )
[0m12:34:49.559776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:34:49.913468 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231213_113450_00187_scdwh
[0m12:34:49.914460 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SCHEMA_NOT_FOUND, message="line 117:9: Schema 'trino' does not exist", query_id=20231213_113450_00187_scdwh)
[0m12:34:49.914831 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (execute): 12:34:49.536485 => 12:34:49.914702
[0m12:34:49.915037 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: ROLLBACK
[0m12:34:49.915214 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: Close
[0m12:34:49.917469 [debug] [Thread-1 (]: Database Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=SCHEMA_NOT_FOUND, message="line 117:9: Schema 'trino' does not exist", query_id=20231213_113450_00187_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_part_suppliers.sql
[0m12:34:49.918383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28a320ba-2d91-490e-9215-a1b3a4dc51eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9bb20b450>]}
[0m12:34:49.918736 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model trino_dbt.dim_part_suppliers ............. [[31mERROR[0m in 0.41s]
[0m12:34:49.919099 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_part_suppliers
[0m12:34:49.920576 [debug] [MainThread]: On master: COMMIT
[0m12:34:49.920932 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:34:49.921199 [debug] [MainThread]: Connection 'model.dbt_trino_demo.dim_part_suppliers' was properly closed.
[0m12:34:49.921365 [info ] [MainThread]: 
[0m12:34:49.921560 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.20 seconds (2.20s).
[0m12:34:49.922012 [debug] [MainThread]: Command end result
[0m12:34:49.927999 [info ] [MainThread]: 
[0m12:34:49.928367 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:34:49.928615 [info ] [MainThread]: 
[0m12:34:49.928817 [error] [MainThread]:   Database Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=SCHEMA_NOT_FOUND, message="line 117:9: Schema 'trino' does not exist", query_id=20231213_113450_00187_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_part_suppliers.sql
[0m12:34:49.929012 [info ] [MainThread]: 
[0m12:34:49.929230 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:34:49.930185 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.5113833, "process_user_time": 1.488763, "process_kernel_time": 0.05995, "process_mem_max_rss": "115124", "process_out_blocks": "3464", "command_success": false, "process_in_blocks": "0"}
[0m12:34:49.930692 [debug] [MainThread]: Command `dbt run` failed at 12:34:49.930599 after 2.51 seconds
[0m12:34:49.931062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9bc788ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9bc78a710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9bcdd0990>]}
[0m12:34:49.931321 [debug] [MainThread]: Flushing usage events
[0m12:37:23.398534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94e9fe310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94e9fd050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94ed65910>]}


============================== 12:37:23.400297 | 4388c79a-d19f-4b08-bca7-8f2f6106a33b ==============================
[0m12:37:23.400297 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:37:23.400697 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --model dim_part_suppliers.sql', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:37:23.514309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4388c79a-d19f-4b08-bca7-8f2f6106a33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94e792990>]}
[0m12:37:23.565555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4388c79a-d19f-4b08-bca7-8f2f6106a33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94e76a790>]}
[0m12:37:23.566024 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m12:37:23.572846 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:37:23.579279 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:37:23.579600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4388c79a-d19f-4b08-bca7-8f2f6106a33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94e7e9350>]}
[0m12:37:24.308756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4388c79a-d19f-4b08-bca7-8f2f6106a33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94d24d810>]}
[0m12:37:24.315674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4388c79a-d19f-4b08-bca7-8f2f6106a33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94e555a10>]}
[0m12:37:24.316002 [info ] [MainThread]: Found 10 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m12:37:24.316269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4388c79a-d19f-4b08-bca7-8f2f6106a33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94e4fbc90>]}
[0m12:37:24.317412 [info ] [MainThread]: 
[0m12:37:24.317900 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m12:37:24.318792 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m12:37:24.328954 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m12:37:24.329188 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m12:37:24.329359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:25.416038 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m12:37:25.418439 [debug] [ThreadPool]: On list_lakehouse: Close
[0m12:37:25.421201 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt_dbt)
[0m12:37:25.425978 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt_dbt"
[0m12:37:25.426213 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt_dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt_dbt'
[0m12:37:25.426408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:37:26.005497 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m12:37:26.007745 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: ROLLBACK
[0m12:37:26.008187 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: Close
[0m12:37:26.009750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4388c79a-d19f-4b08-bca7-8f2f6106a33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94e3cffd0>]}
[0m12:37:26.010036 [debug] [MainThread]: On master: COMMIT
[0m12:37:26.010518 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:37:26.010752 [info ] [MainThread]: 
[0m12:37:26.013482 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_part_suppliers
[0m12:37:26.013779 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_dbt.dim_part_suppliers ........................ [RUN]
[0m12:37:26.014282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt_dbt, now model.dbt_trino_demo.dim_part_suppliers)
[0m12:37:26.014496 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_part_suppliers
[0m12:37:26.018430 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:37:26.020196 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:37:26.022956 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:37:26.024889 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:37:26.026985 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:37:26.033823 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:37:26.034195 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (compile): 12:37:26.014606 => 12:37:26.034053
[0m12:37:26.034420 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_part_suppliers
[0m12:37:26.052650 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:37:26.057367 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m12:37:26.057673 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        stg_tpch_part_suppliers ps
            on p.part_key = ps.part_key
        join
        stg_tpch_supplier s
            on ps.supplier_key = s.supplier_key
        join
        stg_tpch_nation n
            on s.nation_key = n.nation_key
        join
        stg_tpch_region r
            on n.region_key = r.region_key
)
select *

from
    final f
order by
    f.part_key,
    f.supplier_key
    )
[0m12:37:26.057939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:37:26.420642 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231213_113727_00190_scdwh
[0m12:37:26.421508 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 117:9: Table 'lakehouse.dbt.stg_tpch_part_suppliers' does not exist", query_id=20231213_113727_00190_scdwh)
[0m12:37:26.422666 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (execute): 12:37:26.034542 => 12:37:26.422254
[0m12:37:26.423253 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: ROLLBACK
[0m12:37:26.423782 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: Close
[0m12:37:26.427064 [debug] [Thread-1 (]: Database Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 117:9: Table 'lakehouse.dbt.stg_tpch_part_suppliers' does not exist", query_id=20231213_113727_00190_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_part_suppliers.sql
[0m12:37:26.428017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4388c79a-d19f-4b08-bca7-8f2f6106a33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94e669790>]}
[0m12:37:26.428381 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_dbt.dim_part_suppliers ............... [[31mERROR[0m in 0.41s]
[0m12:37:26.428760 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_part_suppliers
[0m12:37:26.430369 [debug] [MainThread]: On master: COMMIT
[0m12:37:26.430735 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:26.430888 [debug] [MainThread]: Connection 'model.dbt_trino_demo.dim_part_suppliers' was properly closed.
[0m12:37:26.431107 [info ] [MainThread]: 
[0m12:37:26.431320 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.11 seconds (2.11s).
[0m12:37:26.431776 [debug] [MainThread]: Command end result
[0m12:37:26.437470 [info ] [MainThread]: 
[0m12:37:26.437852 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:37:26.438146 [info ] [MainThread]: 
[0m12:37:26.438420 [error] [MainThread]:   Database Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 117:9: Table 'lakehouse.dbt.stg_tpch_part_suppliers' does not exist", query_id=20231213_113727_00190_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_part_suppliers.sql
[0m12:37:26.438661 [info ] [MainThread]: 
[0m12:37:26.438927 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:37:26.439577 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.0646703, "process_user_time": 2.103114, "process_kernel_time": 0.078621, "process_mem_max_rss": "115548", "process_out_blocks": "3456", "command_success": false, "process_in_blocks": "0"}
[0m12:37:26.439867 [debug] [MainThread]: Command `dbt run` failed at 12:37:26.439798 after 3.07 seconds
[0m12:37:26.440102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94ee84dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94e9e2710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9530b37d0>]}
[0m12:37:26.440299 [debug] [MainThread]: Flushing usage events
[0m12:37:53.179986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9655b1e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc964ec3310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc964ec12d0>]}


============================== 12:37:53.181680 | b4da56fb-9ce9-4949-b119-c31fdd45ca42 ==============================
[0m12:37:53.181680 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:37:53.182023 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:37:53.295154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4da56fb-9ce9-4949-b119-c31fdd45ca42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc964c6a050>]}
[0m12:37:53.345962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4da56fb-9ce9-4949-b119-c31fdd45ca42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc964d1cb50>]}
[0m12:37:53.346443 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m12:37:53.353197 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:37:53.359414 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:37:53.359718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b4da56fb-9ce9-4949-b119-c31fdd45ca42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc964ec3b90>]}
[0m12:37:54.084989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4da56fb-9ce9-4949-b119-c31fdd45ca42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9639116d0>]}
[0m12:37:54.092307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4da56fb-9ce9-4949-b119-c31fdd45ca42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc964a65050>]}
[0m12:37:54.092695 [info ] [MainThread]: Found 10 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m12:37:54.092951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4da56fb-9ce9-4949-b119-c31fdd45ca42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9649a1e50>]}
[0m12:37:54.094245 [info ] [MainThread]: 
[0m12:37:54.094771 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m12:37:54.095725 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m12:37:54.105961 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m12:37:54.106180 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m12:37:54.106339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:55.196618 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m12:37:55.198605 [debug] [ThreadPool]: On list_lakehouse: Close
[0m12:37:55.200521 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_trino_dbt)
[0m12:37:55.206285 [debug] [ThreadPool]: Using trino connection "list_lakehouse_trino_dbt"
[0m12:37:55.206494 [debug] [ThreadPool]: On list_lakehouse_trino_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_trino_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'trino_dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'trino_dbt'
[0m12:37:55.206668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:37:55.927972 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m12:37:55.930514 [debug] [ThreadPool]: On list_lakehouse_trino_dbt: ROLLBACK
[0m12:37:55.931014 [debug] [ThreadPool]: On list_lakehouse_trino_dbt: Close
[0m12:37:55.932918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4da56fb-9ce9-4949-b119-c31fdd45ca42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc964f43350>]}
[0m12:37:55.933193 [debug] [MainThread]: On master: COMMIT
[0m12:37:55.933551 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:37:55.933889 [info ] [MainThread]: 
[0m12:37:55.936096 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m12:37:55.936515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_trino_dbt, now model.dbt_trino_demo.stg_tpch_customers)
[0m12:37:55.936747 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m12:37:55.938961 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m12:37:55.939389 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 12:37:55.936874 => 12:37:55.939233
[0m12:37:55.939952 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m12:37:55.940254 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m12:37:55.940690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m12:37:55.941019 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m12:37:55.942889 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m12:37:55.943357 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 12:37:55.941182 => 12:37:55.943209
[0m12:37:55.943812 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m12:37:55.944042 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m12:37:55.944384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m12:37:55.944592 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m12:37:55.946334 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m12:37:55.946883 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 12:37:55.944718 => 12:37:55.946731
[0m12:37:55.947348 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m12:37:55.947578 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m12:37:55.947935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m12:37:55.948142 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m12:37:55.950178 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m12:37:55.950852 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 12:37:55.948268 => 12:37:55.950609
[0m12:37:55.951487 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m12:37:55.951774 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m12:37:55.952222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m12:37:55.952435 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m12:37:55.954299 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m12:37:55.954789 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 12:37:55.952570 => 12:37:55.954613
[0m12:37:55.955250 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m12:37:55.955483 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m12:37:55.955931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m12:37:55.956143 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m12:37:55.958820 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m12:37:55.959176 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 12:37:55.956271 => 12:37:55.959043
[0m12:37:55.959650 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m12:37:55.959887 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m12:37:55.960238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m12:37:55.960458 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m12:37:55.962205 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m12:37:55.962599 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 12:37:55.960597 => 12:37:55.962428
[0m12:37:55.963095 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m12:37:55.963331 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m12:37:55.963684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m12:37:55.963888 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m12:37:55.967295 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m12:37:55.967997 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 12:37:55.964014 => 12:37:55.967821
[0m12:37:55.968517 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m12:37:55.969284 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_part_suppliers
[0m12:37:55.969577 [info ] [Thread-1 (]: 1 of 2 START sql table model trino_dbt.dim_part_suppliers ...................... [RUN]
[0m12:37:55.970049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_supplier, now model.dbt_trino_demo.dim_part_suppliers)
[0m12:37:55.970333 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_part_suppliers
[0m12:37:55.979185 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:37:55.979598 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (compile): 12:37:55.970463 => 12:37:55.979463
[0m12:37:55.979796 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_part_suppliers
[0m12:37:55.997190 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:37:56.001988 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m12:37:56.002315 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

  
    

    create table "lakehouse"."trino_dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        stg_tpch_part_suppliers ps
            on p.part_key = ps.part_key
        join
        stg_tpch_supplier s
            on ps.supplier_key = s.supplier_key
        join
        stg_tpch_nation n
            on s.nation_key = n.nation_key
        join
        stg_tpch_region r
            on n.region_key = r.region_key
)
select *

from
    final f
order by
    f.part_key,
    f.supplier_key
    )
[0m12:37:56.002617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:37:56.351484 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231213_113756_00193_scdwh
[0m12:37:56.352339 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SCHEMA_NOT_FOUND, message="line 117:9: Schema 'trino' does not exist", query_id=20231213_113756_00193_scdwh)
[0m12:37:56.353261 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (execute): 12:37:55.979911 => 12:37:56.352917
[0m12:37:56.353695 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: ROLLBACK
[0m12:37:56.354048 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: Close
[0m12:37:56.357252 [debug] [Thread-1 (]: Database Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=SCHEMA_NOT_FOUND, message="line 117:9: Schema 'trino' does not exist", query_id=20231213_113756_00193_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_part_suppliers.sql
[0m12:37:56.358253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4da56fb-9ce9-4949-b119-c31fdd45ca42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96498d990>]}
[0m12:37:56.358705 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model trino_dbt.dim_part_suppliers ............. [[31mERROR[0m in 0.39s]
[0m12:37:56.359070 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_part_suppliers
[0m12:37:56.359398 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_suppliers
[0m12:37:56.359668 [info ] [Thread-1 (]: 2 of 2 START sql table model trino_dbt.dim_suppliers ........................... [RUN]
[0m12:37:56.360238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.dim_part_suppliers, now model.dbt_trino_demo.dim_suppliers)
[0m12:37:56.360452 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_suppliers
[0m12:37:56.365757 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_suppliers"
[0m12:37:56.366340 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (compile): 12:37:56.360580 => 12:37:56.366207
[0m12:37:56.366530 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_suppliers
[0m12:37:56.373058 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."trino_dbt"."dim_suppliers"
[0m12:37:56.374403 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m12:37:56.374632 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

    drop table if exists "lakehouse"."trino_dbt"."dim_suppliers"
[0m12:37:56.374810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:37:57.085430 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m12:37:57.087898 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_suppliers"
[0m12:37:57.091125 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m12:37:57.091378 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

  
    

    create table "lakehouse"."trino_dbt"."dim_suppliers"
      
      
    as (
      
with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m12:37:59.445359 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m12:37:59.460343 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (execute): 12:37:56.366638 => 12:37:59.460154
[0m12:37:59.460600 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: ROLLBACK
[0m12:37:59.460781 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: Close
[0m12:37:59.462158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4da56fb-9ce9-4949-b119-c31fdd45ca42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9638dfa10>]}
[0m12:37:59.462536 [info ] [Thread-1 (]: 2 of 2 OK created sql table model trino_dbt.dim_suppliers ...................... [[32mSUCCESS[0m in 3.10s]
[0m12:37:59.462905 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_suppliers
[0m12:37:59.464298 [debug] [MainThread]: On master: COMMIT
[0m12:37:59.464652 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:59.464806 [debug] [MainThread]: Connection 'model.dbt_trino_demo.dim_suppliers' was properly closed.
[0m12:37:59.464981 [info ] [MainThread]: 
[0m12:37:59.465182 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.37 seconds (5.37s).
[0m12:37:59.465743 [debug] [MainThread]: Command end result
[0m12:37:59.471405 [info ] [MainThread]: 
[0m12:37:59.471735 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:37:59.471993 [info ] [MainThread]: 
[0m12:37:59.472215 [error] [MainThread]:   Database Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=SCHEMA_NOT_FOUND, message="line 117:9: Schema 'trino' does not exist", query_id=20231213_113756_00193_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_part_suppliers.sql
[0m12:37:59.472436 [info ] [MainThread]: 
[0m12:37:59.472726 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m12:37:59.473293 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.317201, "process_user_time": 2.196082, "process_kernel_time": 0.117647, "process_mem_max_rss": "115444", "process_out_blocks": "3536", "command_success": false, "process_in_blocks": "0"}
[0m12:37:59.473583 [debug] [MainThread]: Command `dbt run` failed at 12:37:59.473513 after 6.32 seconds
[0m12:37:59.473797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc964ec3d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc964ec27d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc969457390>]}
[0m12:37:59.474002 [debug] [MainThread]: Flushing usage events
[0m12:40:20.467666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ae164d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ae164c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ae166150>]}


============================== 12:40:20.469270 | f3ef57e1-f685-418d-b96c-340cccfdcf4d ==============================
[0m12:40:20.469270 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:40:20.469606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:40:20.584487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3ef57e1-f685-418d-b96c-340cccfdcf4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ae608c10>]}
[0m12:40:20.634828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3ef57e1-f685-418d-b96c-340cccfdcf4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20adf10810>]}
[0m12:40:20.635195 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m12:40:20.641959 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:40:20.648953 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:40:20.649352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f3ef57e1-f685-418d-b96c-340cccfdcf4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20adc0cc90>]}
[0m12:40:21.379687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3ef57e1-f685-418d-b96c-340cccfdcf4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20add73a10>]}
[0m12:40:21.386783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3ef57e1-f685-418d-b96c-340cccfdcf4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20aca34210>]}
[0m12:40:21.387139 [info ] [MainThread]: Found 10 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m12:40:21.387417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3ef57e1-f685-418d-b96c-340cccfdcf4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ae0a6ad0>]}
[0m12:40:21.388675 [info ] [MainThread]: 
[0m12:40:21.389178 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m12:40:21.390846 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m12:40:21.402599 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m12:40:21.402889 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m12:40:21.403048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:22.417841 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m12:40:22.419822 [debug] [ThreadPool]: On list_lakehouse: Close
[0m12:40:22.421740 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt_dbt)
[0m12:40:22.427045 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt_dbt"
[0m12:40:22.427376 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt_dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt_dbt'
[0m12:40:22.427563 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:40:22.999743 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m12:40:23.001666 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: ROLLBACK
[0m12:40:23.002014 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: Close
[0m12:40:23.004034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3ef57e1-f685-418d-b96c-340cccfdcf4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ae0a4190>]}
[0m12:40:23.004392 [debug] [MainThread]: On master: COMMIT
[0m12:40:23.004955 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:40:23.005208 [info ] [MainThread]: 
[0m12:40:23.007424 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m12:40:23.007819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt_dbt, now model.dbt_trino_demo.stg_tpch_customers)
[0m12:40:23.008021 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m12:40:23.010090 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m12:40:23.010476 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 12:40:23.008132 => 12:40:23.010340
[0m12:40:23.011015 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m12:40:23.011319 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m12:40:23.011684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m12:40:23.011921 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m12:40:23.013790 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m12:40:23.014319 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 12:40:23.012057 => 12:40:23.014178
[0m12:40:23.014778 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m12:40:23.015013 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m12:40:23.015413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m12:40:23.015618 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m12:40:23.017304 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m12:40:23.017741 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 12:40:23.015741 => 12:40:23.017601
[0m12:40:23.018201 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m12:40:23.018431 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m12:40:23.018788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m12:40:23.018989 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m12:40:23.021034 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m12:40:23.021718 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 12:40:23.019112 => 12:40:23.021548
[0m12:40:23.022231 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m12:40:23.022501 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m12:40:23.022889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m12:40:23.023129 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m12:40:23.025099 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m12:40:23.025609 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 12:40:23.023272 => 12:40:23.025467
[0m12:40:23.026070 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m12:40:23.026305 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m12:40:23.026807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m12:40:23.027024 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m12:40:23.029731 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m12:40:23.030277 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 12:40:23.027157 => 12:40:23.030121
[0m12:40:23.030779 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m12:40:23.031060 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m12:40:23.031451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m12:40:23.031656 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m12:40:23.033389 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m12:40:23.033742 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 12:40:23.031783 => 12:40:23.033618
[0m12:40:23.034220 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m12:40:23.034467 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m12:40:23.034815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m12:40:23.035028 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m12:40:23.038578 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m12:40:23.039255 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 12:40:23.035157 => 12:40:23.039072
[0m12:40:23.039824 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m12:40:23.040784 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_part_suppliers
[0m12:40:23.041118 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_dbt.dim_part_suppliers ........................ [RUN]
[0m12:40:23.041592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_supplier, now model.dbt_trino_demo.dim_part_suppliers)
[0m12:40:23.041839 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_part_suppliers
[0m12:40:23.050532 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:40:23.051029 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (compile): 12:40:23.041943 => 12:40:23.050836
[0m12:40:23.051329 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_part_suppliers
[0m12:40:23.068537 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_part_suppliers"
[0m12:40:23.073434 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m12:40:23.073779 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        stg_tpch_part_suppliers ps
            on p.part_key = ps.part_key
        join
        stg_tpch_supplier s
            on ps.supplier_key = s.supplier_key
        join
        stg_tpch_nation n
            on s.nation_key = n.nation_key
        join
        stg_tpch_region r
            on n.region_key = r.region_key
)
select *

from
    final f
order by
    f.part_key,
    f.supplier_key
    )
[0m12:40:23.074047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:23.488799 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231213_114024_00198_scdwh
[0m12:40:23.489702 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 117:9: Table 'lakehouse.dbt.stg_tpch_part_suppliers' does not exist", query_id=20231213_114024_00198_scdwh)
[0m12:40:23.490920 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (execute): 12:40:23.051535 => 12:40:23.490449
[0m12:40:23.491171 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: ROLLBACK
[0m12:40:23.491451 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: Close
[0m12:40:23.493800 [debug] [Thread-1 (]: Database Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 117:9: Table 'lakehouse.dbt.stg_tpch_part_suppliers' does not exist", query_id=20231213_114024_00198_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_part_suppliers.sql
[0m12:40:23.494773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3ef57e1-f685-418d-b96c-340cccfdcf4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20aca496d0>]}
[0m12:40:23.495128 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model dbt_dbt.dim_part_suppliers ............... [[31mERROR[0m in 0.45s]
[0m12:40:23.495539 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_part_suppliers
[0m12:40:23.495834 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_suppliers
[0m12:40:23.496106 [info ] [Thread-1 (]: 2 of 2 START sql table model dbt_dbt.dim_suppliers ............................. [RUN]
[0m12:40:23.496783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.dim_part_suppliers, now model.dbt_trino_demo.dim_suppliers)
[0m12:40:23.497018 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_suppliers
[0m12:40:23.501900 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_suppliers"
[0m12:40:23.502265 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (compile): 12:40:23.497139 => 12:40:23.502132
[0m12:40:23.502462 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_suppliers
[0m12:40:23.507741 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt_dbt"."dim_suppliers"
[0m12:40:23.509272 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m12:40:23.509510 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt_dbt"."dim_suppliers"
[0m12:40:23.509686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:23.955659 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m12:40:23.958533 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_suppliers"
[0m12:40:23.962173 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m12:40:23.962404 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_suppliers"
      
      
    as (
      
with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m12:40:25.201853 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m12:40:25.214409 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (execute): 12:40:23.502571 => 12:40:25.214275
[0m12:40:25.214655 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: ROLLBACK
[0m12:40:25.214839 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: Close
[0m12:40:25.215886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3ef57e1-f685-418d-b96c-340cccfdcf4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ac846490>]}
[0m12:40:25.216293 [info ] [Thread-1 (]: 2 of 2 OK created sql table model dbt_dbt.dim_suppliers ........................ [[32mSUCCESS[0m in 1.72s]
[0m12:40:25.216750 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_suppliers
[0m12:40:25.218228 [debug] [MainThread]: On master: COMMIT
[0m12:40:25.218588 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:25.218740 [debug] [MainThread]: Connection 'model.dbt_trino_demo.dim_suppliers' was properly closed.
[0m12:40:25.218932 [info ] [MainThread]: 
[0m12:40:25.219130 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.83 seconds (3.83s).
[0m12:40:25.219584 [debug] [MainThread]: Command end result
[0m12:40:25.225514 [info ] [MainThread]: 
[0m12:40:25.225868 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:40:25.226145 [info ] [MainThread]: 
[0m12:40:25.226371 [error] [MainThread]:   Database Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 117:9: Table 'lakehouse.dbt.stg_tpch_part_suppliers' does not exist", query_id=20231213_114024_00198_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_part_suppliers.sql
[0m12:40:25.226599 [info ] [MainThread]: 
[0m12:40:25.226860 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m12:40:25.227455 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.783788, "process_user_time": 2.23851, "process_kernel_time": 0.080667, "process_mem_max_rss": "115384", "process_out_blocks": "3536", "command_success": false, "process_in_blocks": "0"}
[0m12:40:25.227752 [debug] [MainThread]: Command `dbt run` failed at 12:40:25.227683 after 4.78 seconds
[0m12:40:25.227963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20af287e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20aca385d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ac853a90>]}
[0m12:40:25.228157 [debug] [MainThread]: Flushing usage events
[0m13:27:04.055937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f284bfbba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f284c006d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f284cb296d0>]}


============================== 13:27:04.057600 | d7b4a4da-5305-4ccc-8a06-068fd4417b17 ==============================
[0m13:27:04.057600 [info ] [MainThread]: Running with dbt=1.7.3
[0m13:27:04.057953 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:27:04.172973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7b4a4da-5305-4ccc-8a06-068fd4417b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f284bc35a50>]}
[0m13:27:04.224934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7b4a4da-5305-4ccc-8a06-068fd4417b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f284c023410>]}
[0m13:27:04.225354 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m13:27:04.232171 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m13:27:04.249339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:27:04.249799 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/mart/dim_part_suppliers.sql
[0m13:27:04.335678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7b4a4da-5305-4ccc-8a06-068fd4417b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f284bbcd850>]}
[0m13:27:04.342845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7b4a4da-5305-4ccc-8a06-068fd4417b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f284bcd2990>]}
[0m13:27:04.343183 [info ] [MainThread]: Found 10 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m13:27:04.343450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7b4a4da-5305-4ccc-8a06-068fd4417b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f284bd07f10>]}
[0m13:27:04.344796 [info ] [MainThread]: 
[0m13:27:04.345406 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:27:04.346338 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m13:27:04.356650 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m13:27:04.356866 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m13:27:04.357051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:05.522722 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:27:05.525024 [debug] [ThreadPool]: On list_lakehouse: Close
[0m13:27:05.527852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt_dbt)
[0m13:27:05.532665 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt_dbt"
[0m13:27:05.532894 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt_dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt_dbt'
[0m13:27:05.533103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:27:06.224985 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:27:06.227079 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: ROLLBACK
[0m13:27:06.227255 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: Close
[0m13:27:06.228832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7b4a4da-5305-4ccc-8a06-068fd4417b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f284bdc02d0>]}
[0m13:27:06.229095 [debug] [MainThread]: On master: COMMIT
[0m13:27:06.229458 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:27:06.229673 [info ] [MainThread]: 
[0m13:27:06.231896 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m13:27:06.232298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt_dbt, now model.dbt_trino_demo.stg_tpch_customers)
[0m13:27:06.232500 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m13:27:06.234561 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m13:27:06.234987 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 13:27:06.232636 => 13:27:06.234843
[0m13:27:06.235501 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m13:27:06.235768 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m13:27:06.236159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m13:27:06.236385 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m13:27:06.238215 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m13:27:06.238584 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 13:27:06.236524 => 13:27:06.238442
[0m13:27:06.239071 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m13:27:06.239301 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m13:27:06.239651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m13:27:06.239853 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m13:27:06.242168 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m13:27:06.242591 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 13:27:06.240150 => 13:27:06.242441
[0m13:27:06.243173 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m13:27:06.243492 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m13:27:06.243880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m13:27:06.244089 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m13:27:06.245882 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m13:27:06.246373 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 13:27:06.244216 => 13:27:06.246231
[0m13:27:06.246840 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m13:27:06.247090 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m13:27:06.247495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m13:27:06.247836 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m13:27:06.249642 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m13:27:06.250015 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 13:27:06.247971 => 13:27:06.249890
[0m13:27:06.250457 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m13:27:06.250706 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:27:06.251258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m13:27:06.251480 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:27:06.260215 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m13:27:06.260793 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 13:27:06.251610 => 13:27:06.260592
[0m13:27:06.261533 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:27:06.261815 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m13:27:06.262190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m13:27:06.262405 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m13:27:06.264175 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m13:27:06.264528 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 13:27:06.262535 => 13:27:06.264395
[0m13:27:06.265083 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m13:27:06.265330 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m13:27:06.265684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m13:27:06.265893 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m13:27:06.268551 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m13:27:06.268914 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 13:27:06.266019 => 13:27:06.268781
[0m13:27:06.269427 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m13:27:06.270515 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_part_suppliers
[0m13:27:06.270833 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_dbt.dim_part_suppliers ........................ [RUN]
[0m13:27:06.271286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_supplier, now model.dbt_trino_demo.dim_part_suppliers)
[0m13:27:06.271486 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_part_suppliers
[0m13:27:06.280291 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m13:27:06.280791 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (compile): 13:27:06.271617 => 13:27:06.280617
[0m13:27:06.281085 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_part_suppliers
[0m13:27:06.298155 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_part_suppliers"
[0m13:27:06.302864 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m13:27:06.303183 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        stg_tpch_part p
        join
        stg_tpch_part_suppliers ps
            on p.part_key = ps.part_key
        join
        stg_tpch_supplier s
            on ps.supplier_key = s.supplier_key
        join
        stg_tpch_nation n
            on s.nation_key = n.nation_key
        join
        stg_tpch_region r
            on n.region_key = r.region_key
)
select *

from
    final f
order by
    f.part_key,
    f.supplier_key
    )
[0m13:27:06.303445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:06.662786 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231213_122707_00204_scdwh
[0m13:27:06.663759 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 115:9: Table 'lakehouse.dbt.stg_tpch_part' does not exist", query_id=20231213_122707_00204_scdwh)
[0m13:27:06.664897 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (execute): 13:27:06.281214 => 13:27:06.664471
[0m13:27:06.665523 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: ROLLBACK
[0m13:27:06.666087 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: Close
[0m13:27:06.670031 [debug] [Thread-1 (]: Database Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 115:9: Table 'lakehouse.dbt.stg_tpch_part' does not exist", query_id=20231213_122707_00204_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_part_suppliers.sql
[0m13:27:06.671111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7b4a4da-5305-4ccc-8a06-068fd4417b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f284a8575d0>]}
[0m13:27:06.671478 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model dbt_dbt.dim_part_suppliers ............... [[31mERROR[0m in 0.40s]
[0m13:27:06.671852 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_part_suppliers
[0m13:27:06.672123 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_suppliers
[0m13:27:06.672455 [info ] [Thread-1 (]: 2 of 2 START sql table model dbt_dbt.dim_suppliers ............................. [RUN]
[0m13:27:06.672905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.dim_part_suppliers, now model.dbt_trino_demo.dim_suppliers)
[0m13:27:06.673142 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_suppliers
[0m13:27:06.677984 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_suppliers"
[0m13:27:06.678577 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (compile): 13:27:06.673271 => 13:27:06.678429
[0m13:27:06.678782 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_suppliers
[0m13:27:06.683815 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt_dbt"."dim_suppliers"
[0m13:27:06.685156 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m13:27:06.685365 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt_dbt"."dim_suppliers"
[0m13:27:06.685553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:07.183478 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:27:07.186201 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_suppliers"
[0m13:27:07.190702 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m13:27:07.191028 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_suppliers"
      
      
    as (
      
with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m13:27:08.702611 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m13:27:08.715442 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (execute): 13:27:06.678893 => 13:27:08.715315
[0m13:27:08.715668 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: ROLLBACK
[0m13:27:08.715846 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: Close
[0m13:27:08.716897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7b4a4da-5305-4ccc-8a06-068fd4417b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f284bd05ad0>]}
[0m13:27:08.717257 [info ] [Thread-1 (]: 2 of 2 OK created sql table model dbt_dbt.dim_suppliers ........................ [[32mSUCCESS[0m in 2.04s]
[0m13:27:08.717650 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_suppliers
[0m13:27:08.718947 [debug] [MainThread]: On master: COMMIT
[0m13:27:08.719312 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:08.719467 [debug] [MainThread]: Connection 'model.dbt_trino_demo.dim_suppliers' was properly closed.
[0m13:27:08.719640 [info ] [MainThread]: 
[0m13:27:08.719835 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.37 seconds (4.37s).
[0m13:27:08.720327 [debug] [MainThread]: Command end result
[0m13:27:08.726141 [info ] [MainThread]: 
[0m13:27:08.726476 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:27:08.727359 [info ] [MainThread]: 
[0m13:27:08.727769 [error] [MainThread]:   Database Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 115:9: Table 'lakehouse.dbt.stg_tpch_part' does not exist", query_id=20231213_122707_00204_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_part_suppliers.sql
[0m13:27:08.728048 [info ] [MainThread]: 
[0m13:27:08.728544 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:27:08.729519 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.697409, "process_user_time": 1.624563, "process_kernel_time": 0.072432, "process_mem_max_rss": "113788", "process_out_blocks": "3544", "command_success": false, "process_in_blocks": "0"}
[0m13:27:08.730015 [debug] [MainThread]: Command `dbt run` failed at 13:27:08.729863 after 4.70 seconds
[0m13:27:08.730422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f284c012ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f285052f450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f285061d050>]}
[0m13:27:08.730803 [debug] [MainThread]: Flushing usage events
[0m13:28:23.517029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa19a3a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa19efb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa19ee2d0>]}


============================== 13:28:23.518690 | edbc04aa-e221-492c-8ccc-7e5ac0b75b0b ==============================
[0m13:28:23.518690 [info ] [MainThread]: Running with dbt=1.7.3
[0m13:28:23.519033 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:28:23.632732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edbc04aa-e221-492c-8ccc-7e5ac0b75b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa17e9690>]}
[0m13:28:23.684007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edbc04aa-e221-492c-8ccc-7e5ac0b75b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa199f590>]}
[0m13:28:23.684474 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m13:28:23.691140 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m13:28:23.706171 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:28:23.706807 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/mart/dim_part_suppliers.sql
[0m13:28:23.793416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edbc04aa-e221-492c-8ccc-7e5ac0b75b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa15242d0>]}
[0m13:28:23.800508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edbc04aa-e221-492c-8ccc-7e5ac0b75b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa1414410>]}
[0m13:28:23.800860 [info ] [MainThread]: Found 10 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m13:28:23.801217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edbc04aa-e221-492c-8ccc-7e5ac0b75b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa182c250>]}
[0m13:28:23.802492 [info ] [MainThread]: 
[0m13:28:23.803017 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:28:23.804396 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m13:28:23.816299 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m13:28:23.816586 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m13:28:23.816754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:24.845512 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:28:24.848124 [debug] [ThreadPool]: On list_lakehouse: Close
[0m13:28:24.851586 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt_dbt)
[0m13:28:24.857709 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt_dbt"
[0m13:28:24.857921 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt_dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt_dbt'
[0m13:28:24.858086 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:28:25.618538 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:28:25.620537 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: ROLLBACK
[0m13:28:25.620712 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: Close
[0m13:28:25.622304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edbc04aa-e221-492c-8ccc-7e5ac0b75b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa13691d0>]}
[0m13:28:25.622573 [debug] [MainThread]: On master: COMMIT
[0m13:28:25.622937 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:28:25.623149 [info ] [MainThread]: 
[0m13:28:25.625143 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m13:28:25.625550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt_dbt, now model.dbt_trino_demo.stg_tpch_customers)
[0m13:28:25.625751 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m13:28:25.627808 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m13:28:25.628204 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 13:28:25.625861 => 13:28:25.628070
[0m13:28:25.628691 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m13:28:25.628953 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m13:28:25.629343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m13:28:25.629569 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m13:28:25.631593 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m13:28:25.632135 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 13:28:25.629705 => 13:28:25.631988
[0m13:28:25.632596 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m13:28:25.632856 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m13:28:25.633214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m13:28:25.633419 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m13:28:25.635207 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m13:28:25.635646 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 13:28:25.633541 => 13:28:25.635501
[0m13:28:25.636108 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m13:28:25.636338 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m13:28:25.636692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m13:28:25.636894 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m13:28:25.638605 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m13:28:25.639114 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 13:28:25.637016 => 13:28:25.638973
[0m13:28:25.639599 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m13:28:25.639852 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m13:28:25.640261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m13:28:25.640466 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m13:28:25.642249 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m13:28:25.642724 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 13:28:25.640612 => 13:28:25.642543
[0m13:28:25.643329 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m13:28:25.643585 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:28:25.644062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m13:28:25.644292 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:28:25.653059 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m13:28:25.653500 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 13:28:25.644435 => 13:28:25.653358
[0m13:28:25.653990 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:28:25.654276 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m13:28:25.654677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m13:28:25.654907 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m13:28:25.656679 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m13:28:25.657044 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 13:28:25.655047 => 13:28:25.656900
[0m13:28:25.657568 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m13:28:25.657801 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m13:28:25.658483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m13:28:25.658961 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m13:28:25.662006 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m13:28:25.662423 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 13:28:25.659122 => 13:28:25.662282
[0m13:28:25.662944 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m13:28:25.663825 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_part_suppliers
[0m13:28:25.664092 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_dbt.dim_part_suppliers ........................ [RUN]
[0m13:28:25.664505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_supplier, now model.dbt_trino_demo.dim_part_suppliers)
[0m13:28:25.664706 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_part_suppliers
[0m13:28:25.673332 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m13:28:25.673695 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (compile): 13:28:25.664829 => 13:28:25.673568
[0m13:28:25.673883 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_part_suppliers
[0m13:28:25.691101 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_part_suppliers"
[0m13:28:25.695704 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m13:28:25.696036 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
order by
    f.part_key,
    f.supplier_key
    )
[0m13:28:25.696295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:26.349244 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231213_122826_00209_scdwh
[0m13:28:26.350254 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 121:16: Column 'ps.supplier_key' cannot be resolved", query_id=20231213_122826_00209_scdwh)
[0m13:28:26.351245 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (execute): 13:28:25.673992 => 13:28:26.350873
[0m13:28:26.351480 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: ROLLBACK
[0m13:28:26.351659 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: Close
[0m13:28:26.353968 [debug] [Thread-1 (]: Database Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 121:16: Column 'ps.supplier_key' cannot be resolved", query_id=20231213_122826_00209_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_part_suppliers.sql
[0m13:28:26.354868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edbc04aa-e221-492c-8ccc-7e5ac0b75b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa0264410>]}
[0m13:28:26.355229 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model dbt_dbt.dim_part_suppliers ............... [[31mERROR[0m in 0.69s]
[0m13:28:26.355634 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_part_suppliers
[0m13:28:26.355926 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_suppliers
[0m13:28:26.356220 [info ] [Thread-1 (]: 2 of 2 START sql table model dbt_dbt.dim_suppliers ............................. [RUN]
[0m13:28:26.356927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.dim_part_suppliers, now model.dbt_trino_demo.dim_suppliers)
[0m13:28:26.357164 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_suppliers
[0m13:28:26.362183 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_suppliers"
[0m13:28:26.362634 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (compile): 13:28:26.357274 => 13:28:26.362493
[0m13:28:26.362833 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_suppliers
[0m13:28:26.367932 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt_dbt"."dim_suppliers"
[0m13:28:26.369272 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m13:28:26.369479 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt_dbt"."dim_suppliers"
[0m13:28:26.369655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:26.912000 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:28:26.915242 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_suppliers"
[0m13:28:26.918686 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m13:28:26.918927 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_suppliers"
      
      
    as (
      
with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m13:28:28.181033 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:28:28.194290 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (execute): 13:28:26.362941 => 13:28:28.194159
[0m13:28:28.194538 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: ROLLBACK
[0m13:28:28.194719 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: Close
[0m13:28:28.195768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edbc04aa-e221-492c-8ccc-7e5ac0b75b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa13605d0>]}
[0m13:28:28.196124 [info ] [Thread-1 (]: 2 of 2 OK created sql table model dbt_dbt.dim_suppliers ........................ [[32mSUCCESS[0m in 1.84s]
[0m13:28:28.196482 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_suppliers
[0m13:28:28.198103 [debug] [MainThread]: On master: COMMIT
[0m13:28:28.198457 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:28:28.198609 [debug] [MainThread]: Connection 'model.dbt_trino_demo.dim_suppliers' was properly closed.
[0m13:28:28.198779 [info ] [MainThread]: 
[0m13:28:28.198979 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.40 seconds (4.40s).
[0m13:28:28.199479 [debug] [MainThread]: Command end result
[0m13:28:28.205037 [info ] [MainThread]: 
[0m13:28:28.205352 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:28:28.205641 [info ] [MainThread]: 
[0m13:28:28.205936 [error] [MainThread]:   Database Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 121:16: Column 'ps.supplier_key' cannot be resolved", query_id=20231213_122826_00209_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_part_suppliers.sql
[0m13:28:28.206174 [info ] [MainThread]: 
[0m13:28:28.206474 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:28:28.207100 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.7133656, "process_user_time": 1.556476, "process_kernel_time": 0.12888, "process_mem_max_rss": "113984", "process_out_blocks": "3536", "command_success": false, "process_in_blocks": "0"}
[0m13:28:28.207401 [debug] [MainThread]: Command `dbt run` failed at 13:28:28.207330 after 4.71 seconds
[0m13:28:28.207611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa5f17510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa5f17450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa029c210>]}
[0m13:28:28.207801 [debug] [MainThread]: Flushing usage events
[0m13:30:20.642972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90c4a23890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90c4a11ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90c4a13d10>]}


============================== 13:30:20.644658 | 5dca0815-6427-457b-942e-a38b58ba9399 ==============================
[0m13:30:20.644658 [info ] [MainThread]: Running with dbt=1.7.3
[0m13:30:20.645017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:30:20.760576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dca0815-6427-457b-942e-a38b58ba9399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90c4860650>]}
[0m13:30:20.812653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dca0815-6427-457b-942e-a38b58ba9399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90c4ea4b50>]}
[0m13:30:20.813066 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m13:30:20.819622 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m13:30:20.834715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:30:20.835154 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/mart/dim_part_suppliers.sql
[0m13:30:20.919735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dca0815-6427-457b-942e-a38b58ba9399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90c4560790>]}
[0m13:30:20.926709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dca0815-6427-457b-942e-a38b58ba9399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90c4478410>]}
[0m13:30:20.927122 [info ] [MainThread]: Found 10 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m13:30:20.927370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dca0815-6427-457b-942e-a38b58ba9399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90c46f0c50>]}
[0m13:30:20.928661 [info ] [MainThread]: 
[0m13:30:20.929189 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:30:20.930040 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m13:30:20.940165 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m13:30:20.940463 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m13:30:20.940655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:30:22.241295 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:30:22.243972 [debug] [ThreadPool]: On list_lakehouse: Close
[0m13:30:22.247698 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt_dbt)
[0m13:30:22.253797 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt_dbt"
[0m13:30:22.254006 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt_dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt_dbt'
[0m13:30:22.254194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:30:23.001235 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:30:23.003392 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: ROLLBACK
[0m13:30:23.003565 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: Close
[0m13:30:23.005055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dca0815-6427-457b-942e-a38b58ba9399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90c4412850>]}
[0m13:30:23.005320 [debug] [MainThread]: On master: COMMIT
[0m13:30:23.005682 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:30:23.005899 [info ] [MainThread]: 
[0m13:30:23.008164 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m13:30:23.008663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt_dbt, now model.dbt_trino_demo.stg_tpch_customers)
[0m13:30:23.008914 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m13:30:23.011166 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m13:30:23.011543 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 13:30:23.009036 => 13:30:23.011411
[0m13:30:23.012034 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m13:30:23.012292 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m13:30:23.012680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m13:30:23.012901 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m13:30:23.014727 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m13:30:23.015204 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 13:30:23.013041 => 13:30:23.015060
[0m13:30:23.015665 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m13:30:23.015972 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m13:30:23.016458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m13:30:23.016671 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m13:30:23.018366 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m13:30:23.018716 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 13:30:23.016796 => 13:30:23.018586
[0m13:30:23.019228 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m13:30:23.019458 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m13:30:23.019823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m13:30:23.020025 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m13:30:23.021962 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m13:30:23.022319 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 13:30:23.020158 => 13:30:23.022186
[0m13:30:23.022844 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m13:30:23.023096 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m13:30:23.023537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m13:30:23.023747 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m13:30:23.025844 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m13:30:23.026503 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 13:30:23.023872 => 13:30:23.026328
[0m13:30:23.027052 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m13:30:23.027302 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:30:23.027671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m13:30:23.027879 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:30:23.036457 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m13:30:23.036841 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 13:30:23.028018 => 13:30:23.036696
[0m13:30:23.037324 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:30:23.037591 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m13:30:23.037986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m13:30:23.038202 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m13:30:23.040149 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m13:30:23.040757 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 13:30:23.038329 => 13:30:23.040574
[0m13:30:23.041401 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m13:30:23.041705 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m13:30:23.042105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m13:30:23.042318 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m13:30:23.045098 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m13:30:23.045743 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 13:30:23.042444 => 13:30:23.045514
[0m13:30:23.046227 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m13:30:23.046995 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_part_suppliers
[0m13:30:23.047281 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_dbt.dim_part_suppliers ........................ [RUN]
[0m13:30:23.047746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_supplier, now model.dbt_trino_demo.dim_part_suppliers)
[0m13:30:23.048011 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_part_suppliers
[0m13:30:23.056869 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m13:30:23.057246 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (compile): 13:30:23.048140 => 13:30:23.057116
[0m13:30:23.057441 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_part_suppliers
[0m13:30:23.074735 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_part_suppliers"
[0m13:30:23.079202 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m13:30:23.079522 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.part_supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
order by
    f.part_key,
    f.supplier_key
    )
[0m13:30:23.079776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:23.511474 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231213_123024_00214_scdwh
[0m13:30:23.512291 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 121:37: Cannot apply operator: varchar = bigint", query_id=20231213_123024_00214_scdwh)
[0m13:30:23.513177 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (execute): 13:30:23.057554 => 13:30:23.512820
[0m13:30:23.513762 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: ROLLBACK
[0m13:30:23.514185 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: Close
[0m13:30:23.517511 [debug] [Thread-1 (]: Database Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 121:37: Cannot apply operator: varchar = bigint", query_id=20231213_123024_00214_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_part_suppliers.sql
[0m13:30:23.518514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dca0815-6427-457b-942e-a38b58ba9399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90c3292890>]}
[0m13:30:23.518896 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model dbt_dbt.dim_part_suppliers ............... [[31mERROR[0m in 0.47s]
[0m13:30:23.519258 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_part_suppliers
[0m13:30:23.519535 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_suppliers
[0m13:30:23.519850 [info ] [Thread-1 (]: 2 of 2 START sql table model dbt_dbt.dim_suppliers ............................. [RUN]
[0m13:30:23.520316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.dim_part_suppliers, now model.dbt_trino_demo.dim_suppliers)
[0m13:30:23.520653 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_suppliers
[0m13:30:23.525478 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_suppliers"
[0m13:30:23.526089 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (compile): 13:30:23.520796 => 13:30:23.525942
[0m13:30:23.526287 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_suppliers
[0m13:30:23.531084 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt_dbt"."dim_suppliers"
[0m13:30:23.532361 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m13:30:23.532569 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt_dbt"."dim_suppliers"
[0m13:30:23.532751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:23.843939 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:30:23.846226 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_suppliers"
[0m13:30:23.849523 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m13:30:23.849758 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_suppliers"
      
      
    as (
      
with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m13:30:24.868034 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:30:24.880232 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (execute): 13:30:23.526397 => 13:30:24.880102
[0m13:30:24.880453 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: ROLLBACK
[0m13:30:24.880632 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: Close
[0m13:30:24.882036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dca0815-6427-457b-942e-a38b58ba9399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90c31b97d0>]}
[0m13:30:24.882414 [info ] [Thread-1 (]: 2 of 2 OK created sql table model dbt_dbt.dim_suppliers ........................ [[32mSUCCESS[0m in 1.36s]
[0m13:30:24.882779 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_suppliers
[0m13:30:24.884199 [debug] [MainThread]: On master: COMMIT
[0m13:30:24.884578 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:30:24.884733 [debug] [MainThread]: Connection 'model.dbt_trino_demo.dim_suppliers' was properly closed.
[0m13:30:24.884907 [info ] [MainThread]: 
[0m13:30:24.885105 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.96 seconds (3.96s).
[0m13:30:24.885656 [debug] [MainThread]: Command end result
[0m13:30:24.891361 [info ] [MainThread]: 
[0m13:30:24.891774 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:30:24.892022 [info ] [MainThread]: 
[0m13:30:24.892283 [error] [MainThread]:   Database Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 121:37: Cannot apply operator: varchar = bigint", query_id=20231213_123024_00214_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_part_suppliers.sql
[0m13:30:24.892516 [info ] [MainThread]: 
[0m13:30:24.892762 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:30:24.893316 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.2745357, "process_user_time": 1.535074, "process_kernel_time": 0.110969, "process_mem_max_rss": "113756", "process_out_blocks": "3536", "command_success": false, "process_in_blocks": "0"}
[0m13:30:24.893623 [debug] [MainThread]: Command `dbt run` failed at 13:30:24.893552 after 4.27 seconds
[0m13:30:24.893834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90c4a23890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90c8f5b510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90c8f5b550>]}
[0m13:30:24.894045 [debug] [MainThread]: Flushing usage events
[0m13:32:05.622779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70544be590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70544be910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f705446f610>]}


============================== 13:32:05.624361 | e832eeff-2622-441a-89b6-121aa2e9942a ==============================
[0m13:32:05.624361 [info ] [MainThread]: Running with dbt=1.7.3
[0m13:32:05.624705 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:32:05.738091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e832eeff-2622-441a-89b6-121aa2e9942a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70544bddd0>]}
[0m13:32:05.788169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e832eeff-2622-441a-89b6-121aa2e9942a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f705437be90>]}
[0m13:32:05.788601 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m13:32:05.795238 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m13:32:05.809559 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:32:05.809809 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:32:05.814299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e832eeff-2622-441a-89b6-121aa2e9942a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70540a1650>]}
[0m13:32:05.821551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e832eeff-2622-441a-89b6-121aa2e9942a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70541cfc50>]}
[0m13:32:05.821885 [info ] [MainThread]: Found 10 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m13:32:05.822130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e832eeff-2622-441a-89b6-121aa2e9942a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f705427ff10>]}
[0m13:32:05.823431 [info ] [MainThread]: 
[0m13:32:05.823965 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:32:05.825166 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m13:32:05.836121 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m13:32:05.836387 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m13:32:05.836550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:06.936900 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:32:06.939433 [debug] [ThreadPool]: On list_lakehouse: Close
[0m13:32:06.942785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt_dbt)
[0m13:32:06.948634 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt_dbt"
[0m13:32:06.948840 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt_dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt_dbt'
[0m13:32:06.949004 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:32:07.619721 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:32:07.622334 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: ROLLBACK
[0m13:32:07.622854 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: Close
[0m13:32:07.624595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e832eeff-2622-441a-89b6-121aa2e9942a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f705508af10>]}
[0m13:32:07.624860 [debug] [MainThread]: On master: COMMIT
[0m13:32:07.625238 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:32:07.625609 [info ] [MainThread]: 
[0m13:32:07.627821 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m13:32:07.628274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt_dbt, now model.dbt_trino_demo.stg_tpch_customers)
[0m13:32:07.628492 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m13:32:07.630551 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m13:32:07.630990 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 13:32:07.628611 => 13:32:07.630788
[0m13:32:07.631520 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m13:32:07.631780 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m13:32:07.632161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m13:32:07.632382 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m13:32:07.634752 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m13:32:07.635126 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 13:32:07.632513 => 13:32:07.634993
[0m13:32:07.635596 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m13:32:07.635854 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m13:32:07.636396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m13:32:07.636598 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m13:32:07.638274 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m13:32:07.638593 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 13:32:07.636704 => 13:32:07.638472
[0m13:32:07.639058 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m13:32:07.639373 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m13:32:07.639731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m13:32:07.639944 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m13:32:07.641997 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m13:32:07.642661 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 13:32:07.640069 => 13:32:07.642507
[0m13:32:07.643194 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m13:32:07.643516 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m13:32:07.643891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m13:32:07.644112 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m13:32:07.645995 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m13:32:07.646353 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 13:32:07.644238 => 13:32:07.646227
[0m13:32:07.646986 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m13:32:07.647227 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:32:07.647600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m13:32:07.647815 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:32:07.656662 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m13:32:07.657216 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 13:32:07.647942 => 13:32:07.657033
[0m13:32:07.657790 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:32:07.658091 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m13:32:07.658494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m13:32:07.658707 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m13:32:07.660590 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m13:32:07.661026 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 13:32:07.658836 => 13:32:07.660828
[0m13:32:07.661634 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m13:32:07.661872 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m13:32:07.662238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m13:32:07.662441 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m13:32:07.664207 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m13:32:07.664739 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 13:32:07.662567 => 13:32:07.664597
[0m13:32:07.665199 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m13:32:07.666037 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_part_suppliers
[0m13:32:07.666299 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_dbt.dim_part_suppliers ........................ [RUN]
[0m13:32:07.666716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_supplier, now model.dbt_trino_demo.dim_part_suppliers)
[0m13:32:07.666915 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_part_suppliers
[0m13:32:07.675569 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m13:32:07.675947 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (compile): 13:32:07.667045 => 13:32:07.675817
[0m13:32:07.676135 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_part_suppliers
[0m13:32:07.694312 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_part_suppliers"
[0m13:32:07.698900 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m13:32:07.699204 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.part_supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
order by
    f.part_key,
    f.supplier_key
    )
[0m13:32:07.699451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:08.153226 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231213_123208_00219_scdwh
[0m13:32:08.153966 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 121:37: Cannot apply operator: varchar = bigint", query_id=20231213_123208_00219_scdwh)
[0m13:32:08.154891 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (execute): 13:32:07.676242 => 13:32:08.154617
[0m13:32:08.155261 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: ROLLBACK
[0m13:32:08.155593 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: Close
[0m13:32:08.158844 [debug] [Thread-1 (]: Database Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 121:37: Cannot apply operator: varchar = bigint", query_id=20231213_123208_00219_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_part_suppliers.sql
[0m13:32:08.159753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832eeff-2622-441a-89b6-121aa2e9942a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7053fd9250>]}
[0m13:32:08.160112 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model dbt_dbt.dim_part_suppliers ............... [[31mERROR[0m in 0.49s]
[0m13:32:08.160502 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_part_suppliers
[0m13:32:08.160779 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_suppliers
[0m13:32:08.161129 [info ] [Thread-1 (]: 2 of 2 START sql table model dbt_dbt.dim_suppliers ............................. [RUN]
[0m13:32:08.161613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.dim_part_suppliers, now model.dbt_trino_demo.dim_suppliers)
[0m13:32:08.161819 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_suppliers
[0m13:32:08.166621 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_suppliers"
[0m13:32:08.167012 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (compile): 13:32:08.161943 => 13:32:08.166879
[0m13:32:08.167238 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_suppliers
[0m13:32:08.172172 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt_dbt"."dim_suppliers"
[0m13:32:08.173563 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m13:32:08.173859 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt_dbt"."dim_suppliers"
[0m13:32:08.174313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:08.678047 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:32:08.680197 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_suppliers"
[0m13:32:08.683200 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m13:32:08.683465 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_suppliers"
      
      
    as (
      
with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m13:32:09.955016 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:32:09.967518 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (execute): 13:32:08.167366 => 13:32:09.967373
[0m13:32:09.967739 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: ROLLBACK
[0m13:32:09.967916 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: Close
[0m13:32:09.968954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832eeff-2622-441a-89b6-121aa2e9942a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7053e235d0>]}
[0m13:32:09.969310 [info ] [Thread-1 (]: 2 of 2 OK created sql table model dbt_dbt.dim_suppliers ........................ [[32mSUCCESS[0m in 1.81s]
[0m13:32:09.969723 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_suppliers
[0m13:32:09.971205 [debug] [MainThread]: On master: COMMIT
[0m13:32:09.971582 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:32:09.971736 [debug] [MainThread]: Connection 'model.dbt_trino_demo.dim_suppliers' was properly closed.
[0m13:32:09.971922 [info ] [MainThread]: 
[0m13:32:09.972124 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.15 seconds (4.15s).
[0m13:32:09.972685 [debug] [MainThread]: Command end result
[0m13:32:09.979105 [info ] [MainThread]: 
[0m13:32:09.979422 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:32:09.979694 [info ] [MainThread]: 
[0m13:32:09.979984 [error] [MainThread]:   Database Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 121:37: Cannot apply operator: varchar = bigint", query_id=20231213_123208_00219_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_part_suppliers.sql
[0m13:32:09.980244 [info ] [MainThread]: 
[0m13:32:09.980485 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:32:09.981200 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.3818817, "process_user_time": 1.474516, "process_kernel_time": 0.112636, "process_mem_max_rss": "111500", "process_out_blocks": "2432", "command_success": false, "process_in_blocks": "0"}
[0m13:32:09.981517 [debug] [MainThread]: Command `dbt run` failed at 13:32:09.981443 after 4.38 seconds
[0m13:32:09.981732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7058a07350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7058a07390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7054051a10>]}
[0m13:32:09.981951 [debug] [MainThread]: Flushing usage events
[0m13:32:31.763197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34ed7f8b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34ecfbe090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34ed586090>]}


============================== 13:32:31.764884 | 3584c3c7-afe3-4c20-a2b5-883ffa5db202 ==============================
[0m13:32:31.764884 [info ] [MainThread]: Running with dbt=1.7.3
[0m13:32:31.765227 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:32:31.884661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3584c3c7-afe3-4c20-a2b5-883ffa5db202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34ecf5e850>]}
[0m13:32:31.936401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3584c3c7-afe3-4c20-a2b5-883ffa5db202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34eda14710>]}
[0m13:32:31.936864 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m13:32:31.943634 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m13:32:31.959285 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:32:31.959763 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/mart/dim_part_suppliers.sql
[0m13:32:32.046450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3584c3c7-afe3-4c20-a2b5-883ffa5db202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34eccd6390>]}
[0m13:32:32.053265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3584c3c7-afe3-4c20-a2b5-883ffa5db202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34ecbe03d0>]}
[0m13:32:32.053617 [info ] [MainThread]: Found 10 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m13:32:32.053857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3584c3c7-afe3-4c20-a2b5-883ffa5db202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34ecf35b10>]}
[0m13:32:32.055097 [info ] [MainThread]: 
[0m13:32:32.055657 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:32:32.056825 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m13:32:32.067198 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m13:32:32.067430 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m13:32:32.067586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:33.296784 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:32:33.299026 [debug] [ThreadPool]: On list_lakehouse: Close
[0m13:32:33.302043 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt_dbt)
[0m13:32:33.307012 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt_dbt"
[0m13:32:33.307250 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt_dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt_dbt'
[0m13:32:33.307454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:32:34.055033 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:32:34.056086 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: ROLLBACK
[0m13:32:34.056290 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: Close
[0m13:32:34.057986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3584c3c7-afe3-4c20-a2b5-883ffa5db202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34ecc1eb50>]}
[0m13:32:34.058314 [debug] [MainThread]: On master: COMMIT
[0m13:32:34.058707 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:32:34.058940 [info ] [MainThread]: 
[0m13:32:34.061171 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m13:32:34.061607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt_dbt, now model.dbt_trino_demo.stg_tpch_customers)
[0m13:32:34.061817 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m13:32:34.063859 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m13:32:34.064233 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 13:32:34.061928 => 13:32:34.064101
[0m13:32:34.064784 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m13:32:34.065086 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m13:32:34.065503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m13:32:34.065747 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m13:32:34.067767 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m13:32:34.068329 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 13:32:34.065907 => 13:32:34.068177
[0m13:32:34.068855 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m13:32:34.069167 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m13:32:34.069572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m13:32:34.069815 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m13:32:34.072352 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m13:32:34.073108 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 13:32:34.070010 => 13:32:34.072943
[0m13:32:34.073605 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m13:32:34.073879 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m13:32:34.074361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m13:32:34.074577 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m13:32:34.076501 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m13:32:34.076899 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 13:32:34.074704 => 13:32:34.076743
[0m13:32:34.077441 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m13:32:34.077691 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m13:32:34.078178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m13:32:34.078396 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m13:32:34.080267 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m13:32:34.080858 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 13:32:34.078532 => 13:32:34.080668
[0m13:32:34.081396 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m13:32:34.081643 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:32:34.082012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m13:32:34.082228 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:32:34.092201 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m13:32:34.092914 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 13:32:34.082373 => 13:32:34.092724
[0m13:32:34.093587 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:32:34.093889 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m13:32:34.094321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m13:32:34.094556 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m13:32:34.096512 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m13:32:34.097184 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 13:32:34.094700 => 13:32:34.096952
[0m13:32:34.097670 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m13:32:34.097928 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m13:32:34.098302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m13:32:34.098521 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m13:32:34.101521 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m13:32:34.102165 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 13:32:34.098654 => 13:32:34.101969
[0m13:32:34.102647 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m13:32:34.103675 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_part_suppliers
[0m13:32:34.103952 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_dbt.dim_part_suppliers ........................ [RUN]
[0m13:32:34.104452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_supplier, now model.dbt_trino_demo.dim_part_suppliers)
[0m13:32:34.104677 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_part_suppliers
[0m13:32:34.113504 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m13:32:34.113933 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (compile): 13:32:34.104784 => 13:32:34.113795
[0m13:32:34.114137 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_part_suppliers
[0m13:32:34.131727 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_part_suppliers"
[0m13:32:34.136821 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m13:32:34.137195 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
order by
    f.part_key,
    f.supplier_key
    )
[0m13:32:34.137460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:34.344673 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231213_123235_00224_scdwh
[0m13:32:34.345012 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 121:16: Column 'ps.supplier_key' cannot be resolved", query_id=20231213_123235_00224_scdwh)
[0m13:32:34.345400 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (execute): 13:32:34.114245 => 13:32:34.345241
[0m13:32:34.345623 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: ROLLBACK
[0m13:32:34.345816 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: Close
[0m13:32:34.348462 [debug] [Thread-1 (]: Database Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 121:16: Column 'ps.supplier_key' cannot be resolved", query_id=20231213_123235_00224_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_part_suppliers.sql
[0m13:32:34.349576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3584c3c7-afe3-4c20-a2b5-883ffa5db202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34e794ce10>]}
[0m13:32:34.350017 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model dbt_dbt.dim_part_suppliers ............... [[31mERROR[0m in 0.25s]
[0m13:32:34.350465 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_part_suppliers
[0m13:32:34.350925 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_suppliers
[0m13:32:34.351305 [info ] [Thread-1 (]: 2 of 2 START sql table model dbt_dbt.dim_suppliers ............................. [RUN]
[0m13:32:34.352076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.dim_part_suppliers, now model.dbt_trino_demo.dim_suppliers)
[0m13:32:34.352314 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_suppliers
[0m13:32:34.358001 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_suppliers"
[0m13:32:34.358514 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (compile): 13:32:34.352447 => 13:32:34.358343
[0m13:32:34.358813 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_suppliers
[0m13:32:34.365020 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt_dbt"."dim_suppliers"
[0m13:32:34.366537 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m13:32:34.366813 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt_dbt"."dim_suppliers"
[0m13:32:34.367018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:34.885795 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:32:34.887126 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_suppliers"
[0m13:32:34.891103 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m13:32:34.891416 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_suppliers"
      
      
    as (
      
with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m13:32:36.096752 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:32:36.108199 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (execute): 13:32:34.358997 => 13:32:36.108060
[0m13:32:36.108460 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: ROLLBACK
[0m13:32:36.108680 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: Close
[0m13:32:36.109914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3584c3c7-afe3-4c20-a2b5-883ffa5db202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34ecc1d310>]}
[0m13:32:36.110281 [info ] [Thread-1 (]: 2 of 2 OK created sql table model dbt_dbt.dim_suppliers ........................ [[32mSUCCESS[0m in 1.76s]
[0m13:32:36.110720 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_suppliers
[0m13:32:36.112211 [debug] [MainThread]: On master: COMMIT
[0m13:32:36.112561 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:32:36.112712 [debug] [MainThread]: Connection 'model.dbt_trino_demo.dim_suppliers' was properly closed.
[0m13:32:36.112903 [info ] [MainThread]: 
[0m13:32:36.113140 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.06 seconds (4.06s).
[0m13:32:36.113678 [debug] [MainThread]: Command end result
[0m13:32:36.119708 [info ] [MainThread]: 
[0m13:32:36.120993 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:32:36.121284 [info ] [MainThread]: 
[0m13:32:36.121543 [error] [MainThread]:   Database Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 121:16: Column 'ps.supplier_key' cannot be resolved", query_id=20231213_123235_00224_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_part_suppliers.sql
[0m13:32:36.121822 [info ] [MainThread]: 
[0m13:32:36.122091 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:32:36.122772 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.3834114, "process_user_time": 1.614333, "process_kernel_time": 0.040107, "process_mem_max_rss": "115764", "process_out_blocks": "3544", "command_success": false, "process_in_blocks": "0"}
[0m13:32:36.123106 [debug] [MainThread]: Command `dbt run` failed at 13:32:36.123037 after 4.38 seconds
[0m13:32:36.123315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34ed16f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34ed16e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34ed16de10>]}
[0m13:32:36.123544 [debug] [MainThread]: Flushing usage events
[0m13:37:40.007057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40525a8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f405441eb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4052c34790>]}


============================== 13:37:40.008901 | fa95f10a-6e6b-4f72-9f0e-83076e63c31c ==============================
[0m13:37:40.008901 [info ] [MainThread]: Running with dbt=1.7.3
[0m13:37:40.009353 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:37:40.122160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa95f10a-6e6b-4f72-9f0e-83076e63c31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40524179d0>]}
[0m13:37:40.173100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa95f10a-6e6b-4f72-9f0e-83076e63c31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4056afa210>]}
[0m13:37:40.173543 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m13:37:40.180816 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m13:37:40.196244 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:37:40.196533 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:37:40.200445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa95f10a-6e6b-4f72-9f0e-83076e63c31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f405242f410>]}
[0m13:37:40.207655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa95f10a-6e6b-4f72-9f0e-83076e63c31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40521175d0>]}
[0m13:37:40.207963 [info ] [MainThread]: Found 10 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m13:37:40.208209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa95f10a-6e6b-4f72-9f0e-83076e63c31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40521f4e90>]}
[0m13:37:40.209670 [info ] [MainThread]: 
[0m13:37:40.210471 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:37:40.211544 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m13:37:40.221748 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m13:37:40.221977 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m13:37:40.222173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:37:41.204051 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:37:41.206602 [debug] [ThreadPool]: On list_lakehouse: Close
[0m13:37:41.208588 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt_dbt)
[0m13:37:41.214402 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt_dbt"
[0m13:37:41.214615 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt_dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt_dbt'
[0m13:37:41.214778 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:37:41.936320 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:37:41.938956 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: ROLLBACK
[0m13:37:41.939608 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: Close
[0m13:37:41.942449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa95f10a-6e6b-4f72-9f0e-83076e63c31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4052331550>]}
[0m13:37:41.942767 [debug] [MainThread]: On master: COMMIT
[0m13:37:41.943224 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:37:41.943472 [info ] [MainThread]: 
[0m13:37:41.946558 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m13:37:41.947047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt_dbt, now model.dbt_trino_demo.stg_tpch_customers)
[0m13:37:41.947293 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m13:37:41.949429 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m13:37:41.949883 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 13:37:41.947443 => 13:37:41.949727
[0m13:37:41.950454 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m13:37:41.950761 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m13:37:41.951252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m13:37:41.951504 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m13:37:41.953880 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m13:37:41.954432 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 13:37:41.951652 => 13:37:41.954287
[0m13:37:41.954927 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m13:37:41.955162 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m13:37:41.955547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m13:37:41.955789 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m13:37:41.957521 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m13:37:41.957887 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 13:37:41.955964 => 13:37:41.957740
[0m13:37:41.958383 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m13:37:41.958612 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m13:37:41.958966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m13:37:41.959167 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m13:37:41.960802 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m13:37:41.961381 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 13:37:41.959289 => 13:37:41.961241
[0m13:37:41.961859 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m13:37:41.962095 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m13:37:41.962504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m13:37:41.962710 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m13:37:41.964487 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m13:37:41.964834 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 13:37:41.962834 => 13:37:41.964707
[0m13:37:41.965328 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m13:37:41.965558 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:37:41.966007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m13:37:41.966217 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:37:41.975342 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m13:37:41.975809 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 13:37:41.966344 => 13:37:41.975652
[0m13:37:41.976365 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:37:41.976622 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m13:37:41.977002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m13:37:41.977214 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m13:37:41.978946 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m13:37:41.979298 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 13:37:41.977344 => 13:37:41.979167
[0m13:37:41.979787 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m13:37:41.980021 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m13:37:41.980367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m13:37:41.980571 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m13:37:41.982666 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m13:37:41.983467 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 13:37:41.980706 => 13:37:41.983294
[0m13:37:41.984084 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m13:37:41.985400 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_part_suppliers
[0m13:37:41.985676 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_dbt.dim_part_suppliers ........................ [RUN]
[0m13:37:41.986108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_supplier, now model.dbt_trino_demo.dim_part_suppliers)
[0m13:37:41.986316 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_part_suppliers
[0m13:37:41.995019 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m13:37:41.995447 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (compile): 13:37:41.986427 => 13:37:41.995303
[0m13:37:41.995647 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_part_suppliers
[0m13:37:42.014760 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_part_suppliers"
[0m13:37:42.019447 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m13:37:42.019770 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
order by
    f.part_key,
    f.supplier_key
    )
[0m13:37:42.020027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:37:42.408030 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231213_123743_00231_scdwh
[0m13:37:42.408922 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 121:16: Column 'ps.supplier_key' cannot be resolved", query_id=20231213_123743_00231_scdwh)
[0m13:37:42.409843 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (execute): 13:37:41.995763 => 13:37:42.409495
[0m13:37:42.410402 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: ROLLBACK
[0m13:37:42.410911 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: Close
[0m13:37:42.413984 [debug] [Thread-1 (]: Database Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 121:16: Column 'ps.supplier_key' cannot be resolved", query_id=20231213_123743_00231_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_part_suppliers.sql
[0m13:37:42.414879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa95f10a-6e6b-4f72-9f0e-83076e63c31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4051e36710>]}
[0m13:37:42.415354 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model dbt_dbt.dim_part_suppliers ............... [[31mERROR[0m in 0.43s]
[0m13:37:42.415751 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_part_suppliers
[0m13:37:42.416027 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_suppliers
[0m13:37:42.416299 [info ] [Thread-1 (]: 2 of 2 START sql table model dbt_dbt.dim_suppliers ............................. [RUN]
[0m13:37:42.416938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.dim_part_suppliers, now model.dbt_trino_demo.dim_suppliers)
[0m13:37:42.417150 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_suppliers
[0m13:37:42.422205 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_suppliers"
[0m13:37:42.422629 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (compile): 13:37:42.417263 => 13:37:42.422492
[0m13:37:42.422825 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_suppliers
[0m13:37:42.427870 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt_dbt"."dim_suppliers"
[0m13:37:42.429211 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m13:37:42.429447 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt_dbt"."dim_suppliers"
[0m13:37:42.429691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:37:42.901057 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:37:42.904090 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_suppliers"
[0m13:37:42.906737 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m13:37:42.906975 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_suppliers"
      
      
    as (
      
with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m13:37:43.914983 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:37:43.926589 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (execute): 13:37:42.422953 => 13:37:43.926458
[0m13:37:43.926853 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: ROLLBACK
[0m13:37:43.927060 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: Close
[0m13:37:43.928183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa95f10a-6e6b-4f72-9f0e-83076e63c31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40520f6710>]}
[0m13:37:43.928677 [info ] [Thread-1 (]: 2 of 2 OK created sql table model dbt_dbt.dim_suppliers ........................ [[32mSUCCESS[0m in 1.51s]
[0m13:37:43.929064 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_suppliers
[0m13:37:43.930455 [debug] [MainThread]: On master: COMMIT
[0m13:37:43.930811 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:37:43.931049 [debug] [MainThread]: Connection 'model.dbt_trino_demo.dim_suppliers' was properly closed.
[0m13:37:43.931299 [info ] [MainThread]: 
[0m13:37:43.931497 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.72 seconds (3.72s).
[0m13:37:43.932003 [debug] [MainThread]: Command end result
[0m13:37:43.938355 [info ] [MainThread]: 
[0m13:37:43.938727 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:37:43.939007 [info ] [MainThread]: 
[0m13:37:43.939227 [error] [MainThread]:   Database Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 121:16: Column 'ps.supplier_key' cannot be resolved", query_id=20231213_123743_00231_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_part_suppliers.sql
[0m13:37:43.939471 [info ] [MainThread]: 
[0m13:37:43.939748 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:37:43.940281 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.9566312, "process_user_time": 1.484487, "process_kernel_time": 0.108862, "process_mem_max_rss": "112052", "process_out_blocks": "2440", "command_success": false, "process_in_blocks": "0"}
[0m13:37:43.940577 [debug] [MainThread]: Command `dbt run` failed at 13:37:43.940509 after 3.96 seconds
[0m13:37:43.940787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40523fa6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4056c67790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4056c67750>]}
[0m13:37:43.941022 [debug] [MainThread]: Flushing usage events
[0m13:40:37.735935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2983f7310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2983f7dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe29994fa50>]}


============================== 13:40:37.737533 | 1388b77e-e8dc-4998-b017-963093f5448d ==============================
[0m13:40:37.737533 [info ] [MainThread]: Running with dbt=1.7.3
[0m13:40:37.737865 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:40:37.850503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1388b77e-e8dc-4998-b017-963093f5448d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe298a40b50>]}
[0m13:40:37.900218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1388b77e-e8dc-4998-b017-963093f5448d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe29834c390>]}
[0m13:40:37.900677 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m13:40:37.907197 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m13:40:37.921839 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:40:37.922094 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:40:37.926119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1388b77e-e8dc-4998-b017-963093f5448d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2982e1810>]}
[0m13:40:37.933094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1388b77e-e8dc-4998-b017-963093f5448d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe29811bd10>]}
[0m13:40:37.933411 [info ] [MainThread]: Found 10 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m13:40:37.933663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1388b77e-e8dc-4998-b017-963093f5448d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2983d7010>]}
[0m13:40:37.934906 [info ] [MainThread]: 
[0m13:40:37.935489 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:40:37.936354 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m13:40:37.947284 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m13:40:37.947571 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m13:40:37.947767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:39.051145 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:40:39.052496 [debug] [ThreadPool]: On list_lakehouse: Close
[0m13:40:39.055168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt_dbt)
[0m13:40:39.060217 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt_dbt"
[0m13:40:39.060455 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt_dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt_dbt'
[0m13:40:39.060654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:39.736644 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:40:39.738133 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: ROLLBACK
[0m13:40:39.738367 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: Close
[0m13:40:39.739984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1388b77e-e8dc-4998-b017-963093f5448d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe29820bd90>]}
[0m13:40:39.740272 [debug] [MainThread]: On master: COMMIT
[0m13:40:39.740685 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:40:39.740925 [info ] [MainThread]: 
[0m13:40:39.743219 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m13:40:39.743639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt_dbt, now model.dbt_trino_demo.stg_tpch_customers)
[0m13:40:39.743842 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m13:40:39.745831 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m13:40:39.746194 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 13:40:39.743962 => 13:40:39.746066
[0m13:40:39.746721 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m13:40:39.747002 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m13:40:39.747372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m13:40:39.747592 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m13:40:39.749908 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m13:40:39.750418 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 13:40:39.747734 => 13:40:39.750271
[0m13:40:39.750922 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m13:40:39.751250 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m13:40:39.751603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m13:40:39.751811 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m13:40:39.753516 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m13:40:39.754075 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 13:40:39.751939 => 13:40:39.753922
[0m13:40:39.754531 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m13:40:39.754762 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m13:40:39.755158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m13:40:39.755363 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m13:40:39.757076 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m13:40:39.757429 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 13:40:39.755488 => 13:40:39.757296
[0m13:40:39.757943 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m13:40:39.758179 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m13:40:39.758528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m13:40:39.758728 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m13:40:39.760486 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m13:40:39.760828 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 13:40:39.758853 => 13:40:39.760699
[0m13:40:39.761370 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m13:40:39.761613 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:40:39.762052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m13:40:39.762257 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:40:39.771132 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m13:40:39.771601 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 13:40:39.762382 => 13:40:39.771424
[0m13:40:39.772171 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:40:39.772433 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m13:40:39.772802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m13:40:39.773013 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m13:40:39.774765 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m13:40:39.775238 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 13:40:39.773145 => 13:40:39.775096
[0m13:40:39.775694 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m13:40:39.775934 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m13:40:39.776368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m13:40:39.776574 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m13:40:39.778407 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m13:40:39.779220 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 13:40:39.776701 => 13:40:39.779053
[0m13:40:39.779825 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m13:40:39.780969 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_part_suppliers
[0m13:40:39.781380 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_dbt.dim_part_suppliers ........................ [RUN]
[0m13:40:39.781818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_supplier, now model.dbt_trino_demo.dim_part_suppliers)
[0m13:40:39.782021 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_part_suppliers
[0m13:40:39.790622 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m13:40:39.791014 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (compile): 13:40:39.782138 => 13:40:39.790866
[0m13:40:39.791263 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_part_suppliers
[0m13:40:39.809781 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_part_suppliers"
[0m13:40:39.814692 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m13:40:39.815021 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
order by
    f.part_key,
    f.supplier_key
    )
[0m13:40:39.815275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:40.175320 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231213_124040_00236_scdwh
[0m13:40:40.175792 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 121:16: Column 'ps.supplier_key' cannot be resolved", query_id=20231213_124040_00236_scdwh)
[0m13:40:40.176334 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (execute): 13:40:39.791403 => 13:40:40.176155
[0m13:40:40.176597 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: ROLLBACK
[0m13:40:40.176806 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: Close
[0m13:40:40.179978 [debug] [Thread-1 (]: Database Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 121:16: Column 'ps.supplier_key' cannot be resolved", query_id=20231213_124040_00236_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_part_suppliers.sql
[0m13:40:40.181201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1388b77e-e8dc-4998-b017-963093f5448d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe297e1a190>]}
[0m13:40:40.181652 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model dbt_dbt.dim_part_suppliers ............... [[31mERROR[0m in 0.40s]
[0m13:40:40.182106 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_part_suppliers
[0m13:40:40.182556 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_suppliers
[0m13:40:40.182875 [info ] [Thread-1 (]: 2 of 2 START sql table model dbt_dbt.dim_suppliers ............................. [RUN]
[0m13:40:40.183612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.dim_part_suppliers, now model.dbt_trino_demo.dim_suppliers)
[0m13:40:40.183827 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_suppliers
[0m13:40:40.188852 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_suppliers"
[0m13:40:40.189239 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (compile): 13:40:40.183945 => 13:40:40.189109
[0m13:40:40.189503 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_suppliers
[0m13:40:40.194523 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt_dbt"."dim_suppliers"
[0m13:40:40.195838 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m13:40:40.196046 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt_dbt"."dim_suppliers"
[0m13:40:40.196224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:40.656213 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:40:40.657824 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_suppliers"
[0m13:40:40.660236 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m13:40:40.660486 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_suppliers"
      
      
    as (
      
with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m13:40:41.658093 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:40:41.670252 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (execute): 13:40:40.189622 => 13:40:41.670119
[0m13:40:41.670481 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: ROLLBACK
[0m13:40:41.670664 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: Close
[0m13:40:41.671846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1388b77e-e8dc-4998-b017-963093f5448d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2981dfa10>]}
[0m13:40:41.672204 [info ] [Thread-1 (]: 2 of 2 OK created sql table model dbt_dbt.dim_suppliers ........................ [[32mSUCCESS[0m in 1.49s]
[0m13:40:41.672590 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_suppliers
[0m13:40:41.673938 [debug] [MainThread]: On master: COMMIT
[0m13:40:41.674288 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:41.674440 [debug] [MainThread]: Connection 'model.dbt_trino_demo.dim_suppliers' was properly closed.
[0m13:40:41.674614 [info ] [MainThread]: 
[0m13:40:41.674816 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.74 seconds (3.74s).
[0m13:40:41.675335 [debug] [MainThread]: Command end result
[0m13:40:41.681845 [info ] [MainThread]: 
[0m13:40:41.682185 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:40:41.682427 [info ] [MainThread]: 
[0m13:40:41.682650 [error] [MainThread]:   Database Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 121:16: Column 'ps.supplier_key' cannot be resolved", query_id=20231213_124040_00236_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_part_suppliers.sql
[0m13:40:41.682876 [info ] [MainThread]: 
[0m13:40:41.683197 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:40:41.683776 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.9709847, "process_user_time": 1.556651, "process_kernel_time": 0.050214, "process_mem_max_rss": "111656", "process_out_blocks": "2440", "command_success": false, "process_in_blocks": "0"}
[0m13:40:41.684075 [debug] [MainThread]: Command `dbt run` failed at 13:40:41.684005 after 3.97 seconds
[0m13:40:41.684283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe29859d7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe29859e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe29820a0d0>]}
[0m13:40:41.684485 [debug] [MainThread]: Flushing usage events
[0m13:41:35.849548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae9cf56890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae9cf54810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae9cf55790>]}


============================== 13:41:35.851326 | 334ee56c-82bf-4a58-8ed3-931be6e35608 ==============================
[0m13:41:35.851326 [info ] [MainThread]: Running with dbt=1.7.3
[0m13:41:35.851667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:41:35.965051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '334ee56c-82bf-4a58-8ed3-931be6e35608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae9cf88050>]}
[0m13:41:36.015586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '334ee56c-82bf-4a58-8ed3-931be6e35608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae9ce3bc10>]}
[0m13:41:36.016001 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m13:41:36.022817 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m13:41:36.037785 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:41:36.038210 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/mart/dim_part_suppliers.sql
[0m13:41:36.122477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '334ee56c-82bf-4a58-8ed3-931be6e35608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae9e08bdd0>]}
[0m13:41:36.129538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '334ee56c-82bf-4a58-8ed3-931be6e35608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae9cb9e5d0>]}
[0m13:41:36.129928 [info ] [MainThread]: Found 10 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m13:41:36.130277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '334ee56c-82bf-4a58-8ed3-931be6e35608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae9ccf0c10>]}
[0m13:41:36.131698 [info ] [MainThread]: 
[0m13:41:36.132224 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:41:36.133366 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m13:41:36.144155 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m13:41:36.144433 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m13:41:36.144621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:37.201302 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:41:37.203119 [debug] [ThreadPool]: On list_lakehouse: Close
[0m13:41:37.205684 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt_dbt)
[0m13:41:37.210782 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt_dbt"
[0m13:41:37.211093 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt_dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt_dbt'
[0m13:41:37.211309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:41:37.850435 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:41:37.853167 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: ROLLBACK
[0m13:41:37.853732 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: Close
[0m13:41:37.856283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '334ee56c-82bf-4a58-8ed3-931be6e35608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae9caa42d0>]}
[0m13:41:37.856597 [debug] [MainThread]: On master: COMMIT
[0m13:41:37.857036 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:41:37.857295 [info ] [MainThread]: 
[0m13:41:37.859818 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m13:41:37.860391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt_dbt, now model.dbt_trino_demo.stg_tpch_customers)
[0m13:41:37.860641 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m13:41:37.863238 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m13:41:37.863823 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 13:41:37.860776 => 13:41:37.863630
[0m13:41:37.864498 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m13:41:37.864793 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m13:41:37.865166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m13:41:37.865408 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m13:41:37.867259 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m13:41:37.867787 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 13:41:37.865543 => 13:41:37.867643
[0m13:41:37.868254 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m13:41:37.868486 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m13:41:37.868833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m13:41:37.869035 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m13:41:37.870836 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m13:41:37.871363 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 13:41:37.869157 => 13:41:37.871211
[0m13:41:37.871864 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m13:41:37.872095 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m13:41:37.872450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m13:41:37.872652 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m13:41:37.874348 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m13:41:37.874722 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 13:41:37.872774 => 13:41:37.874589
[0m13:41:37.875233 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m13:41:37.875471 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m13:41:37.875912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m13:41:37.876121 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m13:41:37.877823 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m13:41:37.878164 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 13:41:37.876261 => 13:41:37.878035
[0m13:41:37.878694 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m13:41:37.878926 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:41:37.879587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m13:41:37.880058 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:41:37.889290 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m13:41:37.889740 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 13:41:37.880277 => 13:41:37.889595
[0m13:41:37.890262 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:41:37.890514 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m13:41:37.891039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m13:41:37.891265 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m13:41:37.893063 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m13:41:37.893416 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 13:41:37.891392 => 13:41:37.893285
[0m13:41:37.894073 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m13:41:37.894319 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m13:41:37.894678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m13:41:37.894969 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m13:41:37.898177 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m13:41:37.898810 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 13:41:37.895168 => 13:41:37.898644
[0m13:41:37.899307 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m13:41:37.900192 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_part_suppliers
[0m13:41:37.900479 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_dbt.dim_part_suppliers ........................ [RUN]
[0m13:41:37.900910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_supplier, now model.dbt_trino_demo.dim_part_suppliers)
[0m13:41:37.901169 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_part_suppliers
[0m13:41:37.909642 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m13:41:37.910088 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (compile): 13:41:37.901272 => 13:41:37.909875
[0m13:41:37.910460 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_part_suppliers
[0m13:41:37.927975 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_part_suppliers"
[0m13:41:37.932610 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m13:41:37.932934 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
    )
[0m13:41:37.933232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:38.279639 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231213_124138_00241_scdwh
[0m13:41:38.280591 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 121:16: Column 'ps.supplier_key' cannot be resolved", query_id=20231213_124138_00241_scdwh)
[0m13:41:38.281664 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (execute): 13:41:37.910625 => 13:41:38.281252
[0m13:41:38.282340 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: ROLLBACK
[0m13:41:38.282707 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: Close
[0m13:41:38.285171 [debug] [Thread-1 (]: Database Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 121:16: Column 'ps.supplier_key' cannot be resolved", query_id=20231213_124138_00241_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_part_suppliers.sql
[0m13:41:38.286080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '334ee56c-82bf-4a58-8ed3-931be6e35608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae9cd50310>]}
[0m13:41:38.286440 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model dbt_dbt.dim_part_suppliers ............... [[31mERROR[0m in 0.39s]
[0m13:41:38.286811 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_part_suppliers
[0m13:41:38.287088 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_suppliers
[0m13:41:38.287344 [info ] [Thread-1 (]: 2 of 2 START sql table model dbt_dbt.dim_suppliers ............................. [RUN]
[0m13:41:38.287967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.dim_part_suppliers, now model.dbt_trino_demo.dim_suppliers)
[0m13:41:38.288174 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_suppliers
[0m13:41:38.293069 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_suppliers"
[0m13:41:38.293441 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (compile): 13:41:38.288284 => 13:41:38.293312
[0m13:41:38.293628 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_suppliers
[0m13:41:38.298898 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt_dbt"."dim_suppliers"
[0m13:41:38.300470 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m13:41:38.300707 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt_dbt"."dim_suppliers"
[0m13:41:38.300891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:38.795245 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:41:38.798106 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_suppliers"
[0m13:41:38.801360 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m13:41:38.801595 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_suppliers"
      
      
    as (
      
with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m13:41:39.791025 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:41:39.803520 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (execute): 13:41:38.293756 => 13:41:39.803387
[0m13:41:39.803767 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: ROLLBACK
[0m13:41:39.803950 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: Close
[0m13:41:39.805091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '334ee56c-82bf-4a58-8ed3-931be6e35608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae9c90b0d0>]}
[0m13:41:39.805477 [info ] [Thread-1 (]: 2 of 2 OK created sql table model dbt_dbt.dim_suppliers ........................ [[32mSUCCESS[0m in 1.52s]
[0m13:41:39.805842 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_suppliers
[0m13:41:39.807356 [debug] [MainThread]: On master: COMMIT
[0m13:41:39.807709 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:41:39.807862 [debug] [MainThread]: Connection 'model.dbt_trino_demo.dim_suppliers' was properly closed.
[0m13:41:39.808035 [info ] [MainThread]: 
[0m13:41:39.808242 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.68 seconds (3.68s).
[0m13:41:39.808723 [debug] [MainThread]: Command end result
[0m13:41:39.814739 [info ] [MainThread]: 
[0m13:41:39.815141 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:41:39.815366 [info ] [MainThread]: 
[0m13:41:39.815588 [error] [MainThread]:   Database Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 121:16: Column 'ps.supplier_key' cannot be resolved", query_id=20231213_124138_00241_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_part_suppliers.sql
[0m13:41:39.815807 [info ] [MainThread]: 
[0m13:41:39.816057 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:41:39.816721 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.9907825, "process_user_time": 1.573264, "process_kernel_time": 0.10085, "process_mem_max_rss": "115880", "process_out_blocks": "3544", "command_success": false, "process_in_blocks": "0"}
[0m13:41:39.817125 [debug] [MainThread]: Command `dbt run` failed at 13:41:39.817043 after 3.99 seconds
[0m13:41:39.817351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae9cf3a250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae9cc25f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faea15b5090>]}
[0m13:41:39.817550 [debug] [MainThread]: Flushing usage events
[0m13:44:50.268652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd8f7fa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd8f7f090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd8f7cb10>]}


============================== 13:44:50.270250 | 86845ceb-bd84-4815-9136-f22fd25a24c0 ==============================
[0m13:44:50.270250 [info ] [MainThread]: Running with dbt=1.7.3
[0m13:44:50.270580 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:44:50.381361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86845ceb-bd84-4815-9136-f22fd25a24c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd8d2e490>]}
[0m13:44:50.430382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86845ceb-bd84-4815-9136-f22fd25a24c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd8cf3bd0>]}
[0m13:44:50.430878 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m13:44:50.437390 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m13:44:50.452165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:44:50.452415 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:44:50.456560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86845ceb-bd84-4815-9136-f22fd25a24c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd8dd8bd0>]}
[0m13:44:50.464208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86845ceb-bd84-4815-9136-f22fd25a24c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd8af3dd0>]}
[0m13:44:50.464600 [info ] [MainThread]: Found 10 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m13:44:50.464844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86845ceb-bd84-4815-9136-f22fd25a24c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd8c92210>]}
[0m13:44:50.466101 [info ] [MainThread]: 
[0m13:44:50.466645 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:44:50.467509 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m13:44:50.477663 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m13:44:50.478002 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m13:44:50.478219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:51.608821 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:44:51.610927 [debug] [ThreadPool]: On list_lakehouse: Close
[0m13:44:51.613813 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt_dbt)
[0m13:44:51.619366 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt_dbt"
[0m13:44:51.619568 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt_dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt_dbt'
[0m13:44:51.619737 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:52.382738 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:44:52.385473 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: ROLLBACK
[0m13:44:52.385808 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: Close
[0m13:44:52.387385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86845ceb-bd84-4815-9136-f22fd25a24c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd8d69250>]}
[0m13:44:52.387649 [debug] [MainThread]: On master: COMMIT
[0m13:44:52.388014 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:44:52.388281 [info ] [MainThread]: 
[0m13:44:52.390496 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m13:44:52.391007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt_dbt, now model.dbt_trino_demo.stg_tpch_customers)
[0m13:44:52.391258 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m13:44:52.393579 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m13:44:52.393945 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 13:44:52.391394 => 13:44:52.393816
[0m13:44:52.394461 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m13:44:52.394724 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m13:44:52.395095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m13:44:52.395312 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m13:44:52.397583 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m13:44:52.397983 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 13:44:52.395446 => 13:44:52.397809
[0m13:44:52.398451 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m13:44:52.398678 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m13:44:52.399116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m13:44:52.399658 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m13:44:52.401784 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m13:44:52.402217 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 13:44:52.399800 => 13:44:52.402074
[0m13:44:52.402715 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m13:44:52.403004 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m13:44:52.403376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m13:44:52.403583 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m13:44:52.405421 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m13:44:52.405895 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 13:44:52.403710 => 13:44:52.405754
[0m13:44:52.406355 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m13:44:52.406590 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m13:44:52.406987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m13:44:52.407191 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m13:44:52.408919 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m13:44:52.409396 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 13:44:52.407313 => 13:44:52.409216
[0m13:44:52.409862 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m13:44:52.410088 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:44:52.410486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m13:44:52.410688 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:44:52.419811 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m13:44:52.420304 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 13:44:52.410809 => 13:44:52.420123
[0m13:44:52.420881 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:44:52.421180 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m13:44:52.421569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m13:44:52.421783 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m13:44:52.423610 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m13:44:52.423965 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 13:44:52.421914 => 13:44:52.423832
[0m13:44:52.424487 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m13:44:52.424722 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m13:44:52.425082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m13:44:52.425283 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m13:44:52.427089 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m13:44:52.427432 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 13:44:52.425407 => 13:44:52.427303
[0m13:44:52.427930 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m13:44:52.428673 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_part_suppliers
[0m13:44:52.429177 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_dbt.dim_part_suppliers ........................ [RUN]
[0m13:44:52.430054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_supplier, now model.dbt_trino_demo.dim_part_suppliers)
[0m13:44:52.430304 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_part_suppliers
[0m13:44:52.439040 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m13:44:52.439401 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (compile): 13:44:52.430453 => 13:44:52.439273
[0m13:44:52.439595 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_part_suppliers
[0m13:44:52.457792 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_part_suppliers"
[0m13:44:52.462428 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m13:44:52.462819 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
    )
[0m13:44:52.463091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:52.848989 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231213_124453_00246_scdwh
[0m13:44:52.849836 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 121:16: Column 'ps.supplier_key' cannot be resolved", query_id=20231213_124453_00246_scdwh)
[0m13:44:52.851100 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (execute): 13:44:52.439709 => 13:44:52.850421
[0m13:44:52.851657 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: ROLLBACK
[0m13:44:52.852012 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: Close
[0m13:44:52.855340 [debug] [Thread-1 (]: Database Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 121:16: Column 'ps.supplier_key' cannot be resolved", query_id=20231213_124453_00246_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_part_suppliers.sql
[0m13:44:52.856255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86845ceb-bd84-4815-9136-f22fd25a24c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd8806650>]}
[0m13:44:52.856615 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model dbt_dbt.dim_part_suppliers ............... [[31mERROR[0m in 0.43s]
[0m13:44:52.856968 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_part_suppliers
[0m13:44:52.857255 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_suppliers
[0m13:44:52.857519 [info ] [Thread-1 (]: 2 of 2 START sql table model dbt_dbt.dim_suppliers ............................. [RUN]
[0m13:44:52.858001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.dim_part_suppliers, now model.dbt_trino_demo.dim_suppliers)
[0m13:44:52.858207 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_suppliers
[0m13:44:52.863019 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_suppliers"
[0m13:44:52.863738 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (compile): 13:44:52.858330 => 13:44:52.863587
[0m13:44:52.863964 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_suppliers
[0m13:44:52.868955 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt_dbt"."dim_suppliers"
[0m13:44:52.870260 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m13:44:52.870474 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt_dbt"."dim_suppliers"
[0m13:44:52.870654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:53.369246 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:44:53.373308 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_suppliers"
[0m13:44:53.376999 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m13:44:53.377233 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_suppliers"
      
      
    as (
      
with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m13:44:54.327971 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:44:54.342131 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (execute): 13:44:52.864100 => 13:44:54.342004
[0m13:44:54.342354 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: ROLLBACK
[0m13:44:54.342533 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: Close
[0m13:44:54.343576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86845ceb-bd84-4815-9136-f22fd25a24c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd8b054d0>]}
[0m13:44:54.343978 [info ] [Thread-1 (]: 2 of 2 OK created sql table model dbt_dbt.dim_suppliers ........................ [[32mSUCCESS[0m in 1.49s]
[0m13:44:54.344353 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_suppliers
[0m13:44:54.345986 [debug] [MainThread]: On master: COMMIT
[0m13:44:54.346333 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:44:54.346484 [debug] [MainThread]: Connection 'model.dbt_trino_demo.dim_suppliers' was properly closed.
[0m13:44:54.346656 [info ] [MainThread]: 
[0m13:44:54.346860 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.88 seconds (3.88s).
[0m13:44:54.347356 [debug] [MainThread]: Command end result
[0m13:44:54.353717 [info ] [MainThread]: 
[0m13:44:54.354066 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:44:54.354331 [info ] [MainThread]: 
[0m13:44:54.354541 [error] [MainThread]:   Database Error in model dim_part_suppliers (models/mart/dim_part_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 121:16: Column 'ps.supplier_key' cannot be resolved", query_id=20231213_124453_00246_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/dim_part_suppliers.sql
[0m13:44:54.354783 [info ] [MainThread]: 
[0m13:44:54.355068 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:44:54.355637 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.11067, "process_user_time": 1.528757, "process_kernel_time": 0.079935, "process_mem_max_rss": "111476", "process_out_blocks": "2440", "command_success": false, "process_in_blocks": "0"}
[0m13:44:54.355937 [debug] [MainThread]: Command `dbt run` failed at 13:44:54.355867 after 4.11 seconds
[0m13:44:54.356141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd8f7e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd8f86fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ddd66fbd0>]}
[0m13:44:54.356334 [debug] [MainThread]: Flushing usage events
[0m13:46:12.745921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5243326b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5243978750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5243326690>]}


============================== 13:46:12.747579 | dd55d5fa-6bd1-40ce-aba8-b6ab8f5be63f ==============================
[0m13:46:12.747579 [info ] [MainThread]: Running with dbt=1.7.3
[0m13:46:12.747936 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:46:12.863004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd55d5fa-6bd1-40ce-aba8-b6ab8f5be63f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52432c4350>]}
[0m13:46:12.916847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd55d5fa-6bd1-40ce-aba8-b6ab8f5be63f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5243249f50>]}
[0m13:46:12.917362 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m13:46:12.924192 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m13:46:12.939577 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:46:12.940050 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/staging/stg_tpch_part_suppliers.sql
[0m13:46:13.032395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd55d5fa-6bd1-40ce-aba8-b6ab8f5be63f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52432bbe50>]}
[0m13:46:13.039460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd55d5fa-6bd1-40ce-aba8-b6ab8f5be63f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5242f48450>]}
[0m13:46:13.039853 [info ] [MainThread]: Found 10 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m13:46:13.040158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd55d5fa-6bd1-40ce-aba8-b6ab8f5be63f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5243139050>]}
[0m13:46:13.041644 [info ] [MainThread]: 
[0m13:46:13.042173 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:46:13.043172 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m13:46:13.053422 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m13:46:13.053628 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m13:46:13.053787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:14.261459 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:46:14.263866 [debug] [ThreadPool]: On list_lakehouse: Close
[0m13:46:14.266202 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt_dbt)
[0m13:46:14.271416 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt_dbt"
[0m13:46:14.271660 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt_dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt_dbt'
[0m13:46:14.271878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:46:15.037838 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:46:15.040150 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: ROLLBACK
[0m13:46:15.040517 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: Close
[0m13:46:15.042107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd55d5fa-6bd1-40ce-aba8-b6ab8f5be63f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5243330b90>]}
[0m13:46:15.042375 [debug] [MainThread]: On master: COMMIT
[0m13:46:15.042744 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:46:15.042959 [info ] [MainThread]: 
[0m13:46:15.045192 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m13:46:15.045614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt_dbt, now model.dbt_trino_demo.stg_tpch_customers)
[0m13:46:15.045837 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m13:46:15.047833 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m13:46:15.048293 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 13:46:15.045950 => 13:46:15.048134
[0m13:46:15.048948 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m13:46:15.049249 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m13:46:15.049671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m13:46:15.049916 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m13:46:15.051824 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m13:46:15.052196 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 13:46:15.050065 => 13:46:15.052061
[0m13:46:15.052671 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m13:46:15.052919 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m13:46:15.053267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m13:46:15.053470 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m13:46:15.055173 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m13:46:15.055512 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 13:46:15.053592 => 13:46:15.055389
[0m13:46:15.056012 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m13:46:15.056241 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m13:46:15.056585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m13:46:15.056798 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m13:46:15.058564 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m13:46:15.058932 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 13:46:15.056999 => 13:46:15.058785
[0m13:46:15.059429 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m13:46:15.059662 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m13:46:15.060898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m13:46:15.061269 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m13:46:15.063193 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m13:46:15.063619 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 13:46:15.061420 => 13:46:15.063476
[0m13:46:15.064179 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m13:46:15.064433 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:46:15.064801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m13:46:15.065006 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:46:15.068511 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m13:46:15.068881 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 13:46:15.065131 => 13:46:15.068746
[0m13:46:15.069506 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:46:15.069757 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m13:46:15.070112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m13:46:15.070333 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m13:46:15.072098 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m13:46:15.072473 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 13:46:15.070468 => 13:46:15.072333
[0m13:46:15.072979 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m13:46:15.073218 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m13:46:15.073585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m13:46:15.073827 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m13:46:15.075620 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m13:46:15.076587 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 13:46:15.073954 => 13:46:15.076426
[0m13:46:15.077189 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m13:46:15.078371 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_part_suppliers
[0m13:46:15.078653 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_dbt.dim_part_suppliers ........................ [RUN]
[0m13:46:15.079077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_supplier, now model.dbt_trino_demo.dim_part_suppliers)
[0m13:46:15.079313 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_part_suppliers
[0m13:46:15.087720 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m13:46:15.088120 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (compile): 13:46:15.079425 => 13:46:15.087990
[0m13:46:15.088314 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_part_suppliers
[0m13:46:15.105540 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_part_suppliers"
[0m13:46:15.110563 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m13:46:15.110931 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
    )
[0m13:46:15.111206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:29.545125 [debug] [Thread-1 (]: SQL status: SUCCESS in 14.0 seconds
[0m13:46:29.554567 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (execute): 13:46:15.088421 => 13:46:29.554435
[0m13:46:29.554803 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: ROLLBACK
[0m13:46:29.555000 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: Close
[0m13:46:29.556132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd55d5fa-6bd1-40ce-aba8-b6ab8f5be63f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5242f24f90>]}
[0m13:46:29.556481 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_dbt.dim_part_suppliers ................... [[32mSUCCESS[0m in 14.48s]
[0m13:46:29.556858 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_part_suppliers
[0m13:46:29.557179 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_suppliers
[0m13:46:29.557442 [info ] [Thread-1 (]: 2 of 2 START sql table model dbt_dbt.dim_suppliers ............................. [RUN]
[0m13:46:29.558048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.dim_part_suppliers, now model.dbt_trino_demo.dim_suppliers)
[0m13:46:29.558262 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_suppliers
[0m13:46:29.562981 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_suppliers"
[0m13:46:29.563339 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (compile): 13:46:29.558383 => 13:46:29.563214
[0m13:46:29.563527 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_suppliers
[0m13:46:29.569378 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt_dbt"."dim_suppliers"
[0m13:46:29.570632 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m13:46:29.570855 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt_dbt"."dim_suppliers"
[0m13:46:29.571059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:30.409215 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:46:30.412315 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_suppliers"
[0m13:46:30.415255 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m13:46:30.415488 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_suppliers"
      
      
    as (
      
with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m13:46:31.443799 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:46:31.449223 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (execute): 13:46:29.563636 => 13:46:31.449104
[0m13:46:31.449435 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: ROLLBACK
[0m13:46:31.449612 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: Close
[0m13:46:31.450604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd55d5fa-6bd1-40ce-aba8-b6ab8f5be63f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5242deff90>]}
[0m13:46:31.450977 [info ] [Thread-1 (]: 2 of 2 OK created sql table model dbt_dbt.dim_suppliers ........................ [[32mSUCCESS[0m in 1.89s]
[0m13:46:31.451386 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_suppliers
[0m13:46:31.452788 [debug] [MainThread]: On master: COMMIT
[0m13:46:31.453194 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:46:31.453354 [debug] [MainThread]: Connection 'model.dbt_trino_demo.dim_suppliers' was properly closed.
[0m13:46:31.453529 [info ] [MainThread]: 
[0m13:46:31.453730 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 18.41 seconds (18.41s).
[0m13:46:31.454267 [debug] [MainThread]: Command end result
[0m13:46:31.459722 [info ] [MainThread]: 
[0m13:46:31.460075 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:46:31.460375 [info ] [MainThread]: 
[0m13:46:31.460648 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:46:31.461351 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.738794, "process_user_time": 1.662135, "process_kernel_time": 0.117327, "process_mem_max_rss": "113224", "process_out_blocks": "3552", "process_in_blocks": "0"}
[0m13:46:31.461706 [debug] [MainThread]: Command `dbt run` succeeded at 13:46:31.461634 after 18.74 seconds
[0m13:46:31.461902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5243327f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5247b04fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5247a17350>]}
[0m13:46:31.462099 [debug] [MainThread]: Flushing usage events
[0m13:55:21.038376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe80449f690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8050058d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8042e72d0>]}


============================== 13:55:21.040005 | 8f1d6667-2f4d-475b-ab3a-61e4964165fc ==============================
[0m13:55:21.040005 [info ] [MainThread]: Running with dbt=1.7.3
[0m13:55:21.040336 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:55:21.155458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f1d6667-2f4d-475b-ab3a-61e4964165fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8042b6f50>]}
[0m13:55:21.205058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f1d6667-2f4d-475b-ab3a-61e4964165fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe804113cd0>]}
[0m13:55:21.205497 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m13:55:21.212294 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m13:55:21.227720 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m13:55:21.228097 [debug] [MainThread]: Partial parsing: added file: dbt_trino_demo://models/mart/fct_orders_items.sql
[0m13:55:21.228293 [debug] [MainThread]: Partial parsing: added file: dbt_trino_demo://models/staging/stg_tpch_order_items.sql
[0m13:55:21.312464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f1d6667-2f4d-475b-ab3a-61e4964165fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8041b1b90>]}
[0m13:55:21.319615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f1d6667-2f4d-475b-ab3a-61e4964165fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe803f22810>]}
[0m13:55:21.319957 [info ] [MainThread]: Found 12 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m13:55:21.320184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f1d6667-2f4d-475b-ab3a-61e4964165fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe80414ced0>]}
[0m13:55:21.321527 [info ] [MainThread]: 
[0m13:55:21.322060 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:55:21.322933 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m13:55:21.333359 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m13:55:21.333696 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m13:55:21.333887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:22.403878 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:55:22.406011 [debug] [ThreadPool]: On list_lakehouse: Close
[0m13:55:22.409019 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt_dbt)
[0m13:55:22.414653 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt_dbt"
[0m13:55:22.414866 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt_dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt_dbt'
[0m13:55:22.415029 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:22.714802 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m13:55:22.717484 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: ROLLBACK
[0m13:55:22.717826 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: Close
[0m13:55:22.719601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f1d6667-2f4d-475b-ab3a-61e4964165fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe803ffcc50>]}
[0m13:55:22.719906 [debug] [MainThread]: On master: COMMIT
[0m13:55:22.720272 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:55:22.720506 [info ] [MainThread]: 
[0m13:55:22.723126 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m13:55:22.723598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt_dbt, now model.dbt_trino_demo.stg_tpch_customers)
[0m13:55:22.723838 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m13:55:22.726090 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m13:55:22.726474 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 13:55:22.723975 => 13:55:22.726339
[0m13:55:22.726973 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m13:55:22.727245 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m13:55:22.727630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m13:55:22.727851 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m13:55:22.729661 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m13:55:22.730168 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 13:55:22.727985 => 13:55:22.730010
[0m13:55:22.730649 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m13:55:22.730883 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m13:55:22.731270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m13:55:22.731508 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m13:55:22.733762 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m13:55:22.734501 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 13:55:22.731646 => 13:55:22.734344
[0m13:55:22.735078 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m13:55:22.735361 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m13:55:22.735727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m13:55:22.735935 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m13:55:22.737783 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m13:55:22.738147 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 13:55:22.736058 => 13:55:22.738014
[0m13:55:22.738835 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m13:55:22.739082 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m13:55:22.739464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m13:55:22.739671 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m13:55:22.741531 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m13:55:22.741880 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 13:55:22.739796 => 13:55:22.741754
[0m13:55:22.743060 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m13:55:22.743300 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:55:22.743660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m13:55:22.743865 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:55:22.753050 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m13:55:22.753525 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 13:55:22.743994 => 13:55:22.753366
[0m13:55:22.754072 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m13:55:22.754410 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m13:55:22.754781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m13:55:22.755001 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m13:55:22.757633 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m13:55:22.758003 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 13:55:22.755131 => 13:55:22.757870
[0m13:55:22.758503 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m13:55:22.758754 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m13:55:22.759120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m13:55:22.759327 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m13:55:22.761102 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m13:55:22.761612 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 13:55:22.759451 => 13:55:22.761472
[0m13:55:22.762106 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m13:55:22.762927 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_part_suppliers
[0m13:55:22.763188 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_dbt.dim_part_suppliers ........................ [RUN]
[0m13:55:22.763607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_supplier, now model.dbt_trino_demo.dim_part_suppliers)
[0m13:55:22.763817 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_part_suppliers
[0m13:55:22.772110 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m13:55:22.772467 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (compile): 13:55:22.763985 => 13:55:22.772341
[0m13:55:22.772658 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_part_suppliers
[0m13:55:22.786910 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt_dbt"."dim_part_suppliers"
[0m13:55:22.788239 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m13:55:22.788497 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

    drop table if exists "lakehouse"."dbt_dbt"."dim_part_suppliers"
[0m13:55:22.788704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:23.289688 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:55:23.298004 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_part_suppliers"
[0m13:55:23.302461 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m13:55:23.302737 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
    )
[0m13:55:31.336957 [debug] [Thread-1 (]: SQL status: SUCCESS in 8.0 seconds
[0m13:55:31.351214 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (execute): 13:55:22.772765 => 13:55:31.351074
[0m13:55:31.351450 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: ROLLBACK
[0m13:55:31.351661 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: Close
[0m13:55:31.352675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f1d6667-2f4d-475b-ab3a-61e4964165fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe802d6b590>]}
[0m13:55:31.353042 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_dbt.dim_part_suppliers ................... [[32mSUCCESS[0m in 8.59s]
[0m13:55:31.353410 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_part_suppliers
[0m13:55:31.353697 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_suppliers
[0m13:55:31.353953 [info ] [Thread-1 (]: 2 of 2 START sql table model dbt_dbt.dim_suppliers ............................. [RUN]
[0m13:55:31.354533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.dim_part_suppliers, now model.dbt_trino_demo.dim_suppliers)
[0m13:55:31.354754 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_suppliers
[0m13:55:31.359296 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_suppliers"
[0m13:55:31.359654 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (compile): 13:55:31.354868 => 13:55:31.359529
[0m13:55:31.359839 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_suppliers
[0m13:55:31.363325 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt_dbt"."dim_suppliers"
[0m13:55:31.363788 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m13:55:31.363979 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt_dbt"."dim_suppliers"
[0m13:55:31.364150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:32.202604 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:55:32.205892 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_suppliers"
[0m13:55:32.209364 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m13:55:32.209716 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_suppliers"
      
      
    as (
      
with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m13:55:33.004219 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:55:33.008611 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (execute): 13:55:31.359945 => 13:55:33.008250
[0m13:55:33.008995 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: ROLLBACK
[0m13:55:33.009292 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: Close
[0m13:55:33.010897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f1d6667-2f4d-475b-ab3a-61e4964165fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe802bd7990>]}
[0m13:55:33.011357 [info ] [Thread-1 (]: 2 of 2 OK created sql table model dbt_dbt.dim_suppliers ........................ [[32mSUCCESS[0m in 1.66s]
[0m13:55:33.011706 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_suppliers
[0m13:55:33.013144 [debug] [MainThread]: On master: COMMIT
[0m13:55:33.013525 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:33.013681 [debug] [MainThread]: Connection 'model.dbt_trino_demo.dim_suppliers' was properly closed.
[0m13:55:33.013853 [info ] [MainThread]: 
[0m13:55:33.014061 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 11.69 seconds (11.69s).
[0m13:55:33.014604 [debug] [MainThread]: Command end result
[0m13:55:33.020336 [info ] [MainThread]: 
[0m13:55:33.020707 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:55:33.021040 [info ] [MainThread]: 
[0m13:55:33.021311 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:55:33.021941 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.0073185, "process_user_time": 1.645204, "process_kernel_time": 0.102825, "process_mem_max_rss": "113096", "process_out_blocks": "3568", "process_in_blocks": "0"}
[0m13:55:33.022226 [debug] [MainThread]: Command `dbt run` succeeded at 13:55:33.022160 after 12.01 seconds
[0m13:55:33.022416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe808accfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8089df390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8089df350>]}
[0m13:55:33.022608 [debug] [MainThread]: Flushing usage events
[0m13:57:16.606805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b51227690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b516cc990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b512276d0>]}


============================== 13:57:16.608425 | 9c0767bd-a955-457f-b571-9b907f0c429f ==============================
[0m13:57:16.608425 [info ] [MainThread]: Running with dbt=1.7.3
[0m13:57:16.608759 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:57:16.720304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c0767bd-a955-457f-b571-9b907f0c429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b5129f250>]}
[0m13:57:16.769983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c0767bd-a955-457f-b571-9b907f0c429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b5118bd10>]}
[0m13:57:16.770413 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m13:57:16.777159 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m13:57:16.792265 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:57:16.792654 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/mart/fct_orders_items.sql
[0m13:57:16.792889 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/staging/stg_tpch_order_items.sql
[0m13:57:16.861038 [error] [MainThread]: Encountered an error:
Compilation Error in model fct_orders_items (models/mart/fct_orders_items.sql)
  expected token 'end of print statement', got 'orders'
    line 5
      orders o
[0m13:57:16.861835 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.27819353, "process_user_time": 1.241452, "process_kernel_time": 0.099316, "process_mem_max_rss": "105108", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m13:57:16.862172 [debug] [MainThread]: Command `dbt run` failed at 13:57:16.862096 after 0.28 seconds
[0m13:57:16.862392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b5121e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b50f6d110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b557b3350>]}
[0m13:57:16.862606 [debug] [MainThread]: Flushing usage events
[0m13:58:29.832934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb573cfd3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb573d2e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb573cfcf90>]}


============================== 13:58:29.834501 | 89509329-5bce-4459-968c-f50e3fe3d687 ==============================
[0m13:58:29.834501 [info ] [MainThread]: Running with dbt=1.7.3
[0m13:58:29.834836 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:58:29.948417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89509329-5bce-4459-968c-f50e3fe3d687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb573a5a250>]}
[0m13:58:29.999022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89509329-5bce-4459-968c-f50e3fe3d687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb573a5a250>]}
[0m13:58:29.999451 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m13:58:30.006335 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m13:58:30.021356 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:58:30.021807 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/staging/stg_tpch_order_items.sql
[0m13:58:30.022035 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/mart/fct_orders_items.sql
[0m13:58:30.093845 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_tpch_order_items (models/staging/stg_tpch_order_items.sql)
  macro 'dbt_macro__default__surrogate_key' takes not more than 1 argument(s)
  
  > in macro surrogate_key (macros/sql/surrogate_key.sql)
  > called by model stg_tpch_order_items (models/staging/stg_tpch_order_items.sql)
[0m13:58:30.094463 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.2848155, "process_user_time": 1.272336, "process_kernel_time": 0.030055, "process_mem_max_rss": "105220", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m13:58:30.094819 [debug] [MainThread]: Command `dbt run` failed at 13:58:30.094746 after 0.29 seconds
[0m13:58:30.095030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb573cfd3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb573cefe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb573d2ea50>]}
[0m13:58:30.095247 [debug] [MainThread]: Flushing usage events
[0m14:05:51.782464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26ff36a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26ee0eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26ee0c610>]}


============================== 14:05:51.784157 | 43362544-ccdb-478d-a73c-a9d7f934a34c ==============================
[0m14:05:51.784157 [info ] [MainThread]: Running with dbt=1.7.3
[0m14:05:51.784499 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:51.897960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43362544-ccdb-478d-a73c-a9d7f934a34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26ebbda10>]}
[0m14:05:51.947954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43362544-ccdb-478d-a73c-a9d7f934a34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26ecf7c50>]}
[0m14:05:51.948387 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m14:05:51.954978 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m14:05:51.970437 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:05:51.970897 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/mart/fct_orders_items.sql
[0m14:05:51.971267 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/staging/stg_tpch_order_items.sql
[0m14:05:52.065454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43362544-ccdb-478d-a73c-a9d7f934a34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26e791910>]}
[0m14:05:52.073248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43362544-ccdb-478d-a73c-a9d7f934a34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26eae4650>]}
[0m14:05:52.073585 [info ] [MainThread]: Found 12 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m14:05:52.073912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43362544-ccdb-478d-a73c-a9d7f934a34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26e88dc10>]}
[0m14:05:52.075173 [info ] [MainThread]: 
[0m14:05:52.075684 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:05:52.076561 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m14:05:52.086912 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m14:05:52.087178 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m14:05:52.087366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:53.096359 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:05:53.099150 [debug] [ThreadPool]: On list_lakehouse: Close
[0m14:05:53.101294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt_dbt)
[0m14:05:53.106447 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt_dbt"
[0m14:05:53.106676 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt_dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt_dbt'
[0m14:05:53.106877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:53.828418 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:05:53.830823 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: ROLLBACK
[0m14:05:53.831327 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: Close
[0m14:05:53.833697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43362544-ccdb-478d-a73c-a9d7f934a34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26ea3cd50>]}
[0m14:05:53.834052 [debug] [MainThread]: On master: COMMIT
[0m14:05:53.834554 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:05:53.834819 [info ] [MainThread]: 
[0m14:05:53.837556 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m14:05:53.838007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt_dbt, now model.dbt_trino_demo.stg_tpch_customers)
[0m14:05:53.838233 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m14:05:53.840310 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m14:05:53.840805 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 14:05:53.838358 => 14:05:53.840649
[0m14:05:53.841378 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m14:05:53.841637 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m14:05:53.842019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m14:05:53.842241 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m14:05:53.844091 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m14:05:53.844621 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 14:05:53.842383 => 14:05:53.844476
[0m14:05:53.845095 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m14:05:53.845328 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m14:05:53.845677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m14:05:53.845890 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m14:05:53.847601 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m14:05:53.847956 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 14:05:53.846030 => 14:05:53.847819
[0m14:05:53.848448 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m14:05:53.848676 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m14:05:53.849023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m14:05:53.849225 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m14:05:53.850961 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m14:05:53.851583 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 14:05:53.849347 => 14:05:53.851441
[0m14:05:53.852043 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m14:05:53.852290 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m14:05:53.852700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m14:05:53.852904 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m14:05:53.854575 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m14:05:53.854916 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 14:05:53.853027 => 14:05:53.854787
[0m14:05:53.855416 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m14:05:53.855644 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:05:53.855987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m14:05:53.856188 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:05:53.860575 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m14:05:53.861206 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 14:05:53.856682 => 14:05:53.860930
[0m14:05:53.861922 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:05:53.862256 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m14:05:53.862824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m14:05:53.863032 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m14:05:53.864813 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m14:05:53.865151 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 14:05:53.863158 => 14:05:53.865030
[0m14:05:53.865791 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m14:05:53.866043 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m14:05:53.866406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m14:05:53.866618 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m14:05:53.868339 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m14:05:53.868704 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 14:05:53.866746 => 14:05:53.868571
[0m14:05:53.869196 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m14:05:53.869434 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_order_items
[0m14:05:53.869705 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_dbt.stg_tpch_order_items ...................... [RUN]
[0m14:05:53.870141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_supplier, now model.dbt_trino_demo.stg_tpch_order_items)
[0m14:05:53.870373 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_order_items
[0m14:05:53.882050 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_order_items"
[0m14:05:53.882599 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_order_items (compile): 14:05:53.870507 => 14:05:53.882433
[0m14:05:53.882817 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.stg_tpch_order_items
[0m14:05:53.899889 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.stg_tpch_order_items"
[0m14:05:53.904631 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.stg_tpch_order_items"
[0m14:05:53.904943 [debug] [Thread-1 (]: On model.dbt_trino_demo.stg_tpch_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.stg_tpch_order_items"} */

  
    

    create table "lakehouse"."dbt_dbt"."stg_tpch_order_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_orders as (

select
    orderkey as order_key, 
    custkey as customer_key,
    orderstatus as order_status_code,
    totalprice as order_amount,
    orderdate as order_date,
    orderpriority as order_priority_code,
    clerk as order_clerk_name,
    shippriority as shipping_priority,
    comment as order_comment
from
    tpch.sf1.orders
),  __dbt__cte__stg_tpch_line_item as (

select
    orderkey as order_key,
    partkey as part_key,
    suppkey as supplier_key,
    linenumber as order_line_number,
    quantity as quantity,
    extendedprice as extended_price,
    discount as discount_percentage,
    tax as tax_rate,
    returnflag as return_status_code,
    linestatus as order_line_status_code,
    shipdate as ship_date,
    commitdate as commit_date,
    receiptdate as receipt_date,
    shipinstruct as ship_instructions_desc,
    shipmode as ship_mode_name,
    comment as order_line_comment
from
    tpch.sf1.lineitem
), orders as (
    
    select * from __dbt__cte__stg_tpch_orders

),
line_items as (

    select * from __dbt__cte__stg_tpch_line_item

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(o.order_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l.order_line_number as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as order_item_key,

    o.order_key,
    o.order_date,
    o.customer_key,
    o.order_status_code,
    
    l.part_key,
    l.supplier_key,
    l.return_status_code,
    l.order_line_number,
    l.order_line_status_code,
    l.ship_date,
    l.commit_date,
    l.receipt_date,
    l.ship_mode_name,

    l.quantity,
    
    -- extended_price is actually the line item total,
    -- so we back out the extended price per item
    (l.extended_price/nullif(l.quantity, 0)) as base_price,
    l.discount_percentage,
    (base_price * (1 - l.discount_percentage)) as discounted_price,

    l.extended_price as gross_item_sales_amount,
    (l.extended_price * (1 - l.discount_percentage)) as discounted_item_sales_amount,
    -- We model discounts as negative amounts
    (-1 * l.extended_price * l.discount_percentage) as item_discount_amount,
    l.tax_rate,
    ((gross_item_sales_amount + item_discount_amount) * l.tax_rate) as item_tax_amount,
    (
        gross_item_sales_amount + 
        item_discount_amount + 
        item_tax_amount
    ) as net_item_sales_amount

from
    orders o
    join
    line_items l
        on o.order_key = l.order_key
order by
    o.order_date
    )
[0m14:05:53.905187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:54.295116 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231213_130555_00262_scdwh
[0m14:05:54.296041 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 80:6: Column 'base_price' cannot be resolved", query_id=20231213_130555_00262_scdwh)
[0m14:05:54.297161 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_order_items (execute): 14:05:53.882929 => 14:05:54.296712
[0m14:05:54.297734 [debug] [Thread-1 (]: On model.dbt_trino_demo.stg_tpch_order_items: ROLLBACK
[0m14:05:54.297903 [debug] [Thread-1 (]: On model.dbt_trino_demo.stg_tpch_order_items: Close
[0m14:05:54.300145 [debug] [Thread-1 (]: Database Error in model stg_tpch_order_items (models/staging/stg_tpch_order_items.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 80:6: Column 'base_price' cannot be resolved", query_id=20231213_130555_00262_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/staging/stg_tpch_order_items.sql
[0m14:05:54.301190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43362544-ccdb-478d-a73c-a9d7f934a34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26eb3c890>]}
[0m14:05:54.301552 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model dbt_dbt.stg_tpch_order_items ............. [[31mERROR[0m in 0.43s]
[0m14:05:54.301914 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_order_items
[0m14:05:54.302231 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_part_suppliers
[0m14:05:54.302530 [info ] [Thread-1 (]: 2 of 4 START sql table model dbt_dbt.dim_part_suppliers ........................ [RUN]
[0m14:05:54.302986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_order_items, now model.dbt_trino_demo.dim_part_suppliers)
[0m14:05:54.303242 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_part_suppliers
[0m14:05:54.311909 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m14:05:54.312564 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (compile): 14:05:54.303372 => 14:05:54.312388
[0m14:05:54.312805 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_part_suppliers
[0m14:05:54.318633 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt_dbt"."dim_part_suppliers"
[0m14:05:54.319964 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m14:05:54.320174 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

    drop table if exists "lakehouse"."dbt_dbt"."dim_part_suppliers"
[0m14:05:54.320352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:54.772265 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:05:54.774223 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_part_suppliers"
[0m14:05:54.778637 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m14:05:54.778908 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
    )
[0m14:06:02.344885 [debug] [Thread-1 (]: SQL status: SUCCESS in 8.0 seconds
[0m14:06:02.357202 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (execute): 14:05:54.312941 => 14:06:02.357062
[0m14:06:02.357441 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: ROLLBACK
[0m14:06:02.357628 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: Close
[0m14:06:02.358634 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43362544-ccdb-478d-a73c-a9d7f934a34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26ea7c610>]}
[0m14:06:02.358976 [info ] [Thread-1 (]: 2 of 4 OK created sql table model dbt_dbt.dim_part_suppliers ................... [[32mSUCCESS[0m in 8.06s]
[0m14:06:02.359340 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_part_suppliers
[0m14:06:02.359625 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_suppliers
[0m14:06:02.359915 [info ] [Thread-1 (]: 3 of 4 START sql table model dbt_dbt.dim_suppliers ............................. [RUN]
[0m14:06:02.360430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.dim_part_suppliers, now model.dbt_trino_demo.dim_suppliers)
[0m14:06:02.360623 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_suppliers
[0m14:06:02.365351 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_suppliers"
[0m14:06:02.365774 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (compile): 14:06:02.360730 => 14:06:02.365646
[0m14:06:02.365980 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_suppliers
[0m14:06:02.368674 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt_dbt"."dim_suppliers"
[0m14:06:02.369173 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m14:06:02.369364 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt_dbt"."dim_suppliers"
[0m14:06:02.369531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:03.224422 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:06:03.227074 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_suppliers"
[0m14:06:03.230222 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m14:06:03.230487 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_suppliers"
      
      
    as (
      
with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m14:06:04.091187 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:06:04.094286 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (execute): 14:06:02.366118 => 14:06:04.094169
[0m14:06:04.094484 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: ROLLBACK
[0m14:06:04.094658 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: Close
[0m14:06:04.095648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43362544-ccdb-478d-a73c-a9d7f934a34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26e7e2890>]}
[0m14:06:04.096017 [info ] [Thread-1 (]: 3 of 4 OK created sql table model dbt_dbt.dim_suppliers ........................ [[32mSUCCESS[0m in 1.74s]
[0m14:06:04.096385 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_suppliers
[0m14:06:04.096706 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.fct_orders_items
[0m14:06:04.096948 [info ] [Thread-1 (]: 4 of 4 SKIP relation dbt_dbt.fct_orders_items .................................. [[33mSKIP[0m]
[0m14:06:04.097355 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.fct_orders_items
[0m14:06:04.098741 [debug] [MainThread]: On master: COMMIT
[0m14:06:04.099093 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:04.099248 [debug] [MainThread]: Connection 'model.dbt_trino_demo.dim_suppliers' was properly closed.
[0m14:06:04.099425 [info ] [MainThread]: 
[0m14:06:04.099675 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 12.02 seconds (12.02s).
[0m14:06:04.100340 [debug] [MainThread]: Command end result
[0m14:06:04.143223 [info ] [MainThread]: 
[0m14:06:04.143627 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:06:04.143859 [info ] [MainThread]: 
[0m14:06:04.144148 [error] [MainThread]:   Database Error in model stg_tpch_order_items (models/staging/stg_tpch_order_items.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 80:6: Column 'base_price' cannot be resolved", query_id=20231213_130555_00262_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/staging/stg_tpch_order_items.sql
[0m14:06:04.144389 [info ] [MainThread]: 
[0m14:06:04.144645 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m14:06:04.145218 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.386258, "process_user_time": 1.737601, "process_kernel_time": 0.107986, "process_mem_max_rss": "114324", "process_out_blocks": "3632", "command_success": false, "process_in_blocks": "0"}
[0m14:06:04.145528 [debug] [MainThread]: Command `dbt run` failed at 14:06:04.145454 after 12.39 seconds
[0m14:06:04.145742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2734ff790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2734ff710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26ed37750>]}
[0m14:06:04.145941 [debug] [MainThread]: Flushing usage events
[0m14:13:40.550474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbeea56910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbeea57350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbeea55a50>]}


============================== 14:13:40.552184 | d31c930c-2a1f-48bf-b4cb-d41acfcccf65 ==============================
[0m14:13:40.552184 [info ] [MainThread]: Running with dbt=1.7.3
[0m14:13:40.552524 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:13:40.667248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd31c930c-2a1f-48bf-b4cb-d41acfcccf65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbee6bb090>]}
[0m14:13:40.717495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd31c930c-2a1f-48bf-b4cb-d41acfcccf65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbeedd9990>]}
[0m14:13:40.717921 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m14:13:40.724574 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m14:13:40.740262 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:13:40.740691 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/staging/stg_tpch_order_items.sql
[0m14:13:40.832450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd31c930c-2a1f-48bf-b4cb-d41acfcccf65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbee84c510>]}
[0m14:13:40.839773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd31c930c-2a1f-48bf-b4cb-d41acfcccf65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbee4ac250>]}
[0m14:13:40.840096 [info ] [MainThread]: Found 12 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m14:13:40.840350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd31c930c-2a1f-48bf-b4cb-d41acfcccf65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbee810cd0>]}
[0m14:13:40.842006 [info ] [MainThread]: 
[0m14:13:40.842856 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:13:40.844086 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m14:13:40.854198 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m14:13:40.854419 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m14:13:40.854612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:41.942538 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:13:41.944823 [debug] [ThreadPool]: On list_lakehouse: Close
[0m14:13:41.946938 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt_dbt)
[0m14:13:41.951904 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt_dbt"
[0m14:13:41.952136 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt_dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt_dbt'
[0m14:13:41.952330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:13:42.707306 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:13:42.709829 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: ROLLBACK
[0m14:13:42.710284 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: Close
[0m14:13:42.712776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd31c930c-2a1f-48bf-b4cb-d41acfcccf65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbee7722d0>]}
[0m14:13:42.713165 [debug] [MainThread]: On master: COMMIT
[0m14:13:42.713565 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:13:42.713817 [info ] [MainThread]: 
[0m14:13:42.716099 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m14:13:42.716663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt_dbt, now model.dbt_trino_demo.stg_tpch_customers)
[0m14:13:42.716888 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m14:13:42.718945 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m14:13:42.719384 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 14:13:42.717013 => 14:13:42.719224
[0m14:13:42.719976 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m14:13:42.720278 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m14:13:42.720771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m14:13:42.721044 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m14:13:42.722848 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m14:13:42.723208 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 14:13:42.721181 => 14:13:42.723071
[0m14:13:42.723875 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m14:13:42.724120 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m14:13:42.724471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m14:13:42.724679 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m14:13:42.726333 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m14:13:42.726696 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 14:13:42.724803 => 14:13:42.726559
[0m14:13:42.727179 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m14:13:42.727410 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m14:13:42.727767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m14:13:42.727969 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m14:13:42.729634 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m14:13:42.730336 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 14:13:42.728090 => 14:13:42.730118
[0m14:13:42.730928 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m14:13:42.731262 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m14:13:42.731642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m14:13:42.731880 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m14:13:42.733762 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m14:13:42.734151 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 14:13:42.732053 => 14:13:42.734011
[0m14:13:42.735104 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m14:13:42.735377 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:13:42.735759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m14:13:42.735984 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:13:42.739511 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m14:13:42.740064 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 14:13:42.736126 => 14:13:42.739912
[0m14:13:42.740534 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:13:42.740771 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m14:13:42.741211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m14:13:42.741416 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m14:13:42.743172 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m14:13:42.743729 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 14:13:42.741541 => 14:13:42.743576
[0m14:13:42.744190 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m14:13:42.744425 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m14:13:42.744775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m14:13:42.744979 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m14:13:42.747634 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m14:13:42.748123 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 14:13:42.745270 => 14:13:42.747971
[0m14:13:42.748669 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m14:13:42.748930 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_order_items
[0m14:13:42.749251 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_dbt.stg_tpch_order_items ...................... [RUN]
[0m14:13:42.749720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_supplier, now model.dbt_trino_demo.stg_tpch_order_items)
[0m14:13:42.750001 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_order_items
[0m14:13:42.761673 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_order_items"
[0m14:13:42.762186 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_order_items (compile): 14:13:42.750165 => 14:13:42.762004
[0m14:13:42.762461 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.stg_tpch_order_items
[0m14:13:42.779558 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.stg_tpch_order_items"
[0m14:13:42.783687 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.stg_tpch_order_items"
[0m14:13:42.784000 [debug] [Thread-1 (]: On model.dbt_trino_demo.stg_tpch_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.stg_tpch_order_items"} */

  
    

    create table "lakehouse"."dbt_dbt"."stg_tpch_order_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_orders as (

select
    orderkey as order_key, 
    custkey as customer_key,
    orderstatus as order_status_code,
    totalprice as order_amount,
    orderdate as order_date,
    orderpriority as order_priority_code,
    clerk as order_clerk_name,
    shippriority as shipping_priority,
    comment as order_comment
from
    tpch.sf1.orders
),  __dbt__cte__stg_tpch_line_item as (

select
    orderkey as order_key,
    partkey as part_key,
    suppkey as supplier_key,
    linenumber as order_line_number,
    quantity as quantity,
    extendedprice as extended_price,
    discount as discount_percentage,
    tax as tax_rate,
    returnflag as return_status_code,
    linestatus as order_line_status_code,
    shipdate as ship_date,
    commitdate as commit_date,
    receiptdate as receipt_date,
    shipinstruct as ship_instructions_desc,
    shipmode as ship_mode_name,
    comment as order_line_comment
from
    tpch.sf1.lineitem
), orders as (
    
    select * from __dbt__cte__stg_tpch_orders

),
line_items as (

    select * from __dbt__cte__stg_tpch_line_item

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(o.order_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l.order_line_number as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as order_item_key,

    o.order_key,
    o.order_date,
    o.customer_key,
    o.order_status_code,
    
    l.part_key,
    l.supplier_key,
    l.return_status_code,
    l.order_line_number,
    l.order_line_status_code,
    l.ship_date,
    l.commit_date,
    l.receipt_date,
    l.ship_mode_name,

    l.quantity,
    
    -- extended_price is actually the line item total,
    -- so we back out the extended price per item
    (l.extended_price/nullif(l.quantity, 0)) as base_price,
    l.discount_percentage,
    ((l.extended_price/nullif(l.quantity, 0)) * (1 - l.discount_percentage)) as discounted_price,

    l.extended_price as gross_item_sales_amount,
    (l.extended_price * (1 - l.discount_percentage)) as discounted_item_sales_amount,
    -- We model discounts as negative amounts
    (-1 * l.extended_price * l.discount_percentage) as item_discount_amount,
    l.tax_rate,
    ((gross_item_sales_amount + item_discount_amount) * l.tax_rate) as item_tax_amount,
    (
        gross_item_sales_amount + 
        item_discount_amount + 
        item_tax_amount
    ) as net_item_sales_amount

from
    orders o
    join
    line_items l
        on o.order_key = l.order_key
order by
    o.order_date
    )
[0m14:13:42.784249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:43.171250 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231213_131343_00269_scdwh
[0m14:13:43.172155 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 87:7: Column 'gross_item_sales_amount' cannot be resolved", query_id=20231213_131343_00269_scdwh)
[0m14:13:43.173083 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_order_items (execute): 14:13:42.762586 => 14:13:43.172752
[0m14:13:43.173619 [debug] [Thread-1 (]: On model.dbt_trino_demo.stg_tpch_order_items: ROLLBACK
[0m14:13:43.174104 [debug] [Thread-1 (]: On model.dbt_trino_demo.stg_tpch_order_items: Close
[0m14:13:43.177478 [debug] [Thread-1 (]: Database Error in model stg_tpch_order_items (models/staging/stg_tpch_order_items.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 87:7: Column 'gross_item_sales_amount' cannot be resolved", query_id=20231213_131343_00269_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/staging/stg_tpch_order_items.sql
[0m14:13:43.178425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd31c930c-2a1f-48bf-b4cb-d41acfcccf65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbee796d90>]}
[0m14:13:43.178798 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model dbt_dbt.stg_tpch_order_items ............. [[31mERROR[0m in 0.43s]
[0m14:13:43.179159 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_order_items
[0m14:13:43.179672 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_part_suppliers
[0m14:13:43.180044 [info ] [Thread-1 (]: 2 of 4 START sql table model dbt_dbt.dim_part_suppliers ........................ [RUN]
[0m14:13:43.180883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_order_items, now model.dbt_trino_demo.dim_part_suppliers)
[0m14:13:43.181178 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_part_suppliers
[0m14:13:43.189490 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m14:13:43.189911 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (compile): 14:13:43.181293 => 14:13:43.189777
[0m14:13:43.190104 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_part_suppliers
[0m14:13:43.196522 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt_dbt"."dim_part_suppliers"
[0m14:13:43.198060 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m14:13:43.198300 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

    drop table if exists "lakehouse"."dbt_dbt"."dim_part_suppliers"
[0m14:13:43.198480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:43.647169 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:13:43.648325 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_part_suppliers"
[0m14:13:43.652959 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m14:13:43.653265 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
    )
[0m14:13:53.012865 [debug] [Thread-1 (]: SQL status: SUCCESS in 9.0 seconds
[0m14:13:53.025348 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (execute): 14:13:43.190214 => 14:13:53.025210
[0m14:13:53.025600 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: ROLLBACK
[0m14:13:53.025778 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: Close
[0m14:13:53.027130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd31c930c-2a1f-48bf-b4cb-d41acfcccf65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbee5cde10>]}
[0m14:13:53.027519 [info ] [Thread-1 (]: 2 of 4 OK created sql table model dbt_dbt.dim_part_suppliers ................... [[32mSUCCESS[0m in 9.85s]
[0m14:13:53.027890 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_part_suppliers
[0m14:13:53.028168 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_suppliers
[0m14:13:53.028465 [info ] [Thread-1 (]: 3 of 4 START sql table model dbt_dbt.dim_suppliers ............................. [RUN]
[0m14:13:53.029077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.dim_part_suppliers, now model.dbt_trino_demo.dim_suppliers)
[0m14:13:53.029289 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_suppliers
[0m14:13:53.034005 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_suppliers"
[0m14:13:53.034370 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (compile): 14:13:53.029403 => 14:13:53.034244
[0m14:13:53.034560 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_suppliers
[0m14:13:53.037193 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt_dbt"."dim_suppliers"
[0m14:13:53.037661 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m14:13:53.037852 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt_dbt"."dim_suppliers"
[0m14:13:53.038021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:53.897697 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:13:53.900829 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_suppliers"
[0m14:13:53.903686 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m14:13:53.904158 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_suppliers"
      
      
    as (
      
with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m14:13:54.711409 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:13:54.715417 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (execute): 14:13:53.034667 => 14:13:54.715298
[0m14:13:54.715619 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: ROLLBACK
[0m14:13:54.715791 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: Close
[0m14:13:54.716788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd31c930c-2a1f-48bf-b4cb-d41acfcccf65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbee4ee350>]}
[0m14:13:54.717149 [info ] [Thread-1 (]: 3 of 4 OK created sql table model dbt_dbt.dim_suppliers ........................ [[32mSUCCESS[0m in 1.69s]
[0m14:13:54.717536 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_suppliers
[0m14:13:54.717809 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.fct_orders_items
[0m14:13:54.718077 [info ] [Thread-1 (]: 4 of 4 SKIP relation dbt_dbt.fct_orders_items .................................. [[33mSKIP[0m]
[0m14:13:54.718634 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.fct_orders_items
[0m14:13:54.720733 [debug] [MainThread]: On master: COMMIT
[0m14:13:54.721188 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:13:54.721366 [debug] [MainThread]: Connection 'model.dbt_trino_demo.dim_suppliers' was properly closed.
[0m14:13:54.721544 [info ] [MainThread]: 
[0m14:13:54.721739 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 13.88 seconds (13.88s).
[0m14:13:54.722318 [debug] [MainThread]: Command end result
[0m14:13:54.766018 [info ] [MainThread]: 
[0m14:13:54.766385 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:13:54.766646 [info ] [MainThread]: 
[0m14:13:54.766941 [error] [MainThread]:   Database Error in model stg_tpch_order_items (models/staging/stg_tpch_order_items.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 87:7: Column 'gross_item_sales_amount' cannot be resolved", query_id=20231213_131343_00269_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/staging/stg_tpch_order_items.sql
[0m14:13:54.767147 [info ] [MainThread]: 
[0m14:13:54.767389 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m14:13:54.767984 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 14.241889, "process_user_time": 1.748339, "process_kernel_time": 0.102843, "process_mem_max_rss": "113324", "process_out_blocks": "3632", "command_success": false, "process_in_blocks": "0"}
[0m14:13:54.768292 [debug] [MainThread]: Command `dbt run` failed at 14:13:54.768221 after 14.24 seconds
[0m14:13:54.768506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbef0d4a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf308d290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbee5c3fd0>]}
[0m14:13:54.768703 [debug] [MainThread]: Flushing usage events
[0m14:18:32.958950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be39a2e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be39e7950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be39e77d0>]}


============================== 14:18:32.960635 | fe499811-9bdd-4608-bd37-bcde13dfe129 ==============================
[0m14:18:32.960635 [info ] [MainThread]: Running with dbt=1.7.3
[0m14:18:32.961007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:18:33.073792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe499811-9bdd-4608-bd37-bcde13dfe129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be37880d0>]}
[0m14:18:33.124099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe499811-9bdd-4608-bd37-bcde13dfe129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be377fe50>]}
[0m14:18:33.124496 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m14:18:33.130994 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m14:18:33.146424 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:18:33.146836 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/staging/stg_tpch_order_items.sql
[0m14:18:33.239772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe499811-9bdd-4608-bd37-bcde13dfe129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be324b890>]}
[0m14:18:33.247708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe499811-9bdd-4608-bd37-bcde13dfe129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be3618390>]}
[0m14:18:33.248028 [info ] [MainThread]: Found 12 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m14:18:33.248308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe499811-9bdd-4608-bd37-bcde13dfe129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be381d110>]}
[0m14:18:33.249640 [info ] [MainThread]: 
[0m14:18:33.250165 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:18:33.251192 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m14:18:33.260989 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m14:18:33.261288 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m14:18:33.261513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:34.474969 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:18:34.477519 [debug] [ThreadPool]: On list_lakehouse: Close
[0m14:18:34.479728 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt_dbt)
[0m14:18:34.484552 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt_dbt"
[0m14:18:34.484780 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt_dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt_dbt'
[0m14:18:34.484981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:35.157125 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:18:35.159446 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: ROLLBACK
[0m14:18:35.159832 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: Close
[0m14:18:35.162415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe499811-9bdd-4608-bd37-bcde13dfe129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be39e64d0>]}
[0m14:18:35.162790 [debug] [MainThread]: On master: COMMIT
[0m14:18:35.163270 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:18:35.163499 [info ] [MainThread]: 
[0m14:18:35.165726 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m14:18:35.166284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt_dbt, now model.dbt_trino_demo.stg_tpch_customers)
[0m14:18:35.166494 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m14:18:35.168394 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m14:18:35.168773 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 14:18:35.166608 => 14:18:35.168634
[0m14:18:35.169271 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m14:18:35.169530 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m14:18:35.169903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m14:18:35.170123 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m14:18:35.172004 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m14:18:35.172499 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 14:18:35.170260 => 14:18:35.172351
[0m14:18:35.172961 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m14:18:35.173211 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m14:18:35.173648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m14:18:35.173854 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m14:18:35.175499 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m14:18:35.175978 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 14:18:35.173978 => 14:18:35.175835
[0m14:18:35.176436 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m14:18:35.176690 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m14:18:35.177046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m14:18:35.177247 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m14:18:35.179519 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m14:18:35.180368 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 14:18:35.177371 => 14:18:35.180138
[0m14:18:35.180971 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m14:18:35.181279 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m14:18:35.181668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m14:18:35.181877 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m14:18:35.183691 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m14:18:35.184367 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 14:18:35.182005 => 14:18:35.184211
[0m14:18:35.184856 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m14:18:35.185130 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:18:35.185511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m14:18:35.185732 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:18:35.189248 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m14:18:35.189861 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 14:18:35.185872 => 14:18:35.189698
[0m14:18:35.190389 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:18:35.190621 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m14:18:35.191014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m14:18:35.191275 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m14:18:35.192996 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m14:18:35.193336 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 14:18:35.191410 => 14:18:35.193213
[0m14:18:35.193831 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m14:18:35.194066 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m14:18:35.194414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m14:18:35.194625 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m14:18:35.196800 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m14:18:35.197622 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 14:18:35.194842 => 14:18:35.197355
[0m14:18:35.198172 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m14:18:35.198425 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_order_items
[0m14:18:35.198704 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_dbt.stg_tpch_order_items ...................... [RUN]
[0m14:18:35.199481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_supplier, now model.dbt_trino_demo.stg_tpch_order_items)
[0m14:18:35.199721 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_order_items
[0m14:18:35.210513 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_order_items"
[0m14:18:35.211164 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_order_items (compile): 14:18:35.199856 => 14:18:35.210902
[0m14:18:35.211455 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.stg_tpch_order_items
[0m14:18:35.228826 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.stg_tpch_order_items"
[0m14:18:35.233079 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.stg_tpch_order_items"
[0m14:18:35.233394 [debug] [Thread-1 (]: On model.dbt_trino_demo.stg_tpch_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.stg_tpch_order_items"} */

  
    

    create table "lakehouse"."dbt_dbt"."stg_tpch_order_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_orders as (

select
    orderkey as order_key, 
    custkey as customer_key,
    orderstatus as order_status_code,
    totalprice as order_amount,
    orderdate as order_date,
    orderpriority as order_priority_code,
    clerk as order_clerk_name,
    shippriority as shipping_priority,
    comment as order_comment
from
    tpch.sf1.orders
),  __dbt__cte__stg_tpch_line_item as (

select
    orderkey as order_key,
    partkey as part_key,
    suppkey as supplier_key,
    linenumber as order_line_number,
    quantity as quantity,
    extendedprice as extended_price,
    discount as discount_percentage,
    tax as tax_rate,
    returnflag as return_status_code,
    linestatus as order_line_status_code,
    shipdate as ship_date,
    commitdate as commit_date,
    receiptdate as receipt_date,
    shipinstruct as ship_instructions_desc,
    shipmode as ship_mode_name,
    comment as order_line_comment
from
    tpch.sf1.lineitem
), orders as (
    
    select * from __dbt__cte__stg_tpch_orders

),
line_items as (

    select * from __dbt__cte__stg_tpch_line_item

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(o.order_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l.order_line_number as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as order_item_key,

    o.order_key,
    o.order_date,
    o.customer_key,
    o.order_status_code,
    
    l.part_key,
    l.supplier_key,
    l.return_status_code,
    l.order_line_number,
    l.order_line_status_code,
    l.ship_date,
    l.commit_date,
    l.receipt_date,
    l.ship_mode_name,

    l.quantity,
    
    -- extended_price is actually the line item total,
    -- so we back out the extended price per item
    (l.extended_price/nullif(l.quantity, 0)) as base_price,
    l.discount_percentage,
    ((l.extended_price/nullif(l.quantity, 0)) * (1 - l.discount_percentage)) as discounted_price,

    l.extended_price as gross_item_sales_amount,
    (l.extended_price * (1 - l.discount_percentage)) as discounted_item_sales_amount,
    -- We model discounts as negative amounts
    (-1 * l.extended_price * l.discount_percentage) as item_discount_amount,
    l.tax_rate,
    ((l.extended_price + item_discount_amount) * l.tax_rate) as item_tax_amount,
    (
        l.extended_price + 
        item_discount_amount + 
        item_tax_amount
    ) as net_item_sales_amount

from
    orders o
    join
    line_items l
        on o.order_key = l.order_key
order by
    o.order_date
    )
[0m14:18:35.233656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:35.619801 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231213_131836_00276_scdwh
[0m14:18:35.620804 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 87:26: Column 'item_discount_amount' cannot be resolved", query_id=20231213_131836_00276_scdwh)
[0m14:18:35.621731 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_order_items (execute): 14:18:35.211636 => 14:18:35.621501
[0m14:18:35.621935 [debug] [Thread-1 (]: On model.dbt_trino_demo.stg_tpch_order_items: ROLLBACK
[0m14:18:35.622109 [debug] [Thread-1 (]: On model.dbt_trino_demo.stg_tpch_order_items: Close
[0m14:18:35.624417 [debug] [Thread-1 (]: Database Error in model stg_tpch_order_items (models/staging/stg_tpch_order_items.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 87:26: Column 'item_discount_amount' cannot be resolved", query_id=20231213_131836_00276_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/staging/stg_tpch_order_items.sql
[0m14:18:35.625305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe499811-9bdd-4608-bd37-bcde13dfe129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be339b450>]}
[0m14:18:35.625669 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model dbt_dbt.stg_tpch_order_items ............. [[31mERROR[0m in 0.43s]
[0m14:18:35.626042 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_order_items
[0m14:18:35.626383 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_part_suppliers
[0m14:18:35.626647 [info ] [Thread-1 (]: 2 of 4 START sql table model dbt_dbt.dim_part_suppliers ........................ [RUN]
[0m14:18:35.627129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_order_items, now model.dbt_trino_demo.dim_part_suppliers)
[0m14:18:35.627369 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_part_suppliers
[0m14:18:35.635930 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m14:18:35.636528 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (compile): 14:18:35.627497 => 14:18:35.636365
[0m14:18:35.636735 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_part_suppliers
[0m14:18:35.642795 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt_dbt"."dim_part_suppliers"
[0m14:18:35.644018 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m14:18:35.644253 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

    drop table if exists "lakehouse"."dbt_dbt"."dim_part_suppliers"
[0m14:18:35.644443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:36.112289 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:18:36.115428 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_part_suppliers"
[0m14:18:36.119902 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m14:18:36.120216 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
    )
[0m14:18:43.737817 [debug] [Thread-1 (]: SQL status: SUCCESS in 8.0 seconds
[0m14:18:43.751462 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (execute): 14:18:35.636844 => 14:18:43.751335
[0m14:18:43.751694 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: ROLLBACK
[0m14:18:43.751902 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: Close
[0m14:18:43.752959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe499811-9bdd-4608-bd37-bcde13dfe129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be38abdd0>]}
[0m14:18:43.753301 [info ] [Thread-1 (]: 2 of 4 OK created sql table model dbt_dbt.dim_part_suppliers ................... [[32mSUCCESS[0m in 8.13s]
[0m14:18:43.753672 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_part_suppliers
[0m14:18:43.753982 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_suppliers
[0m14:18:43.754260 [info ] [Thread-1 (]: 3 of 4 START sql table model dbt_dbt.dim_suppliers ............................. [RUN]
[0m14:18:43.754879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.dim_part_suppliers, now model.dbt_trino_demo.dim_suppliers)
[0m14:18:43.755093 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_suppliers
[0m14:18:43.759730 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_suppliers"
[0m14:18:43.760241 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (compile): 14:18:43.755207 => 14:18:43.759970
[0m14:18:43.760508 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_suppliers
[0m14:18:43.765564 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt_dbt"."dim_suppliers"
[0m14:18:43.766099 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m14:18:43.766344 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt_dbt"."dim_suppliers"
[0m14:18:43.766528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:44.620214 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:18:44.623762 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_suppliers"
[0m14:18:44.627234 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m14:18:44.627466 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_suppliers"
      
      
    as (
      
with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m14:18:45.473623 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:18:45.477630 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (execute): 14:18:43.760623 => 14:18:45.477495
[0m14:18:45.477838 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: ROLLBACK
[0m14:18:45.478013 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: Close
[0m14:18:45.479361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe499811-9bdd-4608-bd37-bcde13dfe129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be35f12d0>]}
[0m14:18:45.479696 [info ] [Thread-1 (]: 3 of 4 OK created sql table model dbt_dbt.dim_suppliers ........................ [[32mSUCCESS[0m in 1.72s]
[0m14:18:45.480163 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_suppliers
[0m14:18:45.480469 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.fct_orders_items
[0m14:18:45.480710 [info ] [Thread-1 (]: 4 of 4 SKIP relation dbt_dbt.fct_orders_items .................................. [[33mSKIP[0m]
[0m14:18:45.481290 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.fct_orders_items
[0m14:18:45.482818 [debug] [MainThread]: On master: COMMIT
[0m14:18:45.483172 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:18:45.483326 [debug] [MainThread]: Connection 'model.dbt_trino_demo.dim_suppliers' was properly closed.
[0m14:18:45.483500 [info ] [MainThread]: 
[0m14:18:45.483699 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 12.23 seconds (12.23s).
[0m14:18:45.484255 [debug] [MainThread]: Command end result
[0m14:18:45.528797 [info ] [MainThread]: 
[0m14:18:45.529187 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:18:45.529435 [info ] [MainThread]: 
[0m14:18:45.529763 [error] [MainThread]:   Database Error in model stg_tpch_order_items (models/staging/stg_tpch_order_items.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 87:26: Column 'item_discount_amount' cannot be resolved", query_id=20231213_131836_00276_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/staging/stg_tpch_order_items.sql
[0m14:18:45.529996 [info ] [MainThread]: 
[0m14:18:45.530244 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m14:18:45.530892 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.595852, "process_user_time": 1.739859, "process_kernel_time": 0.117293, "process_mem_max_rss": "113268", "process_out_blocks": "3632", "command_success": false, "process_in_blocks": "0"}
[0m14:18:45.531299 [debug] [MainThread]: Command `dbt run` failed at 14:18:45.531226 after 12.60 seconds
[0m14:18:45.531511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be80b2bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be80b2b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be3380810>]}
[0m14:18:45.531706 [debug] [MainThread]: Flushing usage events
[0m14:19:21.940274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8561c48790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85617e7a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8561c48990>]}


============================== 14:19:21.942219 | 69557a64-176a-45e9-8f88-35538edd0995 ==============================
[0m14:19:21.942219 [info ] [MainThread]: Running with dbt=1.7.3
[0m14:19:21.942639 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:19:22.074606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69557a64-176a-45e9-8f88-35538edd0995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85615cbe90>]}
[0m14:19:22.128356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69557a64-176a-45e9-8f88-35538edd0995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8561540dd0>]}
[0m14:19:22.128805 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m14:19:22.136220 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m14:19:22.152720 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:19:22.153196 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/staging/stg_tpch_order_items.sql
[0m14:19:22.256359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69557a64-176a-45e9-8f88-35538edd0995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f856151c590>]}
[0m14:19:22.265809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69557a64-176a-45e9-8f88-35538edd0995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85613f4250>]}
[0m14:19:22.266181 [info ] [MainThread]: Found 12 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m14:19:22.266453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69557a64-176a-45e9-8f88-35538edd0995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8561190e10>]}
[0m14:19:22.267841 [info ] [MainThread]: 
[0m14:19:22.268437 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:19:22.269439 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m14:19:22.281570 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m14:19:22.281890 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m14:19:22.282187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:19:23.239632 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:19:23.240662 [debug] [ThreadPool]: On list_lakehouse: Close
[0m14:19:23.243012 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt_dbt)
[0m14:19:23.248042 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt_dbt"
[0m14:19:23.248580 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt_dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt_dbt'
[0m14:19:23.248798 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:19:23.841590 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:19:23.842517 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: ROLLBACK
[0m14:19:23.842728 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: Close
[0m14:19:23.844483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69557a64-176a-45e9-8f88-35538edd0995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85611793d0>]}
[0m14:19:23.844782 [debug] [MainThread]: On master: COMMIT
[0m14:19:23.845181 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:19:23.845418 [info ] [MainThread]: 
[0m14:19:23.848159 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m14:19:23.848821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt_dbt, now model.dbt_trino_demo.stg_tpch_customers)
[0m14:19:23.849115 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m14:19:23.851351 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m14:19:23.851776 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 14:19:23.849231 => 14:19:23.851633
[0m14:19:23.852345 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m14:19:23.852644 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m14:19:23.853025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m14:19:23.853244 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m14:19:23.855094 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m14:19:23.855669 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 14:19:23.853377 => 14:19:23.855485
[0m14:19:23.856178 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m14:19:23.856428 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m14:19:23.856813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m14:19:23.857037 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m14:19:23.858898 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m14:19:23.859429 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 14:19:23.857169 => 14:19:23.859251
[0m14:19:23.859950 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m14:19:23.860232 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m14:19:23.860615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m14:19:23.860851 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m14:19:23.862742 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m14:19:23.863182 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 14:19:23.861054 => 14:19:23.863035
[0m14:19:23.863702 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m14:19:23.863951 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m14:19:23.864606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m14:19:23.865526 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m14:19:23.868043 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m14:19:23.868471 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 14:19:23.865834 => 14:19:23.868330
[0m14:19:23.868977 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m14:19:23.869339 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:19:23.869824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m14:19:23.870098 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:19:23.874183 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m14:19:23.874943 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 14:19:23.870271 => 14:19:23.874765
[0m14:19:23.875488 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:19:23.875788 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m14:19:23.876172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m14:19:23.876391 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m14:19:23.878273 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m14:19:23.878869 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 14:19:23.876525 => 14:19:23.878685
[0m14:19:23.879340 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m14:19:23.879594 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m14:19:23.880184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m14:19:23.880559 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m14:19:23.882963 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m14:19:23.883658 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 14:19:23.880735 => 14:19:23.883497
[0m14:19:23.884169 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m14:19:23.884449 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_order_items
[0m14:19:23.884798 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_dbt.stg_tpch_order_items ...................... [RUN]
[0m14:19:23.885513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_supplier, now model.dbt_trino_demo.stg_tpch_order_items)
[0m14:19:23.885772 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_order_items
[0m14:19:23.898027 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_order_items"
[0m14:19:23.898636 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_order_items (compile): 14:19:23.885921 => 14:19:23.898416
[0m14:19:23.898909 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.stg_tpch_order_items
[0m14:19:23.917803 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.stg_tpch_order_items"
[0m14:19:23.922059 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.stg_tpch_order_items"
[0m14:19:23.922420 [debug] [Thread-1 (]: On model.dbt_trino_demo.stg_tpch_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.stg_tpch_order_items"} */

  
    

    create table "lakehouse"."dbt_dbt"."stg_tpch_order_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_orders as (

select
    orderkey as order_key, 
    custkey as customer_key,
    orderstatus as order_status_code,
    totalprice as order_amount,
    orderdate as order_date,
    orderpriority as order_priority_code,
    clerk as order_clerk_name,
    shippriority as shipping_priority,
    comment as order_comment
from
    tpch.sf1.orders
),  __dbt__cte__stg_tpch_line_item as (

select
    orderkey as order_key,
    partkey as part_key,
    suppkey as supplier_key,
    linenumber as order_line_number,
    quantity as quantity,
    extendedprice as extended_price,
    discount as discount_percentage,
    tax as tax_rate,
    returnflag as return_status_code,
    linestatus as order_line_status_code,
    shipdate as ship_date,
    commitdate as commit_date,
    receiptdate as receipt_date,
    shipinstruct as ship_instructions_desc,
    shipmode as ship_mode_name,
    comment as order_line_comment
from
    tpch.sf1.lineitem
), orders as (
    
    select * from __dbt__cte__stg_tpch_orders

),
line_items as (

    select * from __dbt__cte__stg_tpch_line_item

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(o.order_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l.order_line_number as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as order_item_key,

    o.order_key,
    o.order_date,
    o.customer_key,
    o.order_status_code,
    
    l.part_key,
    l.supplier_key,
    l.return_status_code,
    l.order_line_number,
    l.order_line_status_code,
    l.ship_date,
    l.commit_date,
    l.receipt_date,
    l.ship_mode_name,

    l.quantity,
    
    -- extended_price is actually the line item total,
    -- so we back out the extended price per item
    (l.extended_price/nullif(l.quantity, 0)) as base_price,
    l.discount_percentage,
    ((l.extended_price/nullif(l.quantity, 0)) * (1 - l.discount_percentage)) as discounted_price,

    l.extended_price as gross_item_sales_amount,
    (l.extended_price * (1 - l.discount_percentage)) as discounted_item_sales_amount,
    -- We model discounts as negative amounts
    (-1 * l.extended_price * l.discount_percentage) as item_discount_amount,
    l.tax_rate,
    ((l.extended_price + item_discount_amount) * l.tax_rate) as item_tax_amount,
    (
        l.extended_price + 
        (-1 * l.extended_price * l.discount_percentage) + 
        item_tax_amount
    ) as net_item_sales_amount

from
    orders o
    join
    line_items l
        on o.order_key = l.order_key
order by
    o.order_date
    )
[0m14:19:23.922670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:24.303789 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231213_131925_00283_scdwh
[0m14:19:24.304148 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 87:26: Column 'item_discount_amount' cannot be resolved", query_id=20231213_131925_00283_scdwh)
[0m14:19:24.304605 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_order_items (execute): 14:19:23.899026 => 14:19:24.304446
[0m14:19:24.304832 [debug] [Thread-1 (]: On model.dbt_trino_demo.stg_tpch_order_items: ROLLBACK
[0m14:19:24.305011 [debug] [Thread-1 (]: On model.dbt_trino_demo.stg_tpch_order_items: Close
[0m14:19:24.307455 [debug] [Thread-1 (]: Database Error in model stg_tpch_order_items (models/staging/stg_tpch_order_items.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 87:26: Column 'item_discount_amount' cannot be resolved", query_id=20231213_131925_00283_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/staging/stg_tpch_order_items.sql
[0m14:19:24.308555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69557a64-176a-45e9-8f88-35538edd0995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85611ba350>]}
[0m14:19:24.309027 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model dbt_dbt.stg_tpch_order_items ............. [[31mERROR[0m in 0.42s]
[0m14:19:24.309515 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_order_items
[0m14:19:24.309844 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_part_suppliers
[0m14:19:24.310138 [info ] [Thread-1 (]: 2 of 4 START sql table model dbt_dbt.dim_part_suppliers ........................ [RUN]
[0m14:19:24.310837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_order_items, now model.dbt_trino_demo.dim_part_suppliers)
[0m14:19:24.311139 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_part_suppliers
[0m14:19:24.320299 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m14:19:24.320867 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (compile): 14:19:24.311283 => 14:19:24.320696
[0m14:19:24.321140 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_part_suppliers
[0m14:19:24.327745 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt_dbt"."dim_part_suppliers"
[0m14:19:24.329136 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m14:19:24.329402 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

    drop table if exists "lakehouse"."dbt_dbt"."dim_part_suppliers"
[0m14:19:24.329590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:24.829248 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:19:24.830444 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_part_suppliers"
[0m14:19:24.835193 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m14:19:24.835552 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
    )
[0m14:19:31.832708 [debug] [Thread-1 (]: SQL status: SUCCESS in 7.0 seconds
[0m14:19:31.843940 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (execute): 14:19:24.321304 => 14:19:31.843803
[0m14:19:31.844167 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: ROLLBACK
[0m14:19:31.844357 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: Close
[0m14:19:31.845377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69557a64-176a-45e9-8f88-35538edd0995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85611a4310>]}
[0m14:19:31.845720 [info ] [Thread-1 (]: 2 of 4 OK created sql table model dbt_dbt.dim_part_suppliers ................... [[32mSUCCESS[0m in 7.53s]
[0m14:19:31.846082 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_part_suppliers
[0m14:19:31.846562 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_suppliers
[0m14:19:31.847076 [info ] [Thread-1 (]: 3 of 4 START sql table model dbt_dbt.dim_suppliers ............................. [RUN]
[0m14:19:31.847619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.dim_part_suppliers, now model.dbt_trino_demo.dim_suppliers)
[0m14:19:31.847848 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_suppliers
[0m14:19:31.852816 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_suppliers"
[0m14:19:31.853203 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (compile): 14:19:31.847957 => 14:19:31.853072
[0m14:19:31.853396 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_suppliers
[0m14:19:31.856050 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt_dbt"."dim_suppliers"
[0m14:19:31.856536 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m14:19:31.856731 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt_dbt"."dim_suppliers"
[0m14:19:31.856901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:32.768059 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:19:32.769607 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_suppliers"
[0m14:19:32.772164 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m14:19:32.772452 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_suppliers"
      
      
    as (
      
with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m14:19:33.548676 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:19:33.550363 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (execute): 14:19:31.853503 => 14:19:33.550235
[0m14:19:33.550579 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: ROLLBACK
[0m14:19:33.550757 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: Close
[0m14:19:33.551874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69557a64-176a-45e9-8f88-35538edd0995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8560f58610>]}
[0m14:19:33.552252 [info ] [Thread-1 (]: 3 of 4 OK created sql table model dbt_dbt.dim_suppliers ........................ [[32mSUCCESS[0m in 1.70s]
[0m14:19:33.552763 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_suppliers
[0m14:19:33.553105 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.fct_orders_items
[0m14:19:33.553350 [info ] [Thread-1 (]: 4 of 4 SKIP relation dbt_dbt.fct_orders_items .................................. [[33mSKIP[0m]
[0m14:19:33.553786 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.fct_orders_items
[0m14:19:33.555277 [debug] [MainThread]: On master: COMMIT
[0m14:19:33.555760 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:19:33.555997 [debug] [MainThread]: Connection 'model.dbt_trino_demo.dim_suppliers' was properly closed.
[0m14:19:33.556198 [info ] [MainThread]: 
[0m14:19:33.556435 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 11.29 seconds (11.29s).
[0m14:19:33.557102 [debug] [MainThread]: Command end result
[0m14:19:33.603289 [info ] [MainThread]: 
[0m14:19:33.603635 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:19:33.603939 [info ] [MainThread]: 
[0m14:19:33.604283 [error] [MainThread]:   Database Error in model stg_tpch_order_items (models/staging/stg_tpch_order_items.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 87:26: Column 'item_discount_amount' cannot be resolved", query_id=20231213_131925_00283_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/staging/stg_tpch_order_items.sql
[0m14:19:33.604545 [info ] [MainThread]: 
[0m14:19:33.604778 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m14:19:33.605426 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.692228, "process_user_time": 1.741566, "process_kernel_time": 0.072565, "process_mem_max_rss": "114272", "process_out_blocks": "3640", "command_success": false, "process_in_blocks": "0"}
[0m14:19:33.605738 [debug] [MainThread]: Command `dbt run` failed at 14:19:33.605667 after 11.69 seconds
[0m14:19:33.605950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8561c48790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8565d2f350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8561530f10>]}
[0m14:19:33.606144 [debug] [MainThread]: Flushing usage events
[0m14:20:18.356015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f326938bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32693a3fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32693882d0>]}


============================== 14:20:18.357860 | 80caf2c3-d2bf-477c-8926-f873820bc498 ==============================
[0m14:20:18.357860 [info ] [MainThread]: Running with dbt=1.7.3
[0m14:20:18.358353 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:20:18.484592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80caf2c3-d2bf-477c-8926-f873820bc498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3269388250>]}
[0m14:20:18.537304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80caf2c3-d2bf-477c-8926-f873820bc498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3269130250>]}
[0m14:20:18.537785 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m14:20:18.547089 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m14:20:18.564187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:20:18.564634 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/staging/stg_tpch_order_items.sql
[0m14:20:18.661666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80caf2c3-d2bf-477c-8926-f873820bc498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3268c33f10>]}
[0m14:20:18.669293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80caf2c3-d2bf-477c-8926-f873820bc498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3268fdc350>]}
[0m14:20:18.669624 [info ] [MainThread]: Found 12 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m14:20:18.669882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80caf2c3-d2bf-477c-8926-f873820bc498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3268daad50>]}
[0m14:20:18.671166 [info ] [MainThread]: 
[0m14:20:18.671697 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:20:18.672605 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m14:20:18.682924 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m14:20:18.683196 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m14:20:18.683373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:19.723338 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:20:19.724296 [debug] [ThreadPool]: On list_lakehouse: Close
[0m14:20:19.726468 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt_dbt)
[0m14:20:19.731653 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt_dbt"
[0m14:20:19.731945 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt_dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt_dbt'
[0m14:20:19.732166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:20:20.012638 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:20:20.013707 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: ROLLBACK
[0m14:20:20.013930 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: Close
[0m14:20:20.015665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80caf2c3-d2bf-477c-8926-f873820bc498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3268e14610>]}
[0m14:20:20.015958 [debug] [MainThread]: On master: COMMIT
[0m14:20:20.016348 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:20:20.016584 [info ] [MainThread]: 
[0m14:20:20.019333 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m14:20:20.020124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt_dbt, now model.dbt_trino_demo.stg_tpch_customers)
[0m14:20:20.020401 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m14:20:20.022952 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m14:20:20.023606 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 14:20:20.020538 => 14:20:20.023299
[0m14:20:20.024454 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m14:20:20.024958 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m14:20:20.025569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m14:20:20.025855 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m14:20:20.028267 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m14:20:20.029057 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 14:20:20.026088 => 14:20:20.028826
[0m14:20:20.029836 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m14:20:20.030146 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m14:20:20.030962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m14:20:20.031245 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m14:20:20.034940 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m14:20:20.035869 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 14:20:20.031402 => 14:20:20.035513
[0m14:20:20.036992 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m14:20:20.037479 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m14:20:20.038316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m14:20:20.038656 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m14:20:20.041543 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m14:20:20.042191 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 14:20:20.038827 => 14:20:20.042023
[0m14:20:20.042811 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m14:20:20.043112 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m14:20:20.043568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m14:20:20.043820 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m14:20:20.046387 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m14:20:20.047338 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 14:20:20.043965 => 14:20:20.047157
[0m14:20:20.047958 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m14:20:20.048263 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:20:20.048889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m14:20:20.049156 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:20:20.054240 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m14:20:20.055128 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 14:20:20.049340 => 14:20:20.054788
[0m14:20:20.055893 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:20:20.056168 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m14:20:20.056683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m14:20:20.057039 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m14:20:20.059678 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m14:20:20.060455 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 14:20:20.057268 => 14:20:20.060213
[0m14:20:20.061238 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m14:20:20.061538 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m14:20:20.062034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m14:20:20.062487 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m14:20:20.064703 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m14:20:20.065159 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 14:20:20.062647 => 14:20:20.064987
[0m14:20:20.065811 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m14:20:20.066158 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_order_items
[0m14:20:20.066576 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_dbt.stg_tpch_order_items ...................... [RUN]
[0m14:20:20.067630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_supplier, now model.dbt_trino_demo.stg_tpch_order_items)
[0m14:20:20.067848 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_order_items
[0m14:20:20.080542 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_order_items"
[0m14:20:20.081208 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_order_items (compile): 14:20:20.067976 => 14:20:20.080991
[0m14:20:20.081497 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.stg_tpch_order_items
[0m14:20:20.103179 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.stg_tpch_order_items"
[0m14:20:20.109130 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.stg_tpch_order_items"
[0m14:20:20.109682 [debug] [Thread-1 (]: On model.dbt_trino_demo.stg_tpch_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.stg_tpch_order_items"} */

  
    

    create table "lakehouse"."dbt_dbt"."stg_tpch_order_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_orders as (

select
    orderkey as order_key, 
    custkey as customer_key,
    orderstatus as order_status_code,
    totalprice as order_amount,
    orderdate as order_date,
    orderpriority as order_priority_code,
    clerk as order_clerk_name,
    shippriority as shipping_priority,
    comment as order_comment
from
    tpch.sf1.orders
),  __dbt__cte__stg_tpch_line_item as (

select
    orderkey as order_key,
    partkey as part_key,
    suppkey as supplier_key,
    linenumber as order_line_number,
    quantity as quantity,
    extendedprice as extended_price,
    discount as discount_percentage,
    tax as tax_rate,
    returnflag as return_status_code,
    linestatus as order_line_status_code,
    shipdate as ship_date,
    commitdate as commit_date,
    receiptdate as receipt_date,
    shipinstruct as ship_instructions_desc,
    shipmode as ship_mode_name,
    comment as order_line_comment
from
    tpch.sf1.lineitem
), orders as (
    
    select * from __dbt__cte__stg_tpch_orders

),
line_items as (

    select * from __dbt__cte__stg_tpch_line_item

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(o.order_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l.order_line_number as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as order_item_key,

    o.order_key,
    o.order_date,
    o.customer_key,
    o.order_status_code,
    
    l.part_key,
    l.supplier_key,
    l.return_status_code,
    l.order_line_number,
    l.order_line_status_code,
    l.ship_date,
    l.commit_date,
    l.receipt_date,
    l.ship_mode_name,

    l.quantity,
    
    -- extended_price is actually the line item total,
    -- so we back out the extended price per item
    (l.extended_price/nullif(l.quantity, 0)) as base_price,
    l.discount_percentage,
    ((l.extended_price/nullif(l.quantity, 0)) * (1 - l.discount_percentage)) as discounted_price,

    l.extended_price as gross_item_sales_amount,
    (l.extended_price * (1 - l.discount_percentage)) as discounted_item_sales_amount,
    -- We model discounts as negative amounts
    (-1 * l.extended_price * l.discount_percentage) as item_discount_amount,
    l.tax_rate,
    ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate) as item_tax_amount,
    (
        l.extended_price + 
        (-1 * l.extended_price * l.discount_percentage) + 
        item_tax_amount
    ) as net_item_sales_amount

from
    orders o
    join
    line_items l
        on o.order_key = l.order_key
order by
    o.order_date
    )
[0m14:20:20.110113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:20.490684 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231213_132021_00290_scdwh
[0m14:20:20.491024 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 91:9: Column 'item_tax_amount' cannot be resolved", query_id=20231213_132021_00290_scdwh)
[0m14:20:20.491369 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_order_items (execute): 14:20:20.081652 => 14:20:20.491229
[0m14:20:20.491603 [debug] [Thread-1 (]: On model.dbt_trino_demo.stg_tpch_order_items: ROLLBACK
[0m14:20:20.491792 [debug] [Thread-1 (]: On model.dbt_trino_demo.stg_tpch_order_items: Close
[0m14:20:20.494908 [debug] [Thread-1 (]: Database Error in model stg_tpch_order_items (models/staging/stg_tpch_order_items.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 91:9: Column 'item_tax_amount' cannot be resolved", query_id=20231213_132021_00290_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/staging/stg_tpch_order_items.sql
[0m14:20:20.496009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80caf2c3-d2bf-477c-8926-f873820bc498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3268c33b10>]}
[0m14:20:20.496453 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model dbt_dbt.stg_tpch_order_items ............. [[31mERROR[0m in 0.43s]
[0m14:20:20.496879 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_order_items
[0m14:20:20.497219 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_part_suppliers
[0m14:20:20.497497 [info ] [Thread-1 (]: 2 of 4 START sql table model dbt_dbt.dim_part_suppliers ........................ [RUN]
[0m14:20:20.498302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_order_items, now model.dbt_trino_demo.dim_part_suppliers)
[0m14:20:20.498581 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_part_suppliers
[0m14:20:20.507400 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m14:20:20.507948 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (compile): 14:20:20.498741 => 14:20:20.507795
[0m14:20:20.508162 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_part_suppliers
[0m14:20:20.514624 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt_dbt"."dim_part_suppliers"
[0m14:20:20.516604 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m14:20:20.516926 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

    drop table if exists "lakehouse"."dbt_dbt"."dim_part_suppliers"
[0m14:20:20.517127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:21.043889 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:20:21.045335 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_part_suppliers"
[0m14:20:21.050747 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m14:20:21.051093 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
    )
[0m14:20:27.889293 [debug] [Thread-1 (]: SQL status: SUCCESS in 7.0 seconds
[0m14:20:27.901235 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (execute): 14:20:20.508301 => 14:20:27.901086
[0m14:20:27.901507 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: ROLLBACK
[0m14:20:27.901691 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: Close
[0m14:20:27.902973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80caf2c3-d2bf-477c-8926-f873820bc498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3268c6bc50>]}
[0m14:20:27.903418 [info ] [Thread-1 (]: 2 of 4 OK created sql table model dbt_dbt.dim_part_suppliers ................... [[32mSUCCESS[0m in 7.40s]
[0m14:20:27.904239 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_part_suppliers
[0m14:20:27.904567 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_suppliers
[0m14:20:27.904896 [info ] [Thread-1 (]: 3 of 4 START sql table model dbt_dbt.dim_suppliers ............................. [RUN]
[0m14:20:27.905719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.dim_part_suppliers, now model.dbt_trino_demo.dim_suppliers)
[0m14:20:27.906007 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_suppliers
[0m14:20:27.911447 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_suppliers"
[0m14:20:27.912049 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (compile): 14:20:27.906223 => 14:20:27.911862
[0m14:20:27.913705 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_suppliers
[0m14:20:27.916956 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt_dbt"."dim_suppliers"
[0m14:20:27.917489 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m14:20:27.917691 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt_dbt"."dim_suppliers"
[0m14:20:27.917859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:28.876510 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:20:28.877828 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_suppliers"
[0m14:20:28.880591 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m14:20:28.880869 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_suppliers"
      
      
    as (
      
with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m14:20:29.674911 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:20:29.677423 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (execute): 14:20:27.913882 => 14:20:29.677222
[0m14:20:29.677752 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: ROLLBACK
[0m14:20:29.677960 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: Close
[0m14:20:29.679271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80caf2c3-d2bf-477c-8926-f873820bc498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3269002d10>]}
[0m14:20:29.679687 [info ] [Thread-1 (]: 3 of 4 OK created sql table model dbt_dbt.dim_suppliers ........................ [[32mSUCCESS[0m in 1.77s]
[0m14:20:29.680229 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_suppliers
[0m14:20:29.680505 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.fct_orders_items
[0m14:20:29.680755 [info ] [Thread-1 (]: 4 of 4 SKIP relation dbt_dbt.fct_orders_items .................................. [[33mSKIP[0m]
[0m14:20:29.681093 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.fct_orders_items
[0m14:20:29.682569 [debug] [MainThread]: On master: COMMIT
[0m14:20:29.682949 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:20:29.683104 [debug] [MainThread]: Connection 'model.dbt_trino_demo.dim_suppliers' was properly closed.
[0m14:20:29.683282 [info ] [MainThread]: 
[0m14:20:29.683484 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 11.01 seconds (11.01s).
[0m14:20:29.684183 [debug] [MainThread]: Command end result
[0m14:20:29.733129 [info ] [MainThread]: 
[0m14:20:29.733550 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:20:29.733862 [info ] [MainThread]: 
[0m14:20:29.734163 [error] [MainThread]:   Database Error in model stg_tpch_order_items (models/staging/stg_tpch_order_items.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 91:9: Column 'item_tax_amount' cannot be resolved", query_id=20231213_132021_00290_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/staging/stg_tpch_order_items.sql
[0m14:20:29.734394 [info ] [MainThread]: 
[0m14:20:29.734627 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m14:20:29.735246 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.404822, "process_user_time": 1.714712, "process_kernel_time": 0.070192, "process_mem_max_rss": "114288", "process_out_blocks": "3640", "command_success": false, "process_in_blocks": "0"}
[0m14:20:29.735537 [debug] [MainThread]: Command `dbt run` failed at 14:20:29.735466 after 11.41 seconds
[0m14:20:29.735750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f326da9b790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f326da9b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3269db4410>]}
[0m14:20:29.735947 [debug] [MainThread]: Flushing usage events
[0m14:20:49.931902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9039c38d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9039c28290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9039c28dd0>]}


============================== 14:20:49.933911 | 76e2e74a-92b4-4045-96c1-2ef6b0e2c878 ==============================
[0m14:20:49.933911 [info ] [MainThread]: Running with dbt=1.7.3
[0m14:20:49.934386 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:20:50.071646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76e2e74a-92b4-4045-96c1-2ef6b0e2c878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90399f8910>]}
[0m14:20:50.131206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76e2e74a-92b4-4045-96c1-2ef6b0e2c878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9039a8c150>]}
[0m14:20:50.131821 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m14:20:50.139994 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m14:20:50.164175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:20:50.164710 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_demo://models/staging/stg_tpch_order_items.sql
[0m14:20:50.265726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76e2e74a-92b4-4045-96c1-2ef6b0e2c878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90396129d0>]}
[0m14:20:50.273848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76e2e74a-92b4-4045-96c1-2ef6b0e2c878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9039684050>]}
[0m14:20:50.274202 [info ] [MainThread]: Found 12 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m14:20:50.274527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76e2e74a-92b4-4045-96c1-2ef6b0e2c878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90396bdb90>]}
[0m14:20:50.275879 [info ] [MainThread]: 
[0m14:20:50.276563 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:20:50.277840 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m14:20:50.289688 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m14:20:50.290001 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m14:20:50.290189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:51.342547 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:20:51.343843 [debug] [ThreadPool]: On list_lakehouse: Close
[0m14:20:51.346512 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt_dbt)
[0m14:20:51.351651 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt_dbt"
[0m14:20:51.352146 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt_dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt_dbt'
[0m14:20:51.352359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:20:52.142428 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:20:52.143496 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: ROLLBACK
[0m14:20:52.143785 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: Close
[0m14:20:52.145498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76e2e74a-92b4-4045-96c1-2ef6b0e2c878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f903989ad50>]}
[0m14:20:52.145840 [debug] [MainThread]: On master: COMMIT
[0m14:20:52.146365 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:20:52.146635 [info ] [MainThread]: 
[0m14:20:52.148918 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m14:20:52.149694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt_dbt, now model.dbt_trino_demo.stg_tpch_customers)
[0m14:20:52.149979 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m14:20:52.152446 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m14:20:52.152965 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 14:20:52.150120 => 14:20:52.152791
[0m14:20:52.153607 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m14:20:52.153987 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m14:20:52.154452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m14:20:52.154713 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m14:20:52.157020 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m14:20:52.157856 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 14:20:52.154878 => 14:20:52.157656
[0m14:20:52.158553 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m14:20:52.158871 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m14:20:52.159422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m14:20:52.159690 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m14:20:52.162062 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m14:20:52.162775 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 14:20:52.159855 => 14:20:52.162587
[0m14:20:52.163497 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m14:20:52.163816 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m14:20:52.164291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m14:20:52.164546 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m14:20:52.166804 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m14:20:52.167616 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 14:20:52.164708 => 14:20:52.167375
[0m14:20:52.168313 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m14:20:52.168622 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m14:20:52.169153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m14:20:52.169441 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m14:20:52.172417 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m14:20:52.173456 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 14:20:52.169606 => 14:20:52.173255
[0m14:20:52.174290 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m14:20:52.174620 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:20:52.175087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m14:20:52.175353 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:20:52.179839 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m14:20:52.180658 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 14:20:52.175528 => 14:20:52.180464
[0m14:20:52.181284 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:20:52.181596 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m14:20:52.182041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m14:20:52.182295 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m14:20:52.184541 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m14:20:52.185290 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 14:20:52.182459 => 14:20:52.185072
[0m14:20:52.185870 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m14:20:52.186151 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m14:20:52.186560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m14:20:52.186786 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m14:20:52.188881 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m14:20:52.189604 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 14:20:52.186926 => 14:20:52.189405
[0m14:20:52.190127 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m14:20:52.190393 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_order_items
[0m14:20:52.190680 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_dbt.stg_tpch_order_items ...................... [RUN]
[0m14:20:52.191424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_supplier, now model.dbt_trino_demo.stg_tpch_order_items)
[0m14:20:52.191680 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_order_items
[0m14:20:52.204530 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_order_items"
[0m14:20:52.205231 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_order_items (compile): 14:20:52.191820 => 14:20:52.205008
[0m14:20:52.205510 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.stg_tpch_order_items
[0m14:20:52.224029 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.stg_tpch_order_items"
[0m14:20:52.228519 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.stg_tpch_order_items"
[0m14:20:52.228900 [debug] [Thread-1 (]: On model.dbt_trino_demo.stg_tpch_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.stg_tpch_order_items"} */

  
    

    create table "lakehouse"."dbt_dbt"."stg_tpch_order_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_orders as (

select
    orderkey as order_key, 
    custkey as customer_key,
    orderstatus as order_status_code,
    totalprice as order_amount,
    orderdate as order_date,
    orderpriority as order_priority_code,
    clerk as order_clerk_name,
    shippriority as shipping_priority,
    comment as order_comment
from
    tpch.sf1.orders
),  __dbt__cte__stg_tpch_line_item as (

select
    orderkey as order_key,
    partkey as part_key,
    suppkey as supplier_key,
    linenumber as order_line_number,
    quantity as quantity,
    extendedprice as extended_price,
    discount as discount_percentage,
    tax as tax_rate,
    returnflag as return_status_code,
    linestatus as order_line_status_code,
    shipdate as ship_date,
    commitdate as commit_date,
    receiptdate as receipt_date,
    shipinstruct as ship_instructions_desc,
    shipmode as ship_mode_name,
    comment as order_line_comment
from
    tpch.sf1.lineitem
), orders as (
    
    select * from __dbt__cte__stg_tpch_orders

),
line_items as (

    select * from __dbt__cte__stg_tpch_line_item

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(o.order_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l.order_line_number as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as order_item_key,

    o.order_key,
    o.order_date,
    o.customer_key,
    o.order_status_code,
    
    l.part_key,
    l.supplier_key,
    l.return_status_code,
    l.order_line_number,
    l.order_line_status_code,
    l.ship_date,
    l.commit_date,
    l.receipt_date,
    l.ship_mode_name,

    l.quantity,
    
    -- extended_price is actually the line item total,
    -- so we back out the extended price per item
    (l.extended_price/nullif(l.quantity, 0)) as base_price,
    l.discount_percentage,
    ((l.extended_price/nullif(l.quantity, 0)) * (1 - l.discount_percentage)) as discounted_price,

    l.extended_price as gross_item_sales_amount,
    (l.extended_price * (1 - l.discount_percentage)) as discounted_item_sales_amount,
    -- We model discounts as negative amounts
    (-1 * l.extended_price * l.discount_percentage) as item_discount_amount,
    l.tax_rate,
    ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate) as item_tax_amount,
    (
        l.extended_price + 
        (-1 * l.extended_price * l.discount_percentage) + 
        ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate)
    ) as net_item_sales_amount

from
    orders o
    join
    line_items l
        on o.order_key = l.order_key
order by
    o.order_date
    )
[0m14:20:52.229179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:16.542027 [debug] [Thread-1 (]: SQL status: SUCCESS in 24.0 seconds
[0m14:21:16.553956 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_order_items (execute): 14:20:52.205649 => 14:21:16.553749
[0m14:21:16.554306 [debug] [Thread-1 (]: On model.dbt_trino_demo.stg_tpch_order_items: ROLLBACK
[0m14:21:16.554534 [debug] [Thread-1 (]: On model.dbt_trino_demo.stg_tpch_order_items: Close
[0m14:21:16.555892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76e2e74a-92b4-4045-96c1-2ef6b0e2c878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90394aab50>]}
[0m14:21:16.556351 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_dbt.stg_tpch_order_items ................. [[32mSUCCESS[0m in 24.36s]
[0m14:21:16.556742 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_order_items
[0m14:21:16.557084 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_part_suppliers
[0m14:21:16.557368 [info ] [Thread-1 (]: 2 of 4 START sql table model dbt_dbt.dim_part_suppliers ........................ [RUN]
[0m14:21:16.557863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_order_items, now model.dbt_trino_demo.dim_part_suppliers)
[0m14:21:16.558152 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_part_suppliers
[0m14:21:16.566883 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m14:21:16.567558 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (compile): 14:21:16.558285 => 14:21:16.567404
[0m14:21:16.567759 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_part_suppliers
[0m14:21:16.575087 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt_dbt"."dim_part_suppliers"
[0m14:21:16.576700 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m14:21:16.576938 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

    drop table if exists "lakehouse"."dbt_dbt"."dim_part_suppliers"
[0m14:21:16.577127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:17.395743 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:21:17.398408 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_part_suppliers"
[0m14:21:17.403208 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m14:21:17.403486 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
    )
[0m14:21:24.168455 [debug] [Thread-1 (]: SQL status: SUCCESS in 7.0 seconds
[0m14:21:24.171629 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (execute): 14:21:16.567872 => 14:21:24.171495
[0m14:21:24.171890 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: ROLLBACK
[0m14:21:24.172076 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: Close
[0m14:21:24.173235 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76e2e74a-92b4-4045-96c1-2ef6b0e2c878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9039967dd0>]}
[0m14:21:24.173635 [info ] [Thread-1 (]: 2 of 4 OK created sql table model dbt_dbt.dim_part_suppliers ................... [[32mSUCCESS[0m in 7.62s]
[0m14:21:24.174071 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_part_suppliers
[0m14:21:24.174445 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_suppliers
[0m14:21:24.174730 [info ] [Thread-1 (]: 3 of 4 START sql table model dbt_dbt.dim_suppliers ............................. [RUN]
[0m14:21:24.175268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.dim_part_suppliers, now model.dbt_trino_demo.dim_suppliers)
[0m14:21:24.175732 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_suppliers
[0m14:21:24.180628 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_suppliers"
[0m14:21:24.181317 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (compile): 14:21:24.175888 => 14:21:24.181093
[0m14:21:24.182811 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_suppliers
[0m14:21:24.186032 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt_dbt"."dim_suppliers"
[0m14:21:24.186627 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m14:21:24.186925 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt_dbt"."dim_suppliers"
[0m14:21:24.187101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:25.052793 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:21:25.054304 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_suppliers"
[0m14:21:25.056526 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m14:21:25.056767 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_suppliers"
      
      
    as (
      
with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m14:21:25.842149 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:21:25.843906 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (execute): 14:21:24.182943 => 14:21:25.843777
[0m14:21:25.844133 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: ROLLBACK
[0m14:21:25.844326 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: Close
[0m14:21:25.845523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76e2e74a-92b4-4045-96c1-2ef6b0e2c878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9039542f90>]}
[0m14:21:25.846022 [info ] [Thread-1 (]: 3 of 4 OK created sql table model dbt_dbt.dim_suppliers ........................ [[32mSUCCESS[0m in 1.67s]
[0m14:21:25.846454 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_suppliers
[0m14:21:25.846748 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.fct_orders_items
[0m14:21:25.847013 [info ] [Thread-1 (]: 4 of 4 START sql table model dbt_dbt.fct_orders_items .......................... [RUN]
[0m14:21:25.847635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.dim_suppliers, now model.dbt_trino_demo.fct_orders_items)
[0m14:21:25.847849 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.fct_orders_items
[0m14:21:25.855330 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.fct_orders_items"
[0m14:21:25.855950 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.fct_orders_items (compile): 14:21:25.847962 => 14:21:25.855784
[0m14:21:25.856169 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.fct_orders_items
[0m14:21:25.859238 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.fct_orders_items"
[0m14:21:25.900660 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.fct_orders_items"
[0m14:21:25.901039 [debug] [Thread-1 (]: On model.dbt_trino_demo.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.fct_orders_items"} */

  
    

    create table "lakehouse"."dbt_dbt"."fct_orders_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), orders_items as (
    
    select * from "lakehouse"."dbt_dbt"."stg_tpch_order_items"

),
parts_suppliers as (
    
    select * from __dbt__cte__stg_tpch_part_suppliers

),
final as (
    select 

        o.order_item_key,
        o.order_key,
        o.order_date,
        o.customer_key,
        o.order_status_code,
        
        o.part_key,
        o.supplier_key,
        o.return_status_code,
        o.order_line_number,
        o.order_line_status_code,
        o.ship_date,
        o.commit_date,
        o.receipt_date,
        o.ship_mode_name,
        ps.supplier_cost_amount,
        
        o.base_price,
        o.discount_percentage,
        o.discounted_price,
        o.tax_rate,
        
        1 as order_item_count,
        o.quantity,

        o.gross_item_sales_amount,
        o.discounted_item_sales_amount,
        o.item_discount_amount,
        o.item_tax_amount,
        o.net_item_sales_amount

    from
        orders_items o
        join
        parts_suppliers ps
            on o.part_key = ps.part_key and
                o.supplier_key = ps.supplier_key
)
select *

from
    final f
order by
    f.order_date
    )
[0m14:21:25.901271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:26.596038 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231213_132127_00302_scdwh
[0m14:21:26.596406 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=ICEBERG_CANNOT_OPEN_SPLIT, message="Error opening Iceberg split file:/stackable/warehouse/dbt_dbt.db/stg_tpch_order_items-e17cb423726b46b4ae6dfb0e35f964ff/data/20231213_132053_00297_scdwh-b7775747-589d-4c57-b7b0-32effa156458.parquet (offset=0, length=29153402): file:/stackable/warehouse/dbt_dbt.db/stg_tpch_order_items-e17cb423726b46b4ae6dfb0e35f964ff/data/20231213_132053_00297_scdwh-b7775747-589d-4c57-b7b0-32effa156458.parquet", query_id=20231213_132127_00302_scdwh)
[0m14:21:26.596861 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.fct_orders_items (execute): 14:21:25.856284 => 14:21:26.596700
[0m14:21:26.597126 [debug] [Thread-1 (]: On model.dbt_trino_demo.fct_orders_items: ROLLBACK
[0m14:21:26.597359 [debug] [Thread-1 (]: On model.dbt_trino_demo.fct_orders_items: Close
[0m14:21:26.600261 [debug] [Thread-1 (]: Database Error in model fct_orders_items (models/mart/fct_orders_items.sql)
  TrinoExternalError(type=EXTERNAL, name=ICEBERG_CANNOT_OPEN_SPLIT, message="Error opening Iceberg split file:/stackable/warehouse/dbt_dbt.db/stg_tpch_order_items-e17cb423726b46b4ae6dfb0e35f964ff/data/20231213_132053_00297_scdwh-b7775747-589d-4c57-b7b0-32effa156458.parquet (offset=0, length=29153402): file:/stackable/warehouse/dbt_dbt.db/stg_tpch_order_items-e17cb423726b46b4ae6dfb0e35f964ff/data/20231213_132053_00297_scdwh-b7775747-589d-4c57-b7b0-32effa156458.parquet", query_id=20231213_132127_00302_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/fct_orders_items.sql
[0m14:21:26.601307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76e2e74a-92b4-4045-96c1-2ef6b0e2c878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9039b3c750>]}
[0m14:21:26.601680 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model dbt_dbt.fct_orders_items ................. [[31mERROR[0m in 0.75s]
[0m14:21:26.602051 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.fct_orders_items
[0m14:21:26.604067 [debug] [MainThread]: On master: COMMIT
[0m14:21:26.604496 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:21:26.604657 [debug] [MainThread]: Connection 'model.dbt_trino_demo.fct_orders_items' was properly closed.
[0m14:21:26.604835 [info ] [MainThread]: 
[0m14:21:26.605034 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 36.33 seconds (36.33s).
[0m14:21:26.605680 [debug] [MainThread]: Command end result
[0m14:21:26.611841 [info ] [MainThread]: 
[0m14:21:26.612224 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:21:26.612442 [info ] [MainThread]: 
[0m14:21:26.612671 [error] [MainThread]:   Database Error in model fct_orders_items (models/mart/fct_orders_items.sql)
  TrinoExternalError(type=EXTERNAL, name=ICEBERG_CANNOT_OPEN_SPLIT, message="Error opening Iceberg split file:/stackable/warehouse/dbt_dbt.db/stg_tpch_order_items-e17cb423726b46b4ae6dfb0e35f964ff/data/20231213_132053_00297_scdwh-b7775747-589d-4c57-b7b0-32effa156458.parquet (offset=0, length=29153402): file:/stackable/warehouse/dbt_dbt.db/stg_tpch_order_items-e17cb423726b46b4ae6dfb0e35f964ff/data/20231213_132053_00297_scdwh-b7775747-589d-4c57-b7b0-32effa156458.parquet", query_id=20231213_132127_00302_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/fct_orders_items.sql
[0m14:21:26.612902 [info ] [MainThread]: 
[0m14:21:26.613167 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m14:21:26.613790 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 36.711597, "process_user_time": 2.045904, "process_kernel_time": 0.178768, "process_mem_max_rss": "114124", "process_out_blocks": "3688", "command_success": false, "process_in_blocks": "0"}
[0m14:21:26.614093 [debug] [MainThread]: Command `dbt run` failed at 14:21:26.614022 after 36.71 seconds
[0m14:21:26.614312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9039c38290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9039c0a290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9039c65050>]}
[0m14:21:26.614552 [debug] [MainThread]: Flushing usage events
[0m14:25:14.516100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46e369f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46e3653a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46e3650c90>]}


============================== 14:25:14.517742 | 1e3c66ac-93bf-41b9-b65b-b0e5c5e18ad3 ==============================
[0m14:25:14.517742 [info ] [MainThread]: Running with dbt=1.7.3
[0m14:25:14.518073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:25:14.631680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e3c66ac-93bf-41b9-b65b-b0e5c5e18ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46e348b410>]}
[0m14:25:14.682648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e3c66ac-93bf-41b9-b65b-b0e5c5e18ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46e33f3f90>]}
[0m14:25:14.683035 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m14:25:14.689706 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m14:25:14.705366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:25:14.705677 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:25:14.709724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e3c66ac-93bf-41b9-b65b-b0e5c5e18ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46e347b9d0>]}
[0m14:25:14.717525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e3c66ac-93bf-41b9-b65b-b0e5c5e18ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46e33bbc90>]}
[0m14:25:14.717863 [info ] [MainThread]: Found 12 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m14:25:14.718112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e3c66ac-93bf-41b9-b65b-b0e5c5e18ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46e335b190>]}
[0m14:25:14.719425 [info ] [MainThread]: 
[0m14:25:14.719997 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:25:14.721045 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m14:25:14.731842 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m14:25:14.732106 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m14:25:14.732269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:15.760814 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:25:15.763318 [debug] [ThreadPool]: On list_lakehouse: Close
[0m14:25:15.766984 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt_dbt)
[0m14:25:15.773660 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt_dbt"
[0m14:25:15.773869 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt_dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt_dbt'
[0m14:25:15.774032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:25:16.510686 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:25:16.511729 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: ROLLBACK
[0m14:25:16.511936 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt: Close
[0m14:25:16.513804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e3c66ac-93bf-41b9-b65b-b0e5c5e18ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46e424f450>]}
[0m14:25:16.514084 [debug] [MainThread]: On master: COMMIT
[0m14:25:16.514467 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:25:16.514714 [info ] [MainThread]: 
[0m14:25:16.517460 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m14:25:16.517946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt_dbt, now model.dbt_trino_demo.stg_tpch_customers)
[0m14:25:16.518164 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m14:25:16.520724 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m14:25:16.521327 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 14:25:16.518277 => 14:25:16.521166
[0m14:25:16.521853 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m14:25:16.522128 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m14:25:16.522605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m14:25:16.522836 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m14:25:16.524830 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m14:25:16.525424 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 14:25:16.522972 => 14:25:16.525263
[0m14:25:16.525953 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m14:25:16.526207 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m14:25:16.526588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m14:25:16.526808 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m14:25:16.528640 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m14:25:16.529245 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 14:25:16.526944 => 14:25:16.529061
[0m14:25:16.529739 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m14:25:16.530015 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m14:25:16.530441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m14:25:16.530666 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m14:25:16.532811 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m14:25:16.533593 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 14:25:16.530803 => 14:25:16.533411
[0m14:25:16.534181 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m14:25:16.534478 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m14:25:16.534903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m14:25:16.535131 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m14:25:16.537089 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m14:25:16.537778 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 14:25:16.535269 => 14:25:16.537537
[0m14:25:16.538506 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m14:25:16.538917 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:25:16.539542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m14:25:16.539887 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:25:16.551822 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m14:25:16.552359 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 14:25:16.540120 => 14:25:16.552198
[0m14:25:16.552961 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m14:25:16.553252 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m14:25:16.553667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m14:25:16.553902 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m14:25:16.555860 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m14:25:16.556491 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 14:25:16.554043 => 14:25:16.556329
[0m14:25:16.556993 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m14:25:16.557254 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m14:25:16.557664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m14:25:16.557884 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m14:25:16.559900 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m14:25:16.560755 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 14:25:16.558019 => 14:25:16.560391
[0m14:25:16.561437 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m14:25:16.561716 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_order_items
[0m14:25:16.562007 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_dbt.stg_tpch_order_items ...................... [RUN]
[0m14:25:16.562539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_supplier, now model.dbt_trino_demo.stg_tpch_order_items)
[0m14:25:16.562854 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_order_items
[0m14:25:16.575105 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_order_items"
[0m14:25:16.575638 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_order_items (compile): 14:25:16.562986 => 14:25:16.575470
[0m14:25:16.575866 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.stg_tpch_order_items
[0m14:25:16.592512 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt_dbt"."stg_tpch_order_items"
[0m14:25:16.594028 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.stg_tpch_order_items"
[0m14:25:16.594324 [debug] [Thread-1 (]: On model.dbt_trino_demo.stg_tpch_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.stg_tpch_order_items"} */

    drop table if exists "lakehouse"."dbt_dbt"."stg_tpch_order_items"
[0m14:25:16.594526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:17.042519 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:25:17.050123 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.stg_tpch_order_items"
[0m14:25:17.054443 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.stg_tpch_order_items"
[0m14:25:17.054779 [debug] [Thread-1 (]: On model.dbt_trino_demo.stg_tpch_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.stg_tpch_order_items"} */

  
    

    create table "lakehouse"."dbt_dbt"."stg_tpch_order_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_orders as (

select
    orderkey as order_key, 
    custkey as customer_key,
    orderstatus as order_status_code,
    totalprice as order_amount,
    orderdate as order_date,
    orderpriority as order_priority_code,
    clerk as order_clerk_name,
    shippriority as shipping_priority,
    comment as order_comment
from
    tpch.sf1.orders
),  __dbt__cte__stg_tpch_line_item as (

select
    orderkey as order_key,
    partkey as part_key,
    suppkey as supplier_key,
    linenumber as order_line_number,
    quantity as quantity,
    extendedprice as extended_price,
    discount as discount_percentage,
    tax as tax_rate,
    returnflag as return_status_code,
    linestatus as order_line_status_code,
    shipdate as ship_date,
    commitdate as commit_date,
    receiptdate as receipt_date,
    shipinstruct as ship_instructions_desc,
    shipmode as ship_mode_name,
    comment as order_line_comment
from
    tpch.sf1.lineitem
), orders as (
    
    select * from __dbt__cte__stg_tpch_orders

),
line_items as (

    select * from __dbt__cte__stg_tpch_line_item

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(o.order_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l.order_line_number as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as order_item_key,

    o.order_key,
    o.order_date,
    o.customer_key,
    o.order_status_code,
    
    l.part_key,
    l.supplier_key,
    l.return_status_code,
    l.order_line_number,
    l.order_line_status_code,
    l.ship_date,
    l.commit_date,
    l.receipt_date,
    l.ship_mode_name,

    l.quantity,
    
    -- extended_price is actually the line item total,
    -- so we back out the extended price per item
    (l.extended_price/nullif(l.quantity, 0)) as base_price,
    l.discount_percentage,
    ((l.extended_price/nullif(l.quantity, 0)) * (1 - l.discount_percentage)) as discounted_price,

    l.extended_price as gross_item_sales_amount,
    (l.extended_price * (1 - l.discount_percentage)) as discounted_item_sales_amount,
    -- We model discounts as negative amounts
    (-1 * l.extended_price * l.discount_percentage) as item_discount_amount,
    l.tax_rate,
    ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate) as item_tax_amount,
    (
        l.extended_price + 
        (-1 * l.extended_price * l.discount_percentage) + 
        ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate)
    ) as net_item_sales_amount

from
    orders o
    join
    line_items l
        on o.order_key = l.order_key
order by
    o.order_date
    )
[0m14:25:56.017590 [debug] [Thread-1 (]: SQL status: SUCCESS in 39.0 seconds
[0m14:25:56.030117 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_order_items (execute): 14:25:16.576037 => 14:25:56.029980
[0m14:25:56.030365 [debug] [Thread-1 (]: On model.dbt_trino_demo.stg_tpch_order_items: ROLLBACK
[0m14:25:56.030549 [debug] [Thread-1 (]: On model.dbt_trino_demo.stg_tpch_order_items: Close
[0m14:25:56.031899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e3c66ac-93bf-41b9-b65b-b0e5c5e18ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46e34a7090>]}
[0m14:25:56.032328 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_dbt.stg_tpch_order_items ................. [[32mSUCCESS[0m in 39.47s]
[0m14:25:56.032701 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_order_items
[0m14:25:56.033001 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_part_suppliers
[0m14:25:56.033328 [info ] [Thread-1 (]: 2 of 4 START sql table model dbt_dbt.dim_part_suppliers ........................ [RUN]
[0m14:25:56.034121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_order_items, now model.dbt_trino_demo.dim_part_suppliers)
[0m14:25:56.034334 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_part_suppliers
[0m14:25:56.042607 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m14:25:56.043020 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (compile): 14:25:56.034447 => 14:25:56.042888
[0m14:25:56.043216 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_part_suppliers
[0m14:25:56.045888 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt_dbt"."dim_part_suppliers"
[0m14:25:56.046362 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m14:25:56.046554 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

    drop table if exists "lakehouse"."dbt_dbt"."dim_part_suppliers"
[0m14:25:56.046817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:56.891985 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:25:56.893239 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_part_suppliers"
[0m14:25:56.897814 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m14:25:56.898158 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
    )
[0m14:26:03.854213 [debug] [Thread-1 (]: SQL status: SUCCESS in 7.0 seconds
[0m14:26:03.855938 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (execute): 14:25:56.043326 => 14:26:03.855803
[0m14:26:03.856171 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: ROLLBACK
[0m14:26:03.856349 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: Close
[0m14:26:03.857464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e3c66ac-93bf-41b9-b65b-b0e5c5e18ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46e36a9350>]}
[0m14:26:03.857892 [info ] [Thread-1 (]: 2 of 4 OK created sql table model dbt_dbt.dim_part_suppliers ................... [[32mSUCCESS[0m in 7.82s]
[0m14:26:03.858357 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_part_suppliers
[0m14:26:03.858702 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_suppliers
[0m14:26:03.858989 [info ] [Thread-1 (]: 3 of 4 START sql table model dbt_dbt.dim_suppliers ............................. [RUN]
[0m14:26:03.859630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.dim_part_suppliers, now model.dbt_trino_demo.dim_suppliers)
[0m14:26:03.859849 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_suppliers
[0m14:26:03.866077 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_suppliers"
[0m14:26:03.866610 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (compile): 14:26:03.859964 => 14:26:03.866424
[0m14:26:03.866899 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_suppliers
[0m14:26:03.869757 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt_dbt"."dim_suppliers"
[0m14:26:03.870273 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m14:26:03.870571 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt_dbt"."dim_suppliers"
[0m14:26:03.870753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:04.846684 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:26:04.848749 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_suppliers"
[0m14:26:04.850887 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m14:26:04.851174 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt"."dim_suppliers"
      
      
    as (
      
with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m14:26:05.652000 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:26:05.655301 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (execute): 14:26:03.867048 => 14:26:05.655065
[0m14:26:05.655697 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: ROLLBACK
[0m14:26:05.655903 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: Close
[0m14:26:05.657072 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e3c66ac-93bf-41b9-b65b-b0e5c5e18ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46e3105dd0>]}
[0m14:26:05.657443 [info ] [Thread-1 (]: 3 of 4 OK created sql table model dbt_dbt.dim_suppliers ........................ [[32mSUCCESS[0m in 1.80s]
[0m14:26:05.657792 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_suppliers
[0m14:26:05.658084 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.fct_orders_items
[0m14:26:05.658368 [info ] [Thread-1 (]: 4 of 4 START sql table model dbt_dbt.fct_orders_items .......................... [RUN]
[0m14:26:05.658944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.dim_suppliers, now model.dbt_trino_demo.fct_orders_items)
[0m14:26:05.659151 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.fct_orders_items
[0m14:26:05.666355 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.fct_orders_items"
[0m14:26:05.666736 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.fct_orders_items (compile): 14:26:05.659267 => 14:26:05.666603
[0m14:26:05.666930 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.fct_orders_items
[0m14:26:05.668617 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.fct_orders_items"
[0m14:26:05.671415 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.fct_orders_items"
[0m14:26:05.671654 [debug] [Thread-1 (]: On model.dbt_trino_demo.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.fct_orders_items"} */

  
    

    create table "lakehouse"."dbt_dbt"."fct_orders_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), orders_items as (
    
    select * from "lakehouse"."dbt_dbt"."stg_tpch_order_items"

),
parts_suppliers as (
    
    select * from __dbt__cte__stg_tpch_part_suppliers

),
final as (
    select 

        o.order_item_key,
        o.order_key,
        o.order_date,
        o.customer_key,
        o.order_status_code,
        
        o.part_key,
        o.supplier_key,
        o.return_status_code,
        o.order_line_number,
        o.order_line_status_code,
        o.ship_date,
        o.commit_date,
        o.receipt_date,
        o.ship_mode_name,
        ps.supplier_cost_amount,
        
        o.base_price,
        o.discount_percentage,
        o.discounted_price,
        o.tax_rate,
        
        1 as order_item_count,
        o.quantity,

        o.gross_item_sales_amount,
        o.discounted_item_sales_amount,
        o.item_discount_amount,
        o.item_tax_amount,
        o.net_item_sales_amount

    from
        orders_items o
        join
        parts_suppliers ps
            on o.part_key = ps.part_key and
                o.supplier_key = ps.supplier_key
)
select *

from
    final f
order by
    f.order_date
    )
[0m14:26:05.671865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:06.256453 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231213_132606_00311_scdwh
[0m14:26:06.256892 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=ICEBERG_CANNOT_OPEN_SPLIT, message="Error opening Iceberg split file:/stackable/warehouse/dbt_dbt.db/stg_tpch_order_items-eefd191ee2594ac39b89d3727a124f0e/data/20231213_132518_00306_scdwh-ed7a3f7c-379c-42cd-ab1c-1ed200e348d1.parquet (offset=0, length=16662526): file:/stackable/warehouse/dbt_dbt.db/stg_tpch_order_items-eefd191ee2594ac39b89d3727a124f0e/data/20231213_132518_00306_scdwh-ed7a3f7c-379c-42cd-ab1c-1ed200e348d1.parquet", query_id=20231213_132606_00311_scdwh)
[0m14:26:06.257314 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.fct_orders_items (execute): 14:26:05.667039 => 14:26:06.257162
[0m14:26:06.257576 [debug] [Thread-1 (]: On model.dbt_trino_demo.fct_orders_items: ROLLBACK
[0m14:26:06.257788 [debug] [Thread-1 (]: On model.dbt_trino_demo.fct_orders_items: Close
[0m14:26:06.261035 [debug] [Thread-1 (]: Database Error in model fct_orders_items (models/mart/fct_orders_items.sql)
  TrinoExternalError(type=EXTERNAL, name=ICEBERG_CANNOT_OPEN_SPLIT, message="Error opening Iceberg split file:/stackable/warehouse/dbt_dbt.db/stg_tpch_order_items-eefd191ee2594ac39b89d3727a124f0e/data/20231213_132518_00306_scdwh-ed7a3f7c-379c-42cd-ab1c-1ed200e348d1.parquet (offset=0, length=16662526): file:/stackable/warehouse/dbt_dbt.db/stg_tpch_order_items-eefd191ee2594ac39b89d3727a124f0e/data/20231213_132518_00306_scdwh-ed7a3f7c-379c-42cd-ab1c-1ed200e348d1.parquet", query_id=20231213_132606_00311_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/fct_orders_items.sql
[0m14:26:06.262283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e3c66ac-93bf-41b9-b65b-b0e5c5e18ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46e36a9350>]}
[0m14:26:06.262773 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model dbt_dbt.fct_orders_items ................. [[31mERROR[0m in 0.60s]
[0m14:26:06.263275 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.fct_orders_items
[0m14:26:06.265171 [debug] [MainThread]: On master: COMMIT
[0m14:26:06.265822 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:26:06.266073 [debug] [MainThread]: Connection 'model.dbt_trino_demo.fct_orders_items' was properly closed.
[0m14:26:06.266367 [info ] [MainThread]: 
[0m14:26:06.266713 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 51.55 seconds (51.55s).
[0m14:26:06.267753 [debug] [MainThread]: Command end result
[0m14:26:06.276109 [info ] [MainThread]: 
[0m14:26:06.276433 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:26:06.276689 [info ] [MainThread]: 
[0m14:26:06.276948 [error] [MainThread]:   Database Error in model fct_orders_items (models/mart/fct_orders_items.sql)
  TrinoExternalError(type=EXTERNAL, name=ICEBERG_CANNOT_OPEN_SPLIT, message="Error opening Iceberg split file:/stackable/warehouse/dbt_dbt.db/stg_tpch_order_items-eefd191ee2594ac39b89d3727a124f0e/data/20231213_132518_00306_scdwh-ed7a3f7c-379c-42cd-ab1c-1ed200e348d1.parquet (offset=0, length=16662526): file:/stackable/warehouse/dbt_dbt.db/stg_tpch_order_items-eefd191ee2594ac39b89d3727a124f0e/data/20231213_132518_00306_scdwh-ed7a3f7c-379c-42cd-ab1c-1ed200e348d1.parquet", query_id=20231213_132606_00311_scdwh)
  compiled Code at target/run/dbt_trino_demo/models/mart/fct_orders_items.sql
[0m14:26:06.277208 [info ] [MainThread]: 
[0m14:26:06.277430 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m14:26:06.278027 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 51.78589, "process_user_time": 1.801689, "process_kernel_time": 0.201252, "process_mem_max_rss": "112060", "process_out_blocks": "2568", "command_success": false, "process_in_blocks": "0"}
[0m14:26:06.278360 [debug] [MainThread]: Command `dbt run` failed at 14:26:06.278287 after 51.79 seconds
[0m14:26:06.278576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46e7d43a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46e7d43850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46e2f40590>]}
[0m14:26:06.278769 [debug] [MainThread]: Flushing usage events
[0m15:03:23.566640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde7541f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde7544dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde75af5810>]}


============================== 15:03:23.568785 | 4359fa96-3ab5-4b57-84bd-f02e7f4bc815 ==============================
[0m15:03:23.568785 [info ] [MainThread]: Running with dbt=1.7.3
[0m15:03:23.569276 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:03:23.687101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4359fa96-3ab5-4b57-84bd-f02e7f4bc815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde75242690>]}
[0m15:03:23.742612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4359fa96-3ab5-4b57-84bd-f02e7f4bc815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde758b0310>]}
[0m15:03:23.743022 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m15:03:23.750031 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m15:03:23.759374 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:03:23.759676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4359fa96-3ab5-4b57-84bd-f02e7f4bc815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde74e93050>]}
[0m15:03:24.493686 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_trino_iceberg
[0m15:03:24.497262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4359fa96-3ab5-4b57-84bd-f02e7f4bc815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde7504fbd0>]}
[0m15:03:24.505455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4359fa96-3ab5-4b57-84bd-f02e7f4bc815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde63c26c10>]}
[0m15:03:24.505806 [info ] [MainThread]: Found 12 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m15:03:24.506045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4359fa96-3ab5-4b57-84bd-f02e7f4bc815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde751ea910>]}
[0m15:03:24.507376 [info ] [MainThread]: 
[0m15:03:24.508181 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m15:03:24.509555 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m15:03:24.519995 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m15:03:24.520260 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m15:03:24.520432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:25.707615 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m15:03:25.709197 [debug] [ThreadPool]: On list_lakehouse: Close
[0m15:03:25.711351 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m15:03:25.716716 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m15:03:25.717138 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m15:03:25.717318 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:03:26.360985 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m15:03:26.363584 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m15:03:26.364049 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m15:03:26.366453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4359fa96-3ab5-4b57-84bd-f02e7f4bc815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde7520d710>]}
[0m15:03:26.366897 [debug] [MainThread]: On master: COMMIT
[0m15:03:26.367471 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:03:26.367704 [info ] [MainThread]: 
[0m15:03:26.370178 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m15:03:26.370677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_demo.stg_tpch_customers)
[0m15:03:26.370930 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m15:03:26.373075 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m15:03:26.373887 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 15:03:26.371111 => 15:03:26.373703
[0m15:03:26.374521 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m15:03:26.374788 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m15:03:26.375152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m15:03:26.375376 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m15:03:26.377292 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m15:03:26.377918 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 15:03:26.375535 => 15:03:26.377760
[0m15:03:26.378401 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m15:03:26.378636 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m15:03:26.378987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m15:03:26.379192 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m15:03:26.381055 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m15:03:26.381624 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 15:03:26.379318 => 15:03:26.381447
[0m15:03:26.382096 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m15:03:26.382341 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m15:03:26.382806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m15:03:26.383014 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m15:03:26.384611 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m15:03:26.385156 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 15:03:26.383139 => 15:03:26.385002
[0m15:03:26.385728 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m15:03:26.385968 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m15:03:26.386330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m15:03:26.386535 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m15:03:26.389228 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m15:03:26.390142 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 15:03:26.386669 => 15:03:26.389948
[0m15:03:26.390785 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m15:03:26.391141 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m15:03:26.391571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m15:03:26.391786 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m15:03:26.394577 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m15:03:26.394997 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 15:03:26.391916 => 15:03:26.394859
[0m15:03:26.395480 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m15:03:26.395720 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m15:03:26.396073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m15:03:26.396291 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m15:03:26.398082 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m15:03:26.398459 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 15:03:26.396420 => 15:03:26.398326
[0m15:03:26.398941 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m15:03:26.399175 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m15:03:26.399587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m15:03:26.399789 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m15:03:26.401562 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m15:03:26.402040 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 15:03:26.399914 => 15:03:26.401893
[0m15:03:26.402517 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m15:03:26.402749 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_order_items
[0m15:03:26.403016 [info ] [Thread-1 (]: 1 of 4 START sql view model dbt.stg_tpch_order_items ........................... [RUN]
[0m15:03:26.403481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_supplier, now model.dbt_trino_demo.stg_tpch_order_items)
[0m15:03:26.403889 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_order_items
[0m15:03:26.416167 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_order_items"
[0m15:03:26.416792 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_order_items (compile): 15:03:26.404058 => 15:03:26.416626
[0m15:03:26.417016 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.stg_tpch_order_items
[0m15:03:26.429730 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.stg_tpch_order_items"
[0m15:03:26.434097 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.stg_tpch_order_items"
[0m15:03:26.434403 [debug] [Thread-1 (]: On model.dbt_trino_demo.stg_tpch_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.stg_tpch_order_items"} */

  create or replace view
    "lakehouse"."dbt"."stg_tpch_order_items"
  security definer
  as
    with  __dbt__cte__stg_tpch_orders as (

select
    orderkey as order_key, 
    custkey as customer_key,
    orderstatus as order_status_code,
    totalprice as order_amount,
    orderdate as order_date,
    orderpriority as order_priority_code,
    clerk as order_clerk_name,
    shippriority as shipping_priority,
    comment as order_comment
from
    tpch.sf1.orders
),  __dbt__cte__stg_tpch_line_item as (

select
    orderkey as order_key,
    partkey as part_key,
    suppkey as supplier_key,
    linenumber as order_line_number,
    quantity as quantity,
    extendedprice as extended_price,
    discount as discount_percentage,
    tax as tax_rate,
    returnflag as return_status_code,
    linestatus as order_line_status_code,
    shipdate as ship_date,
    commitdate as commit_date,
    receiptdate as receipt_date,
    shipinstruct as ship_instructions_desc,
    shipmode as ship_mode_name,
    comment as order_line_comment
from
    tpch.sf1.lineitem
), orders as (
    
    select * from __dbt__cte__stg_tpch_orders

),
line_items as (

    select * from __dbt__cte__stg_tpch_line_item

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(o.order_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l.order_line_number as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as order_item_key,

    o.order_key,
    o.order_date,
    o.customer_key,
    o.order_status_code,
    
    l.part_key,
    l.supplier_key,
    l.return_status_code,
    l.order_line_number,
    l.order_line_status_code,
    l.ship_date,
    l.commit_date,
    l.receipt_date,
    l.ship_mode_name,

    l.quantity,
    
    -- extended_price is actually the line item total,
    -- so we back out the extended price per item
    (l.extended_price/nullif(l.quantity, 0)) as base_price,
    l.discount_percentage,
    ((l.extended_price/nullif(l.quantity, 0)) * (1 - l.discount_percentage)) as discounted_price,

    l.extended_price as gross_item_sales_amount,
    (l.extended_price * (1 - l.discount_percentage)) as discounted_item_sales_amount,
    -- We model discounts as negative amounts
    (-1 * l.extended_price * l.discount_percentage) as item_discount_amount,
    l.tax_rate,
    ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate) as item_tax_amount,
    (
        l.extended_price + 
        (-1 * l.extended_price * l.discount_percentage) + 
        ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate)
    ) as net_item_sales_amount

from
    orders o
    join
    line_items l
        on o.order_key = l.order_key
order by
    o.order_date
  
[0m15:03:26.434652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:27.007773 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m15:03:27.018280 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_order_items (execute): 15:03:26.417128 => 15:03:27.018147
[0m15:03:27.018513 [debug] [Thread-1 (]: On model.dbt_trino_demo.stg_tpch_order_items: ROLLBACK
[0m15:03:27.018693 [debug] [Thread-1 (]: On model.dbt_trino_demo.stg_tpch_order_items: Close
[0m15:03:27.019741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4359fa96-3ab5-4b57-84bd-f02e7f4bc815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde63a1b990>]}
[0m15:03:27.020089 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbt.stg_tpch_order_items ...................... [[32mSUCCESS[0m in 0.62s]
[0m15:03:27.020460 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_order_items
[0m15:03:27.020926 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_part_suppliers
[0m15:03:27.021221 [info ] [Thread-1 (]: 2 of 4 START sql view model dbt.dim_part_suppliers ............................. [RUN]
[0m15:03:27.021931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_order_items, now model.dbt_trino_demo.dim_part_suppliers)
[0m15:03:27.022205 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_part_suppliers
[0m15:03:27.031370 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m15:03:27.031858 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (compile): 15:03:27.022345 => 15:03:27.031714
[0m15:03:27.032057 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_part_suppliers
[0m15:03:27.034799 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_part_suppliers"
[0m15:03:27.039141 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m15:03:27.039771 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

  create or replace view
    "lakehouse"."dbt"."dim_part_suppliers"
  security definer
  as
    with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
  
[0m15:03:27.040272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:27.580644 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m15:03:27.584763 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (execute): 15:03:27.032171 => 15:03:27.584548
[0m15:03:27.585073 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: ROLLBACK
[0m15:03:27.585428 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: Close
[0m15:03:27.586923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4359fa96-3ab5-4b57-84bd-f02e7f4bc815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde63a69610>]}
[0m15:03:27.587321 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dbt.dim_part_suppliers ........................ [[32mSUCCESS[0m in 0.57s]
[0m15:03:27.587670 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_part_suppliers
[0m15:03:27.587968 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_suppliers
[0m15:03:27.588352 [info ] [Thread-1 (]: 3 of 4 START sql table model dbt.dim_suppliers ................................. [RUN]
[0m15:03:27.588790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.dim_part_suppliers, now model.dbt_trino_demo.dim_suppliers)
[0m15:03:27.589009 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_suppliers
[0m15:03:27.593863 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_suppliers"
[0m15:03:27.594309 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (compile): 15:03:27.589126 => 15:03:27.594179
[0m15:03:27.594506 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_suppliers
[0m15:03:27.615091 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_suppliers"
[0m15:03:27.617399 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m15:03:27.617675 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt"."dim_suppliers__dbt_tmp"
      
      
    as (
      
with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m15:03:27.617887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:32.790231 [debug] [Thread-1 (]: SQL status: SUCCESS in 5.0 seconds
[0m15:03:32.797063 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m15:03:32.797319 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */
alter table "lakehouse"."dbt"."dim_suppliers__dbt_tmp" rename to "lakehouse"."dbt"."dim_suppliers"
[0m15:03:33.367366 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m15:03:33.376036 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."dim_suppliers__dbt_backup"
[0m15:03:33.377338 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m15:03:33.377568 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt"."dim_suppliers__dbt_backup"
[0m15:03:33.533049 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:03:33.535840 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (execute): 15:03:27.594621 => 15:03:33.535637
[0m15:03:33.536196 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: ROLLBACK
[0m15:03:33.536491 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: Close
[0m15:03:33.538213 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4359fa96-3ab5-4b57-84bd-f02e7f4bc815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde63d39e90>]}
[0m15:03:33.538855 [info ] [Thread-1 (]: 3 of 4 OK created sql table model dbt.dim_suppliers ............................ [[32mSUCCESS[0m in 5.95s]
[0m15:03:33.539465 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_suppliers
[0m15:03:33.539957 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.fct_orders_items
[0m15:03:33.540490 [info ] [Thread-1 (]: 4 of 4 START sql view model dbt.fct_orders_items ............................... [RUN]
[0m15:03:33.541898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.dim_suppliers, now model.dbt_trino_demo.fct_orders_items)
[0m15:03:33.542264 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.fct_orders_items
[0m15:03:33.553766 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.fct_orders_items"
[0m15:03:33.554749 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.fct_orders_items (compile): 15:03:33.542459 => 15:03:33.554491
[0m15:03:33.555080 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.fct_orders_items
[0m15:03:33.557773 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.fct_orders_items"
[0m15:03:33.561557 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.fct_orders_items"
[0m15:03:33.561942 [debug] [Thread-1 (]: On model.dbt_trino_demo.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.fct_orders_items"} */

  create or replace view
    "lakehouse"."dbt"."fct_orders_items"
  security definer
  as
    with  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), orders_items as (
    
    select * from "lakehouse"."dbt"."stg_tpch_order_items"

),
parts_suppliers as (
    
    select * from __dbt__cte__stg_tpch_part_suppliers

),
final as (
    select 

        o.order_item_key,
        o.order_key,
        o.order_date,
        o.customer_key,
        o.order_status_code,
        
        o.part_key,
        o.supplier_key,
        o.return_status_code,
        o.order_line_number,
        o.order_line_status_code,
        o.ship_date,
        o.commit_date,
        o.receipt_date,
        o.ship_mode_name,
        ps.supplier_cost_amount,
        
        o.base_price,
        o.discount_percentage,
        o.discounted_price,
        o.tax_rate,
        
        1 as order_item_count,
        o.quantity,

        o.gross_item_sales_amount,
        o.discounted_item_sales_amount,
        o.item_discount_amount,
        o.item_tax_amount,
        o.net_item_sales_amount

    from
        orders_items o
        join
        parts_suppliers ps
            on o.part_key = ps.part_key and
                o.supplier_key = ps.supplier_key
)
select *

from
    final f
order by
    f.order_date
  
[0m15:03:33.562205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:34.094562 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m15:03:34.097597 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.fct_orders_items (execute): 15:03:33.555255 => 15:03:34.097479
[0m15:03:34.097799 [debug] [Thread-1 (]: On model.dbt_trino_demo.fct_orders_items: ROLLBACK
[0m15:03:34.097970 [debug] [Thread-1 (]: On model.dbt_trino_demo.fct_orders_items: Close
[0m15:03:34.098974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4359fa96-3ab5-4b57-84bd-f02e7f4bc815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde74fa1b50>]}
[0m15:03:34.099310 [info ] [Thread-1 (]: 4 of 4 OK created sql view model dbt.fct_orders_items .......................... [[32mSUCCESS[0m in 0.56s]
[0m15:03:34.099752 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.fct_orders_items
[0m15:03:34.101367 [debug] [MainThread]: On master: COMMIT
[0m15:03:34.101717 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:03:34.101871 [debug] [MainThread]: Connection 'model.dbt_trino_demo.fct_orders_items' was properly closed.
[0m15:03:34.102048 [info ] [MainThread]: 
[0m15:03:34.102245 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 9.59 seconds (9.59s).
[0m15:03:34.102896 [debug] [MainThread]: Command end result
[0m15:03:34.108816 [info ] [MainThread]: 
[0m15:03:34.109203 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:03:34.109464 [info ] [MainThread]: 
[0m15:03:34.109779 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:03:34.110519 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.573468, "process_user_time": 2.401432, "process_kernel_time": 0.143064, "process_mem_max_rss": "117160", "process_out_blocks": "3664", "process_in_blocks": "0"}
[0m15:03:34.110887 [debug] [MainThread]: Command `dbt run` succeeded at 15:03:34.110811 after 10.57 seconds
[0m15:03:34.111153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde79a85090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde74ec60d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde63d61310>]}
[0m15:03:34.111359 [debug] [MainThread]: Flushing usage events
[0m15:41:21.351363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0667db2c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06688f8b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0667dded10>]}


============================== 15:41:21.353101 | 5695e1e1-24fd-4371-9b4e-1e8266726514 ==============================
[0m15:41:21.353101 [info ] [MainThread]: Running with dbt=1.7.3
[0m15:41:21.353448 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:41:21.485008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5695e1e1-24fd-4371-9b4e-1e8266726514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0667df2650>]}
[0m15:41:21.539676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5695e1e1-24fd-4371-9b4e-1e8266726514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0667d87390>]}
[0m15:41:21.540092 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m15:41:21.547575 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m15:41:21.554983 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:41:21.555474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5695e1e1-24fd-4371-9b4e-1e8266726514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0668234310>]}
[0m15:41:22.380892 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_trino_iceberg
[0m15:41:22.386482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5695e1e1-24fd-4371-9b4e-1e8266726514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06678f05d0>]}
[0m15:41:22.397699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5695e1e1-24fd-4371-9b4e-1e8266726514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06667ed690>]}
[0m15:41:22.398166 [info ] [MainThread]: Found 12 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m15:41:22.398588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5695e1e1-24fd-4371-9b4e-1e8266726514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06679ee250>]}
[0m15:41:22.400456 [info ] [MainThread]: 
[0m15:41:22.401335 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m15:41:22.402613 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m15:41:22.414843 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m15:41:22.415375 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m15:41:22.415635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:23.413762 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m15:41:23.414689 [debug] [ThreadPool]: On list_lakehouse: Close
[0m15:41:23.416848 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m15:41:23.421757 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m15:41:23.422182 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m15:41:23.422560 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:41:24.031843 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m15:41:24.032993 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m15:41:24.033220 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m15:41:24.035513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5695e1e1-24fd-4371-9b4e-1e8266726514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06664f47d0>]}
[0m15:41:24.035843 [debug] [MainThread]: On master: COMMIT
[0m15:41:24.036298 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:41:24.036532 [info ] [MainThread]: 
[0m15:41:24.038798 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m15:41:24.039214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_demo.stg_tpch_customers)
[0m15:41:24.039418 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m15:41:24.041692 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m15:41:24.042133 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 15:41:24.039534 => 15:41:24.041991
[0m15:41:24.042714 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m15:41:24.043037 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m15:41:24.043458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m15:41:24.043687 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m15:41:24.045799 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m15:41:24.046465 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 15:41:24.043817 => 15:41:24.046272
[0m15:41:24.047027 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m15:41:24.047281 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m15:41:24.047757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m15:41:24.047981 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m15:41:24.049869 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m15:41:24.050243 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 15:41:24.048122 => 15:41:24.050108
[0m15:41:24.050919 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m15:41:24.051224 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m15:41:24.051580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m15:41:24.051812 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m15:41:24.053892 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m15:41:24.054423 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 15:41:24.051958 => 15:41:24.054254
[0m15:41:24.054893 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m15:41:24.055229 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m15:41:24.055923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m15:41:24.056205 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m15:41:24.058907 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m15:41:24.059420 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 15:41:24.056348 => 15:41:24.059284
[0m15:41:24.059930 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m15:41:24.060165 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m15:41:24.060513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m15:41:24.060840 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m15:41:24.064967 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m15:41:24.065748 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 15:41:24.061214 => 15:41:24.065502
[0m15:41:24.066847 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m15:41:24.067379 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m15:41:24.067843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m15:41:24.068104 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m15:41:24.070293 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m15:41:24.071035 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 15:41:24.068254 => 15:41:24.070811
[0m15:41:24.071610 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m15:41:24.071848 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m15:41:24.072308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m15:41:24.072709 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m15:41:24.075119 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m15:41:24.075703 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 15:41:24.072851 => 15:41:24.075548
[0m15:41:24.076207 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m15:41:24.076458 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_order_items
[0m15:41:24.076822 [info ] [Thread-1 (]: 1 of 4 START sql view model dbt.stg_tpch_order_items ........................... [RUN]
[0m15:41:24.077557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_supplier, now model.dbt_trino_demo.stg_tpch_order_items)
[0m15:41:24.077792 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_order_items
[0m15:41:24.091577 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_order_items"
[0m15:41:24.092243 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_order_items (compile): 15:41:24.077924 => 15:41:24.092055
[0m15:41:24.092639 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.stg_tpch_order_items
[0m15:41:24.106496 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.stg_tpch_order_items"
[0m15:41:24.111776 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.stg_tpch_order_items"
[0m15:41:24.112218 [debug] [Thread-1 (]: On model.dbt_trino_demo.stg_tpch_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.stg_tpch_order_items"} */

  create or replace view
    "lakehouse"."dbt"."stg_tpch_order_items"
  security definer
  as
    with  __dbt__cte__stg_tpch_orders as (

select
    orderkey as order_key, 
    custkey as customer_key,
    orderstatus as order_status_code,
    totalprice as order_amount,
    orderdate as order_date,
    orderpriority as order_priority_code,
    clerk as order_clerk_name,
    shippriority as shipping_priority,
    comment as order_comment
from
    tpch.sf1.orders
),  __dbt__cte__stg_tpch_line_item as (

select
    orderkey as order_key,
    partkey as part_key,
    suppkey as supplier_key,
    linenumber as order_line_number,
    quantity as quantity,
    extendedprice as extended_price,
    discount as discount_percentage,
    tax as tax_rate,
    returnflag as return_status_code,
    linestatus as order_line_status_code,
    shipdate as ship_date,
    commitdate as commit_date,
    receiptdate as receipt_date,
    shipinstruct as ship_instructions_desc,
    shipmode as ship_mode_name,
    comment as order_line_comment
from
    tpch.sf1.lineitem
), orders as (
    
    select * from __dbt__cte__stg_tpch_orders

),
line_items as (

    select * from __dbt__cte__stg_tpch_line_item

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(o.order_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l.order_line_number as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as order_item_key,

    o.order_key,
    o.order_date,
    o.customer_key,
    o.order_status_code,
    
    l.part_key,
    l.supplier_key,
    l.return_status_code,
    l.order_line_number,
    l.order_line_status_code,
    l.ship_date,
    l.commit_date,
    l.receipt_date,
    l.ship_mode_name,

    l.quantity,
    
    -- extended_price is actually the line item total,
    -- so we back out the extended price per item
    (l.extended_price/nullif(l.quantity, 0)) as base_price,
    l.discount_percentage,
    ((l.extended_price/nullif(l.quantity, 0)) * (1 - l.discount_percentage)) as discounted_price,

    l.extended_price as gross_item_sales_amount,
    (l.extended_price * (1 - l.discount_percentage)) as discounted_item_sales_amount,
    -- We model discounts as negative amounts
    (-1 * l.extended_price * l.discount_percentage) as item_discount_amount,
    l.tax_rate,
    ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate) as item_tax_amount,
    (
        l.extended_price + 
        (-1 * l.extended_price * l.discount_percentage) + 
        ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate)
    ) as net_item_sales_amount

from
    orders o
    join
    line_items l
        on o.order_key = l.order_key
order by
    o.order_date
  
[0m15:41:24.112512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:24.431379 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:41:24.443819 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_order_items (execute): 15:41:24.092823 => 15:41:24.443679
[0m15:41:24.444081 [debug] [Thread-1 (]: On model.dbt_trino_demo.stg_tpch_order_items: ROLLBACK
[0m15:41:24.444273 [debug] [Thread-1 (]: On model.dbt_trino_demo.stg_tpch_order_items: Close
[0m15:41:24.445483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5695e1e1-24fd-4371-9b4e-1e8266726514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f066670b1d0>]}
[0m15:41:24.445854 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbt.stg_tpch_order_items ...................... [[32mSUCCESS[0m in 0.37s]
[0m15:41:24.446242 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_order_items
[0m15:41:24.446528 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_part_suppliers
[0m15:41:24.446832 [info ] [Thread-1 (]: 2 of 4 START sql view model dbt.dim_part_suppliers ............................. [RUN]
[0m15:41:24.447660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_order_items, now model.dbt_trino_demo.dim_part_suppliers)
[0m15:41:24.447871 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_part_suppliers
[0m15:41:24.458241 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m15:41:24.458868 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (compile): 15:41:24.448086 => 15:41:24.458617
[0m15:41:24.460561 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_part_suppliers
[0m15:41:24.462512 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_part_suppliers"
[0m15:41:24.468279 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m15:41:24.468730 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

  create or replace view
    "lakehouse"."dbt"."dim_part_suppliers"
  security definer
  as
    with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
  
[0m15:41:24.469035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:24.953072 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:41:24.954928 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (execute): 15:41:24.460689 => 15:41:24.954790
[0m15:41:24.955255 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: ROLLBACK
[0m15:41:24.955466 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: Close
[0m15:41:24.956642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5695e1e1-24fd-4371-9b4e-1e8266726514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0666558810>]}
[0m15:41:24.957099 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dbt.dim_part_suppliers ........................ [[32mSUCCESS[0m in 0.51s]
[0m15:41:24.957531 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_part_suppliers
[0m15:41:24.957837 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_suppliers
[0m15:41:24.958092 [info ] [Thread-1 (]: 3 of 4 START sql table model dbt.dim_suppliers ................................. [RUN]
[0m15:41:24.958719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.dim_part_suppliers, now model.dbt_trino_demo.dim_suppliers)
[0m15:41:24.958949 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_suppliers
[0m15:41:24.964127 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_suppliers"
[0m15:41:24.964574 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (compile): 15:41:24.959062 => 15:41:24.964388
[0m15:41:24.964801 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_suppliers
[0m15:41:24.988968 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_suppliers"
[0m15:41:24.991414 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m15:41:24.991702 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt"."dim_suppliers__dbt_tmp"
      
      
    as (
      
with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m15:41:24.991916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:26.323261 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m15:41:26.327452 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m15:41:26.327685 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */
alter table "lakehouse"."dbt"."dim_suppliers" rename to "lakehouse"."dbt"."dim_suppliers__dbt_backup"
[0m15:41:26.796229 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:41:26.799027 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m15:41:26.803150 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */
alter table "lakehouse"."dbt"."dim_suppliers__dbt_tmp" rename to "lakehouse"."dbt"."dim_suppliers"
[0m15:41:27.253932 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:41:27.260148 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."dim_suppliers__dbt_backup"
[0m15:41:27.263163 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m15:41:27.263539 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt"."dim_suppliers__dbt_backup"
[0m15:41:27.773172 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m15:41:27.775844 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (execute): 15:41:24.964924 => 15:41:27.775646
[0m15:41:27.776232 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: ROLLBACK
[0m15:41:27.776428 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: Close
[0m15:41:27.777589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5695e1e1-24fd-4371-9b4e-1e8266726514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06665cc390>]}
[0m15:41:27.777978 [info ] [Thread-1 (]: 3 of 4 OK created sql table model dbt.dim_suppliers ............................ [[32mSUCCESS[0m in 2.82s]
[0m15:41:27.778366 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_suppliers
[0m15:41:27.778663 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.fct_orders_items
[0m15:41:27.778943 [info ] [Thread-1 (]: 4 of 4 START sql view model dbt.fct_orders_items ............................... [RUN]
[0m15:41:27.779848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.dim_suppliers, now model.dbt_trino_demo.fct_orders_items)
[0m15:41:27.780142 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.fct_orders_items
[0m15:41:27.788286 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.fct_orders_items"
[0m15:41:27.788821 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.fct_orders_items (compile): 15:41:27.780301 => 15:41:27.788660
[0m15:41:27.789036 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.fct_orders_items
[0m15:41:27.791880 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.fct_orders_items"
[0m15:41:27.794769 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.fct_orders_items"
[0m15:41:27.795034 [debug] [Thread-1 (]: On model.dbt_trino_demo.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.fct_orders_items"} */

  create or replace view
    "lakehouse"."dbt"."fct_orders_items"
  security definer
  as
    with  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), orders_items as (
    
    select * from "lakehouse"."dbt"."stg_tpch_order_items"

),
parts_suppliers as (
    
    select * from __dbt__cte__stg_tpch_part_suppliers

),
final as (
    select 

        o.order_item_key,
        o.order_key,
        o.order_date,
        o.customer_key,
        o.order_status_code,
        
        o.part_key,
        o.supplier_key,
        o.return_status_code,
        o.order_line_number,
        o.order_line_status_code,
        o.ship_date,
        o.commit_date,
        o.receipt_date,
        o.ship_mode_name,
        ps.supplier_cost_amount,
        
        o.base_price,
        o.discount_percentage,
        o.discounted_price,
        o.tax_rate,
        
        1 as order_item_count,
        o.quantity,

        o.gross_item_sales_amount,
        o.discounted_item_sales_amount,
        o.item_discount_amount,
        o.item_tax_amount,
        o.net_item_sales_amount

    from
        orders_items o
        join
        parts_suppliers ps
            on o.part_key = ps.part_key and
                o.supplier_key = ps.supplier_key
)
select *

from
    final f
order by
    f.order_date
  
[0m15:41:27.795356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:28.642577 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m15:41:28.644963 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.fct_orders_items (execute): 15:41:27.789148 => 15:41:28.644766
[0m15:41:28.645246 [debug] [Thread-1 (]: On model.dbt_trino_demo.fct_orders_items: ROLLBACK
[0m15:41:28.645444 [debug] [Thread-1 (]: On model.dbt_trino_demo.fct_orders_items: Close
[0m15:41:28.646777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5695e1e1-24fd-4371-9b4e-1e8266726514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06666a0bd0>]}
[0m15:41:28.647187 [info ] [Thread-1 (]: 4 of 4 OK created sql view model dbt.fct_orders_items .......................... [[32mSUCCESS[0m in 0.87s]
[0m15:41:28.647557 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.fct_orders_items
[0m15:41:28.649072 [debug] [MainThread]: On master: COMMIT
[0m15:41:28.649555 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:41:28.649714 [debug] [MainThread]: Connection 'model.dbt_trino_demo.fct_orders_items' was properly closed.
[0m15:41:28.649896 [info ] [MainThread]: 
[0m15:41:28.650104 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 6.25 seconds (6.25s).
[0m15:41:28.650769 [debug] [MainThread]: Command end result
[0m15:41:28.657505 [info ] [MainThread]: 
[0m15:41:28.657925 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:41:28.658168 [info ] [MainThread]: 
[0m15:41:28.658411 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:41:28.659078 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.3324575, "process_user_time": 2.560943, "process_kernel_time": 0.123418, "process_mem_max_rss": "115784", "process_out_blocks": "3664", "process_in_blocks": "0"}
[0m15:41:28.659379 [debug] [MainThread]: Command `dbt run` succeeded at 15:41:28.659307 after 7.33 seconds
[0m15:41:28.659591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0667dcce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f066969ff90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06664f80d0>]}
[0m15:41:28.659791 [debug] [MainThread]: Flushing usage events
[0m15:42:53.315896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2b3d3c210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2b3d69fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2b3d1ef50>]}


============================== 15:42:53.317750 | 2e13a183-90ed-4711-b4be-efd8d7847bb3 ==============================
[0m15:42:53.317750 [info ] [MainThread]: Running with dbt=1.7.3
[0m15:42:53.318128 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:42:53.437903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e13a183-90ed-4711-b4be-efd8d7847bb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2b3c302d0>]}
[0m15:42:53.492449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e13a183-90ed-4711-b4be-efd8d7847bb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2b43b42d0>]}
[0m15:42:53.492962 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m15:42:53.500925 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m15:42:53.522786 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:42:53.523102 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:42:53.523871 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_trino_iceberg
[0m15:42:53.529176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e13a183-90ed-4711-b4be-efd8d7847bb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2b394d650>]}
[0m15:42:53.538104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e13a183-90ed-4711-b4be-efd8d7847bb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2b3a87e10>]}
[0m15:42:53.538588 [info ] [MainThread]: Found 12 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m15:42:53.538971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e13a183-90ed-4711-b4be-efd8d7847bb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2b3b82b90>]}
[0m15:42:53.541508 [info ] [MainThread]: 
[0m15:42:53.542335 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m15:42:53.543363 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m15:42:53.556144 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m15:42:53.556435 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m15:42:53.556598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:54.585759 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m15:42:54.586714 [debug] [ThreadPool]: On list_lakehouse: Close
[0m15:42:54.588880 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m15:42:54.594074 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m15:42:54.594375 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m15:42:54.594584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:55.191587 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m15:42:55.192554 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m15:42:55.192743 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m15:42:55.194588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e13a183-90ed-4711-b4be-efd8d7847bb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2b39ae910>]}
[0m15:42:55.194898 [debug] [MainThread]: On master: COMMIT
[0m15:42:55.195265 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:42:55.195492 [info ] [MainThread]: 
[0m15:42:55.197991 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_customers
[0m15:42:55.198482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_demo.stg_tpch_customers)
[0m15:42:55.198705 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_customers
[0m15:42:55.201330 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_customers"
[0m15:42:55.201793 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_customers (compile): 15:42:55.198818 => 15:42:55.201650
[0m15:42:55.202321 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_customers
[0m15:42:55.202647 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_line_item
[0m15:42:55.203037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_customers, now model.dbt_trino_demo.stg_tpch_line_item)
[0m15:42:55.203286 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_line_item
[0m15:42:55.205215 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_line_item"
[0m15:42:55.205746 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_line_item (compile): 15:42:55.203423 => 15:42:55.205593
[0m15:42:55.206290 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_line_item
[0m15:42:55.206532 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_nation
[0m15:42:55.206890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_line_item, now model.dbt_trino_demo.stg_tpch_nation)
[0m15:42:55.207120 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_nation
[0m15:42:55.208894 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_nation"
[0m15:42:55.209442 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_nation (compile): 15:42:55.207255 => 15:42:55.209313
[0m15:42:55.209894 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_nation
[0m15:42:55.210151 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_orders
[0m15:42:55.210680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_nation, now model.dbt_trino_demo.stg_tpch_orders)
[0m15:42:55.210884 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_orders
[0m15:42:55.212713 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_orders"
[0m15:42:55.213213 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_orders (compile): 15:42:55.211072 => 15:42:55.213020
[0m15:42:55.214034 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_orders
[0m15:42:55.214298 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part
[0m15:42:55.214680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_orders, now model.dbt_trino_demo.stg_tpch_part)
[0m15:42:55.214915 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part
[0m15:42:55.217066 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part"
[0m15:42:55.217987 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part (compile): 15:42:55.215057 => 15:42:55.217729
[0m15:42:55.218824 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part
[0m15:42:55.219249 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m15:42:55.219976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part, now model.dbt_trino_demo.stg_tpch_part_suppliers)
[0m15:42:55.220253 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m15:42:55.232988 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_part_suppliers"
[0m15:42:55.233646 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_part_suppliers (compile): 15:42:55.220420 => 15:42:55.233447
[0m15:42:55.234990 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_part_suppliers
[0m15:42:55.236116 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_region
[0m15:42:55.236708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_part_suppliers, now model.dbt_trino_demo.stg_tpch_region)
[0m15:42:55.236988 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_region
[0m15:42:55.239715 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_region"
[0m15:42:55.240206 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_region (compile): 15:42:55.237309 => 15:42:55.240058
[0m15:42:55.240706 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_region
[0m15:42:55.241016 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_supplier
[0m15:42:55.241428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_region, now model.dbt_trino_demo.stg_tpch_supplier)
[0m15:42:55.241878 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_supplier
[0m15:42:55.244313 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_supplier"
[0m15:42:55.244984 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_supplier (compile): 15:42:55.242154 => 15:42:55.244803
[0m15:42:55.245522 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_supplier
[0m15:42:55.245776 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.stg_tpch_order_items
[0m15:42:55.246043 [info ] [Thread-1 (]: 1 of 4 START sql view model dbt.stg_tpch_order_items ........................... [RUN]
[0m15:42:55.246589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_supplier, now model.dbt_trino_demo.stg_tpch_order_items)
[0m15:42:55.246847 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.stg_tpch_order_items
[0m15:42:55.261062 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.stg_tpch_order_items"
[0m15:42:55.261991 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_order_items (compile): 15:42:55.247055 => 15:42:55.261765
[0m15:42:55.262267 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.stg_tpch_order_items
[0m15:42:55.280709 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.stg_tpch_order_items"
[0m15:42:55.286165 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.stg_tpch_order_items"
[0m15:42:55.286589 [debug] [Thread-1 (]: On model.dbt_trino_demo.stg_tpch_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.stg_tpch_order_items"} */

  create or replace view
    "lakehouse"."dbt"."stg_tpch_order_items"
  security definer
  as
    with  __dbt__cte__stg_tpch_orders as (

select
    orderkey as order_key, 
    custkey as customer_key,
    orderstatus as order_status_code,
    totalprice as order_amount,
    orderdate as order_date,
    orderpriority as order_priority_code,
    clerk as order_clerk_name,
    shippriority as shipping_priority,
    comment as order_comment
from
    tpch.sf1.orders
),  __dbt__cte__stg_tpch_line_item as (

select
    orderkey as order_key,
    partkey as part_key,
    suppkey as supplier_key,
    linenumber as order_line_number,
    quantity as quantity,
    extendedprice as extended_price,
    discount as discount_percentage,
    tax as tax_rate,
    returnflag as return_status_code,
    linestatus as order_line_status_code,
    shipdate as ship_date,
    commitdate as commit_date,
    receiptdate as receipt_date,
    shipinstruct as ship_instructions_desc,
    shipmode as ship_mode_name,
    comment as order_line_comment
from
    tpch.sf1.lineitem
), orders as (
    
    select * from __dbt__cte__stg_tpch_orders

),
line_items as (

    select * from __dbt__cte__stg_tpch_line_item

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(o.order_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l.order_line_number as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as order_item_key,

    o.order_key,
    o.order_date,
    o.customer_key,
    o.order_status_code,
    
    l.part_key,
    l.supplier_key,
    l.return_status_code,
    l.order_line_number,
    l.order_line_status_code,
    l.ship_date,
    l.commit_date,
    l.receipt_date,
    l.ship_mode_name,

    l.quantity,
    
    -- extended_price is actually the line item total,
    -- so we back out the extended price per item
    (l.extended_price/nullif(l.quantity, 0)) as base_price,
    l.discount_percentage,
    ((l.extended_price/nullif(l.quantity, 0)) * (1 - l.discount_percentage)) as discounted_price,

    l.extended_price as gross_item_sales_amount,
    (l.extended_price * (1 - l.discount_percentage)) as discounted_item_sales_amount,
    -- We model discounts as negative amounts
    (-1 * l.extended_price * l.discount_percentage) as item_discount_amount,
    l.tax_rate,
    ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate) as item_tax_amount,
    (
        l.extended_price + 
        (-1 * l.extended_price * l.discount_percentage) + 
        ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate)
    ) as net_item_sales_amount

from
    orders o
    join
    line_items l
        on o.order_key = l.order_key
order by
    o.order_date
  
[0m15:42:55.286847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:55.806120 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m15:42:55.818011 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.stg_tpch_order_items (execute): 15:42:55.262405 => 15:42:55.817873
[0m15:42:55.818286 [debug] [Thread-1 (]: On model.dbt_trino_demo.stg_tpch_order_items: ROLLBACK
[0m15:42:55.818478 [debug] [Thread-1 (]: On model.dbt_trino_demo.stg_tpch_order_items: Close
[0m15:42:55.819593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e13a183-90ed-4711-b4be-efd8d7847bb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2b36dbdd0>]}
[0m15:42:55.820120 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbt.stg_tpch_order_items ...................... [[32mSUCCESS[0m in 0.57s]
[0m15:42:55.820568 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.stg_tpch_order_items
[0m15:42:55.820917 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_part_suppliers
[0m15:42:55.821253 [info ] [Thread-1 (]: 2 of 4 START sql view model dbt.dim_part_suppliers ............................. [RUN]
[0m15:42:55.821905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.stg_tpch_order_items, now model.dbt_trino_demo.dim_part_suppliers)
[0m15:42:55.822227 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_part_suppliers
[0m15:42:55.832083 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_part_suppliers"
[0m15:42:55.832746 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (compile): 15:42:55.822367 => 15:42:55.832524
[0m15:42:55.833029 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_part_suppliers
[0m15:42:55.835264 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_part_suppliers"
[0m15:42:55.840585 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_part_suppliers"
[0m15:42:55.841368 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_part_suppliers"} */

  create or replace view
    "lakehouse"."dbt"."dim_part_suppliers"
  security definer
  as
    with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
  
[0m15:42:55.842697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:56.320032 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:42:56.321933 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_part_suppliers (execute): 15:42:55.833144 => 15:42:56.321792
[0m15:42:56.322258 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: ROLLBACK
[0m15:42:56.322441 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_part_suppliers: Close
[0m15:42:56.323708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e13a183-90ed-4711-b4be-efd8d7847bb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2b388aa90>]}
[0m15:42:56.324234 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dbt.dim_part_suppliers ........................ [[32mSUCCESS[0m in 0.50s]
[0m15:42:56.324713 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_part_suppliers
[0m15:42:56.325063 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.dim_suppliers
[0m15:42:56.325359 [info ] [Thread-1 (]: 3 of 4 START sql table model dbt.dim_suppliers ................................. [RUN]
[0m15:42:56.326071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.dim_part_suppliers, now model.dbt_trino_demo.dim_suppliers)
[0m15:42:56.326283 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.dim_suppliers
[0m15:42:56.332226 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.dim_suppliers"
[0m15:42:56.332825 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (compile): 15:42:56.326396 => 15:42:56.332644
[0m15:42:56.333040 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.dim_suppliers
[0m15:42:56.361802 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.dim_suppliers"
[0m15:42:56.366591 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m15:42:56.367166 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt"."dim_suppliers__dbt_tmp"
      
      
    as (
      
with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m15:42:56.367609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:57.444383 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m15:42:57.452631 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m15:42:57.453281 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */
alter table "lakehouse"."dbt"."dim_suppliers" rename to "lakehouse"."dbt"."dim_suppliers__dbt_backup"
[0m15:42:57.963778 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m15:42:57.968169 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m15:42:57.968712 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */
alter table "lakehouse"."dbt"."dim_suppliers__dbt_tmp" rename to "lakehouse"."dbt"."dim_suppliers"
[0m15:42:58.484609 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m15:42:58.489818 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."dim_suppliers__dbt_backup"
[0m15:42:58.491506 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.dim_suppliers"
[0m15:42:58.491820 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt"."dim_suppliers__dbt_backup"
[0m15:42:58.987189 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:42:58.988806 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.dim_suppliers (execute): 15:42:56.333150 => 15:42:58.988661
[0m15:42:58.989006 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: ROLLBACK
[0m15:42:58.989189 [debug] [Thread-1 (]: On model.dbt_trino_demo.dim_suppliers: Close
[0m15:42:58.990291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e13a183-90ed-4711-b4be-efd8d7847bb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2b3a7aa90>]}
[0m15:42:58.990654 [info ] [Thread-1 (]: 3 of 4 OK created sql table model dbt.dim_suppliers ............................ [[32mSUCCESS[0m in 2.66s]
[0m15:42:58.991082 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.dim_suppliers
[0m15:42:58.991408 [debug] [Thread-1 (]: Began running node model.dbt_trino_demo.fct_orders_items
[0m15:42:58.991708 [info ] [Thread-1 (]: 4 of 4 START sql view model dbt.fct_orders_items ............................... [RUN]
[0m15:42:58.992362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_demo.dim_suppliers, now model.dbt_trino_demo.fct_orders_items)
[0m15:42:58.992577 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_demo.fct_orders_items
[0m15:42:59.000338 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_demo.fct_orders_items"
[0m15:42:59.000904 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.fct_orders_items (compile): 15:42:58.992690 => 15:42:59.000720
[0m15:42:59.001203 [debug] [Thread-1 (]: Began executing node model.dbt_trino_demo.fct_orders_items
[0m15:42:59.003177 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_demo.fct_orders_items"
[0m15:42:59.006144 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_demo.fct_orders_items"
[0m15:42:59.006429 [debug] [Thread-1 (]: On model.dbt_trino_demo.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_demo.fct_orders_items"} */

  create or replace view
    "lakehouse"."dbt"."fct_orders_items"
  security definer
  as
    with  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), orders_items as (
    
    select * from "lakehouse"."dbt"."stg_tpch_order_items"

),
parts_suppliers as (
    
    select * from __dbt__cte__stg_tpch_part_suppliers

),
final as (
    select 

        o.order_item_key,
        o.order_key,
        o.order_date,
        o.customer_key,
        o.order_status_code,
        
        o.part_key,
        o.supplier_key,
        o.return_status_code,
        o.order_line_number,
        o.order_line_status_code,
        o.ship_date,
        o.commit_date,
        o.receipt_date,
        o.ship_mode_name,
        ps.supplier_cost_amount,
        
        o.base_price,
        o.discount_percentage,
        o.discounted_price,
        o.tax_rate,
        
        1 as order_item_count,
        o.quantity,

        o.gross_item_sales_amount,
        o.discounted_item_sales_amount,
        o.item_discount_amount,
        o.item_tax_amount,
        o.net_item_sales_amount

    from
        orders_items o
        join
        parts_suppliers ps
            on o.part_key = ps.part_key and
                o.supplier_key = ps.supplier_key
)
select *

from
    final f
order by
    f.order_date
  
[0m15:42:59.006652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:59.869094 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m15:42:59.870912 [debug] [Thread-1 (]: Timing info for model.dbt_trino_demo.fct_orders_items (execute): 15:42:59.001341 => 15:42:59.870788
[0m15:42:59.871152 [debug] [Thread-1 (]: On model.dbt_trino_demo.fct_orders_items: ROLLBACK
[0m15:42:59.871333 [debug] [Thread-1 (]: On model.dbt_trino_demo.fct_orders_items: Close
[0m15:42:59.872469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e13a183-90ed-4711-b4be-efd8d7847bb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2b38cb9d0>]}
[0m15:42:59.872835 [info ] [Thread-1 (]: 4 of 4 OK created sql view model dbt.fct_orders_items .......................... [[32mSUCCESS[0m in 0.88s]
[0m15:42:59.873244 [debug] [Thread-1 (]: Finished running node model.dbt_trino_demo.fct_orders_items
[0m15:42:59.874665 [debug] [MainThread]: On master: COMMIT
[0m15:42:59.875051 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:59.875205 [debug] [MainThread]: Connection 'model.dbt_trino_demo.fct_orders_items' was properly closed.
[0m15:42:59.875386 [info ] [MainThread]: 
[0m15:42:59.875589 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 6.33 seconds (6.33s).
[0m15:42:59.876265 [debug] [MainThread]: Command end result
[0m15:42:59.883475 [info ] [MainThread]: 
[0m15:42:59.883923 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:42:59.884228 [info ] [MainThread]: 
[0m15:42:59.884448 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:42:59.885110 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.5973186, "process_user_time": 1.749924, "process_kernel_time": 0.119994, "process_mem_max_rss": "110924", "process_out_blocks": "2568", "process_in_blocks": "0"}
[0m15:42:59.885418 [debug] [MainThread]: Command `dbt run` succeeded at 15:42:59.885348 after 6.60 seconds
[0m15:42:59.885619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2b3d6bc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2b3d6bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2b83a1250>]}
[0m15:42:59.885903 [debug] [MainThread]: Flushing usage events
[0m15:45:40.687653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d01acfdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d02634c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d01acdc50>]}


============================== 15:45:40.689495 | 519e81b8-d267-461e-a4b0-e980693c5d49 ==============================
[0m15:45:40.689495 [info ] [MainThread]: Running with dbt=1.7.3
[0m15:45:40.689919 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:45:40.821482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '519e81b8-d267-461e-a4b0-e980693c5d49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d01accad0>]}
[0m15:45:40.876179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '519e81b8-d267-461e-a4b0-e980693c5d49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d0172e3d0>]}
[0m15:45:40.876716 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m15:45:40.884099 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m15:45:40.891725 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m15:45:40.892141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '519e81b8-d267-461e-a4b0-e980693c5d49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d0185c910>]}
[0m15:45:41.738858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '519e81b8-d267-461e-a4b0-e980693c5d49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d0072cb10>]}
[0m15:45:41.748348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '519e81b8-d267-461e-a4b0-e980693c5d49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d01829690>]}
[0m15:45:41.748762 [info ] [MainThread]: Found 12 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m15:45:41.749044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '519e81b8-d267-461e-a4b0-e980693c5d49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d018bf450>]}
[0m15:45:41.750521 [info ] [MainThread]: 
[0m15:45:41.751211 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m15:45:41.752622 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m15:45:41.766437 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m15:45:41.766763 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m15:45:41.766975 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:42.910977 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m15:45:42.912465 [debug] [ThreadPool]: On list_lakehouse: Close
[0m15:45:42.914276 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now create_lakehouse_dbt_dbt2)
[0m15:45:42.915001 [debug] [ThreadPool]: Creating schema "database: "lakehouse"
schema: "dbt_dbt2"
"
[0m15:45:42.918381 [debug] [ThreadPool]: Using trino connection "create_lakehouse_dbt_dbt2"
[0m15:45:42.918629 [debug] [ThreadPool]: On create_lakehouse_dbt_dbt2: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "create_lakehouse_dbt_dbt2"} */
create schema if not exists "lakehouse"."dbt_dbt2"
[0m15:45:42.918786 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:45:43.354517 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:45:43.355328 [debug] [ThreadPool]: On create_lakehouse_dbt_dbt2: COMMIT
[0m15:45:43.355586 [debug] [ThreadPool]: On create_lakehouse_dbt_dbt2: Close
[0m15:45:43.358146 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lakehouse_dbt_dbt2, now list_lakehouse_dbt_dbt2)
[0m15:45:43.364778 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt_dbt2"
[0m15:45:43.365087 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt2: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt_dbt2"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt_dbt2') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt_dbt2'
[0m15:45:43.365365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:45:44.019605 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m15:45:44.020484 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt2: ROLLBACK
[0m15:45:44.020701 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt2: Close
[0m15:45:44.022287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '519e81b8-d267-461e-a4b0-e980693c5d49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d01555550>]}
[0m15:45:44.022643 [debug] [MainThread]: On master: COMMIT
[0m15:45:44.023058 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:45:44.023356 [info ] [MainThread]: 
[0m15:45:44.026408 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_customers
[0m15:45:44.026892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt_dbt2, now model.dbt_trino_iceberg.stg_tpch_customers)
[0m15:45:44.027116 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_customers
[0m15:45:44.029091 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_customers"
[0m15:45:44.030526 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_customers (compile): 15:45:44.027232 => 15:45:44.030339
[0m15:45:44.031229 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_customers
[0m15:45:44.031988 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m15:45:44.032529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_customers, now model.dbt_trino_iceberg.stg_tpch_line_item)
[0m15:45:44.032807 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_line_item
[0m15:45:44.035416 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_line_item"
[0m15:45:44.036251 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_line_item (compile): 15:45:44.032985 => 15:45:44.036006
[0m15:45:44.037151 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m15:45:44.037714 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_nation
[0m15:45:44.038641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_line_item, now model.dbt_trino_iceberg.stg_tpch_nation)
[0m15:45:44.039066 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_nation
[0m15:45:44.044825 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_nation"
[0m15:45:44.045869 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_nation (compile): 15:45:44.039494 => 15:45:44.045627
[0m15:45:44.046651 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_nation
[0m15:45:44.047024 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_orders
[0m15:45:44.047654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_nation, now model.dbt_trino_iceberg.stg_tpch_orders)
[0m15:45:44.048148 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_orders
[0m15:45:44.053816 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_orders"
[0m15:45:44.055326 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_orders (compile): 15:45:44.048439 => 15:45:44.054957
[0m15:45:44.056498 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_orders
[0m15:45:44.056908 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part
[0m15:45:44.057741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_orders, now model.dbt_trino_iceberg.stg_tpch_part)
[0m15:45:44.058651 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part
[0m15:45:44.062729 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part"
[0m15:45:44.063396 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part (compile): 15:45:44.059425 => 15:45:44.063204
[0m15:45:44.063976 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part
[0m15:45:44.064316 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m15:45:44.064796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part, now model.dbt_trino_iceberg.stg_tpch_part_suppliers)
[0m15:45:44.065048 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m15:45:44.069819 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part_suppliers"
[0m15:45:44.071157 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part_suppliers (compile): 15:45:44.065192 => 15:45:44.070853
[0m15:45:44.071937 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m15:45:44.072270 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_region
[0m15:45:44.072690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part_suppliers, now model.dbt_trino_iceberg.stg_tpch_region)
[0m15:45:44.072932 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_region
[0m15:45:44.075654 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_region"
[0m15:45:44.076406 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_region (compile): 15:45:44.073094 => 15:45:44.076161
[0m15:45:44.077009 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_region
[0m15:45:44.077315 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m15:45:44.077731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_region, now model.dbt_trino_iceberg.stg_tpch_supplier)
[0m15:45:44.077979 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_supplier
[0m15:45:44.080258 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_supplier"
[0m15:45:44.080819 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_supplier (compile): 15:45:44.078122 => 15:45:44.080682
[0m15:45:44.081371 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m15:45:44.081664 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_order_items
[0m15:45:44.081943 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_dbt2.stg_tpch_order_items ..................... [RUN]
[0m15:45:44.082614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_supplier, now model.dbt_trino_iceberg.stg_tpch_order_items)
[0m15:45:44.082869 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_order_items
[0m15:45:44.097548 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_order_items"
[0m15:45:44.098294 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_order_items (compile): 15:45:44.083011 => 15:45:44.098061
[0m15:45:44.098654 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.stg_tpch_order_items
[0m15:45:44.119119 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.stg_tpch_order_items"
[0m15:45:44.124305 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.stg_tpch_order_items"
[0m15:45:44.124651 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.stg_tpch_order_items"} */

  
    

    create table "lakehouse"."dbt_dbt2"."stg_tpch_order_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_orders as (

select
    orderkey as order_key, 
    custkey as customer_key,
    orderstatus as order_status_code,
    totalprice as order_amount,
    orderdate as order_date,
    orderpriority as order_priority_code,
    clerk as order_clerk_name,
    shippriority as shipping_priority,
    comment as order_comment
from
    tpch.sf1.orders
),  __dbt__cte__stg_tpch_line_item as (

select
    orderkey as order_key,
    partkey as part_key,
    suppkey as supplier_key,
    linenumber as order_line_number,
    quantity as quantity,
    extendedprice as extended_price,
    discount as discount_percentage,
    tax as tax_rate,
    returnflag as return_status_code,
    linestatus as order_line_status_code,
    shipdate as ship_date,
    commitdate as commit_date,
    receiptdate as receipt_date,
    shipinstruct as ship_instructions_desc,
    shipmode as ship_mode_name,
    comment as order_line_comment
from
    tpch.sf1.lineitem
), orders as (
    
    select * from __dbt__cte__stg_tpch_orders

),
line_items as (

    select * from __dbt__cte__stg_tpch_line_item

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(o.order_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l.order_line_number as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as order_item_key,

    o.order_key,
    o.order_date,
    o.customer_key,
    o.order_status_code,
    
    l.part_key,
    l.supplier_key,
    l.return_status_code,
    l.order_line_number,
    l.order_line_status_code,
    l.ship_date,
    l.commit_date,
    l.receipt_date,
    l.ship_mode_name,

    l.quantity,
    
    -- extended_price is actually the line item total,
    -- so we back out the extended price per item
    (l.extended_price/nullif(l.quantity, 0)) as base_price,
    l.discount_percentage,
    ((l.extended_price/nullif(l.quantity, 0)) * (1 - l.discount_percentage)) as discounted_price,

    l.extended_price as gross_item_sales_amount,
    (l.extended_price * (1 - l.discount_percentage)) as discounted_item_sales_amount,
    -- We model discounts as negative amounts
    (-1 * l.extended_price * l.discount_percentage) as item_discount_amount,
    l.tax_rate,
    ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate) as item_tax_amount,
    (
        l.extended_price + 
        (-1 * l.extended_price * l.discount_percentage) + 
        ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate)
    ) as net_item_sales_amount

from
    orders o
    join
    line_items l
        on o.order_key = l.order_key
order by
    o.order_date
    )
[0m15:45:44.124906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:46:08.724298 [debug] [Thread-1 (]: SQL status: SUCCESS in 25.0 seconds
[0m15:46:08.733284 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_order_items (execute): 15:45:44.098844 => 15:46:08.733115
[0m15:46:08.733570 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_order_items: ROLLBACK
[0m15:46:08.733761 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_order_items: Close
[0m15:46:08.734922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '519e81b8-d267-461e-a4b0-e980693c5d49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d00797910>]}
[0m15:46:08.735370 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_dbt2.stg_tpch_order_items ................ [[32mSUCCESS[0m in 24.65s]
[0m15:46:08.735872 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_order_items
[0m15:46:08.736185 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_part_suppliers
[0m15:46:08.736502 [info ] [Thread-1 (]: 2 of 4 START sql table model dbt_dbt2.dim_part_suppliers ....................... [RUN]
[0m15:46:08.737442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_order_items, now model.dbt_trino_iceberg.dim_part_suppliers)
[0m15:46:08.737713 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_part_suppliers
[0m15:46:08.749364 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m15:46:08.750421 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (compile): 15:46:08.737887 => 15:46:08.750230
[0m15:46:08.750677 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_part_suppliers
[0m15:46:08.753954 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m15:46:08.760476 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m15:46:08.761119 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt2"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
    )
[0m15:46:08.761518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:46:15.932760 [debug] [Thread-1 (]: SQL status: SUCCESS in 7.0 seconds
[0m15:46:15.935537 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (execute): 15:46:08.750810 => 15:46:15.935328
[0m15:46:15.935975 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: ROLLBACK
[0m15:46:15.936316 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: Close
[0m15:46:15.938054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '519e81b8-d267-461e-a4b0-e980693c5d49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d0067e950>]}
[0m15:46:15.938680 [info ] [Thread-1 (]: 2 of 4 OK created sql table model dbt_dbt2.dim_part_suppliers .................. [[32mSUCCESS[0m in 7.20s]
[0m15:46:15.939320 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_part_suppliers
[0m15:46:15.939720 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_suppliers
[0m15:46:15.940144 [info ] [Thread-1 (]: 3 of 4 START sql table model dbt_dbt2.dim_suppliers ............................ [RUN]
[0m15:46:15.941012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_part_suppliers, now model.dbt_trino_iceberg.dim_suppliers)
[0m15:46:15.941349 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_suppliers
[0m15:46:15.946952 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_suppliers"
[0m15:46:15.947952 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (compile): 15:46:15.941488 => 15:46:15.947463
[0m15:46:15.948331 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_suppliers
[0m15:46:15.952364 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_suppliers"
[0m15:46:15.957240 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m15:46:15.957780 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt2"."dim_suppliers"
      
      
    as (
      
with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m15:46:15.958218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:46:17.081821 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m15:46:17.083339 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (execute): 15:46:15.948525 => 15:46:17.083175
[0m15:46:17.083675 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: ROLLBACK
[0m15:46:17.083979 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: Close
[0m15:46:17.085303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '519e81b8-d267-461e-a4b0-e980693c5d49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d015c1310>]}
[0m15:46:17.085662 [info ] [Thread-1 (]: 3 of 4 OK created sql table model dbt_dbt2.dim_suppliers ....................... [[32mSUCCESS[0m in 1.14s]
[0m15:46:17.086027 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_suppliers
[0m15:46:17.086341 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.fct_orders_items
[0m15:46:17.086626 [info ] [Thread-1 (]: 4 of 4 START sql table model dbt_dbt2.fct_orders_items ......................... [RUN]
[0m15:46:17.087117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_suppliers, now model.dbt_trino_iceberg.fct_orders_items)
[0m15:46:17.087341 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.fct_orders_items
[0m15:46:17.096223 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.fct_orders_items"
[0m15:46:17.097014 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (compile): 15:46:17.087468 => 15:46:17.096813
[0m15:46:17.097292 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.fct_orders_items
[0m15:46:17.099306 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.fct_orders_items"
[0m15:46:17.103932 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m15:46:17.104448 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

  
    

    create table "lakehouse"."dbt_dbt2"."fct_orders_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), orders_items as (
    
    select * from "lakehouse"."dbt_dbt2"."stg_tpch_order_items"

),
parts_suppliers as (
    
    select * from __dbt__cte__stg_tpch_part_suppliers

),
final as (
    select 

        o.order_item_key,
        o.order_key,
        o.order_date,
        o.customer_key,
        o.order_status_code,
        
        o.part_key,
        o.supplier_key,
        o.return_status_code,
        o.order_line_number,
        o.order_line_status_code,
        o.ship_date,
        o.commit_date,
        o.receipt_date,
        o.ship_mode_name,
        ps.supplier_cost_amount,
        
        o.base_price,
        o.discount_percentage,
        o.discounted_price,
        o.tax_rate,
        
        1 as order_item_count,
        o.quantity,

        o.gross_item_sales_amount,
        o.discounted_item_sales_amount,
        o.item_discount_amount,
        o.item_tax_amount,
        o.net_item_sales_amount

    from
        orders_items o
        join
        parts_suppliers ps
            on o.part_key = ps.part_key and
                o.supplier_key = ps.supplier_key
)
select *

from
    final f
order by
    f.order_date
    )
[0m15:46:17.104753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:46:17.732084 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231213_144618_00454_scdwh
[0m15:46:17.732575 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=ICEBERG_CANNOT_OPEN_SPLIT, message="Error opening Iceberg split file:/stackable/warehouse/dbt_dbt2.db/stg_tpch_order_items-d5f3e40390b64543a8f2ce1dc0ed3402/data/20231213_144545_00451_scdwh-110285f5-a7bc-4f9d-bfac-ed745c223998.parquet (offset=0, length=16656953): file:/stackable/warehouse/dbt_dbt2.db/stg_tpch_order_items-d5f3e40390b64543a8f2ce1dc0ed3402/data/20231213_144545_00451_scdwh-110285f5-a7bc-4f9d-bfac-ed745c223998.parquet", query_id=20231213_144618_00454_scdwh)
[0m15:46:17.733005 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (execute): 15:46:17.097462 => 15:46:17.732829
[0m15:46:17.733231 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: ROLLBACK
[0m15:46:17.733481 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: Close
[0m15:46:17.738481 [debug] [Thread-1 (]: Database Error in model fct_orders_items (models/mart/fct_orders_items.sql)
  TrinoExternalError(type=EXTERNAL, name=ICEBERG_CANNOT_OPEN_SPLIT, message="Error opening Iceberg split file:/stackable/warehouse/dbt_dbt2.db/stg_tpch_order_items-d5f3e40390b64543a8f2ce1dc0ed3402/data/20231213_144545_00451_scdwh-110285f5-a7bc-4f9d-bfac-ed745c223998.parquet (offset=0, length=16656953): file:/stackable/warehouse/dbt_dbt2.db/stg_tpch_order_items-d5f3e40390b64543a8f2ce1dc0ed3402/data/20231213_144545_00451_scdwh-110285f5-a7bc-4f9d-bfac-ed745c223998.parquet", query_id=20231213_144618_00454_scdwh)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/fct_orders_items.sql
[0m15:46:17.739694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '519e81b8-d267-461e-a4b0-e980693c5d49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d01847810>]}
[0m15:46:17.740118 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model dbt_dbt2.fct_orders_items ................ [[31mERROR[0m in 0.65s]
[0m15:46:17.740763 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.fct_orders_items
[0m15:46:17.742892 [debug] [MainThread]: On master: COMMIT
[0m15:46:17.743300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:17.743468 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.fct_orders_items' was properly closed.
[0m15:46:17.743674 [info ] [MainThread]: 
[0m15:46:17.743906 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 35.99 seconds (35.99s).
[0m15:46:17.744810 [debug] [MainThread]: Command end result
[0m15:46:17.752618 [info ] [MainThread]: 
[0m15:46:17.753058 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:46:17.753320 [info ] [MainThread]: 
[0m15:46:17.753555 [error] [MainThread]:   Database Error in model fct_orders_items (models/mart/fct_orders_items.sql)
  TrinoExternalError(type=EXTERNAL, name=ICEBERG_CANNOT_OPEN_SPLIT, message="Error opening Iceberg split file:/stackable/warehouse/dbt_dbt2.db/stg_tpch_order_items-d5f3e40390b64543a8f2ce1dc0ed3402/data/20231213_144545_00451_scdwh-110285f5-a7bc-4f9d-bfac-ed745c223998.parquet (offset=0, length=16656953): file:/stackable/warehouse/dbt_dbt2.db/stg_tpch_order_items-d5f3e40390b64543a8f2ce1dc0ed3402/data/20231213_144545_00451_scdwh-110285f5-a7bc-4f9d-bfac-ed745c223998.parquet", query_id=20231213_144618_00454_scdwh)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/fct_orders_items.sql
[0m15:46:17.753813 [info ] [MainThread]: 
[0m15:46:17.754066 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m15:46:17.754670 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 37.091763, "process_user_time": 2.670746, "process_kernel_time": 0.079427, "process_mem_max_rss": "117732", "process_out_blocks": "3704", "command_success": false, "process_in_blocks": "0"}
[0m15:46:17.754980 [debug] [MainThread]: Command `dbt run` failed at 15:46:17.754909 after 37.09 seconds
[0m15:46:17.755201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d02634c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d01adbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d060235d0>]}
[0m15:46:17.755403 [debug] [MainThread]: Flushing usage events
[0m16:00:47.266594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc889e50410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc88a9b8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc889e53950>]}


============================== 16:00:47.268836 | f3c87572-cfef-4df1-b76c-a4fa0ff7696b ==============================
[0m16:00:47.268836 [info ] [MainThread]: Running with dbt=1.7.3
[0m16:00:47.269380 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --debug run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:00:47.399652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3c87572-cfef-4df1-b76c-a4fa0ff7696b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc889c20610>]}
[0m16:00:47.455778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3c87572-cfef-4df1-b76c-a4fa0ff7696b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc889bc66d0>]}
[0m16:00:47.456398 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m16:00:47.464201 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m16:00:47.484273 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:00:47.486305 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:00:47.491176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3c87572-cfef-4df1-b76c-a4fa0ff7696b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8898f8150>]}
[0m16:00:47.501780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3c87572-cfef-4df1-b76c-a4fa0ff7696b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8899cbdd0>]}
[0m16:00:47.502364 [info ] [MainThread]: Found 12 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m16:00:47.502731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3c87572-cfef-4df1-b76c-a4fa0ff7696b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc889a90d50>]}
[0m16:00:47.504222 [info ] [MainThread]: 
[0m16:00:47.504905 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:00:47.505893 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m16:00:47.518410 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m16:00:47.518790 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m16:00:47.519071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:48.520845 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:00:48.521941 [debug] [ThreadPool]: On list_lakehouse: Close
[0m16:00:48.524431 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt_dbt2)
[0m16:00:48.530281 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt_dbt2"
[0m16:00:48.530755 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt2: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt_dbt2"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt_dbt2') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt_dbt2'
[0m16:00:48.531167 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:49.104808 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:00:49.105908 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt2: ROLLBACK
[0m16:00:49.106140 [debug] [ThreadPool]: On list_lakehouse_dbt_dbt2: Close
[0m16:00:49.108339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3c87572-cfef-4df1-b76c-a4fa0ff7696b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc889ac3d50>]}
[0m16:00:49.108726 [debug] [MainThread]: On master: COMMIT
[0m16:00:49.109296 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:00:49.109519 [info ] [MainThread]: 
[0m16:00:49.112710 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_customers
[0m16:00:49.113419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt_dbt2, now model.dbt_trino_iceberg.stg_tpch_customers)
[0m16:00:49.113739 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_customers
[0m16:00:49.116681 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_customers"
[0m16:00:49.117256 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_customers (compile): 16:00:49.113963 => 16:00:49.117081
[0m16:00:49.117925 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_customers
[0m16:00:49.118285 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m16:00:49.118867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_customers, now model.dbt_trino_iceberg.stg_tpch_line_item)
[0m16:00:49.119213 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_line_item
[0m16:00:49.122226 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_line_item"
[0m16:00:49.123123 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_line_item (compile): 16:00:49.119497 => 16:00:49.122857
[0m16:00:49.124162 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m16:00:49.124631 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_nation
[0m16:00:49.125373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_line_item, now model.dbt_trino_iceberg.stg_tpch_nation)
[0m16:00:49.125691 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_nation
[0m16:00:49.127933 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_nation"
[0m16:00:49.128419 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_nation (compile): 16:00:49.125879 => 16:00:49.128257
[0m16:00:49.129037 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_nation
[0m16:00:49.129358 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_orders
[0m16:00:49.129995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_nation, now model.dbt_trino_iceberg.stg_tpch_orders)
[0m16:00:49.130291 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_orders
[0m16:00:49.132574 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_orders"
[0m16:00:49.133143 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_orders (compile): 16:00:49.130478 => 16:00:49.132976
[0m16:00:49.133814 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_orders
[0m16:00:49.134167 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part
[0m16:00:49.135081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_orders, now model.dbt_trino_iceberg.stg_tpch_part)
[0m16:00:49.135407 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part
[0m16:00:49.138387 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part"
[0m16:00:49.139219 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part (compile): 16:00:49.135674 => 16:00:49.138996
[0m16:00:49.140040 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part
[0m16:00:49.140464 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m16:00:49.141132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part, now model.dbt_trino_iceberg.stg_tpch_part_suppliers)
[0m16:00:49.141567 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m16:00:49.154326 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part_suppliers"
[0m16:00:49.155238 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part_suppliers (compile): 16:00:49.141760 => 16:00:49.154955
[0m16:00:49.156499 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m16:00:49.156980 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_region
[0m16:00:49.157557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part_suppliers, now model.dbt_trino_iceberg.stg_tpch_region)
[0m16:00:49.158070 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_region
[0m16:00:49.162993 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_region"
[0m16:00:49.163839 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_region (compile): 16:00:49.158308 => 16:00:49.163568
[0m16:00:49.164693 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_region
[0m16:00:49.165038 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m16:00:49.165671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_region, now model.dbt_trino_iceberg.stg_tpch_supplier)
[0m16:00:49.165932 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_supplier
[0m16:00:49.168704 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_supplier"
[0m16:00:49.170069 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_supplier (compile): 16:00:49.166121 => 16:00:49.169790
[0m16:00:49.171025 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m16:00:49.171521 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_order_items
[0m16:00:49.172384 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_dbt2.stg_tpch_order_items ..................... [RUN]
[0m16:00:49.172846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_supplier, now model.dbt_trino_iceberg.stg_tpch_order_items)
[0m16:00:49.173165 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_order_items
[0m16:00:49.186675 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_order_items"
[0m16:00:49.187493 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_order_items (compile): 16:00:49.173373 => 16:00:49.187237
[0m16:00:49.187792 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.stg_tpch_order_items
[0m16:00:49.207133 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt_dbt2"."stg_tpch_order_items"
[0m16:00:49.208871 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.stg_tpch_order_items"
[0m16:00:49.209210 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.stg_tpch_order_items"} */

    drop table if exists "lakehouse"."dbt_dbt2"."stg_tpch_order_items"
[0m16:00:49.209509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:49.712607 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m16:00:49.720460 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.stg_tpch_order_items"
[0m16:00:49.725331 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.stg_tpch_order_items"
[0m16:00:49.725860 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.stg_tpch_order_items"} */

  
    

    create table "lakehouse"."dbt_dbt2"."stg_tpch_order_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_orders as (

select
    orderkey as order_key, 
    custkey as customer_key,
    orderstatus as order_status_code,
    totalprice as order_amount,
    orderdate as order_date,
    orderpriority as order_priority_code,
    clerk as order_clerk_name,
    shippriority as shipping_priority,
    comment as order_comment
from
    tpch.sf1.orders
),  __dbt__cte__stg_tpch_line_item as (

select
    orderkey as order_key,
    partkey as part_key,
    suppkey as supplier_key,
    linenumber as order_line_number,
    quantity as quantity,
    extendedprice as extended_price,
    discount as discount_percentage,
    tax as tax_rate,
    returnflag as return_status_code,
    linestatus as order_line_status_code,
    shipdate as ship_date,
    commitdate as commit_date,
    receiptdate as receipt_date,
    shipinstruct as ship_instructions_desc,
    shipmode as ship_mode_name,
    comment as order_line_comment
from
    tpch.sf1.lineitem
), orders as (
    
    select * from __dbt__cte__stg_tpch_orders

),
line_items as (

    select * from __dbt__cte__stg_tpch_line_item

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(o.order_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l.order_line_number as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as order_item_key,

    o.order_key,
    o.order_date,
    o.customer_key,
    o.order_status_code,
    
    l.part_key,
    l.supplier_key,
    l.return_status_code,
    l.order_line_number,
    l.order_line_status_code,
    l.ship_date,
    l.commit_date,
    l.receipt_date,
    l.ship_mode_name,

    l.quantity,
    
    -- extended_price is actually the line item total,
    -- so we back out the extended price per item
    (l.extended_price/nullif(l.quantity, 0)) as base_price,
    l.discount_percentage,
    ((l.extended_price/nullif(l.quantity, 0)) * (1 - l.discount_percentage)) as discounted_price,

    l.extended_price as gross_item_sales_amount,
    (l.extended_price * (1 - l.discount_percentage)) as discounted_item_sales_amount,
    -- We model discounts as negative amounts
    (-1 * l.extended_price * l.discount_percentage) as item_discount_amount,
    l.tax_rate,
    ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate) as item_tax_amount,
    (
        l.extended_price + 
        (-1 * l.extended_price * l.discount_percentage) + 
        ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate)
    ) as net_item_sales_amount

from
    orders o
    join
    line_items l
        on o.order_key = l.order_key
order by
    o.order_date
    )
[0m16:01:16.910100 [debug] [Thread-1 (]: SQL status: SUCCESS in 27.0 seconds
[0m16:01:16.923472 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_order_items (execute): 16:00:49.187981 => 16:01:16.923325
[0m16:01:16.923879 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_order_items: ROLLBACK
[0m16:01:16.924292 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_order_items: Close
[0m16:01:16.926725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3c87572-cfef-4df1-b76c-a4fa0ff7696b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc889824a10>]}
[0m16:01:16.927623 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_dbt2.stg_tpch_order_items ................ [[32mSUCCESS[0m in 27.75s]
[0m16:01:16.928189 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_order_items
[0m16:01:16.928579 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_part_suppliers
[0m16:01:16.929161 [info ] [Thread-1 (]: 2 of 4 START sql table model dbt_dbt2.dim_part_suppliers ....................... [RUN]
[0m16:01:16.929866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_order_items, now model.dbt_trino_iceberg.dim_part_suppliers)
[0m16:01:16.930201 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_part_suppliers
[0m16:01:16.941514 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m16:01:16.942475 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (compile): 16:01:16.930750 => 16:01:16.942213
[0m16:01:16.942947 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_part_suppliers
[0m16:01:16.947857 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt_dbt2"."dim_part_suppliers"
[0m16:01:16.948814 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m16:01:16.949386 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

    drop table if exists "lakehouse"."dbt_dbt2"."dim_part_suppliers"
[0m16:01:16.949821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:17.761282 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m16:01:17.762601 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m16:01:17.768968 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m16:01:17.769776 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt2"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
    )
[0m16:01:24.267498 [debug] [Thread-1 (]: SQL status: SUCCESS in 6.0 seconds
[0m16:01:24.269430 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (execute): 16:01:16.943169 => 16:01:24.269282
[0m16:01:24.269759 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: ROLLBACK
[0m16:01:24.270033 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: Close
[0m16:01:24.271523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3c87572-cfef-4df1-b76c-a4fa0ff7696b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc889854590>]}
[0m16:01:24.272123 [info ] [Thread-1 (]: 2 of 4 OK created sql table model dbt_dbt2.dim_part_suppliers .................. [[32mSUCCESS[0m in 7.34s]
[0m16:01:24.272589 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_part_suppliers
[0m16:01:24.273030 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_suppliers
[0m16:01:24.273561 [info ] [Thread-1 (]: 3 of 4 START sql table model dbt_dbt2.dim_suppliers ............................ [RUN]
[0m16:01:24.274230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_part_suppliers, now model.dbt_trino_iceberg.dim_suppliers)
[0m16:01:24.274775 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_suppliers
[0m16:01:24.281965 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_suppliers"
[0m16:01:24.283266 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (compile): 16:01:24.275013 => 16:01:24.282962
[0m16:01:24.283884 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_suppliers
[0m16:01:24.287629 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt_dbt2"."dim_suppliers"
[0m16:01:24.288433 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m16:01:24.288745 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt_dbt2"."dim_suppliers"
[0m16:01:24.289049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:25.236249 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m16:01:25.237559 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_suppliers"
[0m16:01:25.241480 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m16:01:25.241820 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt_dbt2"."dim_suppliers"
      
      
    as (
      
with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m16:01:26.011220 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m16:01:26.012971 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (execute): 16:01:24.284346 => 16:01:26.012846
[0m16:01:26.013244 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: ROLLBACK
[0m16:01:26.013512 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: Close
[0m16:01:26.015029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3c87572-cfef-4df1-b76c-a4fa0ff7696b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc889a42410>]}
[0m16:01:26.015636 [info ] [Thread-1 (]: 3 of 4 OK created sql table model dbt_dbt2.dim_suppliers ....................... [[32mSUCCESS[0m in 1.74s]
[0m16:01:26.016041 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_suppliers
[0m16:01:26.016425 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.fct_orders_items
[0m16:01:26.016962 [info ] [Thread-1 (]: 4 of 4 START sql table model dbt_dbt2.fct_orders_items ......................... [RUN]
[0m16:01:26.017435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_suppliers, now model.dbt_trino_iceberg.fct_orders_items)
[0m16:01:26.017700 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.fct_orders_items
[0m16:01:26.026000 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.fct_orders_items"
[0m16:01:26.026629 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (compile): 16:01:26.017899 => 16:01:26.026385
[0m16:01:26.026954 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.fct_orders_items
[0m16:01:26.028952 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.fct_orders_items"
[0m16:01:26.032529 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m16:01:26.032924 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

  
    

    create table "lakehouse"."dbt_dbt2"."fct_orders_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), orders_items as (
    
    select * from "lakehouse"."dbt_dbt2"."stg_tpch_order_items"

),
parts_suppliers as (
    
    select * from __dbt__cte__stg_tpch_part_suppliers

),
final as (
    select 

        o.order_item_key,
        o.order_key,
        o.order_date,
        o.customer_key,
        o.order_status_code,
        
        o.part_key,
        o.supplier_key,
        o.return_status_code,
        o.order_line_number,
        o.order_line_status_code,
        o.ship_date,
        o.commit_date,
        o.receipt_date,
        o.ship_mode_name,
        ps.supplier_cost_amount,
        
        o.base_price,
        o.discount_percentage,
        o.discounted_price,
        o.tax_rate,
        
        1 as order_item_count,
        o.quantity,

        o.gross_item_sales_amount,
        o.discounted_item_sales_amount,
        o.item_discount_amount,
        o.item_tax_amount,
        o.net_item_sales_amount

    from
        orders_items o
        join
        parts_suppliers ps
            on o.part_key = ps.part_key and
                o.supplier_key = ps.supplier_key
)
select *

from
    final f
order by
    f.order_date
    )
[0m16:01:26.033309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:26.746426 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231213_150127_00471_scdwh
[0m16:01:26.747151 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=ICEBERG_CANNOT_OPEN_SPLIT, message="Error opening Iceberg split file:/stackable/warehouse/dbt_dbt2.db/stg_tpch_order_items-da29f3d53cb24dd3a3c35cc1cc5bfd9b/data/20231213_150051_00466_scdwh-9573d4dd-b387-4782-bbba-d780a81c25bf.parquet (offset=0, length=119082481): file:/stackable/warehouse/dbt_dbt2.db/stg_tpch_order_items-da29f3d53cb24dd3a3c35cc1cc5bfd9b/data/20231213_150051_00466_scdwh-9573d4dd-b387-4782-bbba-d780a81c25bf.parquet", query_id=20231213_150127_00471_scdwh)
[0m16:01:26.748005 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (execute): 16:01:26.027174 => 16:01:26.747682
[0m16:01:26.748663 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: ROLLBACK
[0m16:01:26.749304 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: Close
[0m16:01:26.752823 [debug] [Thread-1 (]: Database Error in model fct_orders_items (models/mart/fct_orders_items.sql)
  TrinoExternalError(type=EXTERNAL, name=ICEBERG_CANNOT_OPEN_SPLIT, message="Error opening Iceberg split file:/stackable/warehouse/dbt_dbt2.db/stg_tpch_order_items-da29f3d53cb24dd3a3c35cc1cc5bfd9b/data/20231213_150051_00466_scdwh-9573d4dd-b387-4782-bbba-d780a81c25bf.parquet (offset=0, length=119082481): file:/stackable/warehouse/dbt_dbt2.db/stg_tpch_order_items-da29f3d53cb24dd3a3c35cc1cc5bfd9b/data/20231213_150051_00466_scdwh-9573d4dd-b387-4782-bbba-d780a81c25bf.parquet", query_id=20231213_150127_00471_scdwh)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/fct_orders_items.sql
[0m16:01:26.754379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3c87572-cfef-4df1-b76c-a4fa0ff7696b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8897e9350>]}
[0m16:01:26.754937 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model dbt_dbt2.fct_orders_items ................ [[31mERROR[0m in 0.74s]
[0m16:01:26.755333 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.fct_orders_items
[0m16:01:26.757325 [debug] [MainThread]: On master: COMMIT
[0m16:01:26.757882 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:01:26.758172 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.fct_orders_items' was properly closed.
[0m16:01:26.758474 [info ] [MainThread]: 
[0m16:01:26.758727 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 39.25 seconds (39.25s).
[0m16:01:26.759447 [debug] [MainThread]: Command end result
[0m16:01:26.768591 [info ] [MainThread]: 
[0m16:01:26.768944 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:01:26.769203 [info ] [MainThread]: 
[0m16:01:26.769457 [error] [MainThread]:   Database Error in model fct_orders_items (models/mart/fct_orders_items.sql)
  TrinoExternalError(type=EXTERNAL, name=ICEBERG_CANNOT_OPEN_SPLIT, message="Error opening Iceberg split file:/stackable/warehouse/dbt_dbt2.db/stg_tpch_order_items-da29f3d53cb24dd3a3c35cc1cc5bfd9b/data/20231213_150051_00466_scdwh-9573d4dd-b387-4782-bbba-d780a81c25bf.parquet (offset=0, length=119082481): file:/stackable/warehouse/dbt_dbt2.db/stg_tpch_order_items-da29f3d53cb24dd3a3c35cc1cc5bfd9b/data/20231213_150051_00466_scdwh-9573d4dd-b387-4782-bbba-d780a81c25bf.parquet", query_id=20231213_150127_00471_scdwh)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/fct_orders_items.sql
[0m16:01:26.769715 [info ] [MainThread]: 
[0m16:01:26.770018 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m16:01:26.771008 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 39.530758, "process_user_time": 1.795853, "process_kernel_time": 0.196268, "process_mem_max_rss": "111848", "process_out_blocks": "2592", "command_success": false, "process_in_blocks": "0"}
[0m16:01:26.771641 [debug] [MainThread]: Command `dbt run` failed at 16:01:26.771528 after 39.53 seconds
[0m16:01:26.771998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc88e50ecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc88e50ec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc88bd2c950>]}
[0m16:01:26.772293 [debug] [MainThread]: Flushing usage events
[0m10:41:26.560095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd170823290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1708222d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1707d7c90>]}


============================== 10:41:26.562790 | a685f7dc-c784-45e2-a2a3-fff1522e966a ==============================
[0m10:41:26.562790 [info ] [MainThread]: Running with dbt=1.7.3
[0m10:41:26.563140 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:41:26.709596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a685f7dc-c784-45e2-a2a3-fff1522e966a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd170823dd0>]}
[0m10:41:26.761045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a685f7dc-c784-45e2-a2a3-fff1522e966a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd17082d610>]}
[0m10:41:26.761531 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m10:41:26.770530 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m10:41:26.778249 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:41:26.778576 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:41:26.778853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a685f7dc-c784-45e2-a2a3-fff1522e966a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd17180f010>]}
[0m10:41:27.564190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a685f7dc-c784-45e2-a2a3-fff1522e966a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd170432050>]}
[0m10:41:27.572639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a685f7dc-c784-45e2-a2a3-fff1522e966a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd16f39e8d0>]}
[0m10:41:27.573047 [info ] [MainThread]: Found 12 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m10:41:27.573307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a685f7dc-c784-45e2-a2a3-fff1522e966a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd170823b90>]}
[0m10:41:27.574578 [info ] [MainThread]: 
[0m10:41:27.575089 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m10:41:27.575978 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m10:41:27.585958 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m10:41:27.586201 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m10:41:27.586366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:41:28.822979 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m10:41:28.825171 [debug] [ThreadPool]: On list_lakehouse: Close
[0m10:41:28.828204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m10:41:28.835008 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m10:41:28.835293 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m10:41:28.835461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:41:30.064731 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m10:41:30.067446 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m10:41:30.067933 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m10:41:30.070156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a685f7dc-c784-45e2-a2a3-fff1522e966a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1706fc990>]}
[0m10:41:30.070432 [debug] [MainThread]: On master: COMMIT
[0m10:41:30.070801 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:41:30.071022 [info ] [MainThread]: 
[0m10:41:30.074485 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_customers
[0m10:41:30.074898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.stg_tpch_customers)
[0m10:41:30.075105 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_customers
[0m10:41:30.077104 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_customers"
[0m10:41:30.078983 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_customers (compile): 10:41:30.075217 => 10:41:30.078834
[0m10:41:30.079469 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_customers
[0m10:41:30.079719 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m10:41:30.080130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_customers, now model.dbt_trino_iceberg.stg_tpch_line_item)
[0m10:41:30.080336 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_line_item
[0m10:41:30.082293 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_line_item"
[0m10:41:30.082661 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_line_item (compile): 10:41:30.080461 => 10:41:30.082517
[0m10:41:30.083231 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m10:41:30.083462 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_nation
[0m10:41:30.083918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_line_item, now model.dbt_trino_iceberg.stg_tpch_nation)
[0m10:41:30.084121 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_nation
[0m10:41:30.085834 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_nation"
[0m10:41:30.086521 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_nation (compile): 10:41:30.084245 => 10:41:30.086253
[0m10:41:30.086986 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_nation
[0m10:41:30.087218 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_orders
[0m10:41:30.087573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_nation, now model.dbt_trino_iceberg.stg_tpch_orders)
[0m10:41:30.087778 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_orders
[0m10:41:30.089578 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_orders"
[0m10:41:30.089921 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_orders (compile): 10:41:30.087902 => 10:41:30.089792
[0m10:41:30.090583 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_orders
[0m10:41:30.090830 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part
[0m10:41:30.091237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_orders, now model.dbt_trino_iceberg.stg_tpch_part)
[0m10:41:30.091484 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part
[0m10:41:30.093976 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part"
[0m10:41:30.094354 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part (compile): 10:41:30.091611 => 10:41:30.094213
[0m10:41:30.095151 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part
[0m10:41:30.095397 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m10:41:30.095797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part, now model.dbt_trino_iceberg.stg_tpch_part_suppliers)
[0m10:41:30.096004 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m10:41:30.098938 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part_suppliers"
[0m10:41:30.099797 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part_suppliers (compile): 10:41:30.096130 => 10:41:30.099577
[0m10:41:30.100397 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m10:41:30.100651 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_region
[0m10:41:30.101018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part_suppliers, now model.dbt_trino_iceberg.stg_tpch_region)
[0m10:41:30.101228 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_region
[0m10:41:30.103142 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_region"
[0m10:41:30.103502 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_region (compile): 10:41:30.101357 => 10:41:30.103369
[0m10:41:30.104002 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_region
[0m10:41:30.104235 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m10:41:30.104596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_region, now model.dbt_trino_iceberg.stg_tpch_supplier)
[0m10:41:30.104801 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_supplier
[0m10:41:30.106603 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_supplier"
[0m10:41:30.107123 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_supplier (compile): 10:41:30.104926 => 10:41:30.106973
[0m10:41:30.107597 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m10:41:30.107885 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_order_items
[0m10:41:30.108155 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt.stg_tpch_order_items .......................... [RUN]
[0m10:41:30.108643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_supplier, now model.dbt_trino_iceberg.stg_tpch_order_items)
[0m10:41:30.108899 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_order_items
[0m10:41:30.120807 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_order_items"
[0m10:41:30.121237 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_order_items (compile): 10:41:30.109039 => 10:41:30.121104
[0m10:41:30.121434 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.stg_tpch_order_items
[0m10:41:30.135190 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."stg_tpch_order_items"
[0m10:41:30.136472 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.stg_tpch_order_items"
[0m10:41:30.136696 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.stg_tpch_order_items"} */

    drop view if exists "lakehouse"."dbt"."stg_tpch_order_items"
[0m10:41:30.136883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:41:30.715971 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m10:41:30.725522 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.stg_tpch_order_items"
[0m10:41:30.732263 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.stg_tpch_order_items"
[0m10:41:30.732597 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.stg_tpch_order_items"} */

  
    

    create table "lakehouse"."dbt"."stg_tpch_order_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_orders as (

select
    orderkey as order_key, 
    custkey as customer_key,
    orderstatus as order_status_code,
    totalprice as order_amount,
    orderdate as order_date,
    orderpriority as order_priority_code,
    clerk as order_clerk_name,
    shippriority as shipping_priority,
    comment as order_comment
from
    tpch.sf1.orders
),  __dbt__cte__stg_tpch_line_item as (

select
    orderkey as order_key,
    partkey as part_key,
    suppkey as supplier_key,
    linenumber as order_line_number,
    quantity as quantity,
    extendedprice as extended_price,
    discount as discount_percentage,
    tax as tax_rate,
    returnflag as return_status_code,
    linestatus as order_line_status_code,
    shipdate as ship_date,
    commitdate as commit_date,
    receiptdate as receipt_date,
    shipinstruct as ship_instructions_desc,
    shipmode as ship_mode_name,
    comment as order_line_comment
from
    tpch.sf1.lineitem
), orders as (
    
    select * from __dbt__cte__stg_tpch_orders

),
line_items as (

    select * from __dbt__cte__stg_tpch_line_item

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(o.order_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l.order_line_number as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as order_item_key,

    o.order_key,
    o.order_date,
    o.customer_key,
    o.order_status_code,
    
    l.part_key,
    l.supplier_key,
    l.return_status_code,
    l.order_line_number,
    l.order_line_status_code,
    l.ship_date,
    l.commit_date,
    l.receipt_date,
    l.ship_mode_name,

    l.quantity,
    
    -- extended_price is actually the line item total,
    -- so we back out the extended price per item
    (l.extended_price/nullif(l.quantity, 0)) as base_price,
    l.discount_percentage,
    ((l.extended_price/nullif(l.quantity, 0)) * (1 - l.discount_percentage)) as discounted_price,

    l.extended_price as gross_item_sales_amount,
    (l.extended_price * (1 - l.discount_percentage)) as discounted_item_sales_amount,
    -- We model discounts as negative amounts
    (-1 * l.extended_price * l.discount_percentage) as item_discount_amount,
    l.tax_rate,
    ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate) as item_tax_amount,
    (
        l.extended_price + 
        (-1 * l.extended_price * l.discount_percentage) + 
        ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate)
    ) as net_item_sales_amount

from
    orders o
    join
    line_items l
        on o.order_key = l.order_key
order by
    o.order_date
    )
[0m10:42:10.636598 [debug] [Thread-1 (]: SQL status: SUCCESS in 40.0 seconds
[0m10:42:10.652775 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_order_items (execute): 10:41:30.121543 => 10:42:10.652486
[0m10:42:10.653501 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_order_items: ROLLBACK
[0m10:42:10.653981 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_order_items: Close
[0m10:42:10.656370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a685f7dc-c784-45e2-a2a3-fff1522e966a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd16f14e650>]}
[0m10:42:10.656986 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt.stg_tpch_order_items ..................... [[32mSUCCESS[0m in 40.55s]
[0m10:42:10.657629 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_order_items
[0m10:42:10.658043 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_part_suppliers
[0m10:42:10.658465 [info ] [Thread-1 (]: 2 of 4 START sql table model dbt.dim_part_suppliers ............................ [RUN]
[0m10:42:10.659339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_order_items, now model.dbt_trino_iceberg.dim_part_suppliers)
[0m10:42:10.659966 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_part_suppliers
[0m10:42:10.677625 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m10:42:10.684807 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (compile): 10:42:10.660291 => 10:42:10.684525
[0m10:42:10.685174 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_part_suppliers
[0m10:42:10.688917 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."dim_part_suppliers"
[0m10:42:10.689577 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m10:42:10.689871 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

    drop view if exists "lakehouse"."dbt"."dim_part_suppliers"
[0m10:42:10.690072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:11.426125 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m10:42:11.428871 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m10:42:11.440669 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m10:42:11.440965 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
    )
[0m10:42:21.119019 [debug] [Thread-1 (]: SQL status: SUCCESS in 10.0 seconds
[0m10:42:21.120816 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (execute): 10:42:10.685342 => 10:42:21.120675
[0m10:42:21.121054 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: ROLLBACK
[0m10:42:21.121239 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: Close
[0m10:42:21.122290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a685f7dc-c784-45e2-a2a3-fff1522e966a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd16f38f910>]}
[0m10:42:21.122691 [info ] [Thread-1 (]: 2 of 4 OK created sql table model dbt.dim_part_suppliers ....................... [[32mSUCCESS[0m in 10.46s]
[0m10:42:21.123170 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_part_suppliers
[0m10:42:21.123508 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_suppliers
[0m10:42:21.123775 [info ] [Thread-1 (]: 3 of 4 START sql table model dbt.dim_suppliers ................................. [RUN]
[0m10:42:21.124391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_part_suppliers, now model.dbt_trino_iceberg.dim_suppliers)
[0m10:42:21.124644 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_suppliers
[0m10:42:21.129694 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_suppliers"
[0m10:42:21.130099 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (compile): 10:42:21.124788 => 10:42:21.129966
[0m10:42:21.130293 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_suppliers
[0m10:42:21.132304 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_suppliers"
[0m10:42:21.134775 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m10:42:21.135024 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt"."dim_suppliers"
      
      
    as (
      
with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m10:42:21.135231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:22.860031 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m10:42:22.862296 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (execute): 10:42:21.130427 => 10:42:22.862095
[0m10:42:22.862644 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: ROLLBACK
[0m10:42:22.862933 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: Close
[0m10:42:22.864434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a685f7dc-c784-45e2-a2a3-fff1522e966a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd16f16e550>]}
[0m10:42:22.865169 [info ] [Thread-1 (]: 3 of 4 OK created sql table model dbt.dim_suppliers ............................ [[32mSUCCESS[0m in 1.74s]
[0m10:42:22.865818 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_suppliers
[0m10:42:22.866234 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.fct_orders_items
[0m10:42:22.866588 [info ] [Thread-1 (]: 4 of 4 START sql table model dbt.fct_orders_items .............................. [RUN]
[0m10:42:22.867164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_suppliers, now model.dbt_trino_iceberg.fct_orders_items)
[0m10:42:22.867499 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.fct_orders_items
[0m10:42:22.875901 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.fct_orders_items"
[0m10:42:22.876372 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (compile): 10:42:22.867642 => 10:42:22.876224
[0m10:42:22.876578 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.fct_orders_items
[0m10:42:22.881014 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."fct_orders_items"
[0m10:42:22.881634 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m10:42:22.881865 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

    drop view if exists "lakehouse"."dbt"."fct_orders_items"
[0m10:42:22.882174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:23.389033 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m10:42:23.390299 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.fct_orders_items"
[0m10:42:23.393268 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m10:42:23.393531 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

  
    

    create table "lakehouse"."dbt"."fct_orders_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), orders_items as (
    
    select * from "lakehouse"."dbt"."stg_tpch_order_items"

),
parts_suppliers as (
    
    select * from __dbt__cte__stg_tpch_part_suppliers

),
final as (
    select 

        o.order_item_key,
        o.order_key,
        o.order_date,
        o.customer_key,
        o.order_status_code,
        
        o.part_key,
        o.supplier_key,
        o.return_status_code,
        o.order_line_number,
        o.order_line_status_code,
        o.ship_date,
        o.commit_date,
        o.receipt_date,
        o.ship_mode_name,
        ps.supplier_cost_amount,
        
        o.base_price,
        o.discount_percentage,
        o.discounted_price,
        o.tax_rate,
        
        1 as order_item_count,
        o.quantity,

        o.gross_item_sales_amount,
        o.discounted_item_sales_amount,
        o.item_discount_amount,
        o.item_tax_amount,
        o.net_item_sales_amount

    from
        orders_items o
        join
        parts_suppliers ps
            on o.part_key = ps.part_key and
                o.supplier_key = ps.supplier_key
)
select *

from
    final f
order by
    f.order_date
    )
[0m10:42:53.795011 [debug] [Thread-1 (]: SQL status: SUCCESS in 30.0 seconds
[0m10:42:53.798010 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (execute): 10:42:22.876689 => 10:42:53.797794
[0m10:42:53.798287 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: ROLLBACK
[0m10:42:53.798535 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: Close
[0m10:42:53.799837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a685f7dc-c784-45e2-a2a3-fff1522e966a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd16f1b9cd0>]}
[0m10:42:53.800222 [info ] [Thread-1 (]: 4 of 4 OK created sql table model dbt.fct_orders_items ......................... [[32mSUCCESS[0m in 30.93s]
[0m10:42:53.800580 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.fct_orders_items
[0m10:42:53.802122 [debug] [MainThread]: On master: COMMIT
[0m10:42:53.802477 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:42:53.802628 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.fct_orders_items' was properly closed.
[0m10:42:53.802835 [info ] [MainThread]: 
[0m10:42:53.803034 [info ] [MainThread]: Finished running 4 table models in 0 hours 1 minutes and 26.23 seconds (86.23s).
[0m10:42:53.803695 [debug] [MainThread]: Command end result
[0m10:42:53.809871 [info ] [MainThread]: 
[0m10:42:53.810241 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:42:53.810631 [info ] [MainThread]: 
[0m10:42:53.810918 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:42:53.811544 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 87.28362, "process_user_time": 2.725497, "process_kernel_time": 0.14759, "process_mem_max_rss": "116016", "process_in_blocks": "5936", "process_out_blocks": "3704"}
[0m10:42:53.811843 [debug] [MainThread]: Command `dbt run` succeeded at 10:42:53.811771 after 87.28 seconds
[0m10:42:53.812049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd170822f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1707df410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd174e39090>]}
[0m10:42:53.812242 [debug] [MainThread]: Flushing usage events
[0m11:35:31.492327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043f89b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043fcf4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043f89bb10>]}


============================== 11:35:31.494233 | fd224376-f62f-4d49-9d7d-1f1e185d8224 ==============================
[0m11:35:31.494233 [info ] [MainThread]: Running with dbt=1.7.3
[0m11:35:31.494709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:35:31.609523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd224376-f62f-4d49-9d7d-1f1e185d8224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043f5fcf90>]}
[0m11:35:31.660039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd224376-f62f-4d49-9d7d-1f1e185d8224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043f84b690>]}
[0m11:35:31.660480 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m11:35:31.667092 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m11:35:31.674008 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:35:31.674325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fd224376-f62f-4d49-9d7d-1f1e185d8224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043f52d590>]}
[0m11:35:32.411107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd224376-f62f-4d49-9d7d-1f1e185d8224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043f606290>]}
[0m11:35:32.418908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd224376-f62f-4d49-9d7d-1f1e185d8224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043e0bbe10>]}
[0m11:35:32.419262 [info ] [MainThread]: Found 12 models, 8 sources, 0 exposures, 0 metrics, 535 macros, 0 groups, 0 semantic models
[0m11:35:32.419518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd224376-f62f-4d49-9d7d-1f1e185d8224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043f564a10>]}
[0m11:35:32.420817 [info ] [MainThread]: 
[0m11:35:32.421329 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m11:35:32.422267 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m11:35:32.432393 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m11:35:32.432617 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m11:35:32.432778 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:35:33.637696 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m11:35:33.639716 [debug] [ThreadPool]: On list_lakehouse: Close
[0m11:35:33.641169 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now create_lakehouse_dbt2 WITH LOCATION ('s3a://lakehouse.dbt'))
[0m11:35:33.641615 [debug] [ThreadPool]: Creating schema "database: "lakehouse"
schema: "dbt2 WITH LOCATION (\'s3a://lakehouse.dbt\')"
"
[0m11:35:33.644716 [debug] [ThreadPool]: Using trino connection "create_lakehouse_dbt2 WITH LOCATION ('s3a://lakehouse.dbt')"
[0m11:35:33.644918 [debug] [ThreadPool]: On create_lakehouse_dbt2 WITH LOCATION ('s3a://lakehouse.dbt'): /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "create_lakehouse_dbt2 WITH LOCATION ('s3a://lakehouse.dbt')"} */
create schema if not exists "lakehouse"."dbt2 WITH LOCATION ('s3a://lakehouse.dbt')"
[0m11:35:33.645072 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:34.043321 [debug] [ThreadPool]: Trino adapter: Trino query id: 20231214_103533_00064_h894h
[0m11:35:34.044603 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=GENERIC_USER_ERROR, message="Invalid object name: 'dbt2 with location ('s3a://lakehouse.dbt')'", query_id=20231214_103533_00064_h894h)
[0m11:35:34.045536 [debug] [ThreadPool]: On create_lakehouse_dbt2 WITH LOCATION ('s3a://lakehouse.dbt'): ROLLBACK
[0m11:35:34.046017 [debug] [ThreadPool]: On create_lakehouse_dbt2 WITH LOCATION ('s3a://lakehouse.dbt'): Close
[0m11:35:34.047267 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:35:34.047466 [debug] [MainThread]: Connection 'create_lakehouse_dbt2 WITH LOCATION ('s3a://lakehouse.dbt')' was properly closed.
[0m11:35:34.047649 [info ] [MainThread]: 
[0m11:35:34.047853 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.63 seconds (1.63s).
[0m11:35:34.048175 [error] [MainThread]: Encountered an error:
Database Error
  TrinoUserError(type=USER_ERROR, name=GENERIC_USER_ERROR, message="Invalid object name: 'dbt2 with location ('s3a://lakehouse.dbt')'", query_id=20231214_103533_00064_h894h)
[0m11:35:34.049135 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.5807872, "process_user_time": 2.067759, "process_kernel_time": 0.10988, "process_mem_max_rss": "113024", "process_in_blocks": "8", "process_out_blocks": "2304", "command_success": false}
[0m11:35:34.049590 [debug] [MainThread]: Command `dbt run` failed at 11:35:34.049479 after 2.58 seconds
[0m11:35:34.049890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043f868290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043f89aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0443f3b750>]}
[0m11:35:34.050199 [debug] [MainThread]: Flushing usage events
[0m19:06:41.207839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f775e1b6e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f775e1da1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f775e1da2d0>]}


============================== 19:06:41.210458 | f34d5add-44fc-43a4-9cd9-771d845a97db ==============================
[0m19:06:41.210458 [info ] [MainThread]: Running with dbt=1.7.3
[0m19:06:41.210804 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:06:41.329290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f34d5add-44fc-43a4-9cd9-771d845a97db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f775dfd4a50>]}
[0m19:06:41.379035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f34d5add-44fc-43a4-9cd9-771d845a97db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f775e1ef510>]}
[0m19:06:41.379482 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m19:06:41.386460 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m19:06:41.395057 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:06:41.395364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f34d5add-44fc-43a4-9cd9-771d845a97db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f775e1e0e90>]}
[0m19:06:42.059095 [error] [MainThread]: Encountered an error:
Compilation Error in model int_parts_suppliers (models/intermediate/int_parts_suppliers.sql)
  macro 'dbt_macro__default__surrogate_key' takes not more than 1 argument(s)
  
  > in macro surrogate_key (macros/sql/surrogate_key.sql)
  > called by model int_parts_suppliers (models/intermediate/int_parts_suppliers.sql)
[0m19:06:42.060061 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.87682194, "process_user_time": 1.888374, "process_kernel_time": 0.439621, "process_mem_max_rss": "105984", "process_in_blocks": "16", "process_out_blocks": "8", "command_success": false}
[0m19:06:42.060383 [debug] [MainThread]: Command `dbt run` failed at 19:06:42.060308 after 0.88 seconds
[0m19:06:42.060599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f775e1db3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f775e0c5350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f775faaaf50>]}
[0m19:06:42.060818 [debug] [MainThread]: Flushing usage events
[0m19:18:13.250393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ac1be9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ac872110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99acb05a50>]}


============================== 19:18:13.252234 | e45039c5-310c-4de5-9d2d-b5db2a8cc581 ==============================
[0m19:18:13.252234 [info ] [MainThread]: Running with dbt=1.7.3
[0m19:18:13.252659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:18:13.368270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e45039c5-310c-4de5-9d2d-b5db2a8cc581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ac09bfd0>]}
[0m19:18:13.419219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e45039c5-310c-4de5-9d2d-b5db2a8cc581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ac0a4290>]}
[0m19:18:13.419641 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m19:18:13.426594 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m19:18:13.434458 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:18:13.434879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e45039c5-310c-4de5-9d2d-b5db2a8cc581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99abc366d0>]}
[0m19:18:14.105856 [error] [MainThread]: Encountered an error:
Compilation Error in model int_parts_suppliers (models/intermediate/int_parts_suppliers.sql)
  macro 'dbt_macro__default__surrogate_key' takes not more than 1 argument(s)
  
  > in macro surrogate_key (macros/sql/surrogate_key.sql)
  > called by model int_parts_suppliers (models/intermediate/int_parts_suppliers.sql)
[0m19:18:14.106655 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.88126814, "process_user_time": 1.880128, "process_kernel_time": 0.200013, "process_mem_max_rss": "105692", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m19:18:14.107019 [debug] [MainThread]: Command `dbt run` failed at 19:18:14.106944 after 0.88 seconds
[0m19:18:14.107227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ac62d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ac0a4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99abfe7090>]}
[0m19:18:14.107463 [debug] [MainThread]: Flushing usage events
[0m19:18:31.048676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ed9a7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ed9a4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ed9a55d0>]}


============================== 19:18:31.050313 | 2e023d46-c811-4edf-956d-eed3dfadadc7 ==============================
[0m19:18:31.050313 [info ] [MainThread]: Running with dbt=1.7.3
[0m19:18:31.050677 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:18:31.165748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e023d46-c811-4edf-956d-eed3dfadadc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ed793b10>]}
[0m19:18:31.216236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e023d46-c811-4edf-956d-eed3dfadadc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ed9c96d0>]}
[0m19:18:31.216688 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m19:18:31.223434 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m19:18:31.230148 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:18:31.230439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2e023d46-c811-4edf-956d-eed3dfadadc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ed4264d0>]}
[0m19:18:31.896625 [error] [MainThread]: Encountered an error:
Compilation Error in model int_parts_suppliers (models/intermediate/int_parts_suppliers.sql)
  macro 'dbt_macro__generate_surrogate_key' takes not more than 1 argument(s)
[0m19:18:31.897339 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8725765, "process_user_time": 1.856668, "process_kernel_time": 0.109802, "process_mem_max_rss": "106380", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m19:18:31.897686 [debug] [MainThread]: Command `dbt run` failed at 19:18:31.897608 after 0.87 seconds
[0m19:18:31.897899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62f204b990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ed47fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ed99d5d0>]}
[0m19:18:31.898110 [debug] [MainThread]: Flushing usage events
[0m19:20:23.439887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f997319f190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f997319de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f997319e990>]}


============================== 19:20:23.441584 | 8fdb89d1-1dd4-4e72-814a-d580e76846d9 ==============================
[0m19:20:23.441584 [info ] [MainThread]: Running with dbt=1.7.3
[0m19:20:23.441937 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:20:23.555918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fdb89d1-1dd4-4e72-814a-d580e76846d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9972f74f90>]}
[0m19:20:23.606176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fdb89d1-1dd4-4e72-814a-d580e76846d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99731c8fd0>]}
[0m19:20:23.606626 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m19:20:23.613238 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m19:20:23.620483 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:20:23.620847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8fdb89d1-1dd4-4e72-814a-d580e76846d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9972fbb190>]}
[0m19:20:24.276335 [error] [MainThread]: Encountered an error:
Compilation Error in model int_parts_suppliers (models/intermediate/int_parts_suppliers.sql)
  macro 'dbt_macro__generate_surrogate_key' takes not more than 1 argument(s)
[0m19:20:24.276930 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.86097527, "process_user_time": 1.80554, "process_kernel_time": 0.110338, "process_mem_max_rss": "105732", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m19:20:24.277265 [debug] [MainThread]: Command `dbt run` failed at 19:20:24.277187 after 0.86 seconds
[0m19:20:24.277477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f997317af50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9972bf6d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f997317bf50>]}
[0m19:20:24.277685 [debug] [MainThread]: Flushing usage events
[0m19:31:34.768947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc88103c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc8814e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc8814ef10>]}


============================== 19:31:34.770645 | e635cd12-1579-4ab2-bb64-345b8652f6c8 ==============================
[0m19:31:34.770645 [info ] [MainThread]: Running with dbt=1.7.3
[0m19:31:34.770997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:31:34.885328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e635cd12-1579-4ab2-bb64-345b8652f6c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc87f44b10>]}
[0m19:31:34.935063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e635cd12-1579-4ab2-bb64-345b8652f6c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc88183150>]}
[0m19:31:34.935504 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m19:31:34.942505 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m19:31:34.949419 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:31:34.949732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e635cd12-1579-4ab2-bb64-345b8652f6c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc87b96a50>]}
[0m19:31:35.670407 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_trino_iceberg.fct_orders_items' (models/mart/fct_orders_items.sql) depends on a node named 'stg_tpch_order_items' which was not found
[0m19:31:35.671225 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.9258871, "process_user_time": 1.934979, "process_kernel_time": 0.080206, "process_mem_max_rss": "109448", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m19:31:35.671639 [debug] [MainThread]: Command `dbt run` failed at 19:31:35.671562 after 0.93 seconds
[0m19:31:35.671865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc8810be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc87f89110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc87bb21d0>]}
[0m19:31:35.672139 [debug] [MainThread]: Flushing usage events
[0m19:33:23.156366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eee42a890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eee42b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eee42b410>]}


============================== 19:33:23.158023 | aca159cd-c4da-4f56-b650-e86e9b4ff285 ==============================
[0m19:33:23.158023 [info ] [MainThread]: Running with dbt=1.7.3
[0m19:33:23.158364 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:33:23.274013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aca159cd-c4da-4f56-b650-e86e9b4ff285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eee2a7610>]}
[0m19:33:23.324982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aca159cd-c4da-4f56-b650-e86e9b4ff285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eee438390>]}
[0m19:33:23.325388 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m19:33:23.332000 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m19:33:23.339666 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:33:23.340061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aca159cd-c4da-4f56-b650-e86e9b4ff285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eee27a910>]}
[0m19:33:24.089271 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_trino_iceberg.vars
[0m19:33:24.092881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aca159cd-c4da-4f56-b650-e86e9b4ff285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eedda9350>]}
[0m19:33:24.103772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aca159cd-c4da-4f56-b650-e86e9b4ff285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eede36a90>]}
[0m19:33:24.104210 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m19:33:24.104510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aca159cd-c4da-4f56-b650-e86e9b4ff285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eee081cd0>]}
[0m19:33:24.106125 [info ] [MainThread]: 
[0m19:33:24.106710 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m19:33:24.107716 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m19:33:24.117832 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m19:33:24.118061 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m19:33:24.118228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:25.448958 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m19:33:25.451548 [debug] [ThreadPool]: On list_lakehouse: Close
[0m19:33:25.454451 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m19:33:25.460064 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m19:33:25.460274 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m19:33:25.460439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:33:26.821491 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m19:33:26.823758 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m19:33:26.823949 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m19:33:26.825872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aca159cd-c4da-4f56-b650-e86e9b4ff285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eee081cd0>]}
[0m19:33:26.826156 [debug] [MainThread]: On master: COMMIT
[0m19:33:26.826535 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:33:26.826762 [info ] [MainThread]: 
[0m19:33:26.830141 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_customers
[0m19:33:26.830599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.stg_tpch_customers)
[0m19:33:26.830812 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_customers
[0m19:33:26.832936 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_customers"
[0m19:33:26.833466 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_customers (compile): 19:33:26.830925 => 19:33:26.833325
[0m19:33:26.834045 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_customers
[0m19:33:26.834299 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m19:33:26.834701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_customers, now model.dbt_trino_iceberg.stg_tpch_line_item)
[0m19:33:26.834926 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_line_item
[0m19:33:26.837598 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_line_item"
[0m19:33:26.838191 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_line_item (compile): 19:33:26.835062 => 19:33:26.838044
[0m19:33:26.838725 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m19:33:26.838964 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_nation
[0m19:33:26.839324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_line_item, now model.dbt_trino_iceberg.stg_tpch_nation)
[0m19:33:26.839559 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_nation
[0m19:33:26.841462 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_nation"
[0m19:33:26.842080 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_nation (compile): 19:33:26.839712 => 19:33:26.841934
[0m19:33:26.842568 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_nation
[0m19:33:26.842813 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_orders
[0m19:33:26.843239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_nation, now model.dbt_trino_iceberg.stg_tpch_orders)
[0m19:33:26.843450 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_orders
[0m19:33:26.845548 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_orders"
[0m19:33:26.846103 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_orders (compile): 19:33:26.843575 => 19:33:26.845952
[0m19:33:26.846620 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_orders
[0m19:33:26.846859 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part
[0m19:33:26.847225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_orders, now model.dbt_trino_iceberg.stg_tpch_part)
[0m19:33:26.847431 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part
[0m19:33:26.849326 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part"
[0m19:33:26.850344 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part (compile): 19:33:26.847557 => 19:33:26.850145
[0m19:33:26.850881 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part
[0m19:33:26.851152 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m19:33:26.851590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part, now model.dbt_trino_iceberg.stg_tpch_part_suppliers)
[0m19:33:26.851829 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m19:33:26.854631 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part_suppliers"
[0m19:33:26.855357 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part_suppliers (compile): 19:33:26.851972 => 19:33:26.855203
[0m19:33:26.856045 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m19:33:26.856365 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_region
[0m19:33:26.856760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part_suppliers, now model.dbt_trino_iceberg.stg_tpch_region)
[0m19:33:26.857020 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_region
[0m19:33:26.858981 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_region"
[0m19:33:26.859518 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_region (compile): 19:33:26.857162 => 19:33:26.859372
[0m19:33:26.860010 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_region
[0m19:33:26.860262 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m19:33:26.860846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_region, now model.dbt_trino_iceberg.stg_tpch_supplier)
[0m19:33:26.861375 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_supplier
[0m19:33:26.863500 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_supplier"
[0m19:33:26.863946 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_supplier (compile): 19:33:26.861552 => 19:33:26.863812
[0m19:33:26.864430 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m19:33:26.864672 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.int_order_items
[0m19:33:26.864959 [info ] [Thread-1 (]: 1 of 7 START sql table model dbt.int_order_items ............................... [RUN]
[0m19:33:26.865675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_supplier, now model.dbt_trino_iceberg.int_order_items)
[0m19:33:26.865949 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.int_order_items
[0m19:33:26.878384 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.int_order_items"
[0m19:33:26.879348 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_order_items (compile): 19:33:26.866117 => 19:33:26.879174
[0m19:33:26.879576 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.int_order_items
[0m19:33:26.897395 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.int_order_items"
[0m19:33:26.902729 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_order_items"
[0m19:33:26.903065 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_order_items"} */

  
    

    create table "lakehouse"."dbt"."int_order_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_orders as (

select
    orderkey as order_key, 
    custkey as customer_key,
    orderstatus as order_status_code,
    totalprice as order_amount,
    orderdate as order_date,
    orderpriority as order_priority_code,
    clerk as order_clerk_name,
    shippriority as shipping_priority,
    comment as order_comment
from
    tpch.sf1.orders
),  __dbt__cte__stg_tpch_line_item as (

select
    orderkey as order_key,
    partkey as part_key,
    suppkey as supplier_key,
    linenumber as order_line_number,
    quantity as quantity,
    extendedprice as extended_price,
    discount as discount_percentage,
    tax as tax_rate,
    returnflag as return_status_code,
    linestatus as order_line_status_code,
    shipdate as ship_date,
    commitdate as commit_date,
    receiptdate as receipt_date,
    shipinstruct as ship_instructions_desc,
    shipmode as ship_mode_name,
    comment as order_line_comment
from
    tpch.sf1.lineitem
), orders as (
    
    select * from __dbt__cte__stg_tpch_orders

),
line_items as (

    select * from __dbt__cte__stg_tpch_line_item

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(o.order_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l.order_line_number as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as order_item_key,

    o.order_key,
    o.order_date,
    o.customer_key,
    o.order_status_code,
    
    l.part_key,
    l.supplier_key,
    l.return_status_code,
    l.order_line_number,
    l.order_line_status_code,
    l.ship_date,
    l.commit_date,
    l.receipt_date,
    l.ship_mode_name,

    l.quantity,
    
    -- extended_price is actually the line item total,
    -- so we back out the extended price per item
    (l.extended_price/nullif(l.quantity, 0)) as base_price,
    l.discount_percentage,
    ((l.extended_price/nullif(l.quantity, 0)) * (1 - l.discount_percentage)) as discounted_price,

    l.extended_price as gross_item_sales_amount,
    (l.extended_price * (1 - l.discount_percentage)) as discounted_item_sales_amount,
    -- We model discounts as negative amounts
    (-1 * l.extended_price * l.discount_percentage) as item_discount_amount,
    l.tax_rate,
    ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate) as item_tax_amount,
    (
        l.extended_price + 
        (-1 * l.extended_price * l.discount_percentage) + 
        ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate)
    ) as net_item_sales_amount

from
    orders o
    join
    line_items l
        on o.order_key = l.order_key
order by
    o.order_date
    )
[0m19:33:26.903317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:16.042610 [debug] [Thread-1 (]: SQL status: SUCCESS in 49.0 seconds
[0m19:34:16.055739 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_order_items (execute): 19:33:26.879689 => 19:34:16.055611
[0m19:34:16.055969 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: ROLLBACK
[0m19:34:16.056156 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: Close
[0m19:34:16.057241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aca159cd-c4da-4f56-b650-e86e9b4ff285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eecbf4990>]}
[0m19:34:16.057602 [info ] [Thread-1 (]: 1 of 7 OK created sql table model dbt.int_order_items .......................... [[32mSUCCESS[0m in 49.19s]
[0m19:34:16.058012 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.int_order_items
[0m19:34:16.058340 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_part_suppliers
[0m19:34:16.058627 [info ] [Thread-1 (]: 2 of 7 START sql table model dbt.dim_part_suppliers ............................ [RUN]
[0m19:34:16.059335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.int_order_items, now model.dbt_trino_iceberg.dim_part_suppliers)
[0m19:34:16.059574 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_part_suppliers
[0m19:34:16.068471 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m19:34:16.069134 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (compile): 19:34:16.059712 => 19:34:16.068924
[0m19:34:16.069385 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_part_suppliers
[0m19:34:16.074927 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."dim_part_suppliers"
[0m19:34:16.076191 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m19:34:16.076419 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

    drop table if exists "lakehouse"."dbt"."dim_part_suppliers"
[0m19:34:16.076600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:17.409906 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:34:17.412055 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m19:34:17.417110 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m19:34:17.417392 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
order by
    f.part_key,
    f.supplier_key
    )
[0m19:34:30.512712 [debug] [Thread-1 (]: SQL status: SUCCESS in 13.0 seconds
[0m19:34:30.518519 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (execute): 19:34:16.069508 => 19:34:30.518391
[0m19:34:30.518745 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: ROLLBACK
[0m19:34:30.518928 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: Close
[0m19:34:30.520149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aca159cd-c4da-4f56-b650-e86e9b4ff285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eecbee9d0>]}
[0m19:34:30.520519 [info ] [Thread-1 (]: 2 of 7 OK created sql table model dbt.dim_part_suppliers ....................... [[32mSUCCESS[0m in 14.46s]
[0m19:34:30.520880 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_part_suppliers
[0m19:34:30.521226 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_suppliers
[0m19:34:30.521528 [info ] [Thread-1 (]: 3 of 7 START sql table model dbt.dim_suppliers ................................. [RUN]
[0m19:34:30.522744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_part_suppliers, now model.dbt_trino_iceberg.dim_suppliers)
[0m19:34:30.522961 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_suppliers
[0m19:34:30.527499 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_suppliers"
[0m19:34:30.527972 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (compile): 19:34:30.523076 => 19:34:30.527807
[0m19:34:30.528178 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_suppliers
[0m19:34:30.531443 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."dim_suppliers"
[0m19:34:30.531968 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m19:34:30.532167 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt"."dim_suppliers"
[0m19:34:30.532340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:31.588830 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:34:31.592480 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_suppliers"
[0m19:34:31.596780 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m19:34:31.597011 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt"."dim_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m19:34:35.809010 [debug] [Thread-1 (]: SQL status: SUCCESS in 4.0 seconds
[0m19:34:35.813144 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (execute): 19:34:30.528284 => 19:34:35.813026
[0m19:34:35.815272 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: ROLLBACK
[0m19:34:35.815583 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: Close
[0m19:34:35.816714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aca159cd-c4da-4f56-b650-e86e9b4ff285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eeca87b50>]}
[0m19:34:35.817121 [info ] [Thread-1 (]: 3 of 7 OK created sql table model dbt.dim_suppliers ............................ [[32mSUCCESS[0m in 5.29s]
[0m19:34:35.817580 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_suppliers
[0m19:34:35.817920 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.int_parts_suppliers
[0m19:34:35.818195 [info ] [Thread-1 (]: 4 of 7 START sql table model dbt.int_parts_suppliers ........................... [RUN]
[0m19:34:35.818721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_suppliers, now model.dbt_trino_iceberg.int_parts_suppliers)
[0m19:34:35.818935 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.int_parts_suppliers
[0m19:34:35.827013 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.int_parts_suppliers"
[0m19:34:35.827795 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_parts_suppliers (compile): 19:34:35.819060 => 19:34:35.827637
[0m19:34:35.827998 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.int_parts_suppliers
[0m19:34:35.829758 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.int_parts_suppliers"
[0m19:34:35.833124 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_parts_suppliers"
[0m19:34:35.833378 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_parts_suppliers"} */

  
    

    create table "lakehouse"."dbt"."int_parts_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
part_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(p.part_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(s.supplier_key as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
			as part_supplier_key,
    p.part_key,
    p.part_name,
    p.part_manufacturer_name,
    p.part_brand_name,
    p.part_type_name,
    p.part_size,
    p.part_container_desc,
    p.retail_price,

    s.supplier_key,
    s.supplier_name,
    s.nation_key,

    ps.supplier_availabe_quantity,
    ps.supplier_cost_amount
from
    parts p
    join
    part_suppliers ps
        on p.part_key = ps.part_key
    join
    suppliers s
        on ps.supplier_key = s.supplier_key
order by
    p.part_key
    )
[0m19:34:35.833635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:46.470095 [debug] [Thread-1 (]: SQL status: SUCCESS in 11.0 seconds
[0m19:34:46.473830 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_parts_suppliers (execute): 19:34:35.828109 => 19:34:46.473610
[0m19:34:46.474202 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: ROLLBACK
[0m19:34:46.474530 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: Close
[0m19:34:46.476117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aca159cd-c4da-4f56-b650-e86e9b4ff285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eeca87b50>]}
[0m19:34:46.476508 [info ] [Thread-1 (]: 4 of 7 OK created sql table model dbt.int_parts_suppliers ...................... [[32mSUCCESS[0m in 10.66s]
[0m19:34:46.476879 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.int_parts_suppliers
[0m19:34:46.477186 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.fct_orders_items
[0m19:34:46.477456 [info ] [Thread-1 (]: 5 of 7 START sql table model dbt.fct_orders_items .............................. [RUN]
[0m19:34:46.478145 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.int_parts_suppliers, now model.dbt_trino_iceberg.fct_orders_items)
[0m19:34:46.478357 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.fct_orders_items
[0m19:34:46.486402 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.fct_orders_items"
[0m19:34:46.486940 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (compile): 19:34:46.478470 => 19:34:46.486788
[0m19:34:46.487146 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.fct_orders_items
[0m19:34:46.489905 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."fct_orders_items"
[0m19:34:46.490385 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m19:34:46.490584 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

    drop table if exists "lakehouse"."dbt"."fct_orders_items"
[0m19:34:46.490754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:47.548871 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:34:47.552755 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.fct_orders_items"
[0m19:34:47.557433 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m19:34:47.557677 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

  
    

    create table "lakehouse"."dbt"."fct_orders_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), orders_items as (
    
    select * from "lakehouse"."dbt"."int_order_items"

),
parts_suppliers as (
    
    select * from __dbt__cte__stg_tpch_part_suppliers

),
final as (
    select 

        o.order_item_key,
        o.order_key,
        o.order_date,
        o.customer_key,
        o.order_status_code,
        
        o.part_key,
        o.supplier_key,
        o.return_status_code,
        o.order_line_number,
        o.order_line_status_code,
        o.ship_date,
        o.commit_date,
        o.receipt_date,
        o.ship_mode_name,
        ps.supplier_cost_amount,
        
        o.base_price,
        o.discount_percentage,
        o.discounted_price,
        o.tax_rate,
        
        1 as order_item_count,
        o.quantity,

        o.gross_item_sales_amount,
        o.discounted_item_sales_amount,
        o.item_discount_amount,
        o.item_tax_amount,
        o.net_item_sales_amount

    from
        orders_items o
        join
        parts_suppliers ps
            on o.part_key = ps.part_key and
                o.supplier_key = ps.supplier_key
)
select *

from
    final f
order by
    f.order_date
    )
[0m19:35:21.264014 [debug] [Thread-1 (]: SQL status: SUCCESS in 34.0 seconds
[0m19:35:21.268137 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (execute): 19:34:46.487255 => 19:35:21.268012
[0m19:35:21.268346 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: ROLLBACK
[0m19:35:21.268525 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: Close
[0m19:35:21.269606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aca159cd-c4da-4f56-b650-e86e9b4ff285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eeca87b10>]}
[0m19:35:21.269965 [info ] [Thread-1 (]: 5 of 7 OK created sql table model dbt.fct_orders_items ......................... [[32mSUCCESS[0m in 34.79s]
[0m19:35:21.270337 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.fct_orders_items
[0m19:35:21.270632 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m19:35:21.270891 [info ] [Thread-1 (]: 6 of 7 START sql table model dbt.minimum_cost_suppliers ........................ [RUN]
[0m19:35:21.271597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.fct_orders_items, now model.dbt_trino_iceberg.minimum_cost_suppliers)
[0m19:35:21.271829 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m19:35:21.274910 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m19:35:21.275486 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (compile): 19:35:21.271962 => 19:35:21.275345
[0m19:35:21.275705 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m19:35:21.277490 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m19:35:21.279374 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m19:35:21.279608 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.minimum_cost_suppliers"} */

  
    

    create table "lakehouse"."dbt"."minimum_cost_suppliers"
      
      
    as (
      /*
2 Q2 - Minimum Cost Supplier Query
This query finds which supplier should be selected to place an order for a given part in a given region
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 30)
*/

with parts_suppliers as (

    select
        s.supplier_account_balance,
        s.supplier_name,
        s.supplier_nation_key,
        s.supplier_region_key,
        s.supplier_nation_name,
        s.supplier_region_name,
        s.part_key,
        s.part_manufacturer_name,
        s.part_size,
        s.part_type_name,
        s.supplier_cost_amount,
        s.supplier_address,
        s.supplier_phone_number,
        rank() over(partition by s.supplier_region_key, s.part_key order by s.supplier_cost_amount) as supplier_cost_rank,
        row_number() over(partition by s.supplier_region_key, s.part_key, s.supplier_cost_amount order by s.supplier_account_balance desc) as supplier_rank
    from
        "lakehouse"."dbt"."dim_part_suppliers" s
)
select
    s.*
from
    int_parts_suppliers  s
where
    s.supplier_cost_rank = 1 and 
    s.supplier_rank <= 100
order by 
    s.supplier_name, s.part_key
    )
[0m19:35:21.279815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:22.155023 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231217_183524_00012_ijqrb
[0m19:35:22.155936 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 42:5: Column 's.supplier_cost_rank' cannot be resolved", query_id=20231217_183524_00012_ijqrb)
[0m19:35:22.156896 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (execute): 19:35:21.275852 => 19:35:22.156552
[0m19:35:22.157451 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: ROLLBACK
[0m19:35:22.157967 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: Close
[0m19:35:22.177032 [debug] [Thread-1 (]: Database Error in model minimum_cost_suppliers (models/mart/minimum_cost_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 42:5: Column 's.supplier_cost_rank' cannot be resolved", query_id=20231217_183524_00012_ijqrb)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/minimum_cost_suppliers.sql
[0m19:35:22.178057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aca159cd-c4da-4f56-b650-e86e9b4ff285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eeca99ad0>]}
[0m19:35:22.178439 [error] [Thread-1 (]: 6 of 7 ERROR creating sql table model dbt.minimum_cost_suppliers ............... [[31mERROR[0m in 0.91s]
[0m19:35:22.178871 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m19:35:22.179231 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m19:35:22.179528 [info ] [Thread-1 (]: 7 of 7 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m19:35:22.180183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.minimum_cost_suppliers, now model.dbt_trino_iceberg.pricing_summary_report)
[0m19:35:22.180397 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m19:35:22.182979 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 19:35:22.180525 => 19:35:22.182837
[0m19:35:22.188433 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m19:35:22.188694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aca159cd-c4da-4f56-b650-e86e9b4ff285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eecb5bbd0>]}
[0m19:35:22.189004 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.01s]
[0m19:35:22.189316 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m19:35:22.190937 [debug] [MainThread]: On master: COMMIT
[0m19:35:22.191375 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:35:22.191566 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m19:35:22.191752 [info ] [MainThread]: 
[0m19:35:22.191950 [info ] [MainThread]: Finished running 7 table models in 0 hours 1 minutes and 58.09 seconds (118.09s).
[0m19:35:22.192739 [debug] [MainThread]: Command end result
[0m19:35:22.199549 [info ] [MainThread]: 
[0m19:35:22.199859 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:35:22.200196 [info ] [MainThread]: 
[0m19:35:22.200439 [error] [MainThread]:   Database Error in model minimum_cost_suppliers (models/mart/minimum_cost_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 42:5: Column 's.supplier_cost_rank' cannot be resolved", query_id=20231217_183524_00012_ijqrb)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/minimum_cost_suppliers.sql
[0m19:35:22.200674 [info ] [MainThread]: 
[0m19:35:22.201250 [error] [MainThread]:   Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m19:35:22.201569 [info ] [MainThread]: 
[0m19:35:22.201875 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m19:35:22.202566 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 119.070045, "process_user_time": 3.020986, "process_kernel_time": 0.224532, "process_mem_max_rss": "119892", "process_in_blocks": "784", "process_out_blocks": "3848", "command_success": false}
[0m19:35:22.202888 [debug] [MainThread]: Command `dbt run` failed at 19:35:22.202812 after 119.07 seconds
[0m19:35:22.203114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef2adf6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eee422e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eedd94dd0>]}
[0m19:35:22.203329 [debug] [MainThread]: Flushing usage events
[0m19:42:55.594316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f511063e390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51107f3e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51107f3250>]}


============================== 19:42:55.595902 | 1643d057-8d1f-418c-99c5-82e7f183332c ==============================
[0m19:42:55.595902 [info ] [MainThread]: Running with dbt=1.7.3
[0m19:42:55.596294 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:42:55.710550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1643d057-8d1f-418c-99c5-82e7f183332c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5110680250>]}
[0m19:42:55.759617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1643d057-8d1f-418c-99c5-82e7f183332c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5110703910>]}
[0m19:42:55.759993 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m19:42:55.766492 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m19:42:55.773517 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:42:55.773873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1643d057-8d1f-418c-99c5-82e7f183332c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51102a4c90>]}
[0m19:42:56.514462 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_trino_iceberg.dbt
[0m19:42:56.517956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1643d057-8d1f-418c-99c5-82e7f183332c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51102e4390>]}
[0m19:42:56.526525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1643d057-8d1f-418c-99c5-82e7f183332c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510f036790>]}
[0m19:42:56.526982 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m19:42:56.527294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1643d057-8d1f-418c-99c5-82e7f183332c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51103a7310>]}
[0m19:42:56.528756 [info ] [MainThread]: 
[0m19:42:56.529295 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m19:42:56.530396 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m19:42:56.540419 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m19:42:56.540626 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m19:42:56.540797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:42:59.237518 [debug] [ThreadPool]: SQL status: SUCCESS in 3.0 seconds
[0m19:42:59.239461 [debug] [ThreadPool]: On list_lakehouse: Close
[0m19:42:59.241532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m19:42:59.247872 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m19:42:59.248090 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m19:42:59.248257 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:43:00.634581 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m19:43:00.635577 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m19:43:00.639882 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m19:43:00.642283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1643d057-8d1f-418c-99c5-82e7f183332c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51103ada90>]}
[0m19:43:00.642612 [debug] [MainThread]: On master: COMMIT
[0m19:43:00.643005 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:43:00.643272 [info ] [MainThread]: 
[0m19:43:00.645700 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_customers
[0m19:43:00.646266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.stg_tpch_customers)
[0m19:43:00.646478 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_customers
[0m19:43:00.648421 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_customers"
[0m19:43:00.648875 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_customers (compile): 19:43:00.646593 => 19:43:00.648685
[0m19:43:00.649386 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_customers
[0m19:43:00.649634 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m19:43:00.649988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_customers, now model.dbt_trino_iceberg.stg_tpch_line_item)
[0m19:43:00.650210 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_line_item
[0m19:43:00.652828 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_line_item"
[0m19:43:00.653460 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_line_item (compile): 19:43:00.650343 => 19:43:00.653268
[0m19:43:00.653959 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m19:43:00.654201 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_nation
[0m19:43:00.654550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_line_item, now model.dbt_trino_iceberg.stg_tpch_nation)
[0m19:43:00.654756 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_nation
[0m19:43:00.656783 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_nation"
[0m19:43:00.657352 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_nation (compile): 19:43:00.654880 => 19:43:00.657120
[0m19:43:00.658090 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_nation
[0m19:43:00.658427 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_orders
[0m19:43:00.658931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_nation, now model.dbt_trino_iceberg.stg_tpch_orders)
[0m19:43:00.659225 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_orders
[0m19:43:00.661377 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_orders"
[0m19:43:00.661911 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_orders (compile): 19:43:00.659402 => 19:43:00.661770
[0m19:43:00.662375 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_orders
[0m19:43:00.662618 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part
[0m19:43:00.663000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_orders, now model.dbt_trino_iceberg.stg_tpch_part)
[0m19:43:00.663307 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part
[0m19:43:00.665833 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part"
[0m19:43:00.666841 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part (compile): 19:43:00.663477 => 19:43:00.666673
[0m19:43:00.667348 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part
[0m19:43:00.667594 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m19:43:00.668041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part, now model.dbt_trino_iceberg.stg_tpch_part_suppliers)
[0m19:43:00.668259 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m19:43:00.670988 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part_suppliers"
[0m19:43:00.671373 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part_suppliers (compile): 19:43:00.668387 => 19:43:00.671210
[0m19:43:00.671928 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m19:43:00.672165 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_region
[0m19:43:00.672515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part_suppliers, now model.dbt_trino_iceberg.stg_tpch_region)
[0m19:43:00.672761 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_region
[0m19:43:00.674700 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_region"
[0m19:43:00.675367 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_region (compile): 19:43:00.672898 => 19:43:00.675171
[0m19:43:00.675859 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_region
[0m19:43:00.676106 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m19:43:00.676467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_region, now model.dbt_trino_iceberg.stg_tpch_supplier)
[0m19:43:00.676674 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_supplier
[0m19:43:00.678453 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_supplier"
[0m19:43:00.678794 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_supplier (compile): 19:43:00.676801 => 19:43:00.678667
[0m19:43:00.679314 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m19:43:00.679591 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.int_order_items
[0m19:43:00.679853 [info ] [Thread-1 (]: 1 of 7 START sql view model dbt.int_order_items ................................ [RUN]
[0m19:43:00.681327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_supplier, now model.dbt_trino_iceberg.int_order_items)
[0m19:43:00.681650 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.int_order_items
[0m19:43:00.694260 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.int_order_items"
[0m19:43:00.694762 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_order_items (compile): 19:43:00.681828 => 19:43:00.694600
[0m19:43:00.694979 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.int_order_items
[0m19:43:00.713878 [debug] [Thread-1 (]: Dropping relation "lakehouse"."dbt"."int_order_items" because it is of type table
[0m19:43:00.719051 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."int_order_items"
[0m19:43:00.720615 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_order_items"
[0m19:43:00.720848 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_order_items"} */

    drop table if exists "lakehouse"."dbt"."int_order_items"
[0m19:43:00.721029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:43:01.486779 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:43:01.493314 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.int_order_items"
[0m19:43:01.497366 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_order_items"
[0m19:43:01.497644 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_order_items"} */

  create or replace view
    "lakehouse"."dbt"."int_order_items"
  security definer
  as
    with  __dbt__cte__stg_tpch_orders as (

select
    orderkey as order_key, 
    custkey as customer_key,
    orderstatus as order_status_code,
    totalprice as order_amount,
    orderdate as order_date,
    orderpriority as order_priority_code,
    clerk as order_clerk_name,
    shippriority as shipping_priority,
    comment as order_comment
from
    tpch.sf1.orders
),  __dbt__cte__stg_tpch_line_item as (

select
    orderkey as order_key,
    partkey as part_key,
    suppkey as supplier_key,
    linenumber as order_line_number,
    quantity as quantity,
    extendedprice as extended_price,
    discount as discount_percentage,
    tax as tax_rate,
    returnflag as return_status_code,
    linestatus as order_line_status_code,
    shipdate as ship_date,
    commitdate as commit_date,
    receiptdate as receipt_date,
    shipinstruct as ship_instructions_desc,
    shipmode as ship_mode_name,
    comment as order_line_comment
from
    tpch.sf1.lineitem
), orders as (
    
    select * from __dbt__cte__stg_tpch_orders

),
line_items as (

    select * from __dbt__cte__stg_tpch_line_item

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(o.order_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l.order_line_number as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as order_item_key,

    o.order_key,
    o.order_date,
    o.customer_key,
    o.order_status_code,
    
    l.part_key,
    l.supplier_key,
    l.return_status_code,
    l.order_line_number,
    l.order_line_status_code,
    l.ship_date,
    l.commit_date,
    l.receipt_date,
    l.ship_mode_name,

    l.quantity,
    
    -- extended_price is actually the line item total,
    -- so we back out the extended price per item
    (l.extended_price/nullif(l.quantity, 0)) as base_price,
    l.discount_percentage,
    ((l.extended_price/nullif(l.quantity, 0)) * (1 - l.discount_percentage)) as discounted_price,

    l.extended_price as gross_item_sales_amount,
    (l.extended_price * (1 - l.discount_percentage)) as discounted_item_sales_amount,
    -- We model discounts as negative amounts
    (-1 * l.extended_price * l.discount_percentage) as item_discount_amount,
    l.tax_rate,
    ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate) as item_tax_amount,
    (
        l.extended_price + 
        (-1 * l.extended_price * l.discount_percentage) + 
        ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate)
    ) as net_item_sales_amount

from
    orders o
    join
    line_items l
        on o.order_key = l.order_key
order by
    o.order_date
  
[0m19:43:02.840660 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:43:02.851257 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_order_items (execute): 19:43:00.695095 => 19:43:02.851104
[0m19:43:02.851522 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: ROLLBACK
[0m19:43:02.851714 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: Close
[0m19:43:02.852932 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1643d057-8d1f-418c-99c5-82e7f183332c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510f0016d0>]}
[0m19:43:02.853329 [info ] [Thread-1 (]: 1 of 7 OK created sql view model dbt.int_order_items ........................... [[32mSUCCESS[0m in 2.17s]
[0m19:43:02.854049 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.int_order_items
[0m19:43:02.854442 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_part_suppliers
[0m19:43:02.854728 [info ] [Thread-1 (]: 2 of 7 START sql view model dbt.dim_part_suppliers ............................. [RUN]
[0m19:43:02.855437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.int_order_items, now model.dbt_trino_iceberg.dim_part_suppliers)
[0m19:43:02.855668 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_part_suppliers
[0m19:43:02.864652 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m19:43:02.865047 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (compile): 19:43:02.855812 => 19:43:02.864915
[0m19:43:02.865240 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_part_suppliers
[0m19:43:02.866809 [debug] [Thread-1 (]: Dropping relation "lakehouse"."dbt"."dim_part_suppliers" because it is of type table
[0m19:43:02.868246 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."dim_part_suppliers"
[0m19:43:02.868814 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m19:43:02.869008 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

    drop table if exists "lakehouse"."dbt"."dim_part_suppliers"
[0m19:43:02.869177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:43:03.937621 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:43:03.940083 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m19:43:03.944752 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m19:43:03.945031 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

  create or replace view
    "lakehouse"."dbt"."dim_part_suppliers"
  security definer
  as
    with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
order by
    f.part_key,
    f.supplier_key
  
[0m19:43:05.019992 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:43:05.021681 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (execute): 19:43:02.865350 => 19:43:05.021542
[0m19:43:05.021913 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: ROLLBACK
[0m19:43:05.022114 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: Close
[0m19:43:05.023529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1643d057-8d1f-418c-99c5-82e7f183332c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51101e3410>]}
[0m19:43:05.023947 [info ] [Thread-1 (]: 2 of 7 OK created sql view model dbt.dim_part_suppliers ........................ [[32mSUCCESS[0m in 2.17s]
[0m19:43:05.024416 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_part_suppliers
[0m19:43:05.024723 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_suppliers
[0m19:43:05.025055 [info ] [Thread-1 (]: 3 of 7 START sql view model dbt.dim_suppliers .................................. [RUN]
[0m19:43:05.025794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_part_suppliers, now model.dbt_trino_iceberg.dim_suppliers)
[0m19:43:05.026059 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_suppliers
[0m19:43:05.033097 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_suppliers"
[0m19:43:05.033677 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (compile): 19:43:05.026247 => 19:43:05.033494
[0m19:43:05.033978 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_suppliers
[0m19:43:05.036593 [debug] [Thread-1 (]: Dropping relation "lakehouse"."dbt"."dim_suppliers" because it is of type table
[0m19:43:05.039878 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."dim_suppliers"
[0m19:43:05.040681 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m19:43:05.040967 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt"."dim_suppliers"
[0m19:43:05.041165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:43:06.236196 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:43:06.239064 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_suppliers"
[0m19:43:06.246409 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m19:43:06.246726 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

  create or replace view
    "lakehouse"."dbt"."dim_suppliers"
  security definer
  as
    with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
  
[0m19:43:06.991220 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:43:06.992863 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (execute): 19:43:05.034133 => 19:43:06.992731
[0m19:43:06.993078 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: ROLLBACK
[0m19:43:06.993265 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: Close
[0m19:43:06.994463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1643d057-8d1f-418c-99c5-82e7f183332c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510effd250>]}
[0m19:43:06.994798 [info ] [Thread-1 (]: 3 of 7 OK created sql view model dbt.dim_suppliers ............................. [[32mSUCCESS[0m in 1.97s]
[0m19:43:06.995152 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_suppliers
[0m19:43:06.995584 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.int_parts_suppliers
[0m19:43:06.995849 [info ] [Thread-1 (]: 4 of 7 START sql view model dbt.int_parts_suppliers ............................ [RUN]
[0m19:43:06.996385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_suppliers, now model.dbt_trino_iceberg.int_parts_suppliers)
[0m19:43:06.996580 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.int_parts_suppliers
[0m19:43:07.004453 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.int_parts_suppliers"
[0m19:43:07.004862 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_parts_suppliers (compile): 19:43:06.996685 => 19:43:07.004729
[0m19:43:07.005055 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.int_parts_suppliers
[0m19:43:07.006572 [debug] [Thread-1 (]: Dropping relation "lakehouse"."dbt"."int_parts_suppliers" because it is of type table
[0m19:43:07.007952 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."int_parts_suppliers"
[0m19:43:07.008449 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_parts_suppliers"
[0m19:43:07.008653 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_parts_suppliers"} */

    drop table if exists "lakehouse"."dbt"."int_parts_suppliers"
[0m19:43:07.008832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:43:08.119939 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:43:08.122312 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.int_parts_suppliers"
[0m19:43:08.126461 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_parts_suppliers"
[0m19:43:08.126712 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_parts_suppliers"} */

  create or replace view
    "lakehouse"."dbt"."int_parts_suppliers"
  security definer
  as
    with  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
part_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(p.part_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(s.supplier_key as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
			as part_supplier_key,
    p.part_key,
    p.part_name,
    p.part_manufacturer_name,
    p.part_brand_name,
    p.part_type_name,
    p.part_size,
    p.part_container_desc,
    p.retail_price,

    s.supplier_key,
    s.supplier_name,
    s.nation_key,

    ps.supplier_availabe_quantity,
    ps.supplier_cost_amount
from
    parts p
    join
    part_suppliers ps
        on p.part_key = ps.part_key
    join
    suppliers s
        on ps.supplier_key = s.supplier_key
order by
    p.part_key
  
[0m19:43:08.608469 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:43:08.611564 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_parts_suppliers (execute): 19:43:07.005163 => 19:43:08.611345
[0m19:43:08.611936 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: ROLLBACK
[0m19:43:08.612183 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: Close
[0m19:43:08.613344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1643d057-8d1f-418c-99c5-82e7f183332c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510f06a8d0>]}
[0m19:43:08.613735 [info ] [Thread-1 (]: 4 of 7 OK created sql view model dbt.int_parts_suppliers ....................... [[32mSUCCESS[0m in 1.62s]
[0m19:43:08.614156 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.int_parts_suppliers
[0m19:43:08.614556 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.fct_orders_items
[0m19:43:08.614832 [info ] [Thread-1 (]: 5 of 7 START sql view model dbt.fct_orders_items ............................... [RUN]
[0m19:43:08.615552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.int_parts_suppliers, now model.dbt_trino_iceberg.fct_orders_items)
[0m19:43:08.615845 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.fct_orders_items
[0m19:43:08.623373 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.fct_orders_items"
[0m19:43:08.623900 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (compile): 19:43:08.615969 => 19:43:08.623747
[0m19:43:08.624116 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.fct_orders_items
[0m19:43:08.625650 [debug] [Thread-1 (]: Dropping relation "lakehouse"."dbt"."fct_orders_items" because it is of type table
[0m19:43:08.628039 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."fct_orders_items"
[0m19:43:08.628542 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m19:43:08.628742 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

    drop table if exists "lakehouse"."dbt"."fct_orders_items"
[0m19:43:08.628915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:43:09.157852 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:43:09.159219 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.fct_orders_items"
[0m19:43:09.162475 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m19:43:09.162754 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

  create or replace view
    "lakehouse"."dbt"."fct_orders_items"
  security definer
  as
    with  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), orders_items as (
    
    select * from "lakehouse"."dbt"."int_order_items"

),
parts_suppliers as (
    
    select * from __dbt__cte__stg_tpch_part_suppliers

),
final as (
    select 

        o.order_item_key,
        o.order_key,
        o.order_date,
        o.customer_key,
        o.order_status_code,
        
        o.part_key,
        o.supplier_key,
        o.return_status_code,
        o.order_line_number,
        o.order_line_status_code,
        o.ship_date,
        o.commit_date,
        o.receipt_date,
        o.ship_mode_name,
        ps.supplier_cost_amount,
        
        o.base_price,
        o.discount_percentage,
        o.discounted_price,
        o.tax_rate,
        
        1 as order_item_count,
        o.quantity,

        o.gross_item_sales_amount,
        o.discounted_item_sales_amount,
        o.item_discount_amount,
        o.item_tax_amount,
        o.net_item_sales_amount

    from
        orders_items o
        join
        parts_suppliers ps
            on o.part_key = ps.part_key and
                o.supplier_key = ps.supplier_key
)
select *

from
    final f
order by
    f.order_date
  
[0m19:43:09.826411 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:43:09.828591 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (execute): 19:43:08.624240 => 19:43:09.828344
[0m19:43:09.829007 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: ROLLBACK
[0m19:43:09.829255 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: Close
[0m19:43:09.830711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1643d057-8d1f-418c-99c5-82e7f183332c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510ee6c050>]}
[0m19:43:09.831189 [info ] [Thread-1 (]: 5 of 7 OK created sql view model dbt.fct_orders_items .......................... [[32mSUCCESS[0m in 1.22s]
[0m19:43:09.831759 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.fct_orders_items
[0m19:43:09.832090 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m19:43:09.832434 [info ] [Thread-1 (]: 6 of 7 START sql view model dbt.minimum_cost_suppliers ......................... [RUN]
[0m19:43:09.832995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.fct_orders_items, now model.dbt_trino_iceberg.minimum_cost_suppliers)
[0m19:43:09.833527 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m19:43:09.836182 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m19:43:09.836717 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (compile): 19:43:09.833903 => 19:43:09.836544
[0m19:43:09.836961 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m19:43:09.840739 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m19:43:09.842910 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m19:43:09.843193 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.minimum_cost_suppliers"} */

  create or replace view
    "lakehouse"."dbt"."minimum_cost_suppliers"
  security definer
  as
    /*
2 Q2 - Minimum Cost Supplier Query
This query finds which supplier should be selected to place an order for a given part in a given region
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 30)
*/

with parts_suppliers as (

    select
        s.supplier_account_balance,
        s.supplier_name,
        s.supplier_nation_key,
        s.supplier_region_key,
        s.supplier_nation_name,
        s.supplier_region_name,
        s.part_key,
        s.part_manufacturer_name,
        s.part_size,
        s.part_type_name,
        s.supplier_cost_amount,
        s.supplier_address,
        s.supplier_phone_number,
        rank() over(partition by s.supplier_region_key, s.part_key order by s.supplier_cost_amount) as supplier_cost_rank,
        row_number() over(partition by s.supplier_region_key, s.part_key, s.supplier_cost_amount order by s.supplier_account_balance desc) as supplier_rank
    from
        "lakehouse"."dbt"."dim_part_suppliers" s
)
select
    s.*
from
    int_parts_suppliers  s
where
    s.supplier_cost_rank = 1 and 
    s.supplier_rank <= 100
order by 
    s.supplier_name, s.part_key
  
[0m19:43:09.843432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:43:10.263411 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231217_184312_00025_ijqrb
[0m19:43:10.263744 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:5: Column 's.supplier_cost_rank' cannot be resolved", query_id=20231217_184312_00025_ijqrb)
[0m19:43:10.264111 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (execute): 19:43:09.838425 => 19:43:10.263957
[0m19:43:10.264339 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: ROLLBACK
[0m19:43:10.264536 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: Close
[0m19:43:10.267169 [debug] [Thread-1 (]: Database Error in model minimum_cost_suppliers (models/mart/minimum_cost_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:5: Column 's.supplier_cost_rank' cannot be resolved", query_id=20231217_184312_00025_ijqrb)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/minimum_cost_suppliers.sql
[0m19:43:10.268392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1643d057-8d1f-418c-99c5-82e7f183332c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51103edd50>]}
[0m19:43:10.268755 [error] [Thread-1 (]: 6 of 7 ERROR creating sql view model dbt.minimum_cost_suppliers ................ [[31mERROR[0m in 0.44s]
[0m19:43:10.269165 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m19:43:10.269551 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m19:43:10.269888 [info ] [Thread-1 (]: 7 of 7 START sql view model dbt.pricing_summary_report ......................... [RUN]
[0m19:43:10.270583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.minimum_cost_suppliers, now model.dbt_trino_iceberg.pricing_summary_report)
[0m19:43:10.270870 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m19:43:10.273717 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 19:43:10.271009 => 19:43:10.273566
[0m19:43:10.274980 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m19:43:10.275252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1643d057-8d1f-418c-99c5-82e7f183332c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5110364050>]}
[0m19:43:10.275656 [error] [Thread-1 (]: 7 of 7 ERROR creating sql view model dbt.pricing_summary_report ................ [[31mERROR[0m in 0.00s]
[0m19:43:10.276107 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m19:43:10.277682 [debug] [MainThread]: On master: COMMIT
[0m19:43:10.278117 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:43:10.278302 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m19:43:10.278538 [info ] [MainThread]: 
[0m19:43:10.278829 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 13.75 seconds (13.75s).
[0m19:43:10.279761 [debug] [MainThread]: Command end result
[0m19:43:10.287278 [info ] [MainThread]: 
[0m19:43:10.287828 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:43:10.288176 [info ] [MainThread]: 
[0m19:43:10.288532 [error] [MainThread]:   Database Error in model minimum_cost_suppliers (models/mart/minimum_cost_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:5: Column 's.supplier_cost_rank' cannot be resolved", query_id=20231217_184312_00025_ijqrb)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/minimum_cost_suppliers.sql
[0m19:43:10.288856 [info ] [MainThread]: 
[0m19:43:10.289094 [error] [MainThread]:   Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m19:43:10.289447 [info ] [MainThread]: 
[0m19:43:10.289823 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m19:43:10.290581 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 14.719859, "process_user_time": 2.543506, "process_kernel_time": 0.099745, "process_mem_max_rss": "116948", "process_out_blocks": "3808", "command_success": false, "process_in_blocks": "0"}
[0m19:43:10.290882 [debug] [MainThread]: Command `dbt run` failed at 19:43:10.290812 after 14.72 seconds
[0m19:43:10.291126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f511064d510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f511027ecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5114eb36d0>]}
[0m19:43:10.291503 [debug] [MainThread]: Flushing usage events
[0m19:45:27.313573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ff9fce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ff856150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ff9fee10>]}


============================== 19:45:27.315262 | 20e2212b-e913-498d-a454-33d09777b52a ==============================
[0m19:45:27.315262 [info ] [MainThread]: Running with dbt=1.7.3
[0m19:45:27.315608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:45:27.428947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20e2212b-e913-498d-a454-33d09777b52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ff7ec610>]}
[0m19:45:27.478479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20e2212b-e913-498d-a454-33d09777b52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ff79bad0>]}
[0m19:45:27.478937 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m19:45:27.485887 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m19:45:27.493089 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:45:27.493394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '20e2212b-e913-498d-a454-33d09777b52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ff7ee910>]}
[0m19:45:28.228328 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_trino_iceberg.dbt
- models.dbt_trino_iceberg.dbt.vars
[0m19:45:28.231902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20e2212b-e913-498d-a454-33d09777b52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ff90f690>]}
[0m19:45:28.239598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20e2212b-e913-498d-a454-33d09777b52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ff365a50>]}
[0m19:45:28.239913 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m19:45:28.240148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20e2212b-e913-498d-a454-33d09777b52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ff5b7310>]}
[0m19:45:28.241556 [info ] [MainThread]: 
[0m19:45:28.242065 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m19:45:28.243059 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m19:45:28.253318 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m19:45:28.253577 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m19:45:28.253746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:45:29.789562 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m19:45:29.792331 [debug] [ThreadPool]: On list_lakehouse: Close
[0m19:45:29.794610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m19:45:29.800263 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m19:45:29.800473 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m19:45:29.800646 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:45:30.582391 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m19:45:30.584372 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m19:45:30.584545 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m19:45:30.586727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20e2212b-e913-498d-a454-33d09777b52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ff90d610>]}
[0m19:45:30.586999 [debug] [MainThread]: On master: COMMIT
[0m19:45:30.587362 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:45:30.587577 [info ] [MainThread]: 
[0m19:45:30.589905 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_customers
[0m19:45:30.590361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.stg_tpch_customers)
[0m19:45:30.590611 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_customers
[0m19:45:30.593097 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_customers"
[0m19:45:30.593622 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_customers (compile): 19:45:30.590945 => 19:45:30.593437
[0m19:45:30.594268 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_customers
[0m19:45:30.594576 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m19:45:30.594964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_customers, now model.dbt_trino_iceberg.stg_tpch_line_item)
[0m19:45:30.595186 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_line_item
[0m19:45:30.597488 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_line_item"
[0m19:45:30.597969 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_line_item (compile): 19:45:30.595316 => 19:45:30.597828
[0m19:45:30.598423 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m19:45:30.598656 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_nation
[0m19:45:30.599056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_line_item, now model.dbt_trino_iceberg.stg_tpch_nation)
[0m19:45:30.599259 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_nation
[0m19:45:30.601003 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_nation"
[0m19:45:30.601697 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_nation (compile): 19:45:30.599381 => 19:45:30.601457
[0m19:45:30.602238 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_nation
[0m19:45:30.602495 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_orders
[0m19:45:30.602861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_nation, now model.dbt_trino_iceberg.stg_tpch_orders)
[0m19:45:30.603074 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_orders
[0m19:45:30.604931 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_orders"
[0m19:45:30.605486 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_orders (compile): 19:45:30.603201 => 19:45:30.605339
[0m19:45:30.605952 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_orders
[0m19:45:30.606191 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part
[0m19:45:30.606543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_orders, now model.dbt_trino_iceberg.stg_tpch_part)
[0m19:45:30.606748 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part
[0m19:45:30.608517 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part"
[0m19:45:30.608936 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part (compile): 19:45:30.606872 => 19:45:30.608769
[0m19:45:30.609501 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part
[0m19:45:30.609745 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m19:45:30.610096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part, now model.dbt_trino_iceberg.stg_tpch_part_suppliers)
[0m19:45:30.610300 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m19:45:30.613027 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part_suppliers"
[0m19:45:30.613377 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part_suppliers (compile): 19:45:30.610424 => 19:45:30.613252
[0m19:45:30.613891 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m19:45:30.614126 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_region
[0m19:45:30.614468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part_suppliers, now model.dbt_trino_iceberg.stg_tpch_region)
[0m19:45:30.614671 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_region
[0m19:45:30.616394 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_region"
[0m19:45:30.617140 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_region (compile): 19:45:30.614796 => 19:45:30.616946
[0m19:45:30.617803 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_region
[0m19:45:30.618206 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m19:45:30.618720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_region, now model.dbt_trino_iceberg.stg_tpch_supplier)
[0m19:45:30.618931 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_supplier
[0m19:45:30.620818 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_supplier"
[0m19:45:30.621308 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_supplier (compile): 19:45:30.619060 => 19:45:30.621112
[0m19:45:30.621809 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m19:45:30.622041 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.int_order_items
[0m19:45:30.622301 [info ] [Thread-1 (]: 1 of 7 START sql view model dbt.int_order_items ................................ [RUN]
[0m19:45:30.622747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_supplier, now model.dbt_trino_iceberg.int_order_items)
[0m19:45:30.622996 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.int_order_items
[0m19:45:30.635622 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.int_order_items"
[0m19:45:30.636120 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_order_items (compile): 19:45:30.623126 => 19:45:30.635956
[0m19:45:30.636332 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.int_order_items
[0m19:45:30.648369 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.int_order_items"
[0m19:45:30.653982 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_order_items"
[0m19:45:30.654345 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_order_items"} */

  create or replace view
    "lakehouse"."dbt"."int_order_items"
  security definer
  as
    with  __dbt__cte__stg_tpch_orders as (

select
    orderkey as order_key, 
    custkey as customer_key,
    orderstatus as order_status_code,
    totalprice as order_amount,
    orderdate as order_date,
    orderpriority as order_priority_code,
    clerk as order_clerk_name,
    shippriority as shipping_priority,
    comment as order_comment
from
    tpch.sf1.orders
),  __dbt__cte__stg_tpch_line_item as (

select
    orderkey as order_key,
    partkey as part_key,
    suppkey as supplier_key,
    linenumber as order_line_number,
    quantity as quantity,
    extendedprice as extended_price,
    discount as discount_percentage,
    tax as tax_rate,
    returnflag as return_status_code,
    linestatus as order_line_status_code,
    shipdate as ship_date,
    commitdate as commit_date,
    receiptdate as receipt_date,
    shipinstruct as ship_instructions_desc,
    shipmode as ship_mode_name,
    comment as order_line_comment
from
    tpch.sf1.lineitem
), orders as (
    
    select * from __dbt__cte__stg_tpch_orders

),
line_items as (

    select * from __dbt__cte__stg_tpch_line_item

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(o.order_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l.order_line_number as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as order_item_key,

    o.order_key,
    o.order_date,
    o.customer_key,
    o.order_status_code,
    
    l.part_key,
    l.supplier_key,
    l.return_status_code,
    l.order_line_number,
    l.order_line_status_code,
    l.ship_date,
    l.commit_date,
    l.receipt_date,
    l.ship_mode_name,

    l.quantity,
    
    -- extended_price is actually the line item total,
    -- so we back out the extended price per item
    (l.extended_price/nullif(l.quantity, 0)) as base_price,
    l.discount_percentage,
    ((l.extended_price/nullif(l.quantity, 0)) * (1 - l.discount_percentage)) as discounted_price,

    l.extended_price as gross_item_sales_amount,
    (l.extended_price * (1 - l.discount_percentage)) as discounted_item_sales_amount,
    -- We model discounts as negative amounts
    (-1 * l.extended_price * l.discount_percentage) as item_discount_amount,
    l.tax_rate,
    ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate) as item_tax_amount,
    (
        l.extended_price + 
        (-1 * l.extended_price * l.discount_percentage) + 
        ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate)
    ) as net_item_sales_amount

from
    orders o
    join
    line_items l
        on o.order_key = l.order_key
order by
    o.order_date
  
[0m19:45:30.654612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:31.300509 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:45:31.315320 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_order_items (execute): 19:45:30.636447 => 19:45:31.315015
[0m19:45:31.316055 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: ROLLBACK
[0m19:45:31.316543 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: Close
[0m19:45:31.318442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20e2212b-e913-498d-a454-33d09777b52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03fe1fd850>]}
[0m19:45:31.319041 [info ] [Thread-1 (]: 1 of 7 OK created sql view model dbt.int_order_items ........................... [[32mSUCCESS[0m in 0.70s]
[0m19:45:31.319595 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.int_order_items
[0m19:45:31.319972 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_part_suppliers
[0m19:45:31.320360 [info ] [Thread-1 (]: 2 of 7 START sql view model dbt.dim_part_suppliers ............................. [RUN]
[0m19:45:31.321410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.int_order_items, now model.dbt_trino_iceberg.dim_part_suppliers)
[0m19:45:31.321914 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_part_suppliers
[0m19:45:31.333419 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m19:45:31.333945 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (compile): 19:45:31.322209 => 19:45:31.333786
[0m19:45:31.334159 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_part_suppliers
[0m19:45:31.336054 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m19:45:31.340182 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m19:45:31.340450 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

  create or replace view
    "lakehouse"."dbt"."dim_part_suppliers"
  security definer
  as
    with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
order by
    f.part_key,
    f.supplier_key
  
[0m19:45:31.340695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:32.143096 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:45:32.147560 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (execute): 19:45:31.334273 => 19:45:32.147266
[0m19:45:32.147910 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: ROLLBACK
[0m19:45:32.148158 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: Close
[0m19:45:32.149532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20e2212b-e913-498d-a454-33d09777b52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03fe16bed0>]}
[0m19:45:32.149854 [info ] [Thread-1 (]: 2 of 7 OK created sql view model dbt.dim_part_suppliers ........................ [[32mSUCCESS[0m in 0.83s]
[0m19:45:32.150212 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_part_suppliers
[0m19:45:32.150513 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_suppliers
[0m19:45:32.151004 [info ] [Thread-1 (]: 3 of 7 START sql view model dbt.dim_suppliers .................................. [RUN]
[0m19:45:32.151516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_part_suppliers, now model.dbt_trino_iceberg.dim_suppliers)
[0m19:45:32.151740 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_suppliers
[0m19:45:32.156987 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_suppliers"
[0m19:45:32.157778 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (compile): 19:45:32.151872 => 19:45:32.157556
[0m19:45:32.159568 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_suppliers
[0m19:45:32.161869 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_suppliers"
[0m19:45:32.164015 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m19:45:32.164256 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

  create or replace view
    "lakehouse"."dbt"."dim_suppliers"
  security definer
  as
    with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
  
[0m19:45:32.164463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:32.866329 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:45:32.870426 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (execute): 19:45:32.159753 => 19:45:32.870301
[0m19:45:32.872858 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: ROLLBACK
[0m19:45:32.873178 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: Close
[0m19:45:32.874566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20e2212b-e913-498d-a454-33d09777b52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ff568c90>]}
[0m19:45:32.874985 [info ] [Thread-1 (]: 3 of 7 OK created sql view model dbt.dim_suppliers ............................. [[32mSUCCESS[0m in 0.72s]
[0m19:45:32.875503 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_suppliers
[0m19:45:32.875807 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.int_parts_suppliers
[0m19:45:32.876111 [info ] [Thread-1 (]: 4 of 7 START sql view model dbt.int_parts_suppliers ............................ [RUN]
[0m19:45:32.876983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_suppliers, now model.dbt_trino_iceberg.int_parts_suppliers)
[0m19:45:32.877196 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.int_parts_suppliers
[0m19:45:32.886216 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.int_parts_suppliers"
[0m19:45:32.886633 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_parts_suppliers (compile): 19:45:32.877311 => 19:45:32.886493
[0m19:45:32.886830 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.int_parts_suppliers
[0m19:45:32.888528 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.int_parts_suppliers"
[0m19:45:32.891654 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_parts_suppliers"
[0m19:45:32.891904 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_parts_suppliers"} */

  create or replace view
    "lakehouse"."dbt"."int_parts_suppliers"
  security definer
  as
    with  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
part_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(p.part_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(s.supplier_key as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
			as part_supplier_key,
    p.part_key,
    p.part_name,
    p.part_manufacturer_name,
    p.part_brand_name,
    p.part_type_name,
    p.part_size,
    p.part_container_desc,
    p.retail_price,

    s.supplier_key,
    s.supplier_name,
    s.nation_key,

    ps.supplier_availabe_quantity,
    ps.supplier_cost_amount
from
    parts p
    join
    part_suppliers ps
        on p.part_key = ps.part_key
    join
    suppliers s
        on ps.supplier_key = s.supplier_key
order by
    p.part_key
  
[0m19:45:32.892130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:33.638333 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:45:33.642434 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_parts_suppliers (execute): 19:45:32.886936 => 19:45:33.642284
[0m19:45:33.642644 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: ROLLBACK
[0m19:45:33.642817 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: Close
[0m19:45:33.643885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20e2212b-e913-498d-a454-33d09777b52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03fe324d90>]}
[0m19:45:33.644218 [info ] [Thread-1 (]: 4 of 7 OK created sql view model dbt.int_parts_suppliers ....................... [[32mSUCCESS[0m in 0.77s]
[0m19:45:33.644613 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.int_parts_suppliers
[0m19:45:33.644936 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.fct_orders_items
[0m19:45:33.645193 [info ] [Thread-1 (]: 5 of 7 START sql view model dbt.fct_orders_items ............................... [RUN]
[0m19:45:33.645845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.int_parts_suppliers, now model.dbt_trino_iceberg.fct_orders_items)
[0m19:45:33.646056 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.fct_orders_items
[0m19:45:33.653207 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.fct_orders_items"
[0m19:45:33.653609 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (compile): 19:45:33.646169 => 19:45:33.653479
[0m19:45:33.653797 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.fct_orders_items
[0m19:45:33.656999 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.fct_orders_items"
[0m19:45:33.660152 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m19:45:33.660444 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

  create or replace view
    "lakehouse"."dbt"."fct_orders_items"
  security definer
  as
    with  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), orders_items as (
    
    select * from "lakehouse"."dbt"."int_order_items"

),
parts_suppliers as (
    
    select * from __dbt__cte__stg_tpch_part_suppliers

),
final as (
    select 

        o.order_item_key,
        o.order_key,
        o.order_date,
        o.customer_key,
        o.order_status_code,
        
        o.part_key,
        o.supplier_key,
        o.return_status_code,
        o.order_line_number,
        o.order_line_status_code,
        o.ship_date,
        o.commit_date,
        o.receipt_date,
        o.ship_mode_name,
        ps.supplier_cost_amount,
        
        o.base_price,
        o.discount_percentage,
        o.discounted_price,
        o.tax_rate,
        
        1 as order_item_count,
        o.quantity,

        o.gross_item_sales_amount,
        o.discounted_item_sales_amount,
        o.item_discount_amount,
        o.item_tax_amount,
        o.net_item_sales_amount

    from
        orders_items o
        join
        parts_suppliers ps
            on o.part_key = ps.part_key and
                o.supplier_key = ps.supplier_key
)
select *

from
    final f
order by
    f.order_date
  
[0m19:45:33.660670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:34.806943 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:45:34.811409 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (execute): 19:45:33.653903 => 19:45:34.811149
[0m19:45:34.811802 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: ROLLBACK
[0m19:45:34.812166 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: Close
[0m19:45:34.813381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20e2212b-e913-498d-a454-33d09777b52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03fe14a450>]}
[0m19:45:34.813768 [info ] [Thread-1 (]: 5 of 7 OK created sql view model dbt.fct_orders_items .......................... [[32mSUCCESS[0m in 1.17s]
[0m19:45:34.814217 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.fct_orders_items
[0m19:45:34.814558 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m19:45:34.815133 [info ] [Thread-1 (]: 6 of 7 START sql view model dbt.minimum_cost_suppliers ......................... [RUN]
[0m19:45:34.815641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.fct_orders_items, now model.dbt_trino_iceberg.minimum_cost_suppliers)
[0m19:45:34.815882 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m19:45:34.817813 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m19:45:34.818213 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (compile): 19:45:34.816014 => 19:45:34.818084
[0m19:45:34.818405 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m19:45:34.820080 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m19:45:34.821841 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m19:45:34.822070 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.minimum_cost_suppliers"} */

  create or replace view
    "lakehouse"."dbt"."minimum_cost_suppliers"
  security definer
  as
    /*
2 Q2 - Minimum Cost Supplier Query
This query finds which supplier should be selected to place an order for a given part in a given region
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 30)
*/

with parts_suppliers as (

    select
        s.supplier_account_balance,
        s.supplier_name,
        s.supplier_nation_key,
        s.supplier_region_key,
        s.supplier_nation_name,
        s.supplier_region_name,
        s.part_key,
        s.part_manufacturer_name,
        s.part_size,
        s.part_type_name,
        s.supplier_cost_amount,
        s.supplier_address,
        s.supplier_phone_number,
        rank() over(partition by s.supplier_region_key, s.part_key order by s.supplier_cost_amount) as supplier_cost_rank,
        row_number() over(partition by s.supplier_region_key, s.part_key, s.supplier_cost_amount order by s.supplier_account_balance desc) as supplier_rank
    from
        "lakehouse"."dbt"."dim_part_suppliers" s
)
select
    s.*
from
    int_parts_suppliers  s
where
    s.supplier_cost_rank = 1 and 
    s.supplier_rank <= 100
order by 
    s.supplier_name, s.part_key
  
[0m19:45:34.822273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:35.622891 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231217_184537_00033_ijqrb
[0m19:45:35.623805 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:5: Column 's.supplier_cost_rank' cannot be resolved", query_id=20231217_184537_00033_ijqrb)
[0m19:45:35.624884 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (execute): 19:45:34.818513 => 19:45:35.624463
[0m19:45:35.625429 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: ROLLBACK
[0m19:45:35.625916 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: Close
[0m19:45:35.628847 [debug] [Thread-1 (]: Database Error in model minimum_cost_suppliers (models/mart/minimum_cost_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:5: Column 's.supplier_cost_rank' cannot be resolved", query_id=20231217_184537_00033_ijqrb)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/minimum_cost_suppliers.sql
[0m19:45:35.629855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20e2212b-e913-498d-a454-33d09777b52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03fe30cd50>]}
[0m19:45:35.630211 [error] [Thread-1 (]: 6 of 7 ERROR creating sql view model dbt.minimum_cost_suppliers ................ [[31mERROR[0m in 0.81s]
[0m19:45:35.630577 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m19:45:35.630894 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m19:45:35.631168 [info ] [Thread-1 (]: 7 of 7 START sql view model dbt.pricing_summary_report ......................... [RUN]
[0m19:45:35.631715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.minimum_cost_suppliers, now model.dbt_trino_iceberg.pricing_summary_report)
[0m19:45:35.631927 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m19:45:35.635299 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 19:45:35.632054 => 19:45:35.635126
[0m19:45:35.636529 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m19:45:35.636784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20e2212b-e913-498d-a454-33d09777b52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03fe05c610>]}
[0m19:45:35.637095 [error] [Thread-1 (]: 7 of 7 ERROR creating sql view model dbt.pricing_summary_report ................ [[31mERROR[0m in 0.01s]
[0m19:45:35.637442 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m19:45:35.638697 [debug] [MainThread]: On master: COMMIT
[0m19:45:35.639058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:45:35.639212 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m19:45:35.639389 [info ] [MainThread]: 
[0m19:45:35.639598 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 7.40 seconds (7.40s).
[0m19:45:35.640468 [debug] [MainThread]: Command end result
[0m19:45:35.648602 [info ] [MainThread]: 
[0m19:45:35.648961 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:45:35.649580 [info ] [MainThread]: 
[0m19:45:35.650019 [error] [MainThread]:   Database Error in model minimum_cost_suppliers (models/mart/minimum_cost_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:5: Column 's.supplier_cost_rank' cannot be resolved", query_id=20231217_184537_00033_ijqrb)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/minimum_cost_suppliers.sql
[0m19:45:35.650462 [info ] [MainThread]: 
[0m19:45:35.650977 [error] [MainThread]:   Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m19:45:35.651308 [info ] [MainThread]: 
[0m19:45:35.651604 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m19:45:35.652271 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.363354, "process_user_time": 2.398495, "process_kernel_time": 0.147448, "process_mem_max_rss": "116144", "process_out_blocks": "3808", "command_success": false, "process_in_blocks": "0"}
[0m19:45:35.652585 [debug] [MainThread]: Command `dbt run` failed at 19:45:35.652512 after 8.36 seconds
[0m19:45:35.652805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ff857a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04040bb6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0403f3f290>]}
[0m19:45:35.653162 [debug] [MainThread]: Flushing usage events
[0m19:47:16.115985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf82ee3c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf83340b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf82ee22d0>]}


============================== 19:47:16.117603 | cb400a74-c44f-49c8-be38-67056be6b454 ==============================
[0m19:47:16.117603 [info ] [MainThread]: Running with dbt=1.7.3
[0m19:47:16.117936 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:47:16.230102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb400a74-c44f-49c8-be38-67056be6b454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf82c46b10>]}
[0m19:47:16.279336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb400a74-c44f-49c8-be38-67056be6b454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf82c1d5d0>]}
[0m19:47:16.279779 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m19:47:16.286614 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m19:47:16.293183 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:47:16.293500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cb400a74-c44f-49c8-be38-67056be6b454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf8293f590>]}
[0m19:47:17.036514 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_trino_iceberg.vars
[0m19:47:17.039973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb400a74-c44f-49c8-be38-67056be6b454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf82b1af50>]}
[0m19:47:17.047797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb400a74-c44f-49c8-be38-67056be6b454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf82a582d0>]}
[0m19:47:17.048120 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m19:47:17.048381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb400a74-c44f-49c8-be38-67056be6b454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf82bf0cd0>]}
[0m19:47:17.049823 [info ] [MainThread]: 
[0m19:47:17.050520 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m19:47:17.051626 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m19:47:17.062154 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m19:47:17.062406 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m19:47:17.062566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:18.251532 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m19:47:18.252714 [debug] [ThreadPool]: On list_lakehouse: Close
[0m19:47:18.255597 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m19:47:18.261033 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m19:47:18.261508 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m19:47:18.261680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:19.022844 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m19:47:19.025280 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m19:47:19.025744 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m19:47:19.028635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb400a74-c44f-49c8-be38-67056be6b454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf829a7690>]}
[0m19:47:19.028911 [debug] [MainThread]: On master: COMMIT
[0m19:47:19.029291 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:47:19.029513 [info ] [MainThread]: 
[0m19:47:19.032119 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_customers
[0m19:47:19.032877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.stg_tpch_customers)
[0m19:47:19.033145 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_customers
[0m19:47:19.035310 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_customers"
[0m19:47:19.035776 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_customers (compile): 19:47:19.033299 => 19:47:19.035615
[0m19:47:19.036347 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_customers
[0m19:47:19.036626 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m19:47:19.037024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_customers, now model.dbt_trino_iceberg.stg_tpch_line_item)
[0m19:47:19.037243 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_line_item
[0m19:47:19.039684 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_line_item"
[0m19:47:19.040234 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_line_item (compile): 19:47:19.037377 => 19:47:19.040055
[0m19:47:19.040746 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m19:47:19.040989 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_nation
[0m19:47:19.041391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_line_item, now model.dbt_trino_iceberg.stg_tpch_nation)
[0m19:47:19.041601 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_nation
[0m19:47:19.043372 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_nation"
[0m19:47:19.043721 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_nation (compile): 19:47:19.041747 => 19:47:19.043588
[0m19:47:19.044239 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_nation
[0m19:47:19.044475 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_orders
[0m19:47:19.044830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_nation, now model.dbt_trino_iceberg.stg_tpch_orders)
[0m19:47:19.045031 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_orders
[0m19:47:19.046745 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_orders"
[0m19:47:19.047127 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_orders (compile): 19:47:19.045153 => 19:47:19.046993
[0m19:47:19.047631 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_orders
[0m19:47:19.047864 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part
[0m19:47:19.048422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_orders, now model.dbt_trino_iceberg.stg_tpch_part)
[0m19:47:19.048760 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part
[0m19:47:19.050867 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part"
[0m19:47:19.051462 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part (compile): 19:47:19.048958 => 19:47:19.051273
[0m19:47:19.051982 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part
[0m19:47:19.052255 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m19:47:19.052645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part, now model.dbt_trino_iceberg.stg_tpch_part_suppliers)
[0m19:47:19.052872 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m19:47:19.055562 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part_suppliers"
[0m19:47:19.056118 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part_suppliers (compile): 19:47:19.053016 => 19:47:19.055967
[0m19:47:19.056658 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m19:47:19.056958 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_region
[0m19:47:19.057340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part_suppliers, now model.dbt_trino_iceberg.stg_tpch_region)
[0m19:47:19.057559 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_region
[0m19:47:19.059451 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_region"
[0m19:47:19.060040 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_region (compile): 19:47:19.057722 => 19:47:19.059893
[0m19:47:19.060511 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_region
[0m19:47:19.060751 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m19:47:19.061129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_region, now model.dbt_trino_iceberg.stg_tpch_supplier)
[0m19:47:19.061385 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_supplier
[0m19:47:19.063123 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_supplier"
[0m19:47:19.063484 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_supplier (compile): 19:47:19.061510 => 19:47:19.063356
[0m19:47:19.064115 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m19:47:19.064560 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.int_order_items
[0m19:47:19.064979 [info ] [Thread-1 (]: 1 of 7 START sql table model dbt.int_order_items ............................... [RUN]
[0m19:47:19.065571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_supplier, now model.dbt_trino_iceberg.int_order_items)
[0m19:47:19.065809 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.int_order_items
[0m19:47:19.077449 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.int_order_items"
[0m19:47:19.078180 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_order_items (compile): 19:47:19.065944 => 19:47:19.077998
[0m19:47:19.078398 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.int_order_items
[0m19:47:19.093340 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."int_order_items"
[0m19:47:19.095647 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_order_items"
[0m19:47:19.095890 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_order_items"} */

    drop view if exists "lakehouse"."dbt"."int_order_items"
[0m19:47:19.096073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:19.635924 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:47:19.644227 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.int_order_items"
[0m19:47:19.648242 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_order_items"
[0m19:47:19.648517 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_order_items"} */

  
    

    create table "lakehouse"."dbt"."int_order_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_orders as (

select
    orderkey as order_key, 
    custkey as customer_key,
    orderstatus as order_status_code,
    totalprice as order_amount,
    orderdate as order_date,
    orderpriority as order_priority_code,
    clerk as order_clerk_name,
    shippriority as shipping_priority,
    comment as order_comment
from
    tpch.sf1.orders
),  __dbt__cte__stg_tpch_line_item as (

select
    orderkey as order_key,
    partkey as part_key,
    suppkey as supplier_key,
    linenumber as order_line_number,
    quantity as quantity,
    extendedprice as extended_price,
    discount as discount_percentage,
    tax as tax_rate,
    returnflag as return_status_code,
    linestatus as order_line_status_code,
    shipdate as ship_date,
    commitdate as commit_date,
    receiptdate as receipt_date,
    shipinstruct as ship_instructions_desc,
    shipmode as ship_mode_name,
    comment as order_line_comment
from
    tpch.sf1.lineitem
), orders as (
    
    select * from __dbt__cte__stg_tpch_orders

),
line_items as (

    select * from __dbt__cte__stg_tpch_line_item

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(o.order_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l.order_line_number as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as order_item_key,

    o.order_key,
    o.order_date,
    o.customer_key,
    o.order_status_code,
    
    l.part_key,
    l.supplier_key,
    l.return_status_code,
    l.order_line_number,
    l.order_line_status_code,
    l.ship_date,
    l.commit_date,
    l.receipt_date,
    l.ship_mode_name,

    l.quantity,
    
    -- extended_price is actually the line item total,
    -- so we back out the extended price per item
    (l.extended_price/nullif(l.quantity, 0)) as base_price,
    l.discount_percentage,
    ((l.extended_price/nullif(l.quantity, 0)) * (1 - l.discount_percentage)) as discounted_price,

    l.extended_price as gross_item_sales_amount,
    (l.extended_price * (1 - l.discount_percentage)) as discounted_item_sales_amount,
    -- We model discounts as negative amounts
    (-1 * l.extended_price * l.discount_percentage) as item_discount_amount,
    l.tax_rate,
    ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate) as item_tax_amount,
    (
        l.extended_price + 
        (-1 * l.extended_price * l.discount_percentage) + 
        ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate)
    ) as net_item_sales_amount

from
    orders o
    join
    line_items l
        on o.order_key = l.order_key
order by
    o.order_date
    )
[0m19:47:48.367700 [debug] [Thread-1 (]: SQL status: SUCCESS in 29.0 seconds
[0m19:47:48.380181 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_order_items (execute): 19:47:19.078511 => 19:47:48.380045
[0m19:47:48.380425 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: ROLLBACK
[0m19:47:48.380604 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: Close
[0m19:47:48.381787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb400a74-c44f-49c8-be38-67056be6b454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf816a8f50>]}
[0m19:47:48.382192 [info ] [Thread-1 (]: 1 of 7 OK created sql table model dbt.int_order_items .......................... [[32mSUCCESS[0m in 29.32s]
[0m19:47:48.382593 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.int_order_items
[0m19:47:48.382867 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_part_suppliers
[0m19:47:48.383131 [info ] [Thread-1 (]: 2 of 7 START sql table model dbt.dim_part_suppliers ............................ [RUN]
[0m19:47:48.383585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.int_order_items, now model.dbt_trino_iceberg.dim_part_suppliers)
[0m19:47:48.383833 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_part_suppliers
[0m19:47:48.392586 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m19:47:48.393065 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (compile): 19:47:48.383962 => 19:47:48.392923
[0m19:47:48.393267 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_part_suppliers
[0m19:47:48.396047 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."dim_part_suppliers"
[0m19:47:48.396531 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m19:47:48.396727 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

    drop view if exists "lakehouse"."dbt"."dim_part_suppliers"
[0m19:47:48.396898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:49.312153 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:47:49.315366 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m19:47:49.320171 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m19:47:49.320447 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
order by
    f.part_key,
    f.supplier_key
    )
[0m19:47:58.281903 [debug] [Thread-1 (]: SQL status: SUCCESS in 9.0 seconds
[0m19:47:58.286511 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (execute): 19:47:48.393382 => 19:47:58.286168
[0m19:47:58.286981 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: ROLLBACK
[0m19:47:58.287247 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: Close
[0m19:47:58.288803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb400a74-c44f-49c8-be38-67056be6b454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf816a0650>]}
[0m19:47:58.289255 [info ] [Thread-1 (]: 2 of 7 OK created sql table model dbt.dim_part_suppliers ....................... [[32mSUCCESS[0m in 9.91s]
[0m19:47:58.289612 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_part_suppliers
[0m19:47:58.289893 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_suppliers
[0m19:47:58.290174 [info ] [Thread-1 (]: 3 of 7 START sql table model dbt.dim_suppliers ................................. [RUN]
[0m19:47:58.291020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_part_suppliers, now model.dbt_trino_iceberg.dim_suppliers)
[0m19:47:58.291381 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_suppliers
[0m19:47:58.296262 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_suppliers"
[0m19:47:58.297002 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (compile): 19:47:58.291525 => 19:47:58.296780
[0m19:47:58.297211 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_suppliers
[0m19:47:58.300873 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."dim_suppliers"
[0m19:47:58.301424 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m19:47:58.301618 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

    drop view if exists "lakehouse"."dbt"."dim_suppliers"
[0m19:47:58.301805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:59.300079 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:47:59.302611 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_suppliers"
[0m19:47:59.310259 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m19:47:59.310576 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt"."dim_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m19:48:00.634791 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:48:00.637433 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (execute): 19:47:58.297322 => 19:48:00.637231
[0m19:48:00.637698 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: ROLLBACK
[0m19:48:00.637889 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: Close
[0m19:48:00.638978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb400a74-c44f-49c8-be38-67056be6b454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf82c36410>]}
[0m19:48:00.639347 [info ] [Thread-1 (]: 3 of 7 OK created sql table model dbt.dim_suppliers ............................ [[32mSUCCESS[0m in 2.35s]
[0m19:48:00.639726 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_suppliers
[0m19:48:00.640021 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.int_parts_suppliers
[0m19:48:00.640316 [info ] [Thread-1 (]: 4 of 7 START sql table model dbt.int_parts_suppliers ........................... [RUN]
[0m19:48:00.640817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_suppliers, now model.dbt_trino_iceberg.int_parts_suppliers)
[0m19:48:00.641029 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.int_parts_suppliers
[0m19:48:00.649753 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.int_parts_suppliers"
[0m19:48:00.650240 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_parts_suppliers (compile): 19:48:00.641157 => 19:48:00.650080
[0m19:48:00.650504 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.int_parts_suppliers
[0m19:48:00.653809 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."int_parts_suppliers"
[0m19:48:00.654522 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_parts_suppliers"
[0m19:48:00.654742 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_parts_suppliers"} */

    drop view if exists "lakehouse"."dbt"."int_parts_suppliers"
[0m19:48:00.654912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:48:01.179627 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:48:01.181023 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.int_parts_suppliers"
[0m19:48:01.184699 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_parts_suppliers"
[0m19:48:01.185018 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_parts_suppliers"} */

  
    

    create table "lakehouse"."dbt"."int_parts_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
part_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(p.part_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(s.supplier_key as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
			as part_supplier_key,
    p.part_key,
    p.part_name,
    p.part_manufacturer_name,
    p.part_brand_name,
    p.part_type_name,
    p.part_size,
    p.part_container_desc,
    p.retail_price,

    s.supplier_key,
    s.supplier_name,
    s.nation_key,

    ps.supplier_availabe_quantity,
    ps.supplier_cost_amount
from
    parts p
    join
    part_suppliers ps
        on p.part_key = ps.part_key
    join
    suppliers s
        on ps.supplier_key = s.supplier_key
order by
    p.part_key
    )
[0m19:48:08.093890 [debug] [Thread-1 (]: SQL status: SUCCESS in 7.0 seconds
[0m19:48:08.098449 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_parts_suppliers (execute): 19:48:00.650623 => 19:48:08.098145
[0m19:48:08.098871 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: ROLLBACK
[0m19:48:08.099139 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: Close
[0m19:48:08.100651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb400a74-c44f-49c8-be38-67056be6b454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf81651f10>]}
[0m19:48:08.100988 [info ] [Thread-1 (]: 4 of 7 OK created sql table model dbt.int_parts_suppliers ...................... [[32mSUCCESS[0m in 7.46s]
[0m19:48:08.101419 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.int_parts_suppliers
[0m19:48:08.101717 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.fct_orders_items
[0m19:48:08.101972 [info ] [Thread-1 (]: 5 of 7 START sql table model dbt.fct_orders_items .............................. [RUN]
[0m19:48:08.102725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.int_parts_suppliers, now model.dbt_trino_iceberg.fct_orders_items)
[0m19:48:08.102937 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.fct_orders_items
[0m19:48:08.110309 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.fct_orders_items"
[0m19:48:08.110728 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (compile): 19:48:08.103050 => 19:48:08.110596
[0m19:48:08.110939 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.fct_orders_items
[0m19:48:08.114656 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."fct_orders_items"
[0m19:48:08.115138 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m19:48:08.115331 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

    drop view if exists "lakehouse"."dbt"."fct_orders_items"
[0m19:48:08.115498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:48:09.076810 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:48:09.080101 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.fct_orders_items"
[0m19:48:09.084754 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m19:48:09.085001 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

  
    

    create table "lakehouse"."dbt"."fct_orders_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), orders_items as (
    
    select * from "lakehouse"."dbt"."int_order_items"

),
parts_suppliers as (
    
    select * from __dbt__cte__stg_tpch_part_suppliers

),
final as (
    select 

        o.order_item_key,
        o.order_key,
        o.order_date,
        o.customer_key,
        o.order_status_code,
        
        o.part_key,
        o.supplier_key,
        o.return_status_code,
        o.order_line_number,
        o.order_line_status_code,
        o.ship_date,
        o.commit_date,
        o.receipt_date,
        o.ship_mode_name,
        ps.supplier_cost_amount,
        
        o.base_price,
        o.discount_percentage,
        o.discounted_price,
        o.tax_rate,
        
        1 as order_item_count,
        o.quantity,

        o.gross_item_sales_amount,
        o.discounted_item_sales_amount,
        o.item_discount_amount,
        o.item_tax_amount,
        o.net_item_sales_amount

    from
        orders_items o
        join
        parts_suppliers ps
            on o.part_key = ps.part_key and
                o.supplier_key = ps.supplier_key
)
select *

from
    final f
order by
    f.order_date
    )
[0m19:48:38.227844 [debug] [Thread-1 (]: SQL status: SUCCESS in 29.0 seconds
[0m19:48:38.231180 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (execute): 19:48:08.111098 => 19:48:38.230967
[0m19:48:38.231567 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: ROLLBACK
[0m19:48:38.231885 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: Close
[0m19:48:38.232914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb400a74-c44f-49c8-be38-67056be6b454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf859e6e10>]}
[0m19:48:38.233266 [info ] [Thread-1 (]: 5 of 7 OK created sql table model dbt.fct_orders_items ......................... [[32mSUCCESS[0m in 30.13s]
[0m19:48:38.233635 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.fct_orders_items
[0m19:48:38.233983 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m19:48:38.234273 [info ] [Thread-1 (]: 6 of 7 START sql table model dbt.minimum_cost_suppliers ........................ [RUN]
[0m19:48:38.235093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.fct_orders_items, now model.dbt_trino_iceberg.minimum_cost_suppliers)
[0m19:48:38.235319 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m19:48:38.237314 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m19:48:38.238046 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (compile): 19:48:38.235452 => 19:48:38.237894
[0m19:48:38.238260 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m19:48:38.240231 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m19:48:38.242108 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m19:48:38.242339 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_demo", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.minimum_cost_suppliers"} */

  
    

    create table "lakehouse"."dbt"."minimum_cost_suppliers"
      
      
    as (
      /*
2 Q2 - Minimum Cost Supplier Query
This query finds which supplier should be selected to place an order for a given part in a given region
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 30)
*/

with parts_suppliers as (

    select
        s.supplier_account_balance,
        s.supplier_name,
        s.supplier_nation_key,
        s.supplier_region_key,
        s.supplier_nation_name,
        s.supplier_region_name,
        s.part_key,
        s.part_manufacturer_name,
        s.part_size,
        s.part_type_name,
        s.supplier_cost_amount,
        s.supplier_address,
        s.supplier_phone_number,
        rank() over(partition by s.supplier_region_key, s.part_key order by s.supplier_cost_amount) as supplier_cost_rank,
        row_number() over(partition by s.supplier_region_key, s.part_key, s.supplier_cost_amount order by s.supplier_account_balance desc) as supplier_rank
    from
        "lakehouse"."dbt"."dim_part_suppliers" s
)
select
    s.*
from
    int_parts_suppliers  s
where
    s.supplier_cost_rank = 1 and 
    s.supplier_rank <= 100
order by 
    s.supplier_name, s.part_key
    )
[0m19:48:38.242567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:48:39.125690 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231217_184841_00046_ijqrb
[0m19:48:39.126598 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 42:5: Column 's.supplier_cost_rank' cannot be resolved", query_id=20231217_184841_00046_ijqrb)
[0m19:48:39.127684 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (execute): 19:48:38.238409 => 19:48:39.127243
[0m19:48:39.128556 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: ROLLBACK
[0m19:48:39.128949 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: Close
[0m19:48:39.131746 [debug] [Thread-1 (]: Database Error in model minimum_cost_suppliers (models/mart/minimum_cost_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 42:5: Column 's.supplier_cost_rank' cannot be resolved", query_id=20231217_184841_00046_ijqrb)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/minimum_cost_suppliers.sql
[0m19:48:39.132839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb400a74-c44f-49c8-be38-67056be6b454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf816396d0>]}
[0m19:48:39.133220 [error] [Thread-1 (]: 6 of 7 ERROR creating sql table model dbt.minimum_cost_suppliers ............... [[31mERROR[0m in 0.90s]
[0m19:48:39.133720 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m19:48:39.134002 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m19:48:39.134264 [info ] [Thread-1 (]: 7 of 7 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m19:48:39.134935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.minimum_cost_suppliers, now model.dbt_trino_iceberg.pricing_summary_report)
[0m19:48:39.135145 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m19:48:39.137678 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 19:48:39.135258 => 19:48:39.137539
[0m19:48:39.138755 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m19:48:39.138986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb400a74-c44f-49c8-be38-67056be6b454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf82c84950>]}
[0m19:48:39.139287 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.00s]
[0m19:48:39.139593 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m19:48:39.141105 [debug] [MainThread]: On master: COMMIT
[0m19:48:39.141546 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:48:39.141707 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m19:48:39.141890 [info ] [MainThread]: 
[0m19:48:39.142090 [info ] [MainThread]: Finished running 7 table models in 0 hours 1 minutes and 22.09 seconds (82.09s).
[0m19:48:39.142923 [debug] [MainThread]: Command end result
[0m19:48:39.150459 [info ] [MainThread]: 
[0m19:48:39.151290 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:48:39.151637 [info ] [MainThread]: 
[0m19:48:39.152034 [error] [MainThread]:   Database Error in model minimum_cost_suppliers (models/mart/minimum_cost_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 42:5: Column 's.supplier_cost_rank' cannot be resolved", query_id=20231217_184841_00046_ijqrb)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/minimum_cost_suppliers.sql
[0m19:48:39.152427 [info ] [MainThread]: 
[0m19:48:39.152696 [error] [MainThread]:   Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m19:48:39.152994 [info ] [MainThread]: 
[0m19:48:39.153272 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m19:48:39.154067 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 83.06162, "process_user_time": 2.8266, "process_kernel_time": 0.212236, "process_mem_max_rss": "118068", "process_out_blocks": "3872", "command_success": false, "process_in_blocks": "0"}
[0m19:48:39.154389 [debug] [MainThread]: Command `dbt run` failed at 19:48:39.154319 after 83.06 seconds
[0m19:48:39.154612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf82eec310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf83340c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf875837d0>]}
[0m19:48:39.154819 [debug] [MainThread]: Flushing usage events
[0m19:49:57.416328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1adffb3390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1adfffe8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1adfffe910>]}


============================== 19:49:57.417937 | 3260fd86-f3f5-400d-b053-85eb9d779c7a ==============================
[0m19:49:57.417937 [info ] [MainThread]: Running with dbt=1.7.3
[0m19:49:57.418273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:49:57.419899 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dbt_trino_iceberg'
[0m19:49:57.420438 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.027909469, "process_user_time": 1.006973, "process_kernel_time": 0.040278, "process_mem_max_rss": "96632", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m19:49:57.420741 [debug] [MainThread]: Command `dbt run` failed at 19:49:57.420664 after 0.03 seconds
[0m19:49:57.420941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1adffb0110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1adffb0250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1adffae450>]}
[0m19:49:57.421142 [debug] [MainThread]: Flushing usage events
[0m19:52:18.636918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b8d8f8d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b8d93fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b8e469a90>]}


============================== 19:52:18.638573 | aab85622-496b-418c-8859-3ecc54923665 ==============================
[0m19:52:18.638573 [info ] [MainThread]: Running with dbt=1.7.3
[0m19:52:18.638966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --model pricing_summary_report.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:52:18.752621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aab85622-496b-418c-8859-3ecc54923665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b8f79f890>]}
[0m19:52:18.802818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aab85622-496b-418c-8859-3ecc54923665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b8d8f9990>]}
[0m19:52:18.803264 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m19:52:18.810130 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m19:52:18.816877 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m19:52:18.817171 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:52:18.817400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aab85622-496b-418c-8859-3ecc54923665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b8d77ca50>]}
[0m19:52:19.551755 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_trino_iceberg.vars
[0m19:52:19.555333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aab85622-496b-418c-8859-3ecc54923665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b8d2828d0>]}
[0m19:52:19.563367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aab85622-496b-418c-8859-3ecc54923665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b8d57e6d0>]}
[0m19:52:19.563735 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m19:52:19.564068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aab85622-496b-418c-8859-3ecc54923665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b8d290310>]}
[0m19:52:19.565281 [info ] [MainThread]: 
[0m19:52:19.565830 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m19:52:19.566674 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m19:52:19.576810 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m19:52:19.577017 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m19:52:19.577175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:20.850123 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m19:52:20.852639 [debug] [ThreadPool]: On list_lakehouse: Close
[0m19:52:20.854776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m19:52:20.860373 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m19:52:20.860587 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m19:52:20.860752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:52:21.633290 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m19:52:21.635054 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m19:52:21.635228 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m19:52:21.637127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aab85622-496b-418c-8859-3ecc54923665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b8d405590>]}
[0m19:52:21.637397 [debug] [MainThread]: On master: COMMIT
[0m19:52:21.637751 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:52:21.637963 [info ] [MainThread]: 
[0m19:52:21.640235 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m19:52:21.640576 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m19:52:21.641059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m19:52:21.641366 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m19:52:21.643954 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 19:52:21.641511 => 19:52:21.643812
[0m19:52:21.645916 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m19:52:21.646280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aab85622-496b-418c-8859-3ecc54923665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b8d384190>]}
[0m19:52:21.646617 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.01s]
[0m19:52:21.647144 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m19:52:21.648470 [debug] [MainThread]: On master: COMMIT
[0m19:52:21.648819 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:52:21.648973 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m19:52:21.649130 [info ] [MainThread]: 
[0m19:52:21.649326 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.08 seconds (2.08s).
[0m19:52:21.649695 [debug] [MainThread]: Command end result
[0m19:52:21.656003 [info ] [MainThread]: 
[0m19:52:21.656364 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:52:21.656611 [info ] [MainThread]: 
[0m19:52:21.656832 [error] [MainThread]:   Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m19:52:21.657034 [info ] [MainThread]: 
[0m19:52:21.657313 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:52:21.657848 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.0454938, "process_user_time": 2.041359, "process_kernel_time": 0.109004, "process_mem_max_rss": "114064", "process_out_blocks": "3496", "command_success": false, "process_in_blocks": "0"}
[0m19:52:21.658144 [debug] [MainThread]: Command `dbt run` failed at 19:52:21.658072 after 3.05 seconds
[0m19:52:21.658409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b8d754c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b91f3d150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b8ef32bd0>]}
[0m19:52:21.658615 [debug] [MainThread]: Flushing usage events
[0m19:54:16.635125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a328fd590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a328fd2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a32927b50>]}


============================== 19:54:16.636748 | 5ee7478a-c4cf-4504-95b8-ae77228bbccb ==============================
[0m19:54:16.636748 [info ] [MainThread]: Running with dbt=1.7.3
[0m19:54:16.637169 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:54:16.749792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ee7478a-c4cf-4504-95b8-ae77228bbccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a32700190>]}
[0m19:54:16.800002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ee7478a-c4cf-4504-95b8-ae77228bbccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a32741f10>]}
[0m19:54:16.800457 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m19:54:16.807178 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m19:54:16.822983 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:54:16.823258 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:54:16.823915 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_trino_iceberg.vars
[0m19:54:16.828031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ee7478a-c4cf-4504-95b8-ae77228bbccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a328e3d10>]}
[0m19:54:16.836010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ee7478a-c4cf-4504-95b8-ae77228bbccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a32657dd0>]}
[0m19:54:16.836329 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m19:54:16.836585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ee7478a-c4cf-4504-95b8-ae77228bbccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a326dda10>]}
[0m19:54:16.837974 [info ] [MainThread]: 
[0m19:54:16.838505 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m19:54:16.839504 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m19:54:16.850103 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m19:54:16.850364 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m19:54:16.850527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:54:18.109526 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m19:54:18.112353 [debug] [ThreadPool]: On list_lakehouse: Close
[0m19:54:18.116413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m19:54:18.123245 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m19:54:18.123456 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m19:54:18.123622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:54:18.711370 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m19:54:18.714346 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m19:54:18.714521 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m19:54:18.716538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ee7478a-c4cf-4504-95b8-ae77228bbccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a328f2790>]}
[0m19:54:18.716809 [debug] [MainThread]: On master: COMMIT
[0m19:54:18.717258 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:54:18.717528 [info ] [MainThread]: 
[0m19:54:18.720111 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_customers
[0m19:54:18.720564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.stg_tpch_customers)
[0m19:54:18.720796 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_customers
[0m19:54:18.723324 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_customers"
[0m19:54:18.723690 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_customers (compile): 19:54:18.720924 => 19:54:18.723561
[0m19:54:18.724163 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_customers
[0m19:54:18.724407 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m19:54:18.724782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_customers, now model.dbt_trino_iceberg.stg_tpch_line_item)
[0m19:54:18.725000 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_line_item
[0m19:54:18.727058 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_line_item"
[0m19:54:18.727753 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_line_item (compile): 19:54:18.725139 => 19:54:18.727570
[0m19:54:18.728249 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m19:54:18.728493 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_nation
[0m19:54:18.728895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_line_item, now model.dbt_trino_iceberg.stg_tpch_nation)
[0m19:54:18.729109 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_nation
[0m19:54:18.730912 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_nation"
[0m19:54:18.731295 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_nation (compile): 19:54:18.729237 => 19:54:18.731136
[0m19:54:18.731912 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_nation
[0m19:54:18.732147 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_orders
[0m19:54:18.732497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_nation, now model.dbt_trino_iceberg.stg_tpch_orders)
[0m19:54:18.732702 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_orders
[0m19:54:18.734469 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_orders"
[0m19:54:18.734823 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_orders (compile): 19:54:18.732831 => 19:54:18.734688
[0m19:54:18.735336 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_orders
[0m19:54:18.735578 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part
[0m19:54:18.735996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_orders, now model.dbt_trino_iceberg.stg_tpch_part)
[0m19:54:18.736221 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part
[0m19:54:18.738034 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part"
[0m19:54:18.738403 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part (compile): 19:54:18.736358 => 19:54:18.738271
[0m19:54:18.738907 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part
[0m19:54:18.739141 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m19:54:18.739498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part, now model.dbt_trino_iceberg.stg_tpch_part_suppliers)
[0m19:54:18.739707 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m19:54:18.749332 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part_suppliers"
[0m19:54:18.749864 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part_suppliers (compile): 19:54:18.739831 => 19:54:18.749700
[0m19:54:18.750442 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m19:54:18.750725 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_region
[0m19:54:18.751111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part_suppliers, now model.dbt_trino_iceberg.stg_tpch_region)
[0m19:54:18.751370 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_region
[0m19:54:18.753263 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_region"
[0m19:54:18.753882 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_region (compile): 19:54:18.751527 => 19:54:18.753695
[0m19:54:18.754541 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_region
[0m19:54:18.754822 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m19:54:18.755208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_region, now model.dbt_trino_iceberg.stg_tpch_supplier)
[0m19:54:18.755437 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_supplier
[0m19:54:18.757253 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_supplier"
[0m19:54:18.757658 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_supplier (compile): 19:54:18.755583 => 19:54:18.757495
[0m19:54:18.758177 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m19:54:18.758627 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.int_order_items
[0m19:54:18.759047 [info ] [Thread-1 (]: 1 of 7 START sql table model dbt.int_order_items ............................... [RUN]
[0m19:54:18.759587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_supplier, now model.dbt_trino_iceberg.int_order_items)
[0m19:54:18.760193 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.int_order_items
[0m19:54:18.772197 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.int_order_items"
[0m19:54:18.772696 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_order_items (compile): 19:54:18.760338 => 19:54:18.772534
[0m19:54:18.772907 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.int_order_items
[0m19:54:18.788078 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."int_order_items"
[0m19:54:18.789456 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_order_items"
[0m19:54:18.789689 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_order_items"} */

    drop table if exists "lakehouse"."dbt"."int_order_items"
[0m19:54:18.789883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:54:19.342150 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:54:19.351511 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.int_order_items"
[0m19:54:19.355653 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_order_items"
[0m19:54:19.355924 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_order_items"} */

  
    

    create table "lakehouse"."dbt"."int_order_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_orders as (

select
    orderkey as order_key, 
    custkey as customer_key,
    orderstatus as order_status_code,
    totalprice as order_amount,
    orderdate as order_date,
    orderpriority as order_priority_code,
    clerk as order_clerk_name,
    shippriority as shipping_priority,
    comment as order_comment
from
    tpch.sf1.orders
),  __dbt__cte__stg_tpch_line_item as (

select
    orderkey as order_key,
    partkey as part_key,
    suppkey as supplier_key,
    linenumber as order_line_number,
    quantity as quantity,
    extendedprice as extended_price,
    discount as discount_percentage,
    tax as tax_rate,
    returnflag as return_status_code,
    linestatus as order_line_status_code,
    shipdate as ship_date,
    commitdate as commit_date,
    receiptdate as receipt_date,
    shipinstruct as ship_instructions_desc,
    shipmode as ship_mode_name,
    comment as order_line_comment
from
    tpch.sf1.lineitem
), orders as (
    
    select * from __dbt__cte__stg_tpch_orders

),
line_items as (

    select * from __dbt__cte__stg_tpch_line_item

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(o.order_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l.order_line_number as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as order_item_key,

    o.order_key,
    o.order_date,
    o.customer_key,
    o.order_status_code,
    
    l.part_key,
    l.supplier_key,
    l.return_status_code,
    l.order_line_number,
    l.order_line_status_code,
    l.ship_date,
    l.commit_date,
    l.receipt_date,
    l.ship_mode_name,

    l.quantity,
    
    -- extended_price is actually the line item total,
    -- so we back out the extended price per item
    (l.extended_price/nullif(l.quantity, 0)) as base_price,
    l.discount_percentage,
    ((l.extended_price/nullif(l.quantity, 0)) * (1 - l.discount_percentage)) as discounted_price,

    l.extended_price as gross_item_sales_amount,
    (l.extended_price * (1 - l.discount_percentage)) as discounted_item_sales_amount,
    -- We model discounts as negative amounts
    (-1 * l.extended_price * l.discount_percentage) as item_discount_amount,
    l.tax_rate,
    ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate) as item_tax_amount,
    (
        l.extended_price + 
        (-1 * l.extended_price * l.discount_percentage) + 
        ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate)
    ) as net_item_sales_amount

from
    orders o
    join
    line_items l
        on o.order_key = l.order_key
order by
    o.order_date
    )
[0m19:54:44.676909 [debug] [Thread-1 (]: SQL status: SUCCESS in 25.0 seconds
[0m19:54:44.689407 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_order_items (execute): 19:54:18.773019 => 19:54:44.689268
[0m19:54:44.689647 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: ROLLBACK
[0m19:54:44.689833 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: Close
[0m19:54:44.690953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ee7478a-c4cf-4504-95b8-ae77228bbccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a32283710>]}
[0m19:54:44.691339 [info ] [Thread-1 (]: 1 of 7 OK created sql table model dbt.int_order_items .......................... [[32mSUCCESS[0m in 25.93s]
[0m19:54:44.691733 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.int_order_items
[0m19:54:44.692008 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_part_suppliers
[0m19:54:44.692265 [info ] [Thread-1 (]: 2 of 7 START sql table model dbt.dim_part_suppliers ............................ [RUN]
[0m19:54:44.692729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.int_order_items, now model.dbt_trino_iceberg.dim_part_suppliers)
[0m19:54:44.692959 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_part_suppliers
[0m19:54:44.701591 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m19:54:44.702214 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (compile): 19:54:44.693094 => 19:54:44.702047
[0m19:54:44.702420 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_part_suppliers
[0m19:54:44.705048 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."dim_part_suppliers"
[0m19:54:44.705712 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m19:54:44.705944 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

    drop table if exists "lakehouse"."dbt"."dim_part_suppliers"
[0m19:54:44.706144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:54:46.043608 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:54:46.046546 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m19:54:46.050968 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m19:54:46.051238 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
order by
    f.part_key,
    f.supplier_key
    )
[0m19:54:55.098241 [debug] [Thread-1 (]: SQL status: SUCCESS in 9.0 seconds
[0m19:54:55.102256 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (execute): 19:54:44.702532 => 19:54:55.101988
[0m19:54:55.102714 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: ROLLBACK
[0m19:54:55.103120 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: Close
[0m19:54:55.104555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ee7478a-c4cf-4504-95b8-ae77228bbccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a32281990>]}
[0m19:54:55.105022 [info ] [Thread-1 (]: 2 of 7 OK created sql table model dbt.dim_part_suppliers ....................... [[32mSUCCESS[0m in 10.41s]
[0m19:54:55.105507 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_part_suppliers
[0m19:54:55.105779 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_suppliers
[0m19:54:55.106070 [info ] [Thread-1 (]: 3 of 7 START sql table model dbt.dim_suppliers ................................. [RUN]
[0m19:54:55.106536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_part_suppliers, now model.dbt_trino_iceberg.dim_suppliers)
[0m19:54:55.106758 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_suppliers
[0m19:54:55.113237 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_suppliers"
[0m19:54:55.113706 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (compile): 19:54:55.106887 => 19:54:55.113557
[0m19:54:55.113912 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_suppliers
[0m19:54:55.116629 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."dim_suppliers"
[0m19:54:55.117093 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m19:54:55.117284 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt"."dim_suppliers"
[0m19:54:55.117472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:54:56.415889 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:54:56.417463 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_suppliers"
[0m19:54:56.419816 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m19:54:56.420040 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt"."dim_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m19:54:57.776240 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:54:57.778630 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (execute): 19:54:55.114023 => 19:54:57.778480
[0m19:54:57.778921 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: ROLLBACK
[0m19:54:57.779139 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: Close
[0m19:54:57.780535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ee7478a-c4cf-4504-95b8-ae77228bbccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a3238a3d0>]}
[0m19:54:57.781034 [info ] [Thread-1 (]: 3 of 7 OK created sql table model dbt.dim_suppliers ............................ [[32mSUCCESS[0m in 2.67s]
[0m19:54:57.781613 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_suppliers
[0m19:54:57.781938 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.int_parts_suppliers
[0m19:54:57.782289 [info ] [Thread-1 (]: 4 of 7 START sql table model dbt.int_parts_suppliers ........................... [RUN]
[0m19:54:57.783027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_suppliers, now model.dbt_trino_iceberg.int_parts_suppliers)
[0m19:54:57.783256 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.int_parts_suppliers
[0m19:54:57.792401 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.int_parts_suppliers"
[0m19:54:57.793061 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_parts_suppliers (compile): 19:54:57.783368 => 19:54:57.792837
[0m19:54:57.794816 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.int_parts_suppliers
[0m19:54:57.797869 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."int_parts_suppliers"
[0m19:54:57.798477 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_parts_suppliers"
[0m19:54:57.798677 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_parts_suppliers"} */

    drop table if exists "lakehouse"."dbt"."int_parts_suppliers"
[0m19:54:57.798850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:54:58.398113 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:54:58.399472 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.int_parts_suppliers"
[0m19:54:58.403642 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_parts_suppliers"
[0m19:54:58.403903 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_parts_suppliers"} */

  
    

    create table "lakehouse"."dbt"."int_parts_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
part_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(p.part_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(s.supplier_key as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
			as part_supplier_key,
    p.part_key,
    p.part_name,
    p.part_manufacturer_name,
    p.part_brand_name,
    p.part_type_name,
    p.part_size,
    p.part_container_desc,
    p.retail_price,

    s.supplier_key,
    s.supplier_name,
    s.nation_key,

    ps.supplier_availabe_quantity,
    ps.supplier_cost_amount
from
    parts p
    join
    part_suppliers ps
        on p.part_key = ps.part_key
    join
    suppliers s
        on ps.supplier_key = s.supplier_key
order by
    p.part_key
    )
[0m19:55:05.467340 [debug] [Thread-1 (]: SQL status: SUCCESS in 7.0 seconds
[0m19:55:05.470948 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_parts_suppliers (execute): 19:54:57.794950 => 19:55:05.470752
[0m19:55:05.471307 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: ROLLBACK
[0m19:55:05.471608 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: Close
[0m19:55:05.473172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ee7478a-c4cf-4504-95b8-ae77228bbccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a3266c110>]}
[0m19:55:05.473514 [info ] [Thread-1 (]: 4 of 7 OK created sql table model dbt.int_parts_suppliers ...................... [[32mSUCCESS[0m in 7.69s]
[0m19:55:05.474125 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.int_parts_suppliers
[0m19:55:05.474421 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.fct_orders_items
[0m19:55:05.474725 [info ] [Thread-1 (]: 5 of 7 START sql table model dbt.fct_orders_items .............................. [RUN]
[0m19:55:05.475427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.int_parts_suppliers, now model.dbt_trino_iceberg.fct_orders_items)
[0m19:55:05.475712 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.fct_orders_items
[0m19:55:05.483616 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.fct_orders_items"
[0m19:55:05.484157 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (compile): 19:55:05.475848 => 19:55:05.484003
[0m19:55:05.484366 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.fct_orders_items
[0m19:55:05.488293 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."fct_orders_items"
[0m19:55:05.488779 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m19:55:05.489066 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

    drop table if exists "lakehouse"."dbt"."fct_orders_items"
[0m19:55:05.489251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:06.694249 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:55:06.696784 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.fct_orders_items"
[0m19:55:06.700753 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m19:55:06.701000 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

  
    

    create table "lakehouse"."dbt"."fct_orders_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), orders_items as (
    
    select * from "lakehouse"."dbt"."int_order_items"

),
parts_suppliers as (
    
    select * from __dbt__cte__stg_tpch_part_suppliers

),
final as (
    select 

        o.order_item_key,
        o.order_key,
        o.order_date,
        o.customer_key,
        o.order_status_code,
        
        o.part_key,
        o.supplier_key,
        o.return_status_code,
        o.order_line_number,
        o.order_line_status_code,
        o.ship_date,
        o.commit_date,
        o.receipt_date,
        o.ship_mode_name,
        ps.supplier_cost_amount,
        
        o.base_price,
        o.discount_percentage,
        o.discounted_price,
        o.tax_rate,
        
        1 as order_item_count,
        o.quantity,

        o.gross_item_sales_amount,
        o.discounted_item_sales_amount,
        o.item_discount_amount,
        o.item_tax_amount,
        o.net_item_sales_amount

    from
        orders_items o
        join
        parts_suppliers ps
            on o.part_key = ps.part_key and
                o.supplier_key = ps.supplier_key
)
select *

from
    final f
order by
    f.order_date
    )
[0m19:55:34.077861 [debug] [Thread-1 (]: SQL status: SUCCESS in 27.0 seconds
[0m19:55:34.080531 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (execute): 19:55:05.484480 => 19:55:34.080311
[0m19:55:34.080788 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: ROLLBACK
[0m19:55:34.081002 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: Close
[0m19:55:34.082159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ee7478a-c4cf-4504-95b8-ae77228bbccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a322e8290>]}
[0m19:55:34.082507 [info ] [Thread-1 (]: 5 of 7 OK created sql table model dbt.fct_orders_items ......................... [[32mSUCCESS[0m in 28.61s]
[0m19:55:34.082871 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.fct_orders_items
[0m19:55:34.083145 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m19:55:34.083403 [info ] [Thread-1 (]: 6 of 7 START sql table model dbt.minimum_cost_suppliers ........................ [RUN]
[0m19:55:34.084213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.fct_orders_items, now model.dbt_trino_iceberg.minimum_cost_suppliers)
[0m19:55:34.084449 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m19:55:34.086332 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m19:55:34.086700 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (compile): 19:55:34.084567 => 19:55:34.086573
[0m19:55:34.086966 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m19:55:34.088867 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m19:55:34.090900 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m19:55:34.091148 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.minimum_cost_suppliers"} */

  
    

    create table "lakehouse"."dbt"."minimum_cost_suppliers"
      
      
    as (
      /*
2 Q2 - Minimum Cost Supplier Query
This query finds which supplier should be selected to place an order for a given part in a given region
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 30)
*/

with parts_suppliers as (

    select
        s.supplier_account_balance,
        s.supplier_name,
        s.supplier_nation_key,
        s.supplier_region_key,
        s.supplier_nation_name,
        s.supplier_region_name,
        s.part_key,
        s.part_manufacturer_name,
        s.part_size,
        s.part_type_name,
        s.supplier_cost_amount,
        s.supplier_address,
        s.supplier_phone_number,
        rank() over(partition by s.supplier_region_key, s.part_key order by s.supplier_cost_amount) as supplier_cost_rank,
        row_number() over(partition by s.supplier_region_key, s.part_key, s.supplier_cost_amount order by s.supplier_account_balance desc) as supplier_rank
    from
        "lakehouse"."dbt"."dim_part_suppliers" s
)
select
    s.*
from
    int_parts_suppliers  s
where
    s.supplier_cost_rank = 1 and 
    s.supplier_rank <= 100
order by 
    s.supplier_name, s.part_key
    )
[0m19:55:34.091429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:35.228356 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231217_185537_00061_ijqrb
[0m19:55:35.228915 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 42:5: Column 's.supplier_cost_rank' cannot be resolved", query_id=20231217_185537_00061_ijqrb)
[0m19:55:35.229450 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (execute): 19:55:34.087110 => 19:55:35.229248
[0m19:55:35.229773 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: ROLLBACK
[0m19:55:35.230061 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: Close
[0m19:55:35.233439 [debug] [Thread-1 (]: Database Error in model minimum_cost_suppliers (models/mart/minimum_cost_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 42:5: Column 's.supplier_cost_rank' cannot be resolved", query_id=20231217_185537_00061_ijqrb)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/minimum_cost_suppliers.sql
[0m19:55:35.234476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ee7478a-c4cf-4504-95b8-ae77228bbccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a3228b490>]}
[0m19:55:35.234845 [error] [Thread-1 (]: 6 of 7 ERROR creating sql table model dbt.minimum_cost_suppliers ............... [[31mERROR[0m in 1.15s]
[0m19:55:35.235223 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m19:55:35.235508 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m19:55:35.235788 [info ] [Thread-1 (]: 7 of 7 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m19:55:35.236318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.minimum_cost_suppliers, now model.dbt_trino_iceberg.pricing_summary_report)
[0m19:55:35.236618 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m19:55:35.239281 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 19:55:35.236759 => 19:55:35.239116
[0m19:55:35.240694 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m19:55:35.240946 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ee7478a-c4cf-4504-95b8-ae77228bbccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a32464a50>]}
[0m19:55:35.241263 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.00s]
[0m19:55:35.241636 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m19:55:35.242897 [debug] [MainThread]: On master: COMMIT
[0m19:55:35.243269 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:55:35.243425 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m19:55:35.243606 [info ] [MainThread]: 
[0m19:55:35.243804 [info ] [MainThread]: Finished running 7 table models in 0 hours 1 minutes and 18.41 seconds (78.41s).
[0m19:55:35.244724 [debug] [MainThread]: Command end result
[0m19:55:35.252440 [info ] [MainThread]: 
[0m19:55:35.252853 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:55:35.253175 [info ] [MainThread]: 
[0m19:55:35.253439 [error] [MainThread]:   Database Error in model minimum_cost_suppliers (models/mart/minimum_cost_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 42:5: Column 's.supplier_cost_rank' cannot be resolved", query_id=20231217_185537_00061_ijqrb)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/minimum_cost_suppliers.sql
[0m19:55:35.253655 [info ] [MainThread]: 
[0m19:55:35.253878 [error] [MainThread]:   Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m19:55:35.254080 [info ] [MainThread]: 
[0m19:55:35.254334 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m19:55:35.254881 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 78.64357, "process_user_time": 1.953471, "process_kernel_time": 0.221745, "process_mem_max_rss": "111948", "process_out_blocks": "2720", "command_success": false, "process_in_blocks": "0"}
[0m19:55:35.255185 [debug] [MainThread]: Command `dbt run` failed at 19:55:35.255115 after 78.64 seconds
[0m19:55:35.255401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a36e77390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a36e77410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a36e772d0>]}
[0m19:55:35.255600 [debug] [MainThread]: Flushing usage events
[0m19:58:39.596153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f97c08750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f97bf4c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f97bf5050>]}


============================== 19:58:39.597762 | a20c0a05-25e5-4602-b100-eef4c60c4cf5 ==============================
[0m19:58:39.597762 [info ] [MainThread]: Running with dbt=1.7.3
[0m19:58:39.598097 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m19:58:39.649439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a20c0a05-25e5-4602-b100-eef4c60c4cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f97b0ae50>]}
[0m19:58:39.664317 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.09226004, "process_user_time": 1.111784, "process_kernel_time": 0.070112, "process_mem_max_rss": "97824", "process_out_blocks": "16", "process_in_blocks": "0"}
[0m19:58:39.664652 [debug] [MainThread]: Command `dbt clean` succeeded at 19:58:39.664574 after 0.09 seconds
[0m19:58:39.664860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f97bf4f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f9c2b3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f9c137310>]}
[0m19:58:39.665079 [debug] [MainThread]: Flushing usage events
[0m19:58:53.809620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6124f2fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6124f73990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6124f73dd0>]}


============================== 19:58:53.811233 | d50e9ca3-af77-48bc-bf10-e3050f1e866c ==============================
[0m19:58:53.811233 [info ] [MainThread]: Running with dbt=1.7.3
[0m19:58:53.811618 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:58:53.923998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd50e9ca3-af77-48bc-bf10-e3050f1e866c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6124d3b410>]}
[0m19:58:53.974024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd50e9ca3-af77-48bc-bf10-e3050f1e866c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6124d810d0>]}
[0m19:58:53.974468 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m19:58:53.975040 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m19:58:53.975639 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.19006954, "process_user_time": 1.179856, "process_kernel_time": 0.039995, "process_mem_max_rss": "101024", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:58:53.975947 [debug] [MainThread]: Command `dbt run` failed at 19:58:53.975872 after 0.19 seconds
[0m19:58:53.976150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6124fb4490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f612963ebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f612963f790>]}
[0m19:58:53.976353 [debug] [MainThread]: Flushing usage events
[0m19:59:05.438979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9d64ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9d64ce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9d64e7d0>]}


============================== 19:59:05.440572 | b4652e05-60ae-4ebd-acab-0b30fe45b0c6 ==============================
[0m19:59:05.440572 [info ] [MainThread]: Running with dbt=1.7.3
[0m19:59:05.440911 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:59:05.490744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4652e05-60ae-4ebd-acab-0b30fe45b0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9d52db90>]}
[0m19:59:05.499753 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zdc7bbu1'
[0m19:59:05.500048 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m19:59:06.820365 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m19:59:06.823712 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m19:59:06.954435 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m19:59:06.959492 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m19:59:08.358701 [info ] [MainThread]: Installed from version 1.1.1
[0m19:59:08.359014 [info ] [MainThread]: Up to date!
[0m19:59:08.359334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b4652e05-60ae-4ebd-acab-0b30fe45b0c6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9d54b690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9d55fa10>]}
[0m19:59:08.359930 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.9442692, "process_user_time": 1.131928, "process_kernel_time": 0.04079, "process_mem_max_rss": "101084", "process_in_blocks": "8", "process_out_blocks": "2016"}
[0m19:59:08.360234 [debug] [MainThread]: Command `dbt deps` succeeded at 19:59:08.360163 after 2.94 seconds
[0m19:59:08.360424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9d686f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9d68c2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ba1cbd090>]}
[0m19:59:08.360612 [debug] [MainThread]: Flushing usage events
[0m19:59:12.442781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e0032bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e0059ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e0032c50>]}


============================== 19:59:12.444580 | 1bb72543-f45b-44af-94f6-6490490deddb ==============================
[0m19:59:12.444580 [info ] [MainThread]: Running with dbt=1.7.3
[0m19:59:12.445015 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:59:12.558959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1bb72543-f45b-44af-94f6-6490490deddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95dfe49c50>]}
[0m19:59:12.611280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1bb72543-f45b-44af-94f6-6490490deddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95dff1fe90>]}
[0m19:59:12.611689 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m19:59:12.618430 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m19:59:12.618753 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:59:12.619023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1bb72543-f45b-44af-94f6-6490490deddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e005a150>]}
[0m19:59:13.356285 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_trino_iceberg.vars
[0m19:59:13.359576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1bb72543-f45b-44af-94f6-6490490deddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95dfc0b090>]}
[0m19:59:13.367032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1bb72543-f45b-44af-94f6-6490490deddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95dfb91890>]}
[0m19:59:13.367338 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m19:59:13.367583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bb72543-f45b-44af-94f6-6490490deddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95dea16b50>]}
[0m19:59:13.368923 [info ] [MainThread]: 
[0m19:59:13.369785 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m19:59:13.371014 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m19:59:13.381146 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m19:59:13.381405 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m19:59:13.381577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:15.095567 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m19:59:15.096437 [debug] [ThreadPool]: On list_lakehouse: Close
[0m19:59:15.099008 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m19:59:15.105705 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m19:59:15.105934 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m19:59:15.106105 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:59:16.445511 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m19:59:16.448416 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m19:59:16.448697 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m19:59:16.450755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bb72543-f45b-44af-94f6-6490490deddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95dfbfc110>]}
[0m19:59:16.451038 [debug] [MainThread]: On master: COMMIT
[0m19:59:16.451477 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:59:16.451727 [info ] [MainThread]: 
[0m19:59:16.454367 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_customers
[0m19:59:16.454992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.stg_tpch_customers)
[0m19:59:16.455215 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_customers
[0m19:59:16.457138 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_customers"
[0m19:59:16.457845 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_customers (compile): 19:59:16.455330 => 19:59:16.457702
[0m19:59:16.458347 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_customers
[0m19:59:16.458595 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m19:59:16.458974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_customers, now model.dbt_trino_iceberg.stg_tpch_line_item)
[0m19:59:16.459183 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_line_item
[0m19:59:16.461014 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_line_item"
[0m19:59:16.461437 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_line_item (compile): 19:59:16.459308 => 19:59:16.461227
[0m19:59:16.461922 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m19:59:16.462154 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_nation
[0m19:59:16.462506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_line_item, now model.dbt_trino_iceberg.stg_tpch_nation)
[0m19:59:16.462712 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_nation
[0m19:59:16.464977 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_nation"
[0m19:59:16.465303 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_nation (compile): 19:59:16.462834 => 19:59:16.465179
[0m19:59:16.465779 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_nation
[0m19:59:16.466094 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_orders
[0m19:59:16.466630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_nation, now model.dbt_trino_iceberg.stg_tpch_orders)
[0m19:59:16.466917 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_orders
[0m19:59:16.468851 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_orders"
[0m19:59:16.469475 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_orders (compile): 19:59:16.467056 => 19:59:16.469296
[0m19:59:16.470011 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_orders
[0m19:59:16.470256 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part
[0m19:59:16.470625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_orders, now model.dbt_trino_iceberg.stg_tpch_part)
[0m19:59:16.470834 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part
[0m19:59:16.472704 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part"
[0m19:59:16.473220 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part (compile): 19:59:16.470961 => 19:59:16.473079
[0m19:59:16.473713 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part
[0m19:59:16.473974 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m19:59:16.474349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part, now model.dbt_trino_iceberg.stg_tpch_part_suppliers)
[0m19:59:16.474575 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m19:59:16.477330 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part_suppliers"
[0m19:59:16.477978 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part_suppliers (compile): 19:59:16.474717 => 19:59:16.477837
[0m19:59:16.478459 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m19:59:16.478697 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_region
[0m19:59:16.479056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part_suppliers, now model.dbt_trino_iceberg.stg_tpch_region)
[0m19:59:16.479263 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_region
[0m19:59:16.481039 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_region"
[0m19:59:16.481595 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_region (compile): 19:59:16.479388 => 19:59:16.481446
[0m19:59:16.482251 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_region
[0m19:59:16.482567 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m19:59:16.482969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_region, now model.dbt_trino_iceberg.stg_tpch_supplier)
[0m19:59:16.483201 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_supplier
[0m19:59:16.485198 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_supplier"
[0m19:59:16.485721 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_supplier (compile): 19:59:16.483335 => 19:59:16.485569
[0m19:59:16.486202 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m19:59:16.486437 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.int_order_items
[0m19:59:16.486703 [info ] [Thread-1 (]: 1 of 7 START sql table model dbt.int_order_items ............................... [RUN]
[0m19:59:16.487164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_supplier, now model.dbt_trino_iceberg.int_order_items)
[0m19:59:16.487395 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.int_order_items
[0m19:59:16.499374 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.int_order_items"
[0m19:59:16.500063 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_order_items (compile): 19:59:16.487522 => 19:59:16.499905
[0m19:59:16.500329 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.int_order_items
[0m19:59:16.514681 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."int_order_items"
[0m19:59:16.516213 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_order_items"
[0m19:59:16.516452 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_order_items"} */

    drop table if exists "lakehouse"."dbt"."int_order_items"
[0m19:59:16.516640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:59:17.570047 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:59:17.581559 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.int_order_items"
[0m19:59:17.587723 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_order_items"
[0m19:59:17.588408 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_order_items"} */

  
    

    create table "lakehouse"."dbt"."int_order_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_orders as (

select
    orderkey as order_key, 
    custkey as customer_key,
    orderstatus as order_status_code,
    totalprice as order_amount,
    orderdate as order_date,
    orderpriority as order_priority_code,
    clerk as order_clerk_name,
    shippriority as shipping_priority,
    comment as order_comment
from
    tpch.sf1.orders
),  __dbt__cte__stg_tpch_line_item as (

select
    orderkey as order_key,
    partkey as part_key,
    suppkey as supplier_key,
    linenumber as order_line_number,
    quantity as quantity,
    extendedprice as extended_price,
    discount as discount_percentage,
    tax as tax_rate,
    returnflag as return_status_code,
    linestatus as order_line_status_code,
    shipdate as ship_date,
    commitdate as commit_date,
    receiptdate as receipt_date,
    shipinstruct as ship_instructions_desc,
    shipmode as ship_mode_name,
    comment as order_line_comment
from
    tpch.sf1.lineitem
), orders as (
    
    select * from __dbt__cte__stg_tpch_orders

),
line_items as (

    select * from __dbt__cte__stg_tpch_line_item

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(o.order_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l.order_line_number as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as order_item_key,

    o.order_key,
    o.order_date,
    o.customer_key,
    o.order_status_code,
    
    l.part_key,
    l.supplier_key,
    l.return_status_code,
    l.order_line_number,
    l.order_line_status_code,
    l.ship_date,
    l.commit_date,
    l.receipt_date,
    l.ship_mode_name,

    l.quantity,
    
    -- extended_price is actually the line item total,
    -- so we back out the extended price per item
    (l.extended_price/nullif(l.quantity, 0)) as base_price,
    l.discount_percentage,
    ((l.extended_price/nullif(l.quantity, 0)) * (1 - l.discount_percentage)) as discounted_price,

    l.extended_price as gross_item_sales_amount,
    (l.extended_price * (1 - l.discount_percentage)) as discounted_item_sales_amount,
    -- We model discounts as negative amounts
    (-1 * l.extended_price * l.discount_percentage) as item_discount_amount,
    l.tax_rate,
    ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate) as item_tax_amount,
    (
        l.extended_price + 
        (-1 * l.extended_price * l.discount_percentage) + 
        ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate)
    ) as net_item_sales_amount

from
    orders o
    join
    line_items l
        on o.order_key = l.order_key
order by
    o.order_date
    )
[0m19:59:43.483258 [debug] [Thread-1 (]: SQL status: SUCCESS in 26.0 seconds
[0m19:59:43.495959 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_order_items (execute): 19:59:16.500455 => 19:59:43.495822
[0m19:59:43.496205 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: ROLLBACK
[0m19:59:43.496391 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: Close
[0m19:59:43.497663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bb72543-f45b-44af-94f6-6490490deddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95de98ca10>]}
[0m19:59:43.498324 [info ] [Thread-1 (]: 1 of 7 OK created sql table model dbt.int_order_items .......................... [[32mSUCCESS[0m in 27.01s]
[0m19:59:43.498928 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.int_order_items
[0m19:59:43.499270 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_part_suppliers
[0m19:59:43.499542 [info ] [Thread-1 (]: 2 of 7 START sql table model dbt.dim_part_suppliers ............................ [RUN]
[0m19:59:43.500055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.int_order_items, now model.dbt_trino_iceberg.dim_part_suppliers)
[0m19:59:43.500286 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_part_suppliers
[0m19:59:43.509385 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m19:59:43.510157 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (compile): 19:59:43.500417 => 19:59:43.509994
[0m19:59:43.510371 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_part_suppliers
[0m19:59:43.513222 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."dim_part_suppliers"
[0m19:59:43.513737 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m19:59:43.514082 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

    drop table if exists "lakehouse"."dbt"."dim_part_suppliers"
[0m19:59:43.514456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:59:44.891182 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:59:44.893173 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m19:59:44.898591 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m19:59:44.898874 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
order by
    f.part_key,
    f.supplier_key
    )
[0m19:59:54.347504 [debug] [Thread-1 (]: SQL status: SUCCESS in 9.0 seconds
[0m19:59:54.351212 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (execute): 19:59:43.510481 => 19:59:54.351087
[0m19:59:54.351482 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: ROLLBACK
[0m19:59:54.351666 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: Close
[0m19:59:54.352735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bb72543-f45b-44af-94f6-6490490deddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95de79dc50>]}
[0m19:59:54.353088 [info ] [Thread-1 (]: 2 of 7 OK created sql table model dbt.dim_part_suppliers ....................... [[32mSUCCESS[0m in 10.85s]
[0m19:59:54.353453 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_part_suppliers
[0m19:59:54.353744 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_suppliers
[0m19:59:54.354062 [info ] [Thread-1 (]: 3 of 7 START sql table model dbt.dim_suppliers ................................. [RUN]
[0m19:59:54.354560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_part_suppliers, now model.dbt_trino_iceberg.dim_suppliers)
[0m19:59:54.354778 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_suppliers
[0m19:59:54.359525 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_suppliers"
[0m19:59:54.359889 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (compile): 19:59:54.354907 => 19:59:54.359764
[0m19:59:54.360293 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_suppliers
[0m19:59:54.364095 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."dim_suppliers"
[0m19:59:54.364631 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m19:59:54.364859 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt"."dim_suppliers"
[0m19:59:54.365055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:59:55.709735 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:59:55.710937 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_suppliers"
[0m19:59:55.713748 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m19:59:55.713991 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt"."dim_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m19:59:57.682267 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m19:59:57.684066 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (execute): 19:59:54.360450 => 19:59:57.683944
[0m19:59:57.684278 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: ROLLBACK
[0m19:59:57.684456 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: Close
[0m19:59:57.685537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bb72543-f45b-44af-94f6-6490490deddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95de7ec250>]}
[0m19:59:57.685908 [info ] [Thread-1 (]: 3 of 7 OK created sql table model dbt.dim_suppliers ............................ [[32mSUCCESS[0m in 3.33s]
[0m19:59:57.686264 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_suppliers
[0m19:59:57.686552 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.int_parts_suppliers
[0m19:59:57.687013 [info ] [Thread-1 (]: 4 of 7 START sql table model dbt.int_parts_suppliers ........................... [RUN]
[0m19:59:57.687565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_suppliers, now model.dbt_trino_iceberg.int_parts_suppliers)
[0m19:59:57.687780 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.int_parts_suppliers
[0m19:59:57.696693 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.int_parts_suppliers"
[0m19:59:57.697367 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_parts_suppliers (compile): 19:59:57.687921 => 19:59:57.697171
[0m19:59:57.697629 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.int_parts_suppliers
[0m19:59:57.700642 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."int_parts_suppliers"
[0m19:59:57.701144 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_parts_suppliers"
[0m19:59:57.701361 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_parts_suppliers"} */

    drop table if exists "lakehouse"."dbt"."int_parts_suppliers"
[0m19:59:57.701540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:59:58.679856 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:59:58.681988 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.int_parts_suppliers"
[0m19:59:58.686633 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_parts_suppliers"
[0m19:59:58.686996 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_parts_suppliers"} */

  
    

    create table "lakehouse"."dbt"."int_parts_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
part_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(p.part_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(s.supplier_key as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
			as part_supplier_key,
    p.part_key,
    p.part_name,
    p.part_manufacturer_name,
    p.part_brand_name,
    p.part_type_name,
    p.part_size,
    p.part_container_desc,
    p.retail_price,

    s.supplier_key,
    s.supplier_name,
    s.nation_key,

    ps.supplier_availabe_quantity,
    ps.supplier_cost_amount
from
    parts p
    join
    part_suppliers ps
        on p.part_key = ps.part_key
    join
    suppliers s
        on ps.supplier_key = s.supplier_key
order by
    p.part_key
    )
[0m20:00:06.007804 [debug] [Thread-1 (]: SQL status: SUCCESS in 7.0 seconds
[0m20:00:06.010574 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_parts_suppliers (execute): 19:59:57.697745 => 20:00:06.010354
[0m20:00:06.011139 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: ROLLBACK
[0m20:00:06.011473 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: Close
[0m20:00:06.012991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bb72543-f45b-44af-94f6-6490490deddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95dfb92a50>]}
[0m20:00:06.013479 [info ] [Thread-1 (]: 4 of 7 OK created sql table model dbt.int_parts_suppliers ...................... [[32mSUCCESS[0m in 8.33s]
[0m20:00:06.014025 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.int_parts_suppliers
[0m20:00:06.014305 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.fct_orders_items
[0m20:00:06.014567 [info ] [Thread-1 (]: 5 of 7 START sql table model dbt.fct_orders_items .............................. [RUN]
[0m20:00:06.015128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.int_parts_suppliers, now model.dbt_trino_iceberg.fct_orders_items)
[0m20:00:06.015396 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.fct_orders_items
[0m20:00:06.023200 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.fct_orders_items"
[0m20:00:06.023583 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (compile): 20:00:06.015606 => 20:00:06.023451
[0m20:00:06.023828 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.fct_orders_items
[0m20:00:06.027362 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."fct_orders_items"
[0m20:00:06.027901 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m20:00:06.028100 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

    drop table if exists "lakehouse"."dbt"."fct_orders_items"
[0m20:00:06.028273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:07.359204 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:00:07.362043 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.fct_orders_items"
[0m20:00:07.365986 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m20:00:07.366232 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

  
    

    create table "lakehouse"."dbt"."fct_orders_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), orders_items as (
    
    select * from "lakehouse"."dbt"."int_order_items"

),
parts_suppliers as (
    
    select * from __dbt__cte__stg_tpch_part_suppliers

),
final as (
    select 

        o.order_item_key,
        o.order_key,
        o.order_date,
        o.customer_key,
        o.order_status_code,
        
        o.part_key,
        o.supplier_key,
        o.return_status_code,
        o.order_line_number,
        o.order_line_status_code,
        o.ship_date,
        o.commit_date,
        o.receipt_date,
        o.ship_mode_name,
        ps.supplier_cost_amount,
        
        o.base_price,
        o.discount_percentage,
        o.discounted_price,
        o.tax_rate,
        
        1 as order_item_count,
        o.quantity,

        o.gross_item_sales_amount,
        o.discounted_item_sales_amount,
        o.item_discount_amount,
        o.item_tax_amount,
        o.net_item_sales_amount

    from
        orders_items o
        join
        parts_suppliers ps
            on o.part_key = ps.part_key and
                o.supplier_key = ps.supplier_key
)
select *

from
    final f
order by
    f.order_date
    )
[0m20:00:33.821182 [debug] [Thread-1 (]: SQL status: SUCCESS in 26.0 seconds
[0m20:00:33.824449 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (execute): 20:00:06.024209 => 20:00:33.824268
[0m20:00:33.824709 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: ROLLBACK
[0m20:00:33.824922 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: Close
[0m20:00:33.826183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bb72543-f45b-44af-94f6-6490490deddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95de857290>]}
[0m20:00:33.826621 [info ] [Thread-1 (]: 5 of 7 OK created sql table model dbt.fct_orders_items ......................... [[32mSUCCESS[0m in 27.81s]
[0m20:00:33.827002 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.fct_orders_items
[0m20:00:33.827312 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m20:00:33.827589 [info ] [Thread-1 (]: 6 of 7 START sql table model dbt.minimum_cost_suppliers ........................ [RUN]
[0m20:00:33.828509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.fct_orders_items, now model.dbt_trino_iceberg.minimum_cost_suppliers)
[0m20:00:33.828742 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m20:00:33.831319 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m20:00:33.831892 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (compile): 20:00:33.828862 => 20:00:33.831724
[0m20:00:33.832142 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m20:00:33.834949 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m20:00:33.836735 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m20:00:33.836964 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.minimum_cost_suppliers"} */

  
    

    create table "lakehouse"."dbt"."minimum_cost_suppliers"
      
      
    as (
      /*
2 Q2 - Minimum Cost Supplier Query
This query finds which supplier should be selected to place an order for a given part in a given region
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 30)
*/

with parts_suppliers as (

    select
        s.supplier_account_balance,
        s.supplier_name,
        s.supplier_nation_key,
        s.supplier_region_key,
        s.supplier_nation_name,
        s.supplier_region_name,
        s.part_key,
        s.part_manufacturer_name,
        s.part_size,
        s.part_type_name,
        s.supplier_cost_amount,
        s.supplier_address,
        s.supplier_phone_number,
        rank() over(partition by s.supplier_region_key, s.part_key order by s.supplier_cost_amount) as supplier_cost_rank,
        row_number() over(partition by s.supplier_region_key, s.part_key, s.supplier_cost_amount order by s.supplier_account_balance desc) as supplier_rank
    from
        "lakehouse"."dbt"."dim_part_suppliers" s
)
select
    s.*
from
    int_parts_suppliers  s
where
    s.supplier_cost_rank = 1 and 
    s.supplier_rank <= 100
order by 
    s.supplier_name, s.part_key
    )
[0m20:00:33.837187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:34.750646 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231217_190036_00074_ijqrb
[0m20:00:34.751591 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 42:5: Column 's.supplier_cost_rank' cannot be resolved", query_id=20231217_190036_00074_ijqrb)
[0m20:00:34.752548 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (execute): 20:00:33.832286 => 20:00:34.752173
[0m20:00:34.753467 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: ROLLBACK
[0m20:00:34.753899 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: Close
[0m20:00:34.758040 [debug] [Thread-1 (]: Database Error in model minimum_cost_suppliers (models/mart/minimum_cost_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 42:5: Column 's.supplier_cost_rank' cannot be resolved", query_id=20231217_190036_00074_ijqrb)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/minimum_cost_suppliers.sql
[0m20:00:34.758923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bb72543-f45b-44af-94f6-6490490deddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95de856f50>]}
[0m20:00:34.759259 [error] [Thread-1 (]: 6 of 7 ERROR creating sql table model dbt.minimum_cost_suppliers ............... [[31mERROR[0m in 0.93s]
[0m20:00:34.759660 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m20:00:34.759979 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m20:00:34.760236 [info ] [Thread-1 (]: 7 of 7 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m20:00:34.760897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.minimum_cost_suppliers, now model.dbt_trino_iceberg.pricing_summary_report)
[0m20:00:34.761113 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m20:00:34.763838 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 20:00:34.761228 => 20:00:34.763699
[0m20:00:34.765011 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m20:00:34.765270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bb72543-f45b-44af-94f6-6490490deddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95de8e4cd0>]}
[0m20:00:34.765565 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.00s]
[0m20:00:34.765865 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m20:00:34.767446 [debug] [MainThread]: On master: COMMIT
[0m20:00:34.767835 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:00:34.767996 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m20:00:34.768214 [info ] [MainThread]: 
[0m20:00:34.768435 [info ] [MainThread]: Finished running 7 table models in 0 hours 1 minutes and 21.40 seconds (81.40s).
[0m20:00:34.769314 [debug] [MainThread]: Command end result
[0m20:00:34.777015 [info ] [MainThread]: 
[0m20:00:34.777349 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:00:34.777614 [info ] [MainThread]: 
[0m20:00:34.777928 [error] [MainThread]:   Database Error in model minimum_cost_suppliers (models/mart/minimum_cost_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 42:5: Column 's.supplier_cost_rank' cannot be resolved", query_id=20231217_190036_00074_ijqrb)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/minimum_cost_suppliers.sql
[0m20:00:34.778192 [info ] [MainThread]: 
[0m20:00:34.778444 [error] [MainThread]:   Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m20:00:34.778704 [info ] [MainThread]: 
[0m20:00:34.778952 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m20:00:34.779660 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 82.36043, "process_user_time": 2.766089, "process_kernel_time": 0.165758, "process_mem_max_rss": "117980", "process_out_blocks": "3848", "command_success": false, "process_in_blocks": "0"}
[0m20:00:34.780017 [debug] [MainThread]: Command `dbt run` failed at 20:00:34.779927 after 82.36 seconds
[0m20:00:34.780271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e0062b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e005a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e4726bd0>]}
[0m20:00:34.780515 [debug] [MainThread]: Flushing usage events
[0m20:24:28.200232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f9c39ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f9d2afdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f9bf3a2d0>]}


============================== 20:24:28.202407 | 9bf2b1c9-7b07-4241-907d-65fd36e018f1 ==============================
[0m20:24:28.202407 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:24:28.202799 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:24:28.316015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bf2b1c9-7b07-4241-907d-65fd36e018f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f9bd7b090>]}
[0m20:24:28.366703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bf2b1c9-7b07-4241-907d-65fd36e018f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f9bef3450>]}
[0m20:24:28.367101 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m20:24:28.373798 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:24:28.390842 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:24:28.391107 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:24:28.391825 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_trino_iceberg.vars
[0m20:24:28.395678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bf2b1c9-7b07-4241-907d-65fd36e018f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f9bcda0d0>]}
[0m20:24:28.404584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bf2b1c9-7b07-4241-907d-65fd36e018f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f9ba7b910>]}
[0m20:24:28.404983 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m20:24:28.405235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bf2b1c9-7b07-4241-907d-65fd36e018f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f9bba5550>]}
[0m20:24:28.406513 [info ] [MainThread]: 
[0m20:24:28.407062 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m20:24:28.408061 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m20:24:28.418993 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m20:24:28.419273 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m20:24:28.419448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:24:29.602320 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:24:29.605273 [debug] [ThreadPool]: On list_lakehouse: Close
[0m20:24:29.607780 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m20:24:29.613011 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m20:24:29.613395 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m20:24:29.613581 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:24:30.303486 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:24:30.306238 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m20:24:30.306420 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m20:24:30.308424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bf2b1c9-7b07-4241-907d-65fd36e018f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f9c5e5c90>]}
[0m20:24:30.308703 [debug] [MainThread]: On master: COMMIT
[0m20:24:30.309105 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:24:30.309342 [info ] [MainThread]: 
[0m20:24:30.312069 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_customers
[0m20:24:30.312472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.stg_tpch_customers)
[0m20:24:30.312673 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_customers
[0m20:24:30.315041 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_customers"
[0m20:24:30.315477 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_customers (compile): 20:24:30.312786 => 20:24:30.315336
[0m20:24:30.315969 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_customers
[0m20:24:30.316232 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m20:24:30.316611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_customers, now model.dbt_trino_iceberg.stg_tpch_line_item)
[0m20:24:30.316829 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_line_item
[0m20:24:30.318698 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_line_item"
[0m20:24:30.319127 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_line_item (compile): 20:24:30.316967 => 20:24:30.318988
[0m20:24:30.319587 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m20:24:30.319874 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_nation
[0m20:24:30.320237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_line_item, now model.dbt_trino_iceberg.stg_tpch_nation)
[0m20:24:30.320439 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_nation
[0m20:24:30.322131 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_nation"
[0m20:24:30.322478 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_nation (compile): 20:24:30.320564 => 20:24:30.322345
[0m20:24:30.322961 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_nation
[0m20:24:30.323203 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_orders
[0m20:24:30.323552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_nation, now model.dbt_trino_iceberg.stg_tpch_orders)
[0m20:24:30.323760 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_orders
[0m20:24:30.325429 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_orders"
[0m20:24:30.325805 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_orders (compile): 20:24:30.323884 => 20:24:30.325674
[0m20:24:30.326300 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_orders
[0m20:24:30.326537 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part
[0m20:24:30.326895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_orders, now model.dbt_trino_iceberg.stg_tpch_part)
[0m20:24:30.327099 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part
[0m20:24:30.328836 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part"
[0m20:24:30.329424 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part (compile): 20:24:30.327224 => 20:24:30.329247
[0m20:24:30.329908 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part
[0m20:24:30.330170 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m20:24:30.330547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part, now model.dbt_trino_iceberg.stg_tpch_part_suppliers)
[0m20:24:30.330773 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m20:24:30.341263 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part_suppliers"
[0m20:24:30.341861 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part_suppliers (compile): 20:24:30.330915 => 20:24:30.341691
[0m20:24:30.342394 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m20:24:30.342657 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_region
[0m20:24:30.343135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part_suppliers, now model.dbt_trino_iceberg.stg_tpch_region)
[0m20:24:30.343352 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_region
[0m20:24:30.345177 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_region"
[0m20:24:30.345527 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_region (compile): 20:24:30.343486 => 20:24:30.345398
[0m20:24:30.346004 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_region
[0m20:24:30.346250 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m20:24:30.346604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_region, now model.dbt_trino_iceberg.stg_tpch_supplier)
[0m20:24:30.346809 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_supplier
[0m20:24:30.348644 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_supplier"
[0m20:24:30.349255 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_supplier (compile): 20:24:30.346936 => 20:24:30.349109
[0m20:24:30.350214 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m20:24:30.350599 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.int_order_items
[0m20:24:30.351001 [info ] [Thread-1 (]: 1 of 7 START sql table model dbt.int_order_items ............................... [RUN]
[0m20:24:30.351864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_supplier, now model.dbt_trino_iceberg.int_order_items)
[0m20:24:30.352167 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.int_order_items
[0m20:24:30.366226 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.int_order_items"
[0m20:24:30.366886 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_order_items (compile): 20:24:30.352345 => 20:24:30.366677
[0m20:24:30.367148 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.int_order_items
[0m20:24:30.383863 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."int_order_items"
[0m20:24:30.385235 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_order_items"
[0m20:24:30.385492 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_order_items"} */

    drop table if exists "lakehouse"."dbt"."int_order_items"
[0m20:24:30.385683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:31.013645 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:24:31.022969 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.int_order_items"
[0m20:24:31.027340 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_order_items"
[0m20:24:31.027639 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_order_items"} */

  
    

    create table "lakehouse"."dbt"."int_order_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_orders as (

select
    orderkey as order_key, 
    custkey as customer_key,
    orderstatus as order_status_code,
    totalprice as order_amount,
    orderdate as order_date,
    orderpriority as order_priority_code,
    clerk as order_clerk_name,
    shippriority as shipping_priority,
    comment as order_comment
from
    tpch.sf1.orders
),  __dbt__cte__stg_tpch_line_item as (

select
    orderkey as order_key,
    partkey as part_key,
    suppkey as supplier_key,
    linenumber as order_line_number,
    quantity as quantity,
    extendedprice as extended_price,
    discount as discount_percentage,
    tax as tax_rate,
    returnflag as return_status_code,
    linestatus as order_line_status_code,
    shipdate as ship_date,
    commitdate as commit_date,
    receiptdate as receipt_date,
    shipinstruct as ship_instructions_desc,
    shipmode as ship_mode_name,
    comment as order_line_comment
from
    tpch.sf1.lineitem
), orders as (
    
    select * from __dbt__cte__stg_tpch_orders

),
line_items as (

    select * from __dbt__cte__stg_tpch_line_item

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(o.order_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l.order_line_number as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as order_item_key,

    o.order_key,
    o.order_date,
    o.customer_key,
    o.order_status_code,
    
    l.part_key,
    l.supplier_key,
    l.return_status_code,
    l.order_line_number,
    l.order_line_status_code,
    l.ship_date,
    l.commit_date,
    l.receipt_date,
    l.ship_mode_name,

    l.quantity,
    
    -- extended_price is actually the line item total,
    -- so we back out the extended price per item
    (l.extended_price/nullif(l.quantity, 0)) as base_price,
    l.discount_percentage,
    ((l.extended_price/nullif(l.quantity, 0)) * (1 - l.discount_percentage)) as discounted_price,

    l.extended_price as gross_item_sales_amount,
    (l.extended_price * (1 - l.discount_percentage)) as discounted_item_sales_amount,
    -- We model discounts as negative amounts
    (-1 * l.extended_price * l.discount_percentage) as item_discount_amount,
    l.tax_rate,
    ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate) as item_tax_amount,
    (
        l.extended_price + 
        (-1 * l.extended_price * l.discount_percentage) + 
        ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate)
    ) as net_item_sales_amount

from
    orders o
    join
    line_items l
        on o.order_key = l.order_key
order by
    o.order_date
    )
[0m20:25:01.057284 [debug] [Thread-1 (]: SQL status: SUCCESS in 30.0 seconds
[0m20:25:01.069513 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_order_items (execute): 20:24:30.367279 => 20:25:01.069369
[0m20:25:01.069813 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: ROLLBACK
[0m20:25:01.070027 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: Close
[0m20:25:01.071176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bf2b1c9-7b07-4241-907d-65fd36e018f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f9bac6890>]}
[0m20:25:01.071601 [info ] [Thread-1 (]: 1 of 7 OK created sql table model dbt.int_order_items .......................... [[32mSUCCESS[0m in 30.72s]
[0m20:25:01.071983 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.int_order_items
[0m20:25:01.072281 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_part_suppliers
[0m20:25:01.072593 [info ] [Thread-1 (]: 2 of 7 START sql table model dbt.dim_part_suppliers ............................ [RUN]
[0m20:25:01.073564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.int_order_items, now model.dbt_trino_iceberg.dim_part_suppliers)
[0m20:25:01.073794 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_part_suppliers
[0m20:25:01.082828 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m20:25:01.083347 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (compile): 20:25:01.073915 => 20:25:01.083169
[0m20:25:01.083589 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_part_suppliers
[0m20:25:01.086748 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."dim_part_suppliers"
[0m20:25:01.087382 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m20:25:01.087592 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

    drop table if exists "lakehouse"."dbt"."dim_part_suppliers"
[0m20:25:01.087794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:02.504954 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:25:02.508318 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m20:25:02.514215 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m20:25:02.514536 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
order by
    f.part_key,
    f.supplier_key
    )
[0m20:25:11.511390 [debug] [Thread-1 (]: SQL status: SUCCESS in 9.0 seconds
[0m20:25:11.515703 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (execute): 20:25:01.083716 => 20:25:11.515453
[0m20:25:11.516125 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: ROLLBACK
[0m20:25:11.516497 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: Close
[0m20:25:11.517897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bf2b1c9-7b07-4241-907d-65fd36e018f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f9bc5e2d0>]}
[0m20:25:11.518294 [info ] [Thread-1 (]: 2 of 7 OK created sql table model dbt.dim_part_suppliers ....................... [[32mSUCCESS[0m in 10.44s]
[0m20:25:11.518709 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_part_suppliers
[0m20:25:11.519042 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_suppliers
[0m20:25:11.519319 [info ] [Thread-1 (]: 3 of 7 START sql table model dbt.dim_suppliers ................................. [RUN]
[0m20:25:11.519794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_part_suppliers, now model.dbt_trino_iceberg.dim_suppliers)
[0m20:25:11.520016 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_suppliers
[0m20:25:11.526034 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_suppliers"
[0m20:25:11.526517 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (compile): 20:25:11.520145 => 20:25:11.526375
[0m20:25:11.526710 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_suppliers
[0m20:25:11.529317 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."dim_suppliers"
[0m20:25:11.529793 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m20:25:11.529988 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt"."dim_suppliers"
[0m20:25:11.530156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:12.784735 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:25:12.789114 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_suppliers"
[0m20:25:12.792640 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m20:25:12.792926 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt"."dim_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m20:25:14.208327 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:25:14.211134 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (execute): 20:25:11.526816 => 20:25:14.211016
[0m20:25:14.211376 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: ROLLBACK
[0m20:25:14.211558 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: Close
[0m20:25:14.212539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bf2b1c9-7b07-4241-907d-65fd36e018f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f9b98abd0>]}
[0m20:25:14.212884 [info ] [Thread-1 (]: 3 of 7 OK created sql table model dbt.dim_suppliers ............................ [[32mSUCCESS[0m in 2.69s]
[0m20:25:14.213237 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_suppliers
[0m20:25:14.213526 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.int_parts_suppliers
[0m20:25:14.213838 [info ] [Thread-1 (]: 4 of 7 START sql table model dbt.int_parts_suppliers ........................... [RUN]
[0m20:25:14.214266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_suppliers, now model.dbt_trino_iceberg.int_parts_suppliers)
[0m20:25:14.214646 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.int_parts_suppliers
[0m20:25:14.222851 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.int_parts_suppliers"
[0m20:25:14.223360 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_parts_suppliers (compile): 20:25:14.214783 => 20:25:14.223209
[0m20:25:14.223571 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.int_parts_suppliers
[0m20:25:14.226323 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."int_parts_suppliers"
[0m20:25:14.226797 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_parts_suppliers"
[0m20:25:14.226989 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_parts_suppliers"} */

    drop table if exists "lakehouse"."dbt"."int_parts_suppliers"
[0m20:25:14.227157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:15.171986 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:25:15.174600 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.int_parts_suppliers"
[0m20:25:15.177999 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_parts_suppliers"
[0m20:25:15.178247 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_parts_suppliers"} */

  
    

    create table "lakehouse"."dbt"."int_parts_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
part_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(p.part_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(s.supplier_key as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
			as part_supplier_key,
    p.part_key,
    p.part_name,
    p.part_manufacturer_name,
    p.part_brand_name,
    p.part_type_name,
    p.part_size,
    p.part_container_desc,
    p.retail_price,

    s.supplier_key,
    s.supplier_name,
    s.nation_key,

    ps.supplier_availabe_quantity,
    ps.supplier_cost_amount
from
    parts p
    join
    part_suppliers ps
        on p.part_key = ps.part_key
    join
    suppliers s
        on ps.supplier_key = s.supplier_key
order by
    p.part_key
    )
[0m20:25:22.143293 [debug] [Thread-1 (]: SQL status: SUCCESS in 7.0 seconds
[0m20:25:22.147605 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_parts_suppliers (execute): 20:25:14.223737 => 20:25:22.147483
[0m20:25:22.150497 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: ROLLBACK
[0m20:25:22.150820 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: Close
[0m20:25:22.152614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bf2b1c9-7b07-4241-907d-65fd36e018f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f9ba6abd0>]}
[0m20:25:22.153165 [info ] [Thread-1 (]: 4 of 7 OK created sql table model dbt.int_parts_suppliers ...................... [[32mSUCCESS[0m in 7.94s]
[0m20:25:22.153767 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.int_parts_suppliers
[0m20:25:22.154186 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.fct_orders_items
[0m20:25:22.154509 [info ] [Thread-1 (]: 5 of 7 START sql table model dbt.fct_orders_items .............................. [RUN]
[0m20:25:22.155073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.int_parts_suppliers, now model.dbt_trino_iceberg.fct_orders_items)
[0m20:25:22.155367 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.fct_orders_items
[0m20:25:22.163074 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.fct_orders_items"
[0m20:25:22.163467 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (compile): 20:25:22.155542 => 20:25:22.163336
[0m20:25:22.163659 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.fct_orders_items
[0m20:25:22.167227 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."fct_orders_items"
[0m20:25:22.167710 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m20:25:22.167976 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

    drop table if exists "lakehouse"."dbt"."fct_orders_items"
[0m20:25:22.168151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:23.279432 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:25:23.282724 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.fct_orders_items"
[0m20:25:23.287645 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m20:25:23.287894 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

  
    

    create table "lakehouse"."dbt"."fct_orders_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), orders_items as (
    
    select * from "lakehouse"."dbt"."int_order_items"

),
parts_suppliers as (
    
    select * from __dbt__cte__stg_tpch_part_suppliers

),
final as (
    select 

        o.order_item_key,
        o.order_key,
        o.order_date,
        o.customer_key,
        o.order_status_code,
        
        o.part_key,
        o.supplier_key,
        o.return_status_code,
        o.order_line_number,
        o.order_line_status_code,
        o.ship_date,
        o.commit_date,
        o.receipt_date,
        o.ship_mode_name,
        ps.supplier_cost_amount,
        
        o.base_price,
        o.discount_percentage,
        o.discounted_price,
        o.tax_rate,
        
        1 as order_item_count,
        o.quantity,

        o.gross_item_sales_amount,
        o.discounted_item_sales_amount,
        o.item_discount_amount,
        o.item_tax_amount,
        o.net_item_sales_amount

    from
        orders_items o
        join
        parts_suppliers ps
            on o.part_key = ps.part_key and
                o.supplier_key = ps.supplier_key
)
select *

from
    final f
order by
    f.order_date
    )
[0m20:25:51.083430 [debug] [Thread-1 (]: SQL status: SUCCESS in 28.0 seconds
[0m20:25:51.087633 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (execute): 20:25:22.163765 => 20:25:51.087500
[0m20:25:51.087839 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: ROLLBACK
[0m20:25:51.088015 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: Close
[0m20:25:51.089003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bf2b1c9-7b07-4241-907d-65fd36e018f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f9b796190>]}
[0m20:25:51.089330 [info ] [Thread-1 (]: 5 of 7 OK created sql table model dbt.fct_orders_items ......................... [[32mSUCCESS[0m in 28.93s]
[0m20:25:51.089708 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.fct_orders_items
[0m20:25:51.090082 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m20:25:51.090334 [info ] [Thread-1 (]: 6 of 7 START sql table model dbt.minimum_cost_suppliers ........................ [RUN]
[0m20:25:51.090948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.fct_orders_items, now model.dbt_trino_iceberg.minimum_cost_suppliers)
[0m20:25:51.091180 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m20:25:51.093122 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m20:25:51.093641 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (compile): 20:25:51.091351 => 20:25:51.093492
[0m20:25:51.093858 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m20:25:51.095552 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m20:25:51.097341 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m20:25:51.097595 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.minimum_cost_suppliers"} */

  
    

    create table "lakehouse"."dbt"."minimum_cost_suppliers"
      
      
    as (
      /*
2 Q2 - Minimum Cost Supplier Query
This query finds which supplier should be selected to place an order for a given part in a given region
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 30)
*/

with parts_suppliers as (

    select
        s.supplier_account_balance,
        s.supplier_name,
        s.supplier_nation_key,
        s.supplier_region_key,
        s.supplier_nation_name,
        s.supplier_region_name,
        s.part_key,
        s.part_manufacturer_name,
        s.part_size,
        s.part_type_name,
        s.supplier_cost_amount,
        s.supplier_address,
        s.supplier_phone_number,
        rank() over(partition by s.supplier_region_key, s.part_key order by s.supplier_cost_amount) as supplier_cost_rank,
        row_number() over(partition by s.supplier_region_key, s.part_key, s.supplier_cost_amount order by s.supplier_account_balance desc) as supplier_rank
    from
        "lakehouse"."dbt"."dim_part_suppliers" s
)
select
    s.*
from
    int_parts_suppliers  s
where
    s.supplier_cost_rank = 1 and 
    s.supplier_rank <= 100
order by 
    s.supplier_name, s.part_key
    )
[0m20:25:51.097827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:52.101162 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231217_192554_00087_ijqrb
[0m20:25:52.102121 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 42:5: Column 's.supplier_cost_rank' cannot be resolved", query_id=20231217_192554_00087_ijqrb)
[0m20:25:52.103355 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (execute): 20:25:51.093986 => 20:25:52.102906
[0m20:25:52.104040 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: ROLLBACK
[0m20:25:52.104582 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: Close
[0m20:25:52.107245 [debug] [Thread-1 (]: Database Error in model minimum_cost_suppliers (models/mart/minimum_cost_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 42:5: Column 's.supplier_cost_rank' cannot be resolved", query_id=20231217_192554_00087_ijqrb)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/minimum_cost_suppliers.sql
[0m20:25:52.108131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bf2b1c9-7b07-4241-907d-65fd36e018f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f9bce5f90>]}
[0m20:25:52.108465 [error] [Thread-1 (]: 6 of 7 ERROR creating sql table model dbt.minimum_cost_suppliers ............... [[31mERROR[0m in 1.02s]
[0m20:25:52.108843 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m20:25:52.109146 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m20:25:52.109395 [info ] [Thread-1 (]: 7 of 7 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m20:25:52.110099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.minimum_cost_suppliers, now model.dbt_trino_iceberg.pricing_summary_report)
[0m20:25:52.110305 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m20:25:52.112883 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 20:25:52.110414 => 20:25:52.112745
[0m20:25:52.114004 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m20:25:52.114231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bf2b1c9-7b07-4241-907d-65fd36e018f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f9ba79290>]}
[0m20:25:52.114520 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.00s]
[0m20:25:52.114817 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m20:25:52.116631 [debug] [MainThread]: On master: COMMIT
[0m20:25:52.117048 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:25:52.117214 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m20:25:52.117397 [info ] [MainThread]: 
[0m20:25:52.117638 [info ] [MainThread]: Finished running 7 table models in 0 hours 1 minutes and 23.71 seconds (83.71s).
[0m20:25:52.118502 [debug] [MainThread]: Command end result
[0m20:25:52.126920 [info ] [MainThread]: 
[0m20:25:52.127247 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:25:52.127484 [info ] [MainThread]: 
[0m20:25:52.127712 [error] [MainThread]:   Database Error in model minimum_cost_suppliers (models/mart/minimum_cost_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 42:5: Column 's.supplier_cost_rank' cannot be resolved", query_id=20231217_192554_00087_ijqrb)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/minimum_cost_suppliers.sql
[0m20:25:52.128045 [info ] [MainThread]: 
[0m20:25:52.128257 [error] [MainThread]:   Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m20:25:52.128476 [info ] [MainThread]: 
[0m20:25:52.128736 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m20:25:52.129511 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 83.954475, "process_user_time": 2.124997, "process_kernel_time": 0.275841, "process_mem_max_rss": "112996", "process_out_blocks": "2736", "command_success": false, "process_in_blocks": "0"}
[0m20:25:52.129820 [debug] [MainThread]: Command `dbt run` failed at 20:25:52.129750 after 83.95 seconds
[0m20:25:52.130085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f9c39c210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa046b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa046b3d0>]}
[0m20:25:52.130292 [debug] [MainThread]: Flushing usage events
[0m20:26:37.090594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd034bc1a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd034bd2490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd034bc1d50>]}


============================== 20:26:37.092306 | 0c751544-b0ba-4d9b-91e1-6c04054db3ef ==============================
[0m20:26:37.092306 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:26:37.092680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:26:37.206956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c751544-b0ba-4d9b-91e1-6c04054db3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd034958110>]}
[0m20:26:37.257657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c751544-b0ba-4d9b-91e1-6c04054db3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd034958110>]}
[0m20:26:37.258117 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m20:26:37.265066 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:26:37.280721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:26:37.281215 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/mart/minimum_cost_suppliers.sql
[0m20:26:37.361435 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_trino_iceberg.vars
[0m20:26:37.364740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c751544-b0ba-4d9b-91e1-6c04054db3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd034856350>]}
[0m20:26:37.372308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c751544-b0ba-4d9b-91e1-6c04054db3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd034600790>]}
[0m20:26:37.372624 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m20:26:37.372959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c751544-b0ba-4d9b-91e1-6c04054db3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0348a5750>]}
[0m20:26:37.374580 [info ] [MainThread]: 
[0m20:26:37.375259 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m20:26:37.376351 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m20:26:37.386522 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m20:26:37.386726 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m20:26:37.386882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:26:38.883863 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:26:38.886563 [debug] [ThreadPool]: On list_lakehouse: Close
[0m20:26:38.889548 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m20:26:38.895772 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m20:26:38.895979 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m20:26:38.896142 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:26:39.851026 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:26:39.852118 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m20:26:39.852362 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m20:26:39.854860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c751544-b0ba-4d9b-91e1-6c04054db3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0346f4990>]}
[0m20:26:39.855348 [debug] [MainThread]: On master: COMMIT
[0m20:26:39.855840 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:26:39.856121 [info ] [MainThread]: 
[0m20:26:39.859075 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_customers
[0m20:26:39.859866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.stg_tpch_customers)
[0m20:26:39.860229 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_customers
[0m20:26:39.862723 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_customers"
[0m20:26:39.863461 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_customers (compile): 20:26:39.860404 => 20:26:39.863178
[0m20:26:39.865461 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_customers
[0m20:26:39.865781 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m20:26:39.866243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_customers, now model.dbt_trino_iceberg.stg_tpch_line_item)
[0m20:26:39.866601 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_line_item
[0m20:26:39.868981 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_line_item"
[0m20:26:39.869637 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_line_item (compile): 20:26:39.866776 => 20:26:39.869397
[0m20:26:39.870338 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m20:26:39.870635 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_nation
[0m20:26:39.871076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_line_item, now model.dbt_trino_iceberg.stg_tpch_nation)
[0m20:26:39.871532 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_nation
[0m20:26:39.873689 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_nation"
[0m20:26:39.874209 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_nation (compile): 20:26:39.871692 => 20:26:39.874051
[0m20:26:39.874799 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_nation
[0m20:26:39.875121 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_orders
[0m20:26:39.875817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_nation, now model.dbt_trino_iceberg.stg_tpch_orders)
[0m20:26:39.876232 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_orders
[0m20:26:39.878577 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_orders"
[0m20:26:39.879203 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_orders (compile): 20:26:39.876452 => 20:26:39.878995
[0m20:26:39.879860 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_orders
[0m20:26:39.880170 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part
[0m20:26:39.880635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_orders, now model.dbt_trino_iceberg.stg_tpch_part)
[0m20:26:39.880898 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part
[0m20:26:39.883465 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part"
[0m20:26:39.884342 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part (compile): 20:26:39.881184 => 20:26:39.884106
[0m20:26:39.884978 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part
[0m20:26:39.885314 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m20:26:39.885834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part, now model.dbt_trino_iceberg.stg_tpch_part_suppliers)
[0m20:26:39.886349 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m20:26:39.897437 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part_suppliers"
[0m20:26:39.898066 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part_suppliers (compile): 20:26:39.886580 => 20:26:39.897892
[0m20:26:39.898598 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m20:26:39.898882 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_region
[0m20:26:39.899346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part_suppliers, now model.dbt_trino_iceberg.stg_tpch_region)
[0m20:26:39.899583 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_region
[0m20:26:39.902441 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_region"
[0m20:26:39.903017 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_region (compile): 20:26:39.899720 => 20:26:39.902826
[0m20:26:39.903684 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_region
[0m20:26:39.903992 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m20:26:39.904428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_region, now model.dbt_trino_iceberg.stg_tpch_supplier)
[0m20:26:39.904660 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_supplier
[0m20:26:39.906668 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_supplier"
[0m20:26:39.907141 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_supplier (compile): 20:26:39.904795 => 20:26:39.907005
[0m20:26:39.907631 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m20:26:39.907912 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.int_order_items
[0m20:26:39.908312 [info ] [Thread-1 (]: 1 of 7 START sql table model dbt.int_order_items ............................... [RUN]
[0m20:26:39.909082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_supplier, now model.dbt_trino_iceberg.int_order_items)
[0m20:26:39.909413 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.int_order_items
[0m20:26:39.922754 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.int_order_items"
[0m20:26:39.923394 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_order_items (compile): 20:26:39.909549 => 20:26:39.923213
[0m20:26:39.923640 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.int_order_items
[0m20:26:39.940126 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."int_order_items"
[0m20:26:39.942362 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_order_items"
[0m20:26:39.942841 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_order_items"} */

    drop table if exists "lakehouse"."dbt"."int_order_items"
[0m20:26:39.943137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:40.511386 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:26:40.521464 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.int_order_items"
[0m20:26:40.525635 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_order_items"
[0m20:26:40.525911 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_order_items"} */

  
    

    create table "lakehouse"."dbt"."int_order_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_orders as (

select
    orderkey as order_key, 
    custkey as customer_key,
    orderstatus as order_status_code,
    totalprice as order_amount,
    orderdate as order_date,
    orderpriority as order_priority_code,
    clerk as order_clerk_name,
    shippriority as shipping_priority,
    comment as order_comment
from
    tpch.sf1.orders
),  __dbt__cte__stg_tpch_line_item as (

select
    orderkey as order_key,
    partkey as part_key,
    suppkey as supplier_key,
    linenumber as order_line_number,
    quantity as quantity,
    extendedprice as extended_price,
    discount as discount_percentage,
    tax as tax_rate,
    returnflag as return_status_code,
    linestatus as order_line_status_code,
    shipdate as ship_date,
    commitdate as commit_date,
    receiptdate as receipt_date,
    shipinstruct as ship_instructions_desc,
    shipmode as ship_mode_name,
    comment as order_line_comment
from
    tpch.sf1.lineitem
), orders as (
    
    select * from __dbt__cte__stg_tpch_orders

),
line_items as (

    select * from __dbt__cte__stg_tpch_line_item

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(o.order_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l.order_line_number as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as order_item_key,

    o.order_key,
    o.order_date,
    o.customer_key,
    o.order_status_code,
    
    l.part_key,
    l.supplier_key,
    l.return_status_code,
    l.order_line_number,
    l.order_line_status_code,
    l.ship_date,
    l.commit_date,
    l.receipt_date,
    l.ship_mode_name,

    l.quantity,
    
    -- extended_price is actually the line item total,
    -- so we back out the extended price per item
    (l.extended_price/nullif(l.quantity, 0)) as base_price,
    l.discount_percentage,
    ((l.extended_price/nullif(l.quantity, 0)) * (1 - l.discount_percentage)) as discounted_price,

    l.extended_price as gross_item_sales_amount,
    (l.extended_price * (1 - l.discount_percentage)) as discounted_item_sales_amount,
    -- We model discounts as negative amounts
    (-1 * l.extended_price * l.discount_percentage) as item_discount_amount,
    l.tax_rate,
    ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate) as item_tax_amount,
    (
        l.extended_price + 
        (-1 * l.extended_price * l.discount_percentage) + 
        ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate)
    ) as net_item_sales_amount

from
    orders o
    join
    line_items l
        on o.order_key = l.order_key
order by
    o.order_date
    )
[0m20:27:07.707835 [debug] [Thread-1 (]: SQL status: SUCCESS in 27.0 seconds
[0m20:27:07.719179 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_order_items (execute): 20:26:39.923804 => 20:27:07.719047
[0m20:27:07.719414 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: ROLLBACK
[0m20:27:07.719592 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: Close
[0m20:27:07.720631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c751544-b0ba-4d9b-91e1-6c04054db3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0345d2450>]}
[0m20:27:07.721009 [info ] [Thread-1 (]: 1 of 7 OK created sql table model dbt.int_order_items .......................... [[32mSUCCESS[0m in 27.81s]
[0m20:27:07.721463 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.int_order_items
[0m20:27:07.721763 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_part_suppliers
[0m20:27:07.722034 [info ] [Thread-1 (]: 2 of 7 START sql table model dbt.dim_part_suppliers ............................ [RUN]
[0m20:27:07.722497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.int_order_items, now model.dbt_trino_iceberg.dim_part_suppliers)
[0m20:27:07.722730 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_part_suppliers
[0m20:27:07.731467 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m20:27:07.731940 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (compile): 20:27:07.722864 => 20:27:07.731802
[0m20:27:07.732147 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_part_suppliers
[0m20:27:07.736135 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."dim_part_suppliers"
[0m20:27:07.736753 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m20:27:07.736966 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

    drop table if exists "lakehouse"."dbt"."dim_part_suppliers"
[0m20:27:07.737236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:27:09.046407 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:27:09.049883 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m20:27:09.054575 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m20:27:09.054856 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
order by
    f.part_key,
    f.supplier_key
    )
[0m20:27:18.025812 [debug] [Thread-1 (]: SQL status: SUCCESS in 9.0 seconds
[0m20:27:18.030064 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (execute): 20:27:07.732260 => 20:27:18.029818
[0m20:27:18.030381 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: ROLLBACK
[0m20:27:18.030657 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: Close
[0m20:27:18.032273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c751544-b0ba-4d9b-91e1-6c04054db3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd033494510>]}
[0m20:27:18.032638 [info ] [Thread-1 (]: 2 of 7 OK created sql table model dbt.dim_part_suppliers ....................... [[32mSUCCESS[0m in 10.31s]
[0m20:27:18.032992 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_part_suppliers
[0m20:27:18.033283 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_suppliers
[0m20:27:18.033573 [info ] [Thread-1 (]: 3 of 7 START sql table model dbt.dim_suppliers ................................. [RUN]
[0m20:27:18.034356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_part_suppliers, now model.dbt_trino_iceberg.dim_suppliers)
[0m20:27:18.034568 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_suppliers
[0m20:27:18.039392 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_suppliers"
[0m20:27:18.039763 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (compile): 20:27:18.034681 => 20:27:18.039639
[0m20:27:18.039950 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_suppliers
[0m20:27:18.042630 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."dim_suppliers"
[0m20:27:18.043095 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m20:27:18.043286 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt"."dim_suppliers"
[0m20:27:18.043454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:27:19.123317 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:27:19.126630 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_suppliers"
[0m20:27:19.128981 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m20:27:19.129215 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt"."dim_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m20:27:20.388889 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:27:20.393373 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (execute): 20:27:18.040056 => 20:27:20.393082
[0m20:27:20.393867 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: ROLLBACK
[0m20:27:20.394250 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: Close
[0m20:27:20.395829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c751544-b0ba-4d9b-91e1-6c04054db3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd033422790>]}
[0m20:27:20.396336 [info ] [Thread-1 (]: 3 of 7 OK created sql table model dbt.dim_suppliers ............................ [[32mSUCCESS[0m in 2.36s]
[0m20:27:20.396729 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_suppliers
[0m20:27:20.397022 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.int_parts_suppliers
[0m20:27:20.397306 [info ] [Thread-1 (]: 4 of 7 START sql table model dbt.int_parts_suppliers ........................... [RUN]
[0m20:27:20.397879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_suppliers, now model.dbt_trino_iceberg.int_parts_suppliers)
[0m20:27:20.398087 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.int_parts_suppliers
[0m20:27:20.405839 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.int_parts_suppliers"
[0m20:27:20.406239 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_parts_suppliers (compile): 20:27:20.398199 => 20:27:20.406109
[0m20:27:20.406437 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.int_parts_suppliers
[0m20:27:20.448063 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."int_parts_suppliers"
[0m20:27:20.448756 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_parts_suppliers"
[0m20:27:20.448978 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_parts_suppliers"} */

    drop table if exists "lakehouse"."dbt"."int_parts_suppliers"
[0m20:27:20.449155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:27:21.163704 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:27:21.166242 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.int_parts_suppliers"
[0m20:27:21.169710 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_parts_suppliers"
[0m20:27:21.169982 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_parts_suppliers"} */

  
    

    create table "lakehouse"."dbt"."int_parts_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
part_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(p.part_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(s.supplier_key as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
			as part_supplier_key,
    p.part_key,
    p.part_name,
    p.part_manufacturer_name,
    p.part_brand_name,
    p.part_type_name,
    p.part_size,
    p.part_container_desc,
    p.retail_price,

    s.supplier_key,
    s.supplier_name,
    s.nation_key,

    ps.supplier_availabe_quantity,
    ps.supplier_cost_amount
from
    parts p
    join
    part_suppliers ps
        on p.part_key = ps.part_key
    join
    suppliers s
        on ps.supplier_key = s.supplier_key
order by
    p.part_key
    )
[0m20:27:27.868155 [debug] [Thread-1 (]: SQL status: SUCCESS in 7.0 seconds
[0m20:27:27.872320 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_parts_suppliers (execute): 20:27:20.406546 => 20:27:27.872079
[0m20:27:27.872518 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: ROLLBACK
[0m20:27:27.872693 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: Close
[0m20:27:27.873690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c751544-b0ba-4d9b-91e1-6c04054db3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0349269d0>]}
[0m20:27:27.874023 [info ] [Thread-1 (]: 4 of 7 OK created sql table model dbt.int_parts_suppliers ...................... [[32mSUCCESS[0m in 7.48s]
[0m20:27:27.874389 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.int_parts_suppliers
[0m20:27:27.874689 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.fct_orders_items
[0m20:27:27.874965 [info ] [Thread-1 (]: 5 of 7 START sql table model dbt.fct_orders_items .............................. [RUN]
[0m20:27:27.875433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.int_parts_suppliers, now model.dbt_trino_iceberg.fct_orders_items)
[0m20:27:27.875673 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.fct_orders_items
[0m20:27:27.883320 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.fct_orders_items"
[0m20:27:27.883710 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (compile): 20:27:27.875806 => 20:27:27.883580
[0m20:27:27.883900 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.fct_orders_items
[0m20:27:27.886471 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."fct_orders_items"
[0m20:27:27.886942 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m20:27:27.887143 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

    drop table if exists "lakehouse"."dbt"."fct_orders_items"
[0m20:27:27.887308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:27:29.064400 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:27:29.067614 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.fct_orders_items"
[0m20:27:29.070546 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m20:27:29.070795 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

  
    

    create table "lakehouse"."dbt"."fct_orders_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(partkey as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(suppkey as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
                as part_supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), orders_items as (
    
    select * from "lakehouse"."dbt"."int_order_items"

),
parts_suppliers as (
    
    select * from __dbt__cte__stg_tpch_part_suppliers

),
final as (
    select 

        o.order_item_key,
        o.order_key,
        o.order_date,
        o.customer_key,
        o.order_status_code,
        
        o.part_key,
        o.supplier_key,
        o.return_status_code,
        o.order_line_number,
        o.order_line_status_code,
        o.ship_date,
        o.commit_date,
        o.receipt_date,
        o.ship_mode_name,
        ps.supplier_cost_amount,
        
        o.base_price,
        o.discount_percentage,
        o.discounted_price,
        o.tax_rate,
        
        1 as order_item_count,
        o.quantity,

        o.gross_item_sales_amount,
        o.discounted_item_sales_amount,
        o.item_discount_amount,
        o.item_tax_amount,
        o.net_item_sales_amount

    from
        orders_items o
        join
        parts_suppliers ps
            on o.part_key = ps.part_key and
                o.supplier_key = ps.supplier_key
)
select *

from
    final f
order by
    f.order_date
    )
[0m20:27:59.940169 [debug] [Thread-1 (]: SQL status: SUCCESS in 31.0 seconds
[0m20:27:59.942263 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (execute): 20:27:27.884008 => 20:27:59.942117
[0m20:27:59.942501 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: ROLLBACK
[0m20:27:59.942684 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: Close
[0m20:27:59.943932 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c751544-b0ba-4d9b-91e1-6c04054db3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0353a8b10>]}
[0m20:27:59.944376 [info ] [Thread-1 (]: 5 of 7 OK created sql table model dbt.fct_orders_items ......................... [[32mSUCCESS[0m in 32.07s]
[0m20:27:59.944805 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.fct_orders_items
[0m20:27:59.945209 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m20:27:59.945507 [info ] [Thread-1 (]: 6 of 7 START sql table model dbt.minimum_cost_suppliers ........................ [RUN]
[0m20:27:59.946397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.fct_orders_items, now model.dbt_trino_iceberg.minimum_cost_suppliers)
[0m20:27:59.946621 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m20:27:59.948929 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m20:27:59.949422 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (compile): 20:27:59.946740 => 20:27:59.949273
[0m20:27:59.949632 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m20:27:59.951656 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m20:27:59.953477 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m20:27:59.953815 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.minimum_cost_suppliers"} */

  
    

    create table "lakehouse"."dbt"."minimum_cost_suppliers"
      
      
    as (
      /*
2 Q2 - Minimum Cost Supplier Query
This query finds which supplier should be selected to place an order for a given part in a given region
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 30)
*/

with parts_suppliers as (

    select
        s.supplier_account_balance,
        s.supplier_name,
        s.supplier_nation_key,
        s.supplier_region_key,
        s.supplier_nation_name,
        s.supplier_region_name,
        s.part_key,
        s.part_manufacturer_name,
        s.part_size,
        s.part_type_name,
        s.supplier_cost_amount,
        s.supplier_address,
        s.supplier_phone_number,
        rank() over(partition by s.supplier_region_key, s.part_key order by s.supplier_cost_amount) as supplier_cost_rank,
        row_number() over(partition by s.supplier_region_key, s.part_key, s.supplier_cost_amount order by s.supplier_account_balance desc) as supplier_rank
    from
        "lakehouse"."dbt"."dim_part_suppliers" s
)
select
    s.*
from
    parts_suppliers s
where
    s.supplier_cost_rank = 1 and 
    s.supplier_rank <= 100
order by 
    s.supplier_name, s.part_key
    )
[0m20:27:59.954078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:06.813651 [debug] [Thread-1 (]: SQL status: SUCCESS in 7.0 seconds
[0m20:28:06.816344 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (execute): 20:27:59.949743 => 20:28:06.816167
[0m20:28:06.816574 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: ROLLBACK
[0m20:28:06.816753 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: Close
[0m20:28:06.818373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c751544-b0ba-4d9b-91e1-6c04054db3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0348e8450>]}
[0m20:28:06.818848 [info ] [Thread-1 (]: 6 of 7 OK created sql table model dbt.minimum_cost_suppliers ................... [[32mSUCCESS[0m in 6.87s]
[0m20:28:06.819317 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m20:28:06.819773 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m20:28:06.820050 [info ] [Thread-1 (]: 7 of 7 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m20:28:06.820586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.minimum_cost_suppliers, now model.dbt_trino_iceberg.pricing_summary_report)
[0m20:28:06.820814 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m20:28:06.825688 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 20:28:06.820945 => 20:28:06.825490
[0m20:28:06.827587 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m20:28:06.827964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c751544-b0ba-4d9b-91e1-6c04054db3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0347d2450>]}
[0m20:28:06.828354 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.01s]
[0m20:28:06.828722 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m20:28:06.830805 [debug] [MainThread]: On master: COMMIT
[0m20:28:06.831558 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:28:06.831797 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m20:28:06.832118 [info ] [MainThread]: 
[0m20:28:06.832447 [info ] [MainThread]: Finished running 7 table models in 0 hours 1 minutes and 29.46 seconds (89.46s).
[0m20:28:06.833644 [debug] [MainThread]: Command end result
[0m20:28:06.844934 [info ] [MainThread]: 
[0m20:28:06.845443 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:28:06.845819 [info ] [MainThread]: 
[0m20:28:06.846125 [error] [MainThread]:   Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m20:28:06.846445 [info ] [MainThread]: 
[0m20:28:06.846765 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m20:28:06.847644 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 89.78128, "process_user_time": 2.207457, "process_kernel_time": 0.222682, "process_mem_max_rss": "115248", "process_out_blocks": "3856", "command_success": false, "process_in_blocks": "0"}
[0m20:28:06.848167 [debug] [MainThread]: Command `dbt run` failed at 20:28:06.848049 after 89.78 seconds
[0m20:28:06.848550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd035bc3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0349e9590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd034ac7c50>]}
[0m20:28:06.848886 [debug] [MainThread]: Flushing usage events
[0m20:38:01.526808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff96035b0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff961622690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff960e7c650>]}


============================== 20:38:01.528410 | 49b38e1b-1093-45ad-bafa-0e9f3e82985e ==============================
[0m20:38:01.528410 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:38:01.528753 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --model pricing_summary_report.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:38:01.642684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49b38e1b-1093-45ad-bafa-0e9f3e82985e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff960191550>]}
[0m20:38:01.693168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49b38e1b-1093-45ad-bafa-0e9f3e82985e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff960160f90>]}
[0m20:38:01.693670 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m20:38:01.700207 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:38:01.706911 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:38:01.707235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '49b38e1b-1093-45ad-bafa-0e9f3e82985e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff96000e910>]}
[0m20:38:02.459588 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_trino_iceberg.vars
[0m20:38:02.463179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49b38e1b-1093-45ad-bafa-0e9f3e82985e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff95ed30c10>]}
[0m20:38:02.471740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49b38e1b-1093-45ad-bafa-0e9f3e82985e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff95ea964d0>]}
[0m20:38:02.472062 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m20:38:02.472313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49b38e1b-1093-45ad-bafa-0e9f3e82985e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff95ffe8450>]}
[0m20:38:02.473926 [info ] [MainThread]: 
[0m20:38:02.474656 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m20:38:02.475573 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m20:38:02.485677 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m20:38:02.485921 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m20:38:02.486084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:38:04.297765 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:38:04.299839 [debug] [ThreadPool]: On list_lakehouse: Close
[0m20:38:04.301961 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m20:38:04.307955 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m20:38:04.308167 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m20:38:04.308355 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:06.274719 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:38:06.277301 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m20:38:06.277720 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m20:38:06.280515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49b38e1b-1093-45ad-bafa-0e9f3e82985e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff95fdeec10>]}
[0m20:38:06.280877 [debug] [MainThread]: On master: COMMIT
[0m20:38:06.281304 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:38:06.281537 [info ] [MainThread]: 
[0m20:38:06.283969 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m20:38:06.284262 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m20:38:06.284710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m20:38:06.284934 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m20:38:06.287425 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 20:38:06.285046 => 20:38:06.287282
[0m20:38:06.288643 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m20:38:06.288891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49b38e1b-1093-45ad-bafa-0e9f3e82985e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff95ed5da50>]}
[0m20:38:06.289370 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.00s]
[0m20:38:06.289706 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m20:38:06.291150 [debug] [MainThread]: On master: COMMIT
[0m20:38:06.291553 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:38:06.291710 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m20:38:06.291866 [info ] [MainThread]: 
[0m20:38:06.292060 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.82 seconds (3.82s).
[0m20:38:06.292475 [debug] [MainThread]: Command end result
[0m20:38:06.298394 [info ] [MainThread]: 
[0m20:38:06.298697 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:38:06.298950 [info ] [MainThread]: 
[0m20:38:06.299372 [error] [MainThread]:   Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m20:38:06.300911 [info ] [MainThread]: 
[0m20:38:06.301286 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:38:06.302080 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.7991776, "process_user_time": 2.089467, "process_kernel_time": 0.089548, "process_mem_max_rss": "113780", "process_out_blocks": "3496", "command_success": false, "process_in_blocks": "0"}
[0m20:38:06.302461 [debug] [MainThread]: Command `dbt run` failed at 20:38:06.302332 after 4.80 seconds
[0m20:38:06.302738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff960352490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9649ff850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff960366c90>]}
[0m20:38:06.302995 [debug] [MainThread]: Flushing usage events
[0m20:41:04.231940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d38e70d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d38984d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d389b250>]}


============================== 20:41:04.233735 | 690f35d3-498b-42c4-a802-c046e6d844ca ==============================
[0m20:41:04.233735 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:41:04.234067 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --model pricing_summary_report.sql', 'send_anonymous_usage_stats': 'True'}
[0m20:41:04.347216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '690f35d3-498b-42c4-a802-c046e6d844ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d367fb90>]}
[0m20:41:04.397065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '690f35d3-498b-42c4-a802-c046e6d844ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d3645e10>]}
[0m20:41:04.397479 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m20:41:04.404430 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:41:04.411340 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:41:04.411653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '690f35d3-498b-42c4-a802-c046e6d844ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d36cca50>]}
[0m20:41:05.154450 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_trino_iceberg.vars
[0m20:41:05.157898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '690f35d3-498b-42c4-a802-c046e6d844ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d225f990>]}
[0m20:41:05.165786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '690f35d3-498b-42c4-a802-c046e6d844ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d2113650>]}
[0m20:41:05.166213 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m20:41:05.166558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '690f35d3-498b-42c4-a802-c046e6d844ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d3330d50>]}
[0m20:41:05.167683 [info ] [MainThread]: 
[0m20:41:05.168185 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m20:41:05.169017 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m20:41:05.179881 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m20:41:05.180187 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m20:41:05.180410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:06.496087 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:41:06.498707 [debug] [ThreadPool]: On list_lakehouse: Close
[0m20:41:06.501186 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m20:41:06.506875 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m20:41:06.507080 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m20:41:06.507296 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:41:07.137757 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:41:07.139838 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m20:41:07.140012 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m20:41:07.142151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '690f35d3-498b-42c4-a802-c046e6d844ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d349ad10>]}
[0m20:41:07.142421 [debug] [MainThread]: On master: COMMIT
[0m20:41:07.142781 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:41:07.142994 [info ] [MainThread]: 
[0m20:41:07.145601 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m20:41:07.145970 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m20:41:07.146498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m20:41:07.146752 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m20:41:07.149227 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 20:41:07.146879 => 20:41:07.149084
[0m20:41:07.150434 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m20:41:07.150675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '690f35d3-498b-42c4-a802-c046e6d844ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d21e8d90>]}
[0m20:41:07.151152 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.00s]
[0m20:41:07.151556 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m20:41:07.152813 [debug] [MainThread]: On master: COMMIT
[0m20:41:07.153173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:41:07.153327 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m20:41:07.153481 [info ] [MainThread]: 
[0m20:41:07.153673 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.99 seconds (1.99s).
[0m20:41:07.154042 [debug] [MainThread]: Command end result
[0m20:41:07.161759 [info ] [MainThread]: 
[0m20:41:07.162412 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:41:07.162793 [info ] [MainThread]: 
[0m20:41:07.163072 [error] [MainThread]:   Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m20:41:07.163297 [info ] [MainThread]: 
[0m20:41:07.163543 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:41:07.164208 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.95596, "process_user_time": 2.066009, "process_kernel_time": 0.069529, "process_mem_max_rss": "115116", "process_out_blocks": "3496", "command_success": false, "process_in_blocks": "0"}
[0m20:41:07.164516 [debug] [MainThread]: Command `dbt run` failed at 20:41:07.164441 after 2.96 seconds
[0m20:41:07.164746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d7f8b8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d7e0f5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d7efd310>]}
[0m20:41:07.165025 [debug] [MainThread]: Flushing usage events
[0m20:42:15.046528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f739ca30a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f739e0683d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f739ca33610>]}


============================== 20:42:15.048381 | deeba86a-d2ab-4a1a-8438-c92ce9b732d0 ==============================
[0m20:42:15.048381 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:42:15.048859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --model pricing_summary_report.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:42:15.164961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'deeba86a-d2ab-4a1a-8438-c92ce9b732d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f739c85b790>]}
[0m20:42:15.215225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'deeba86a-d2ab-4a1a-8438-c92ce9b732d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f739c7a6090>]}
[0m20:42:15.215808 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m20:42:15.222389 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:42:15.228978 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:42:15.229272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'deeba86a-d2ab-4a1a-8438-c92ce9b732d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f739c7fafd0>]}
[0m20:42:15.962477 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_trino_iceberg.vars
[0m20:42:15.966076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'deeba86a-d2ab-4a1a-8438-c92ce9b732d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f739c5b6750>]}
[0m20:42:15.973850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'deeba86a-d2ab-4a1a-8438-c92ce9b732d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f739c3c4910>]}
[0m20:42:15.974172 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m20:42:15.974412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'deeba86a-d2ab-4a1a-8438-c92ce9b732d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f739c67de10>]}
[0m20:42:15.975563 [info ] [MainThread]: 
[0m20:42:15.976086 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m20:42:15.976938 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m20:42:15.988195 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m20:42:15.988462 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m20:42:15.988627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:42:17.179386 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:42:17.181998 [debug] [ThreadPool]: On list_lakehouse: Close
[0m20:42:17.185464 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m20:42:17.191631 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m20:42:17.191910 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m20:42:17.192103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:42:17.957754 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:42:17.960002 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m20:42:17.960363 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m20:42:17.962671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'deeba86a-d2ab-4a1a-8438-c92ce9b732d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f739c4b34d0>]}
[0m20:42:17.962972 [debug] [MainThread]: On master: COMMIT
[0m20:42:17.963336 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:42:17.963551 [info ] [MainThread]: 
[0m20:42:17.965724 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m20:42:17.966009 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m20:42:17.966445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m20:42:17.966752 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m20:42:17.969579 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 20:42:17.966952 => 20:42:17.969391
[0m20:42:17.970909 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m20:42:17.971268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deeba86a-d2ab-4a1a-8438-c92ce9b732d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f739b188d90>]}
[0m20:42:17.971773 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.00s]
[0m20:42:17.972123 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m20:42:17.973512 [debug] [MainThread]: On master: COMMIT
[0m20:42:17.973893 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:42:17.974051 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m20:42:17.974216 [info ] [MainThread]: 
[0m20:42:17.974412 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.00 seconds (2.00s).
[0m20:42:17.974832 [debug] [MainThread]: Command end result
[0m20:42:17.982848 [info ] [MainThread]: 
[0m20:42:17.983271 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:42:17.983536 [info ] [MainThread]: 
[0m20:42:17.983776 [error] [MainThread]:   Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m20:42:17.984012 [info ] [MainThread]: 
[0m20:42:17.984330 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:42:17.985091 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.9635127, "process_user_time": 2.035673, "process_kernel_time": 0.097868, "process_mem_max_rss": "114004", "process_out_blocks": "3496", "command_success": false, "process_in_blocks": "0"}
[0m20:42:17.985440 [debug] [MainThread]: Command `dbt run` failed at 20:42:17.985361 after 2.96 seconds
[0m20:42:17.985673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f739c88a810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73a10ef810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f739c891950>]}
[0m20:42:17.985876 [debug] [MainThread]: Flushing usage events
[0m20:44:52.623987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f840a9750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f851d83d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f840a9d10>]}


============================== 20:44:52.625589 | 54a9c073-30c4-4d96-8da6-a9fc46ed4238 ==============================
[0m20:44:52.625589 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:44:52.625939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --model pricing_summary_report.sql', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:44:52.738569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54a9c073-30c4-4d96-8da6-a9fc46ed4238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f83e5a8d0>]}
[0m20:44:52.788791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54a9c073-30c4-4d96-8da6-a9fc46ed4238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f83cf4c90>]}
[0m20:44:52.789321 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m20:44:52.795945 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:44:52.802802 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:44:52.803103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '54a9c073-30c4-4d96-8da6-a9fc46ed4238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f83d0a050>]}
[0m20:44:53.538504 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_trino_iceberg.vars
[0m20:44:53.541973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54a9c073-30c4-4d96-8da6-a9fc46ed4238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f83e1fa10>]}
[0m20:44:53.549165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54a9c073-30c4-4d96-8da6-a9fc46ed4238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f83a052d0>]}
[0m20:44:53.549503 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m20:44:53.549816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54a9c073-30c4-4d96-8da6-a9fc46ed4238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f83da69d0>]}
[0m20:44:53.551204 [info ] [MainThread]: 
[0m20:44:53.551862 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m20:44:53.552740 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m20:44:53.562925 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m20:44:53.563150 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m20:44:53.563318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:44:54.818149 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:44:54.820502 [debug] [ThreadPool]: On list_lakehouse: Close
[0m20:44:54.824184 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m20:44:54.830528 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m20:44:54.830904 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m20:44:54.831124 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:44:55.543686 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:44:55.545544 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m20:44:55.545897 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m20:44:55.548986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54a9c073-30c4-4d96-8da6-a9fc46ed4238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f83fd8690>]}
[0m20:44:55.549427 [debug] [MainThread]: On master: COMMIT
[0m20:44:55.549954 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:44:55.550261 [info ] [MainThread]: 
[0m20:44:55.552430 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m20:44:55.552810 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m20:44:55.553383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m20:44:55.553643 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m20:44:55.556713 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 20:44:55.553777 => 20:44:55.556525
[0m20:44:55.558473 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m20:44:55.558813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54a9c073-30c4-4d96-8da6-a9fc46ed4238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f829bffd0>]}
[0m20:44:55.559189 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.01s]
[0m20:44:55.559658 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m20:44:55.561074 [debug] [MainThread]: On master: COMMIT
[0m20:44:55.561527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:44:55.561710 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m20:44:55.561894 [info ] [MainThread]: 
[0m20:44:55.562188 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.01 seconds (2.01s).
[0m20:44:55.562642 [debug] [MainThread]: Command end result
[0m20:44:55.572030 [info ] [MainThread]: 
[0m20:44:55.572611 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:44:55.573013 [info ] [MainThread]: 
[0m20:44:55.573526 [error] [MainThread]:   Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m20:44:55.574038 [info ] [MainThread]: 
[0m20:44:55.574580 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:44:55.575738 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.9752252, "process_user_time": 2.014252, "process_kernel_time": 0.091556, "process_mem_max_rss": "114136", "process_out_blocks": "3496", "command_success": false, "process_in_blocks": "0"}
[0m20:44:55.576423 [debug] [MainThread]: Command `dbt run` failed at 20:44:55.576271 after 2.98 seconds
[0m20:44:55.576954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f83f0b090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f88767890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f83e25710>]}
[0m20:44:55.577385 [debug] [MainThread]: Flushing usage events
[0m20:49:02.660854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb339b54b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3396d9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3396da550>]}


============================== 20:49:02.662510 | 30c88873-21d9-490b-9ecd-77ea00553102 ==============================
[0m20:49:02.662510 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:49:02.662844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --model pricing_summary_report.sql', 'send_anonymous_usage_stats': 'True'}
[0m20:49:02.779252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30c88873-21d9-490b-9ecd-77ea00553102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb339425610>]}
[0m20:49:02.830513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30c88873-21d9-490b-9ecd-77ea00553102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb339425610>]}
[0m20:49:02.830936 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m20:49:02.837598 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:49:02.844455 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:49:02.844857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '30c88873-21d9-490b-9ecd-77ea00553102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb339158d90>]}
[0m20:49:03.583057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30c88873-21d9-490b-9ecd-77ea00553102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3393f17d0>]}
[0m20:49:03.590981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30c88873-21d9-490b-9ecd-77ea00553102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb33806fb90>]}
[0m20:49:03.591337 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m20:49:03.591622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30c88873-21d9-490b-9ecd-77ea00553102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb33803ac10>]}
[0m20:49:03.592804 [info ] [MainThread]: 
[0m20:49:03.593423 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m20:49:03.594449 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m20:49:03.606273 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m20:49:03.606555 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m20:49:03.606724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:05.327977 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:49:05.330980 [debug] [ThreadPool]: On list_lakehouse: Close
[0m20:49:05.333489 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m20:49:05.338379 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m20:49:05.338640 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m20:49:05.338850 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:49:06.459436 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:49:06.461228 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m20:49:06.461416 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m20:49:06.463463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30c88873-21d9-490b-9ecd-77ea00553102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb33941fad0>]}
[0m20:49:06.463734 [debug] [MainThread]: On master: COMMIT
[0m20:49:06.464128 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:49:06.464358 [info ] [MainThread]: 
[0m20:49:06.466610 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m20:49:06.466929 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m20:49:06.467440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m20:49:06.467670 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m20:49:06.470948 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 20:49:06.467795 => 20:49:06.470807
[0m20:49:06.472427 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m20:49:06.472677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30c88873-21d9-490b-9ecd-77ea00553102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb31bf9ffd0>]}
[0m20:49:06.472987 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.01s]
[0m20:49:06.473412 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m20:49:06.474830 [debug] [MainThread]: On master: COMMIT
[0m20:49:06.475219 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:06.475372 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m20:49:06.475531 [info ] [MainThread]: 
[0m20:49:06.475732 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.88 seconds (2.88s).
[0m20:49:06.476136 [debug] [MainThread]: Command end result
[0m20:49:06.482248 [info ] [MainThread]: 
[0m20:49:06.482603 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:49:06.482901 [info ] [MainThread]: 
[0m20:49:06.483162 [error] [MainThread]:   Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m20:49:06.483468 [info ] [MainThread]: 
[0m20:49:06.483750 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:49:06.484405 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.8472927, "process_user_time": 2.086746, "process_kernel_time": 0.069228, "process_mem_max_rss": "114204", "process_out_blocks": "3504", "command_success": false, "process_in_blocks": "0"}
[0m20:49:06.484708 [debug] [MainThread]: Command `dbt run` failed at 20:49:06.484637 after 3.85 seconds
[0m20:49:06.484925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb33dd9ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb33dd9b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb33dd9bbd0>]}
[0m20:49:06.485125 [debug] [MainThread]: Flushing usage events
[0m20:50:24.792463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d630df810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d631322d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d630dc990>]}


============================== 20:50:24.794149 | 1033212e-e0e8-4a45-824e-dc9ff2e8c857 ==============================
[0m20:50:24.794149 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:50:24.794493 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --model pricing_summary_report.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:50:24.907637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1033212e-e0e8-4a45-824e-dc9ff2e8c857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d62febf50>]}
[0m20:50:24.958038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1033212e-e0e8-4a45-824e-dc9ff2e8c857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d62f29c50>]}
[0m20:50:24.958453 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m20:50:24.965282 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:50:24.980487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:50:24.980775 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:50:24.984913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1033212e-e0e8-4a45-824e-dc9ff2e8c857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d62ccf410>]}
[0m20:50:24.992403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1033212e-e0e8-4a45-824e-dc9ff2e8c857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d62c639d0>]}
[0m20:50:24.992715 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m20:50:24.992986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1033212e-e0e8-4a45-824e-dc9ff2e8c857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d63588910>]}
[0m20:50:24.994455 [info ] [MainThread]: 
[0m20:50:24.995090 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m20:50:24.996044 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m20:50:25.006551 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m20:50:25.006771 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m20:50:25.006929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:26.196953 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:50:26.199698 [debug] [ThreadPool]: On list_lakehouse: Close
[0m20:50:26.203232 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m20:50:26.209149 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m20:50:26.209360 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m20:50:26.209526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:26.906568 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:50:26.909447 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m20:50:26.909857 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m20:50:26.912493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1033212e-e0e8-4a45-824e-dc9ff2e8c857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d62febb90>]}
[0m20:50:26.912788 [debug] [MainThread]: On master: COMMIT
[0m20:50:26.913188 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:50:26.913420 [info ] [MainThread]: 
[0m20:50:26.915655 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m20:50:26.915978 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m20:50:26.916460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m20:50:26.916691 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m20:50:26.920519 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 20:50:26.916820 => 20:50:26.920369
[0m20:50:26.921869 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m20:50:26.922122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1033212e-e0e8-4a45-824e-dc9ff2e8c857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d62d438d0>]}
[0m20:50:26.922441 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.01s]
[0m20:50:26.922763 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m20:50:26.923924 [debug] [MainThread]: On master: COMMIT
[0m20:50:26.924271 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:50:26.924420 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m20:50:26.924574 [info ] [MainThread]: 
[0m20:50:26.924766 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.93 seconds (1.93s).
[0m20:50:26.925199 [debug] [MainThread]: Command end result
[0m20:50:26.931565 [info ] [MainThread]: 
[0m20:50:26.931953 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:50:26.932187 [info ] [MainThread]: 
[0m20:50:26.932444 [error] [MainThread]:   Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m20:50:26.932694 [info ] [MainThread]: 
[0m20:50:26.932999 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:50:26.933572 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.1646469, "process_user_time": 1.313726, "process_kernel_time": 0.079021, "process_mem_max_rss": "109924", "process_out_blocks": "2376", "command_success": false, "process_in_blocks": "0"}
[0m20:50:26.933961 [debug] [MainThread]: Command `dbt run` failed at 20:50:26.933870 after 2.17 seconds
[0m20:50:26.934197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d64a22d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d677cfa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d63c32d50>]}
[0m20:50:26.934395 [debug] [MainThread]: Flushing usage events
[0m20:51:24.699852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc38a38d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc38a3bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc38a3a110>]}


============================== 20:51:24.701812 | a0118127-2089-4bfd-b1c6-e55991d01351 ==============================
[0m20:51:24.701812 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:51:24.702233 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --model pricing_summary_report.sql', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:51:24.816793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0118127-2089-4bfd-b1c6-e55991d01351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc388a7850>]}
[0m20:51:24.868100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0118127-2089-4bfd-b1c6-e55991d01351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc39587e50>]}
[0m20:51:24.868506 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m20:51:24.875320 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:51:24.890674 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:51:24.891305 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/mart/pricing_summary_report.sql
[0m20:51:24.979091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0118127-2089-4bfd-b1c6-e55991d01351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc3845af50>]}
[0m20:51:24.986582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0118127-2089-4bfd-b1c6-e55991d01351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc3849c1d0>]}
[0m20:51:24.986920 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m20:51:24.987187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0118127-2089-4bfd-b1c6-e55991d01351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc38894a90>]}
[0m20:51:24.988482 [info ] [MainThread]: 
[0m20:51:24.989019 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m20:51:24.989860 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m20:51:24.999720 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m20:51:24.999929 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m20:51:25.000092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:26.532948 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:51:26.535662 [debug] [ThreadPool]: On list_lakehouse: Close
[0m20:51:26.537832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m20:51:26.543843 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m20:51:26.544053 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m20:51:26.544217 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:27.219356 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:51:27.221479 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m20:51:27.221945 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m20:51:27.225116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0118127-2089-4bfd-b1c6-e55991d01351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc3872fb50>]}
[0m20:51:27.225462 [debug] [MainThread]: On master: COMMIT
[0m20:51:27.225887 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:51:27.226133 [info ] [MainThread]: 
[0m20:51:27.228341 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m20:51:27.228657 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m20:51:27.229102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m20:51:27.229359 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m20:51:27.232223 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 20:51:27.229483 => 20:51:27.232075
[0m20:51:27.233506 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m20:51:27.233757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0118127-2089-4bfd-b1c6-e55991d01351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc38782390>]}
[0m20:51:27.234074 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.00s]
[0m20:51:27.234395 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m20:51:27.235810 [debug] [MainThread]: On master: COMMIT
[0m20:51:27.236174 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:51:27.236330 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m20:51:27.236487 [info ] [MainThread]: 
[0m20:51:27.236684 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.25 seconds (2.25s).
[0m20:51:27.237064 [debug] [MainThread]: Command end result
[0m20:51:27.242400 [info ] [MainThread]: 
[0m20:51:27.242733 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:51:27.243015 [info ] [MainThread]: 
[0m20:51:27.243233 [error] [MainThread]:   Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m20:51:27.243492 [info ] [MainThread]: 
[0m20:51:27.243727 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:51:27.244296 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.5686064, "process_user_time": 1.434015, "process_kernel_time": 0.039833, "process_mem_max_rss": "112536", "process_out_blocks": "3512", "command_success": false, "process_in_blocks": "0"}
[0m20:51:27.244582 [debug] [MainThread]: Command `dbt run` failed at 20:51:27.244514 after 2.57 seconds
[0m20:51:27.244792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc38464550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc3d10b990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc3d10b850>]}
[0m20:51:27.244994 [debug] [MainThread]: Flushing usage events
[0m20:54:14.252874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36c1feb3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36c1febc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36c1fe9e50>]}


============================== 20:54:14.254466 | 857b3e8a-58fe-4b90-9507-45b7dea0d407 ==============================
[0m20:54:14.254466 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:54:14.254811 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --model pricing_summary_report.sql', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:54:14.367211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '857b3e8a-58fe-4b90-9507-45b7dea0d407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36c1efc190>]}
[0m20:54:14.420300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '857b3e8a-58fe-4b90-9507-45b7dea0d407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36c1d8f4d0>]}
[0m20:54:14.420764 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m20:54:14.427509 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:54:14.442831 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:54:14.443566 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/mart/pricing_summary_report.sql
[0m20:54:14.529262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '857b3e8a-58fe-4b90-9507-45b7dea0d407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36c19dbd10>]}
[0m20:54:14.536538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '857b3e8a-58fe-4b90-9507-45b7dea0d407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36c1c44450>]}
[0m20:54:14.536848 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m20:54:14.537094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '857b3e8a-58fe-4b90-9507-45b7dea0d407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36c1dc7950>]}
[0m20:54:14.538348 [info ] [MainThread]: 
[0m20:54:14.538959 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m20:54:14.539760 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m20:54:14.549731 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m20:54:14.549943 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m20:54:14.550102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:16.315022 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:54:16.317490 [debug] [ThreadPool]: On list_lakehouse: Close
[0m20:54:16.321258 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m20:54:16.327023 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m20:54:16.327236 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m20:54:16.327399 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:54:17.554855 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:54:17.556607 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m20:54:17.556920 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m20:54:17.559246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '857b3e8a-58fe-4b90-9507-45b7dea0d407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36c1cb8550>]}
[0m20:54:17.559521 [debug] [MainThread]: On master: COMMIT
[0m20:54:17.559903 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:54:17.560119 [info ] [MainThread]: 
[0m20:54:17.562668 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m20:54:17.562978 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m20:54:17.563446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m20:54:17.563662 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m20:54:17.566338 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 20:54:17.563773 => 20:54:17.566194
[0m20:54:17.567563 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m20:54:17.567808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '857b3e8a-58fe-4b90-9507-45b7dea0d407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36c1c3d6d0>]}
[0m20:54:17.568119 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.00s]
[0m20:54:17.568448 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m20:54:17.569877 [debug] [MainThread]: On master: COMMIT
[0m20:54:17.570225 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:54:17.570380 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m20:54:17.570537 [info ] [MainThread]: 
[0m20:54:17.570731 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.03 seconds (3.03s).
[0m20:54:17.571216 [debug] [MainThread]: Command end result
[0m20:54:17.576581 [info ] [MainThread]: 
[0m20:54:17.576874 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:54:17.577172 [info ] [MainThread]: 
[0m20:54:17.577543 [error] [MainThread]:   Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m20:54:17.577816 [info ] [MainThread]: 
[0m20:54:17.578132 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:54:17.578821 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.349446, "process_user_time": 1.417279, "process_kernel_time": 0.079846, "process_mem_max_rss": "113596", "process_out_blocks": "3512", "command_success": false, "process_in_blocks": "0"}
[0m20:54:17.579198 [debug] [MainThread]: Command `dbt run` failed at 20:54:17.579069 after 3.35 seconds
[0m20:54:17.579474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36c2007190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36c66f76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36c1ff1bd0>]}
[0m20:54:17.579684 [debug] [MainThread]: Flushing usage events
[0m21:02:02.638058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f626bbd4f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f626bc23d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f626bbd5990>]}


============================== 21:02:02.639649 | b74a5554-511f-481c-be5f-e7a4a90e6af2 ==============================
[0m21:02:02.639649 [info ] [MainThread]: Running with dbt=1.7.3
[0m21:02:02.639984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --model pricing_summary_report.sql', 'send_anonymous_usage_stats': 'True'}
[0m21:02:02.754149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b74a5554-511f-481c-be5f-e7a4a90e6af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f626ba162d0>]}
[0m21:02:02.804422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b74a5554-511f-481c-be5f-e7a4a90e6af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f626b96ff90>]}
[0m21:02:02.804855 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m21:02:02.811576 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m21:02:02.818242 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:02:02.818553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b74a5554-511f-481c-be5f-e7a4a90e6af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f626b8c4810>]}
[0m21:02:03.415765 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_tpch_part_suppliers (models/staging/stg_tpch_part_suppliers.sql)
  argument of type 'NoneType' is not iterable
  
  > in macro generate_surrogate_key (macros/sql/generate_surrogate_key.sql)
  > called by model stg_tpch_part_suppliers (models/staging/stg_tpch_part_suppliers.sql)
[0m21:02:03.416439 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.80247086, "process_user_time": 1.780047, "process_kernel_time": 0.040001, "process_mem_max_rss": "107180", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m21:02:03.416788 [debug] [MainThread]: Command `dbt run` failed at 21:02:03.416708 after 0.80 seconds
[0m21:02:03.417018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f626bbdd310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f626b76f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f626bbddf50>]}
[0m21:02:03.417237 [debug] [MainThread]: Flushing usage events
[0m21:03:07.311342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85c3db8d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85c516bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85c4145910>]}


============================== 21:03:07.312975 | 6738b647-0439-4d81-8f2b-55037ad55fb0 ==============================
[0m21:03:07.312975 [info ] [MainThread]: Running with dbt=1.7.3
[0m21:03:07.313310 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:03:07.427253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6738b647-0439-4d81-8f2b-55037ad55fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85c3b59e90>]}
[0m21:03:07.477611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6738b647-0439-4d81-8f2b-55037ad55fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85c3a110d0>]}
[0m21:03:07.477992 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m21:03:07.484578 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m21:03:07.491098 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:03:07.491408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6738b647-0439-4d81-8f2b-55037ad55fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85c3868e50>]}
[0m21:03:08.135434 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_tpch_part_suppliers (models/staging/stg_tpch_part_suppliers.sql)
  argument of type 'NoneType' is not iterable
  
  > in macro generate_surrogate_key (macros/sql/generate_surrogate_key.sql)
  > called by model stg_tpch_part_suppliers (models/staging/stg_tpch_part_suppliers.sql)
[0m21:03:08.136049 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8500436, "process_user_time": 1.844455, "process_kernel_time": 0.040096, "process_mem_max_rss": "107124", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m21:03:08.136382 [debug] [MainThread]: Command `dbt run` failed at 21:03:08.136307 after 0.85 seconds
[0m21:03:08.136595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85c3dc7410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85c4444ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85c3952110>]}
[0m21:03:08.136800 [debug] [MainThread]: Flushing usage events
[0m21:05:57.589394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff133f8f110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1343eccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff133f8ea90>]}


============================== 21:05:57.591065 | 46ff34c6-cfc6-447b-9b56-bdcafd346476 ==============================
[0m21:05:57.591065 [info ] [MainThread]: Running with dbt=1.7.3
[0m21:05:57.591457 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m21:05:57.641500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46ff34c6-cfc6-447b-9b56-bdcafd346476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff133e32e10>]}
[0m21:05:57.656101 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-fjur6e6c'
[0m21:05:57.656418 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:05:57.784863 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:05:57.787681 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:05:57.883330 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:05:57.888530 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:05:58.245428 [info ] [MainThread]: Installed from version 1.1.1
[0m21:05:58.245768 [info ] [MainThread]: Up to date!
[0m21:05:58.246092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '46ff34c6-cfc6-447b-9b56-bdcafd346476', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff133f94d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff133f8ebd0>]}
[0m21:05:58.246829 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.68079126, "process_user_time": 1.12264, "process_kernel_time": 0.089413, "process_mem_max_rss": "101208", "process_out_blocks": "2032", "process_in_blocks": "0"}
[0m21:05:58.247158 [debug] [MainThread]: Command `dbt deps` succeeded at 21:05:58.247081 after 0.68 seconds
[0m21:05:58.247355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1384b7490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1384b7450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1385a5050>]}
[0m21:05:58.247558 [debug] [MainThread]: Flushing usage events
[0m21:12:08.620012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef5c7f1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef5c7f1810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef5c822b90>]}


============================== 21:12:08.621685 | ae605746-f512-4a27-bb92-9cfd1d9b1be1 ==============================
[0m21:12:08.621685 [info ] [MainThread]: Running with dbt=1.7.3
[0m21:12:08.622024 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:12:08.734821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae605746-f512-4a27-bb92-9cfd1d9b1be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef5c5865d0>]}
[0m21:12:08.785797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae605746-f512-4a27-bb92-9cfd1d9b1be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef5c434c50>]}
[0m21:12:08.786244 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m21:12:08.792896 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m21:12:08.800082 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:12:08.800467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ae605746-f512-4a27-bb92-9cfd1d9b1be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef5c60f050>]}
[0m21:12:09.394035 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_tpch_part_suppliers (models/staging/stg_tpch_part_suppliers.sql)
  argument of type 'NoneType' is not iterable
  
  > in macro generate_surrogate_key (macros/sql/generate_surrogate_key.sql)
  > called by model stg_tpch_part_suppliers (models/staging/stg_tpch_part_suppliers.sql)
[0m21:12:09.394688 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7980225, "process_user_time": 1.781618, "process_kernel_time": 0.050045, "process_mem_max_rss": "107280", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m21:12:09.395022 [debug] [MainThread]: Command `dbt run` failed at 21:12:09.394943 after 0.80 seconds
[0m21:12:09.395237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef5c7e37d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef5c5eca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef5c630c10>]}
[0m21:12:09.395454 [debug] [MainThread]: Flushing usage events
[0m21:28:53.216848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57365a5e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57365e3b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57365a6710>]}


============================== 21:28:53.218710 | 40685705-2995-4354-ad24-b1bc981f566c ==============================
[0m21:28:53.218710 [info ] [MainThread]: Running with dbt=1.7.3
[0m21:28:53.219169 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:28:53.332944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40685705-2995-4354-ad24-b1bc981f566c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57363e4b90>]}
[0m21:28:53.382934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40685705-2995-4354-ad24-b1bc981f566c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57364a7690>]}
[0m21:28:53.383390 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m21:28:53.390072 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m21:28:53.397462 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:28:53.397801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '40685705-2995-4354-ad24-b1bc981f566c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5736039390>]}
[0m21:28:53.989403 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_tpch_part_suppliers (models/staging/stg_tpch_part_suppliers.sql)
  argument of type 'NoneType' is not iterable
  
  > in macro generate_surrogate_key (macros/sql/generate_surrogate_key.sql)
  > called by model stg_tpch_part_suppliers (models/staging/stg_tpch_part_suppliers.sql)
[0m21:28:53.990094 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7969656, "process_user_time": 1.730354, "process_kernel_time": 0.120024, "process_mem_max_rss": "105380", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m21:28:53.990486 [debug] [MainThread]: Command `dbt run` failed at 21:28:53.990396 after 0.80 seconds
[0m21:28:53.990733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5736293690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5736110610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57361e6b90>]}
[0m21:28:53.990940 [debug] [MainThread]: Flushing usage events
[0m21:35:37.745129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5a5c7be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5a611cbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5a5c7b110>]}


============================== 21:35:37.746741 | 962a4980-91e6-475b-9e21-5a3eae26c0bd ==============================
[0m21:35:37.746741 [info ] [MainThread]: Running with dbt=1.7.3
[0m21:35:37.747076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:35:37.861602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '962a4980-91e6-475b-9e21-5a3eae26c0bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5a5a26b10>]}
[0m21:35:37.911311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '962a4980-91e6-475b-9e21-5a3eae26c0bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5a5ac4e10>]}
[0m21:35:37.911788 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m21:35:37.918513 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m21:35:37.925436 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:35:37.925748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '962a4980-91e6-475b-9e21-5a3eae26c0bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5a5728a50>]}
[0m21:35:38.542012 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_tpch_part_suppliers (models/staging/stg_tpch_part_suppliers.sql)
  argument of type 'NoneType' is not iterable
  
  > in macro generate_surrogate_key (macros/sql/generate_surrogate_key.sql)
  > called by model stg_tpch_part_suppliers (models/staging/stg_tpch_part_suppliers.sql)
[0m21:35:38.542645 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8215485, "process_user_time": 1.827158, "process_kernel_time": 0.059906, "process_mem_max_rss": "105068", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m21:35:38.543021 [debug] [MainThread]: Command `dbt run` failed at 21:35:38.542942 after 0.82 seconds
[0m21:35:38.543277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5a5c78150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5a575a950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5a5c87210>]}
[0m21:35:38.543568 [debug] [MainThread]: Flushing usage events
[0m22:06:15.443660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff22adc1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff23645310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff22addc50>]}


============================== 22:06:15.445444 | 9cd85a3a-591f-4914-a139-f957ec6183f0 ==============================
[0m22:06:15.445444 [info ] [MainThread]: Running with dbt=1.7.3
[0m22:06:15.445791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:15.560450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9cd85a3a-591f-4914-a139-f957ec6183f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff228f3150>]}
[0m22:06:15.611498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9cd85a3a-591f-4914-a139-f957ec6183f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff22adbb90>]}
[0m22:06:15.611920 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m22:06:15.618787 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m22:06:15.625964 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:06:15.626281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9cd85a3a-591f-4914-a139-f957ec6183f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff2258cd10>]}
[0m22:06:16.228315 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_tpch_part_suppliers (models/staging/stg_tpch_part_suppliers.sql)
  argument of type 'NoneType' is not iterable
  
  > in macro generate_surrogate_key (macros/sql/generate_surrogate_key.sql)
  > called by model stg_tpch_part_suppliers (models/staging/stg_tpch_part_suppliers.sql)
[0m22:06:16.228976 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8101179, "process_user_time": 1.796587, "process_kernel_time": 0.119772, "process_mem_max_rss": "105088", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m22:06:16.229328 [debug] [MainThread]: Command `dbt run` failed at 22:06:16.229251 after 0.81 seconds
[0m22:06:16.229545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff22938810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff22938c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff22466c50>]}
[0m22:06:16.229753 [debug] [MainThread]: Flushing usage events
[0m22:07:36.894923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e3a7a9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e3a7db950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e3a7a8450>]}


============================== 22:07:36.896651 | 09120320-93bd-44d4-8848-d1a6c24cdbc0 ==============================
[0m22:07:36.896651 [info ] [MainThread]: Running with dbt=1.7.3
[0m22:07:36.897008 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:07:37.020065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09120320-93bd-44d4-8848-d1a6c24cdbc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e3a53d050>]}
[0m22:07:37.071514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09120320-93bd-44d4-8848-d1a6c24cdbc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e3a52f710>]}
[0m22:07:37.071924 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m22:07:37.078531 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m22:07:37.085803 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:07:37.086314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '09120320-93bd-44d4-8848-d1a6c24cdbc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e3a23ca50>]}
[0m22:07:37.686013 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_tpch_part_suppliers (models/staging/stg_tpch_part_suppliers.sql)
  argument of type 'NoneType' is not iterable
  
  > in macro generate_surrogate_key (macros/sql/generate_surrogate_key.sql)
  > called by model stg_tpch_part_suppliers (models/staging/stg_tpch_part_suppliers.sql)
[0m22:07:37.686631 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8155758, "process_user_time": 1.796563, "process_kernel_time": 0.049904, "process_mem_max_rss": "105284", "process_out_blocks": "24", "command_success": false, "process_in_blocks": "0"}
[0m22:07:37.686967 [debug] [MainThread]: Command `dbt run` failed at 22:07:37.686887 after 0.82 seconds
[0m22:07:37.687184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e3a78e250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e3a272dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e3a2b7850>]}
[0m22:07:37.687395 [debug] [MainThread]: Flushing usage events
[0m22:09:05.852561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb847a1abd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb84784be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb847a18e50>]}


============================== 22:09:05.854138 | d5787a52-caf2-4a8b-ba75-fb654b3953cd ==============================
[0m22:09:05.854138 [info ] [MainThread]: Running with dbt=1.7.3
[0m22:09:05.854495 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m22:09:05.967231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5787a52-caf2-4a8b-ba75-fb654b3953cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb847a19f90>]}
[0m22:09:06.017395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5787a52-caf2-4a8b-ba75-fb654b3953cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb84779bf50>]}
[0m22:09:06.017794 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m22:09:06.024466 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m22:09:06.031998 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:09:06.032365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd5787a52-caf2-4a8b-ba75-fb654b3953cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8477e82d0>]}
[0m22:09:06.623608 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_tpch_part_suppliers (models/staging/stg_tpch_part_suppliers.sql)
  argument of type 'NoneType' is not iterable
  
  > in macro generate_surrogate_key (macros/sql/generate_surrogate_key.sql)
  > called by model stg_tpch_part_suppliers (models/staging/stg_tpch_part_suppliers.sql)
[0m22:09:06.624246 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.79508924, "process_user_time": 1.838216, "process_kernel_time": 0.00999, "process_mem_max_rss": "105044", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m22:09:06.624615 [debug] [MainThread]: Command `dbt run` failed at 22:09:06.624523 after 0.80 seconds
[0m22:09:06.624837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb847852bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb847576410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb847851110>]}
[0m22:09:06.625044 [debug] [MainThread]: Flushing usage events
[0m22:10:14.154904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9821d300d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9821d33190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9821d33110>]}


============================== 22:10:14.156464 | 717f7314-266c-4323-833b-09545e681d21 ==============================
[0m22:10:14.156464 [info ] [MainThread]: Running with dbt=1.7.3
[0m22:10:14.156802 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models models/staging/stg_tpch_part_suppliers.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:10:14.270081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '717f7314-266c-4323-833b-09545e681d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98225f5150>]}
[0m22:10:14.321689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '717f7314-266c-4323-833b-09545e681d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9821ad8a10>]}
[0m22:10:14.322099 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m22:10:14.328700 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m22:10:14.335306 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:10:14.335603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '717f7314-266c-4323-833b-09545e681d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98217ccc50>]}
[0m22:10:14.944930 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_tpch_part_suppliers (models/staging/stg_tpch_part_suppliers.sql)
  argument of type 'NoneType' is not iterable
  
  > in macro generate_surrogate_key (macros/sql/generate_surrogate_key.sql)
  > called by model stg_tpch_part_suppliers (models/staging/stg_tpch_part_suppliers.sql)
[0m22:10:14.945669 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.81423795, "process_user_time": 1.855987, "process_kernel_time": 0.039913, "process_mem_max_rss": "105364", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m22:10:14.946091 [debug] [MainThread]: Command `dbt run` failed at 22:10:14.945965 after 0.81 seconds
[0m22:10:14.946341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9821d50f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9821812d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9826441150>]}
[0m22:10:14.946557 [debug] [MainThread]: Flushing usage events
[0m22:31:07.834586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71d60c7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71d6720890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71d60c7e50>]}


============================== 22:31:07.836397 | dfc3c496-a627-4a60-b96b-e0b0098d4227 ==============================
[0m22:31:07.836397 [info ] [MainThread]: Running with dbt=1.7.3
[0m22:31:07.836744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:31:07.950412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfc3c496-a627-4a60-b96b-e0b0098d4227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71d6b2d010>]}
[0m22:31:08.001438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfc3c496-a627-4a60-b96b-e0b0098d4227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71d60286d0>]}
[0m22:31:08.001898 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m22:31:08.008651 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m22:31:08.015624 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:31:08.015958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dfc3c496-a627-4a60-b96b-e0b0098d4227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71d5f79310>]}
[0m22:31:08.617661 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_tpch_part_suppliers (models/staging/stg_tpch_part_suppliers.sql)
  argument of type 'NoneType' is not iterable
  
  > in macro generate_surrogate_key (macros/sql/generate_surrogate_key.sql)
  > called by model stg_tpch_part_suppliers (models/staging/stg_tpch_part_suppliers.sql)
[0m22:31:08.618313 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.80785984, "process_user_time": 1.803552, "process_kernel_time": 0.060118, "process_mem_max_rss": "105204", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m22:31:08.618652 [debug] [MainThread]: Command `dbt run` failed at 22:31:08.618574 after 0.81 seconds
[0m22:31:08.618871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71d60c7f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71d5bd2350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71d5c03ad0>]}
[0m22:31:08.619079 [debug] [MainThread]: Flushing usage events
[0m22:33:52.151260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d7a80b390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d7a856ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d7aeeded0>]}


============================== 22:33:52.153361 | 1c499350-c46c-40a6-bcbd-e1bade7ef9d1 ==============================
[0m22:33:52.153361 [info ] [MainThread]: Running with dbt=1.7.3
[0m22:33:52.153803 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models models/staging/', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:33:52.319572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c499350-c46c-40a6-bcbd-e1bade7ef9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d7a645dd0>]}
[0m22:33:52.400359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c499350-c46c-40a6-bcbd-e1bade7ef9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d7a57fed0>]}
[0m22:33:52.400911 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m22:33:52.408829 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m22:33:52.419173 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:33:52.419807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1c499350-c46c-40a6-bcbd-e1bade7ef9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d7a65e050>]}
[0m22:33:53.328481 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_tpch_part_suppliers (models/staging/stg_tpch_part_suppliers.sql)
  argument of type 'NoneType' is not iterable
  
  > in macro generate_surrogate_key (macros/sql/generate_surrogate_key.sql)
  > called by model stg_tpch_part_suppliers (models/staging/stg_tpch_part_suppliers.sql)
[0m22:33:53.330041 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2072906, "process_user_time": 2.608097, "process_kernel_time": 0.100311, "process_mem_max_rss": "107072", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m22:33:53.330637 [debug] [MainThread]: Command `dbt run` failed at 22:33:53.330507 after 1.21 seconds
[0m22:33:53.331046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d7a3f0490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d7a33f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d7a3a7b50>]}
[0m22:33:53.331502 [debug] [MainThread]: Flushing usage events
[0m22:34:56.465180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae47502c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae47b38b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae47503c90>]}


============================== 22:34:56.468178 | 3e95f80f-fb3f-43fc-9137-83fda00444a8 ==============================
[0m22:34:56.468178 [info ] [MainThread]: Running with dbt=1.7.3
[0m22:34:56.468897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models models/staging/', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:34:56.636919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e95f80f-fb3f-43fc-9137-83fda00444a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae472e30d0>]}
[0m22:34:56.702893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e95f80f-fb3f-43fc-9137-83fda00444a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae47283550>]}
[0m22:34:56.703358 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m22:34:56.712168 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m22:34:56.720044 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:34:56.720454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3e95f80f-fb3f-43fc-9137-83fda00444a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae47546c10>]}
[0m22:34:57.572930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '3e95f80f-fb3f-43fc-9137-83fda00444a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae45e92710>]}
[0m22:34:57.583740 [error] [MainThread]: Encountered an error:
argument of type 'NoneType' is not iterable
[0m22:34:57.593238 [error] [MainThread]: Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 75, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 197, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 244, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 271, in wrapper
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 318, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 478, in load
    self.parse_project(
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 675, in parse_project
    parser.parse_file(block)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/parser/base.py", line 483, in parse_file
    self.parse_node(file_block)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/parser/base.py", line 444, in parse_node
    self.render_update(node, config)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/parser/models.py", line 360, in render_update
    super().render_update(node, config)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/parser/base.py", line 420, in render_update
    context = self.render_with_context(node, config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/parser/base.py", line 269, in render_with_context
    get_rendered(parsed_node.raw_code, context, parsed_node, capture_macros=True)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 600, in get_rendered
    rendered = render_template(template, ctx, node)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 546, in render_template
    return template.render(ctx)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/environment.py", line 1301, in render
    self.environment.handle_exception()
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/environment.py", line 936, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "<template>", line 29, in top-level template code
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/context/base.py", line 171, in __call__
    if self.has_var(var_name):
       ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/context/base.py", line 160, in has_var
    return var_name in self._merged
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/utils.py", line 596, in __contains__
    return any((name in entry for entry in self._itersource()))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/utils.py", line 596, in <genexpr>
    return any((name in entry for entry in self._itersource()))
                ^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/utils.py", line 596, in __contains__
    return any((name in entry for entry in self._itersource()))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/utils.py", line 596, in <genexpr>
    return any((name in entry for entry in self._itersource()))
                ^^^^^^^^^^^^^
TypeError: argument of type 'NoneType' is not iterable

[0m22:34:57.594387 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1631176, "process_user_time": 2.518714, "process_kernel_time": 0.090312, "process_mem_max_rss": "106300", "process_in_blocks": "312", "process_out_blocks": "24", "command_success": false}
[0m22:34:57.594852 [debug] [MainThread]: Command `dbt run` failed at 22:34:57.594748 after 1.16 seconds
[0m22:34:57.595116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae47b84b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae46fe7250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae4702add0>]}
[0m22:34:57.595404 [debug] [MainThread]: Flushing usage events
[0m22:36:55.245838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f530a0c5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f530a548bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f530a0c6050>]}


============================== 22:36:55.247711 | a0cf2eec-677b-4369-92c1-6ef1bcdf1bc2 ==============================
[0m22:36:55.247711 [info ] [MainThread]: Running with dbt=1.7.3
[0m22:36:55.248123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models models/staging/', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:36:55.365157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0cf2eec-677b-4369-92c1-6ef1bcdf1bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f530a100c90>]}
[0m22:36:55.418195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0cf2eec-677b-4369-92c1-6ef1bcdf1bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5309e4be50>]}
[0m22:36:55.418681 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m22:36:55.425810 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m22:36:55.433061 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:36:55.433432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a0cf2eec-677b-4369-92c1-6ef1bcdf1bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5309b58950>]}
[0m22:36:56.222573 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_tpch_part_suppliers (models/staging/stg_tpch_part_suppliers.sql)
  argument of type 'NoneType' is not iterable
  
  > in macro generate_surrogate_key (macros/sql/generate_surrogate_key.sql)
  > called by model stg_tpch_part_suppliers (models/staging/stg_tpch_part_suppliers.sql)
[0m22:36:56.223393 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0015662, "process_user_time": 2.242671, "process_kernel_time": 0.039869, "process_mem_max_rss": "105072", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m22:36:56.223773 [debug] [MainThread]: Command `dbt run` failed at 22:36:56.223688 after 1.00 seconds
[0m22:36:56.224025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f530a0a8390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5309b3f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5309c4a610>]}
[0m22:36:56.224262 [debug] [MainThread]: Flushing usage events
[0m22:37:54.097200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a5b52a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a5b3d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a5b3ed50>]}


============================== 22:37:54.099018 | b5932e21-470f-43d9-bbac-b44b049948c9 ==============================
[0m22:37:54.099018 [info ] [MainThread]: Running with dbt=1.7.3
[0m22:37:54.099416 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models models/staging/', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:37:54.245230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5932e21-470f-43d9-bbac-b44b049948c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a5910950>]}
[0m22:37:54.307397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5932e21-470f-43d9-bbac-b44b049948c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a58c3ed0>]}
[0m22:37:54.307861 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m22:37:54.316397 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m22:37:54.325898 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:37:54.326347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b5932e21-470f-43d9-bbac-b44b049948c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a5b66ed0>]}
[0m22:37:55.103242 [error] [MainThread]: Encountered an error:
argument of type 'NoneType' is not iterable
[0m22:37:55.105633 [error] [MainThread]: Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 75, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 197, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 244, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 271, in wrapper
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 318, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 478, in load
    self.parse_project(
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 675, in parse_project
    parser.parse_file(block)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/parser/base.py", line 483, in parse_file
    self.parse_node(file_block)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/parser/base.py", line 444, in parse_node
    self.render_update(node, config)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/parser/models.py", line 360, in render_update
    super().render_update(node, config)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/parser/base.py", line 420, in render_update
    context = self.render_with_context(node, config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/parser/base.py", line 269, in render_with_context
    get_rendered(parsed_node.raw_code, context, parsed_node, capture_macros=True)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 600, in get_rendered
    rendered = render_template(template, ctx, node)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 546, in render_template
    return template.render(ctx)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/environment.py", line 1301, in render
    self.environment.handle_exception()
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/environment.py", line 936, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "<template>", line 29, in top-level template code
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/context/base.py", line 171, in __call__
    if self.has_var(var_name):
       ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/context/base.py", line 160, in has_var
    return var_name in self._merged
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/utils.py", line 596, in __contains__
    return any((name in entry for entry in self._itersource()))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/utils.py", line 596, in <genexpr>
    return any((name in entry for entry in self._itersource()))
                ^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/utils.py", line 596, in __contains__
    return any((name in entry for entry in self._itersource()))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/utils.py", line 596, in <genexpr>
    return any((name in entry for entry in self._itersource()))
                ^^^^^^^^^^^^^
TypeError: argument of type 'NoneType' is not iterable

[0m22:37:55.106465 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0405107, "process_user_time": 2.058077, "process_kernel_time": 0.055374, "process_mem_max_rss": "108460", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m22:37:55.106863 [debug] [MainThread]: Command `dbt run` failed at 22:37:55.106773 after 1.04 seconds
[0m22:37:55.107172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a5b2d950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a5778950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a5813310>]}
[0m22:37:55.107421 [debug] [MainThread]: Flushing usage events
[0m22:49:58.118071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02e542c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02e543190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02e540410>]}


============================== 22:49:58.119928 | 59689f7c-3988-4e08-bd45-efc4434c0c7c ==============================
[0m22:49:58.119928 [info ] [MainThread]: Running with dbt=1.7.3
[0m22:49:58.120295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models models/staging/', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:49:58.244139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59689f7c-3988-4e08-bd45-efc4434c0c7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02e2c3750>]}
[0m22:49:58.298718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59689f7c-3988-4e08-bd45-efc4434c0c7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02e28a110>]}
[0m22:49:58.299232 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m22:49:58.306410 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m22:49:58.314744 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:49:58.315084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '59689f7c-3988-4e08-bd45-efc4434c0c7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02dfc4f10>]}
[0m22:49:59.095029 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_trino_iceberg.dim_part_suppliers' (models/mart/dim_part_suppliers.sql) depends on a node named 'int_part_suppliers' which was not found
[0m22:49:59.095924 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0032576, "process_user_time": 1.939982, "process_kernel_time": 0.055428, "process_mem_max_rss": "106472", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m22:49:59.096297 [debug] [MainThread]: Command `dbt run` failed at 22:49:59.096212 after 1.00 seconds
[0m22:49:59.096540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02e513d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02e516890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02de89110>]}
[0m22:49:59.096814 [debug] [MainThread]: Flushing usage events
[0m22:51:13.678612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44f4d9b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44f4d9050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44f9a6690>]}


============================== 22:51:13.680714 | d2997727-330b-40af-b479-8c3898146eb2 ==============================
[0m22:51:13.680714 [info ] [MainThread]: Running with dbt=1.7.3
[0m22:51:13.681132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:51:13.804898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2997727-330b-40af-b479-8c3898146eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44f292a90>]}
[0m22:51:13.857548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2997727-330b-40af-b479-8c3898146eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44f222690>]}
[0m22:51:13.857998 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m22:51:13.865038 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m22:51:13.876370 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:51:13.876842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd2997727-330b-40af-b479-8c3898146eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44ef5cc10>]}
[0m22:51:14.651157 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_trino_iceberg.dim_part_suppliers' (models/mart/dim_part_suppliers.sql) depends on a node named 'int_part_suppliers' which was not found
[0m22:51:14.651983 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.9984809, "process_user_time": 1.879967, "process_kernel_time": 0.064826, "process_mem_max_rss": "106884", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m22:51:14.652407 [debug] [MainThread]: Command `dbt run` failed at 22:51:14.652324 after 1.00 seconds
[0m22:51:14.652646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44f4b6710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44dd17410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44eefed90>]}
[0m22:51:14.652874 [debug] [MainThread]: Flushing usage events
[0m22:52:31.726434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f250790b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25078ff290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25078fc410>]}


============================== 22:52:31.728296 | 4dce2840-9db7-4bcd-a10f-1f86fd4c51d0 ==============================
[0m22:52:31.728296 [info ] [MainThread]: Running with dbt=1.7.3
[0m22:52:31.728791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:52:31.852640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4dce2840-9db7-4bcd-a10f-1f86fd4c51d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f250776af90>]}
[0m22:52:31.906998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4dce2840-9db7-4bcd-a10f-1f86fd4c51d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2507d84b50>]}
[0m22:52:31.907511 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m22:52:31.914799 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m22:52:31.925154 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:52:31.925547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4dce2840-9db7-4bcd-a10f-1f86fd4c51d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25076f8e90>]}
[0m22:52:32.722918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4dce2840-9db7-4bcd-a10f-1f86fd4c51d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25064afd50>]}
[0m22:52:32.734801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4dce2840-9db7-4bcd-a10f-1f86fd4c51d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25064c54d0>]}
[0m22:52:32.735159 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m22:52:32.735519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dce2840-9db7-4bcd-a10f-1f86fd4c51d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2507378f50>]}
[0m22:52:32.737219 [info ] [MainThread]: 
[0m22:52:32.737770 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m22:52:32.738912 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m22:52:32.750078 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m22:52:32.750311 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m22:52:32.750483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:52:34.413428 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m22:52:34.414541 [debug] [ThreadPool]: On list_lakehouse: Close
[0m22:52:34.417555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m22:52:34.423428 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m22:52:34.423930 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m22:52:34.424194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:52:35.413520 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m22:52:35.416490 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m22:52:35.417058 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m22:52:35.420836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dce2840-9db7-4bcd-a10f-1f86fd4c51d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2506465dd0>]}
[0m22:52:35.421183 [debug] [MainThread]: On master: COMMIT
[0m22:52:35.421700 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:52:35.421991 [info ] [MainThread]: 
[0m22:52:35.425259 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_customers
[0m22:52:35.425772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.stg_tpch_customers)
[0m22:52:35.426003 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_customers
[0m22:52:35.428159 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_customers"
[0m22:52:35.428685 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_customers (compile): 22:52:35.426124 => 22:52:35.428516
[0m22:52:35.429250 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_customers
[0m22:52:35.429542 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m22:52:35.430085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_customers, now model.dbt_trino_iceberg.stg_tpch_line_item)
[0m22:52:35.430335 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_line_item
[0m22:52:35.432371 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_line_item"
[0m22:52:35.432879 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_line_item (compile): 22:52:35.430520 => 22:52:35.432726
[0m22:52:35.433384 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m22:52:35.433654 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_nation
[0m22:52:35.434049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_line_item, now model.dbt_trino_iceberg.stg_tpch_nation)
[0m22:52:35.434281 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_nation
[0m22:52:35.437179 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_nation"
[0m22:52:35.437974 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_nation (compile): 22:52:35.434445 => 22:52:35.437793
[0m22:52:35.438503 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_nation
[0m22:52:35.438837 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_orders
[0m22:52:35.439278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_nation, now model.dbt_trino_iceberg.stg_tpch_orders)
[0m22:52:35.439520 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_orders
[0m22:52:35.441634 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_orders"
[0m22:52:35.442124 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_orders (compile): 22:52:35.439699 => 22:52:35.441935
[0m22:52:35.442664 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_orders
[0m22:52:35.442918 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part
[0m22:52:35.443297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_orders, now model.dbt_trino_iceberg.stg_tpch_part)
[0m22:52:35.443521 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part
[0m22:52:35.445510 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part"
[0m22:52:35.446334 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part (compile): 22:52:35.443659 => 22:52:35.446143
[0m22:52:35.446843 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part
[0m22:52:35.447100 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m22:52:35.447478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part, now model.dbt_trino_iceberg.stg_tpch_part_suppliers)
[0m22:52:35.447703 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m22:52:35.449552 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part_suppliers"
[0m22:52:35.450067 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part_suppliers (compile): 22:52:35.447839 => 22:52:35.449924
[0m22:52:35.450551 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m22:52:35.450797 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_region
[0m22:52:35.451163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part_suppliers, now model.dbt_trino_iceberg.stg_tpch_region)
[0m22:52:35.451382 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_region
[0m22:52:35.453201 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_region"
[0m22:52:35.454082 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_region (compile): 22:52:35.451514 => 22:52:35.453876
[0m22:52:35.454672 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_region
[0m22:52:35.454964 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m22:52:35.455432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_region, now model.dbt_trino_iceberg.stg_tpch_supplier)
[0m22:52:35.455702 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_supplier
[0m22:52:35.457881 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_supplier"
[0m22:52:35.458527 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_supplier (compile): 22:52:35.455871 => 22:52:35.458320
[0m22:52:35.459135 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m22:52:35.459407 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.int_order_items
[0m22:52:35.459712 [info ] [Thread-1 (]: 1 of 7 START sql table model dbt.int_order_items ............................... [RUN]
[0m22:52:35.460183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_supplier, now model.dbt_trino_iceberg.int_order_items)
[0m22:52:35.460456 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.int_order_items
[0m22:52:35.473670 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.int_order_items"
[0m22:52:35.474588 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_order_items (compile): 22:52:35.460594 => 22:52:35.474373
[0m22:52:35.474856 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.int_order_items
[0m22:52:35.490615 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."int_order_items"
[0m22:52:35.492078 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_order_items"
[0m22:52:35.492373 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_order_items"} */

    drop table if exists "lakehouse"."dbt"."int_order_items"
[0m22:52:35.492585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:52:36.410897 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:52:36.421026 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.int_order_items"
[0m22:52:36.430276 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_order_items"
[0m22:52:36.430757 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_order_items"} */

  
    

    create table "lakehouse"."dbt"."int_order_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_orders as (

select
    orderkey as order_key, 
    custkey as customer_key,
    orderstatus as order_status_code,
    totalprice as order_amount,
    orderdate as order_date,
    orderpriority as order_priority_code,
    clerk as order_clerk_name,
    shippriority as shipping_priority,
    comment as order_comment
from
    tpch.sf1.orders
),  __dbt__cte__stg_tpch_line_item as (

select
    orderkey as order_key,
    partkey as part_key,
    suppkey as supplier_key,
    linenumber as order_line_number,
    quantity as quantity,
    extendedprice as extended_price,
    discount as discount_percentage,
    tax as tax_rate,
    returnflag as return_status_code,
    linestatus as order_line_status_code,
    shipdate as ship_date,
    commitdate as commit_date,
    receiptdate as receipt_date,
    shipinstruct as ship_instructions_desc,
    shipmode as ship_mode_name,
    comment as order_line_comment
from
    tpch.sf1.lineitem
), orders as (
    
    select * from __dbt__cte__stg_tpch_orders

),
line_items as (

    select * from __dbt__cte__stg_tpch_line_item

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(o.order_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l.order_line_number as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as order_item_key,

    o.order_key,
    o.order_date,
    o.customer_key,
    o.order_status_code,
    
    l.part_key,
    l.supplier_key,
    l.return_status_code,
    l.order_line_number,
    l.order_line_status_code,
    l.ship_date,
    l.commit_date,
    l.receipt_date,
    l.ship_mode_name,

    l.quantity,
    
    -- extended_price is actually the line item total,
    -- so we back out the extended price per item
    (l.extended_price/nullif(l.quantity, 0)) as base_price,
    l.discount_percentage,
    ((l.extended_price/nullif(l.quantity, 0)) * (1 - l.discount_percentage)) as discounted_price,

    l.extended_price as gross_item_sales_amount,
    (l.extended_price * (1 - l.discount_percentage)) as discounted_item_sales_amount,
    -- We model discounts as negative amounts
    (-1 * l.extended_price * l.discount_percentage) as item_discount_amount,
    l.tax_rate,
    ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate) as item_tax_amount,
    (
        l.extended_price + 
        (-1 * l.extended_price * l.discount_percentage) + 
        ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate)
    ) as net_item_sales_amount

from
    orders o
    join
    line_items l
        on o.order_key = l.order_key
order by
    o.order_date
    )
[0m22:53:16.577732 [debug] [Thread-1 (]: SQL status: SUCCESS in 40.0 seconds
[0m22:53:16.591172 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_order_items (execute): 22:52:35.474989 => 22:53:16.591011
[0m22:53:16.591428 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: ROLLBACK
[0m22:53:16.591645 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: Close
[0m22:53:16.592923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dce2840-9db7-4bcd-a10f-1f86fd4c51d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25062e1a50>]}
[0m22:53:16.593340 [info ] [Thread-1 (]: 1 of 7 OK created sql table model dbt.int_order_items .......................... [[32mSUCCESS[0m in 41.13s]
[0m22:53:16.593746 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.int_order_items
[0m22:53:16.594065 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_suppliers
[0m22:53:16.594424 [info ] [Thread-1 (]: 2 of 7 START sql table model dbt.dim_suppliers ................................. [RUN]
[0m22:53:16.595117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.int_order_items, now model.dbt_trino_iceberg.dim_suppliers)
[0m22:53:16.595382 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_suppliers
[0m22:53:16.600377 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_suppliers"
[0m22:53:16.600942 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (compile): 22:53:16.595531 => 22:53:16.600789
[0m22:53:16.601206 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_suppliers
[0m22:53:16.604141 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."dim_suppliers"
[0m22:53:16.604694 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m22:53:16.604941 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt"."dim_suppliers"
[0m22:53:16.605169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:53:17.524524 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:53:17.528069 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_suppliers"
[0m22:53:17.530609 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m22:53:17.530865 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt"."dim_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m22:53:18.865715 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:53:18.869615 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (execute): 22:53:16.601360 => 22:53:18.869480
[0m22:53:18.869843 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: ROLLBACK
[0m22:53:18.870036 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: Close
[0m22:53:18.871186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dce2840-9db7-4bcd-a10f-1f86fd4c51d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25062e3dd0>]}
[0m22:53:18.871550 [info ] [Thread-1 (]: 2 of 7 OK created sql table model dbt.dim_suppliers ............................ [[32mSUCCESS[0m in 2.28s]
[0m22:53:18.871984 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_suppliers
[0m22:53:18.872274 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.int_parts_suppliers
[0m22:53:18.872622 [info ] [Thread-1 (]: 3 of 7 START sql table model dbt.int_parts_suppliers ........................... [RUN]
[0m22:53:18.873393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_suppliers, now model.dbt_trino_iceberg.int_parts_suppliers)
[0m22:53:18.873619 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.int_parts_suppliers
[0m22:53:18.881791 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.int_parts_suppliers"
[0m22:53:18.882306 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_parts_suppliers (compile): 22:53:18.873740 => 22:53:18.882155
[0m22:53:18.882521 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.int_parts_suppliers
[0m22:53:18.885393 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."int_parts_suppliers"
[0m22:53:18.885899 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_parts_suppliers"
[0m22:53:18.886108 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_parts_suppliers"} */

    drop table if exists "lakehouse"."dbt"."int_parts_suppliers"
[0m22:53:18.886291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:53:19.452288 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:53:19.455852 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.int_parts_suppliers"
[0m22:53:19.461384 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_parts_suppliers"
[0m22:53:19.461689 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_parts_suppliers"} */

  
    

    create table "lakehouse"."dbt"."int_parts_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
part_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(p.part_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(s.supplier_key as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
			as part_supplier_key,
    --p.part_supplier_key,
	p.part_key,
    p.part_name,
    p.part_manufacturer_name,
    p.part_brand_name,
    p.part_type_name,
    p.part_size,
    p.part_container_desc,
    p.retail_price,

    s.supplier_key,
    s.supplier_name,
    s.nation_key,

    ps.supplier_availabe_quantity,
    ps.supplier_cost_amount
from
    parts p
    join
    part_suppliers ps
        on p.part_key = ps.part_key
    join
    suppliers s
        on ps.supplier_key = s.supplier_key
order by
    p.part_key
    )
[0m22:53:27.811147 [debug] [Thread-1 (]: SQL status: SUCCESS in 8.0 seconds
[0m22:53:27.815389 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_parts_suppliers (execute): 22:53:18.882642 => 22:53:27.815260
[0m22:53:27.815626 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: ROLLBACK
[0m22:53:27.815819 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: Close
[0m22:53:27.817012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dce2840-9db7-4bcd-a10f-1f86fd4c51d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2506341750>]}
[0m22:53:27.817380 [info ] [Thread-1 (]: 3 of 7 OK created sql table model dbt.int_parts_suppliers ...................... [[32mSUCCESS[0m in 8.94s]
[0m22:53:27.817760 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.int_parts_suppliers
[0m22:53:27.818053 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.fct_orders_items
[0m22:53:27.818680 [info ] [Thread-1 (]: 4 of 7 START sql table model dbt.fct_orders_items .............................. [RUN]
[0m22:53:27.819172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.int_parts_suppliers, now model.dbt_trino_iceberg.fct_orders_items)
[0m22:53:27.819429 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.fct_orders_items
[0m22:53:27.827890 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.fct_orders_items"
[0m22:53:27.828415 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (compile): 22:53:27.819552 => 22:53:27.828265
[0m22:53:27.828632 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.fct_orders_items
[0m22:53:27.831624 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."fct_orders_items"
[0m22:53:27.832147 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m22:53:27.832361 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

    drop table if exists "lakehouse"."dbt"."fct_orders_items"
[0m22:53:27.832548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:53:28.939544 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:53:28.942576 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.fct_orders_items"
[0m22:53:28.946240 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m22:53:28.946502 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

  
    

    create table "lakehouse"."dbt"."fct_orders_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), orders_items as (
    
    select * from "lakehouse"."dbt"."int_order_items"

),
parts_suppliers as (
    
    select * from __dbt__cte__stg_tpch_part_suppliers

),
final as (
    select 

        o.order_item_key,
        o.order_key,
        o.order_date,
        o.customer_key,
        o.order_status_code,
        
        o.part_key,
        o.supplier_key,
        o.return_status_code,
        o.order_line_number,
        o.order_line_status_code,
        o.ship_date,
        o.commit_date,
        o.receipt_date,
        o.ship_mode_name,
        ps.supplier_cost_amount,
        
        o.base_price,
        o.discount_percentage,
        o.discounted_price,
        o.tax_rate,
        
        1 as order_item_count,
        o.quantity,

        o.gross_item_sales_amount,
        o.discounted_item_sales_amount,
        o.item_discount_amount,
        o.item_tax_amount,
        o.net_item_sales_amount

    from
        orders_items o
        join
        parts_suppliers ps
            on o.part_key = ps.part_key and
                o.supplier_key = ps.supplier_key
)
select *

from
    final f
order by
    f.order_date
    )
[0m22:53:58.770708 [debug] [Thread-1 (]: SQL status: SUCCESS in 30.0 seconds
[0m22:53:58.775208 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (execute): 22:53:27.828753 => 22:53:58.775072
[0m22:53:58.775434 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: ROLLBACK
[0m22:53:58.775629 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: Close
[0m22:53:58.776938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dce2840-9db7-4bcd-a10f-1f86fd4c51d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f250646b150>]}
[0m22:53:58.777305 [info ] [Thread-1 (]: 4 of 7 OK created sql table model dbt.fct_orders_items ......................... [[32mSUCCESS[0m in 30.96s]
[0m22:53:58.777685 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.fct_orders_items
[0m22:53:58.778002 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_part_suppliers
[0m22:53:58.778318 [info ] [Thread-1 (]: 5 of 7 START sql table model dbt.dim_part_suppliers ............................ [RUN]
[0m22:53:58.779214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.fct_orders_items, now model.dbt_trino_iceberg.dim_part_suppliers)
[0m22:53:58.779442 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_part_suppliers
[0m22:53:58.788893 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m22:53:58.789524 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (compile): 22:53:58.779566 => 22:53:58.789285
[0m22:53:58.789781 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_part_suppliers
[0m22:53:58.793171 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."dim_part_suppliers"
[0m22:53:58.793695 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m22:53:58.793906 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

    drop table if exists "lakehouse"."dbt"."dim_part_suppliers"
[0m22:53:58.794164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:53:59.720743 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:53:59.724545 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m22:53:59.729205 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m22:53:59.729527 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from "lakehouse"."dbt"."int_parts_suppliers"

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
order by
    f.part_key,
    f.supplier_key
    )
[0m22:54:10.977147 [debug] [Thread-1 (]: SQL status: SUCCESS in 11.0 seconds
[0m22:54:10.980260 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (execute): 22:53:58.789920 => 22:54:10.979990
[0m22:54:10.980641 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: ROLLBACK
[0m22:54:10.980893 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: Close
[0m22:54:10.982206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dce2840-9db7-4bcd-a10f-1f86fd4c51d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f250616d450>]}
[0m22:54:10.982577 [info ] [Thread-1 (]: 5 of 7 OK created sql table model dbt.dim_part_suppliers ....................... [[32mSUCCESS[0m in 12.20s]
[0m22:54:10.982957 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_part_suppliers
[0m22:54:10.983264 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m22:54:10.983593 [info ] [Thread-1 (]: 6 of 7 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m22:54:10.984106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_part_suppliers, now model.dbt_trino_iceberg.pricing_summary_report)
[0m22:54:10.984374 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m22:54:10.987233 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 22:54:10.984519 => 22:54:10.987087
[0m22:54:10.989586 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  'dict object' has no attribute 'dateadd'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:54:10.989854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dce2840-9db7-4bcd-a10f-1f86fd4c51d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f250616aa90>]}
[0m22:54:10.990179 [error] [Thread-1 (]: 6 of 7 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.01s]
[0m22:54:10.990514 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m22:54:10.990791 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m22:54:10.991060 [info ] [Thread-1 (]: 7 of 7 START sql table model dbt.minimum_cost_suppliers ........................ [RUN]
[0m22:54:10.991709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.pricing_summary_report, now model.dbt_trino_iceberg.minimum_cost_suppliers)
[0m22:54:10.991933 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m22:54:10.993856 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m22:54:10.994301 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (compile): 22:54:10.992054 => 22:54:10.994161
[0m22:54:10.994513 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m22:54:10.997320 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."minimum_cost_suppliers"
[0m22:54:10.997832 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m22:54:10.998038 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.minimum_cost_suppliers"} */

    drop table if exists "lakehouse"."dbt"."minimum_cost_suppliers"
[0m22:54:10.998222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:54:11.944787 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:54:11.946012 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m22:54:11.948394 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m22:54:11.948703 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.minimum_cost_suppliers"} */

  
    

    create table "lakehouse"."dbt"."minimum_cost_suppliers"
      
      
    as (
      /*
2 Q2 - Minimum Cost Supplier Query
This query finds which supplier should be selected to place an order for a given part in a given region
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 30)
*/

with parts_suppliers as (

    select
        s.supplier_account_balance,
        s.supplier_name,
        s.supplier_nation_key,
        s.supplier_region_key,
        s.supplier_nation_name,
        s.supplier_region_name,
        s.part_key,
        s.part_manufacturer_name,
        s.part_size,
        s.part_type_name,
        s.supplier_cost_amount,
        s.supplier_address,
        s.supplier_phone_number,
        rank() over(partition by s.supplier_region_key, s.part_key order by s.supplier_cost_amount) as supplier_cost_rank,
        row_number() over(partition by s.supplier_region_key, s.part_key, s.supplier_cost_amount order by s.supplier_account_balance desc) as supplier_rank
    from
        "lakehouse"."dbt"."dim_part_suppliers" s
)
select
    s.*
from
    parts_suppliers s
where
    s.supplier_cost_rank = 1 and 
    s.supplier_rank <= 100
order by 
    s.supplier_name, s.part_key
    )
[0m22:54:18.433216 [debug] [Thread-1 (]: SQL status: SUCCESS in 6.0 seconds
[0m22:54:18.437303 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (execute): 22:54:10.994637 => 22:54:18.437016
[0m22:54:18.437794 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: ROLLBACK
[0m22:54:18.438093 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: Close
[0m22:54:18.439777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dce2840-9db7-4bcd-a10f-1f86fd4c51d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25062cbe50>]}
[0m22:54:18.440267 [info ] [Thread-1 (]: 7 of 7 OK created sql table model dbt.minimum_cost_suppliers ................... [[32mSUCCESS[0m in 7.45s]
[0m22:54:18.440708 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m22:54:18.442687 [debug] [MainThread]: On master: COMMIT
[0m22:54:18.443063 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:54:18.443233 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.minimum_cost_suppliers' was properly closed.
[0m22:54:18.443432 [info ] [MainThread]: 
[0m22:54:18.443647 [info ] [MainThread]: Finished running 7 table models in 0 hours 1 minutes and 45.71 seconds (105.71s).
[0m22:54:18.444610 [debug] [MainThread]: Command end result
[0m22:54:18.452194 [info ] [MainThread]: 
[0m22:54:18.452565 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:54:18.452799 [info ] [MainThread]: 
[0m22:54:18.453082 [error] [MainThread]:   Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  'dict object' has no attribute 'dateadd'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:54:18.453384 [info ] [MainThread]: 
[0m22:54:18.453711 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m22:54:18.454421 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 106.75368, "process_user_time": 2.935825, "process_kernel_time": 0.27553, "process_mem_max_rss": "117956", "process_out_blocks": "3840", "command_success": false, "process_in_blocks": "0"}
[0m22:54:18.454753 [debug] [MainThread]: Command `dbt run` failed at 22:54:18.454675 after 106.75 seconds
[0m22:54:18.454981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2507fc9c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f250bedf710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f250790b850>]}
[0m22:54:18.455193 [debug] [MainThread]: Flushing usage events
[0m23:00:09.604513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54ccd1790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54d158c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54ccb4b50>]}


============================== 23:00:09.606281 | f116c969-a716-4902-882a-30da562fc005 ==============================
[0m23:00:09.606281 [info ] [MainThread]: Running with dbt=1.7.3
[0m23:00:09.606651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models pricing_summary_report.sql', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:00:09.730134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f116c969-a716-4902-882a-30da562fc005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54cacb710>]}
[0m23:00:09.785726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f116c969-a716-4902-882a-30da562fc005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54c9115d0>]}
[0m23:00:09.786229 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m23:00:09.793560 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m23:00:09.813308 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:00:09.813919 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/mart/pricing_summary_report.sql
[0m23:00:09.905332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f116c969-a716-4902-882a-30da562fc005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54c6e0a10>]}
[0m23:00:09.914815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f116c969-a716-4902-882a-30da562fc005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54c6df410>]}
[0m23:00:09.915181 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m23:00:09.915500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f116c969-a716-4902-882a-30da562fc005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54c9b2a10>]}
[0m23:00:09.916666 [info ] [MainThread]: 
[0m23:00:09.917224 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m23:00:09.918089 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m23:00:09.929549 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m23:00:09.929852 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m23:00:09.930077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:10.988735 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m23:00:10.990505 [debug] [ThreadPool]: On list_lakehouse: Close
[0m23:00:10.993385 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m23:00:10.998665 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m23:00:10.998954 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m23:00:10.999170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:00:11.760412 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m23:00:11.763674 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m23:00:11.764132 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m23:00:11.767466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f116c969-a716-4902-882a-30da562fc005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54c8d14d0>]}
[0m23:00:11.767851 [debug] [MainThread]: On master: COMMIT
[0m23:00:11.768375 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:00:11.768643 [info ] [MainThread]: 
[0m23:00:11.771233 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m23:00:11.771587 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m23:00:11.772149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m23:00:11.772391 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m23:00:11.775433 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 23:00:11.772520 => 23:00:11.775277
[0m23:00:11.776910 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  'dict object' has no attribute 'date_add'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:00:11.777200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f116c969-a716-4902-882a-30da562fc005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54c83be10>]}
[0m23:00:11.777551 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.01s]
[0m23:00:11.777906 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m23:00:11.779551 [debug] [MainThread]: On master: COMMIT
[0m23:00:11.779964 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:00:11.780185 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m23:00:11.780389 [info ] [MainThread]: 
[0m23:00:11.780622 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.86 seconds (1.86s).
[0m23:00:11.781171 [debug] [MainThread]: Command end result
[0m23:00:11.787968 [info ] [MainThread]: 
[0m23:00:11.788409 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:00:11.788725 [info ] [MainThread]: 
[0m23:00:11.788982 [error] [MainThread]:   Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  'dict object' has no attribute 'date_add'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:00:11.789267 [info ] [MainThread]: 
[0m23:00:11.789537 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:00:11.790187 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.211256, "process_user_time": 1.47517, "process_kernel_time": 0.046682, "process_mem_max_rss": "112708", "process_out_blocks": "3512", "command_success": false, "process_in_blocks": "0"}
[0m23:00:11.790509 [debug] [MainThread]: Command `dbt run` failed at 23:00:11.790433 after 2.21 seconds
[0m23:00:11.790741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54cafac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54ccb5cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54ccb5ad0>]}
[0m23:00:11.790962 [debug] [MainThread]: Flushing usage events
[0m23:01:12.599275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0e43fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0e43e210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0e43f2d0>]}


============================== 23:01:12.601086 | f791e7f8-4ed9-4423-a019-8cb40a174b20 ==============================
[0m23:01:12.601086 [info ] [MainThread]: Running with dbt=1.7.3
[0m23:01:12.601449 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models pricing_summary_report.sql', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:01:12.726456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f791e7f8-4ed9-4423-a019-8cb40a174b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0e246f90>]}
[0m23:01:12.781935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f791e7f8-4ed9-4423-a019-8cb40a174b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0e1d3e90>]}
[0m23:01:12.782403 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m23:01:12.789648 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m23:01:12.807054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:01:12.807396 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:01:12.811932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f791e7f8-4ed9-4423-a019-8cb40a174b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0e33fb90>]}
[0m23:01:12.820572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f791e7f8-4ed9-4423-a019-8cb40a174b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0dfb7950>]}
[0m23:01:12.820928 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m23:01:12.821201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f791e7f8-4ed9-4423-a019-8cb40a174b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0e223050>]}
[0m23:01:12.822437 [info ] [MainThread]: 
[0m23:01:12.823201 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m23:01:12.824107 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m23:01:12.835464 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m23:01:12.835812 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m23:01:12.836020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:01:14.368867 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m23:01:14.371045 [debug] [ThreadPool]: On list_lakehouse: Close
[0m23:01:14.375068 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m23:01:14.381706 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m23:01:14.381935 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m23:01:14.382113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:01:15.375901 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m23:01:15.379100 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m23:01:15.379396 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m23:01:15.381865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f791e7f8-4ed9-4423-a019-8cb40a174b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0e0ee6d0>]}
[0m23:01:15.382164 [debug] [MainThread]: On master: COMMIT
[0m23:01:15.382562 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:01:15.382794 [info ] [MainThread]: 
[0m23:01:15.385615 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m23:01:15.385962 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m23:01:15.386511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m23:01:15.386771 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m23:01:15.390741 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 23:01:15.386909 => 23:01:15.390579
[0m23:01:15.392303 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  'dict object' has no attribute 'date_add'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:01:15.392583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f791e7f8-4ed9-4423-a019-8cb40a174b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0e269b10>]}
[0m23:01:15.392938 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.01s]
[0m23:01:15.393320 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m23:01:15.395270 [debug] [MainThread]: On master: COMMIT
[0m23:01:15.395701 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:01:15.395871 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m23:01:15.396068 [info ] [MainThread]: 
[0m23:01:15.396337 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.57 seconds (2.57s).
[0m23:01:15.396834 [debug] [MainThread]: Command end result
[0m23:01:15.403060 [info ] [MainThread]: 
[0m23:01:15.403437 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:01:15.403795 [info ] [MainThread]: 
[0m23:01:15.404074 [error] [MainThread]:   Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  'dict object' has no attribute 'date_add'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:01:15.404309 [info ] [MainThread]: 
[0m23:01:15.404573 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:01:15.405171 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.831494, "process_user_time": 1.345361, "process_kernel_time": 0.064503, "process_mem_max_rss": "110368", "process_out_blocks": "2376", "command_success": false, "process_in_blocks": "0"}
[0m23:01:15.405482 [debug] [MainThread]: Command `dbt run` failed at 23:01:15.405409 after 2.83 seconds
[0m23:01:15.405739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0e8d4dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0e28fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b12a75350>]}
[0m23:01:15.405974 [debug] [MainThread]: Flushing usage events
[0m23:01:28.263847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f970aa490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f970b9690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9708bed0>]}


============================== 23:01:28.265780 | 5180686e-5e69-4ee7-8eeb-e275b213dbe2 ==============================
[0m23:01:28.265780 [info ] [MainThread]: Running with dbt=1.7.3
[0m23:01:28.266159 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models pricing_summary_report.sql', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:01:28.393999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5180686e-5e69-4ee7-8eeb-e275b213dbe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f96eb20d0>]}
[0m23:01:28.448645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5180686e-5e69-4ee7-8eeb-e275b213dbe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f96ff5e10>]}
[0m23:01:28.449091 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m23:01:28.456308 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m23:01:28.473208 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:01:28.473766 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/mart/pricing_summary_report.sql
[0m23:01:28.568535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5180686e-5e69-4ee7-8eeb-e275b213dbe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f96a6b7d0>]}
[0m23:01:28.576774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5180686e-5e69-4ee7-8eeb-e275b213dbe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f96cd8290>]}
[0m23:01:28.577151 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m23:01:28.577432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5180686e-5e69-4ee7-8eeb-e275b213dbe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f96e72a50>]}
[0m23:01:28.578605 [info ] [MainThread]: 
[0m23:01:28.579200 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m23:01:28.580228 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m23:01:28.591121 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m23:01:28.591361 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m23:01:28.591536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:01:29.857232 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m23:01:29.860043 [debug] [ThreadPool]: On list_lakehouse: Close
[0m23:01:29.864408 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m23:01:29.870975 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m23:01:29.871196 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m23:01:29.871377 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:01:30.738288 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m23:01:30.741079 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m23:01:30.741589 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m23:01:30.745363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5180686e-5e69-4ee7-8eeb-e275b213dbe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9797ac50>]}
[0m23:01:30.746060 [debug] [MainThread]: On master: COMMIT
[0m23:01:30.747087 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:01:30.747656 [info ] [MainThread]: 
[0m23:01:30.750734 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m23:01:30.751054 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m23:01:30.751590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m23:01:30.751842 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m23:01:30.754832 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 23:01:30.751964 => 23:01:30.754673
[0m23:01:30.756250 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  'dict object' has no attribute 'dateadd'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:01:30.756535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5180686e-5e69-4ee7-8eeb-e275b213dbe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f96b04ed0>]}
[0m23:01:30.756884 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.01s]
[0m23:01:30.757312 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m23:01:30.758981 [debug] [MainThread]: On master: COMMIT
[0m23:01:30.759481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:01:30.759653 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m23:01:30.759830 [info ] [MainThread]: 
[0m23:01:30.760086 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.18 seconds (2.18s).
[0m23:01:30.760622 [debug] [MainThread]: Command end result
[0m23:01:30.766890 [info ] [MainThread]: 
[0m23:01:30.767294 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:01:30.767637 [info ] [MainThread]: 
[0m23:01:30.767923 [error] [MainThread]:   Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  'dict object' has no attribute 'dateadd'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:01:30.768181 [info ] [MainThread]: 
[0m23:01:30.768475 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:01:30.769092 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.5314884, "process_user_time": 1.440525, "process_kernel_time": 0.056124, "process_mem_max_rss": "112452", "process_out_blocks": "3504", "command_success": false, "process_in_blocks": "0"}
[0m23:01:30.769405 [debug] [MainThread]: Command `dbt run` failed at 23:01:30.769333 after 2.53 seconds
[0m23:01:30.769627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f97779dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f96aaf6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9b61f410>]}
[0m23:01:30.769842 [debug] [MainThread]: Flushing usage events
[0m23:02:35.652999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddfc2330d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddfc3f5650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddfc3f5a50>]}


============================== 23:02:35.656158 | 1787fd67-235d-46bb-bb9c-af761288c7a5 ==============================
[0m23:02:35.656158 [info ] [MainThread]: Running with dbt=1.7.3
[0m23:02:35.656747 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:02:35.721453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1787fd67-235d-46bb-bb9c-af761288c7a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddfc2f7450>]}
[0m23:02:35.734596 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-lfr3qc8r'
[0m23:02:35.734920 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:02:35.887960 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:02:35.891340 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:02:35.992290 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:02:35.996253 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:02:36.308491 [info ] [MainThread]: Installed from version 1.1.1
[0m23:02:36.308875 [info ] [MainThread]: Up to date!
[0m23:02:36.309186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1787fd67-235d-46bb-bb9c-af761288c7a5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddfc134190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddfc134090>]}
[0m23:02:36.309952 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.69048613, "process_user_time": 1.193881, "process_kernel_time": 0.082653, "process_mem_max_rss": "100808", "process_out_blocks": "2032", "process_in_blocks": "0"}
[0m23:02:36.310284 [debug] [MainThread]: Command `dbt deps` succeeded at 23:02:36.310206 after 0.69 seconds
[0m23:02:36.310489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde00a10fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde00923450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddfc234b10>]}
[0m23:02:36.310704 [debug] [MainThread]: Flushing usage events
[0m23:02:43.241583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864345be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86434a7650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8643458310>]}


============================== 23:02:43.243365 | 571885dc-badb-4bf3-9539-c181d583738d ==============================
[0m23:02:43.243365 [info ] [MainThread]: Running with dbt=1.7.3
[0m23:02:43.243769 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models pricing_summary_report.sql', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:02:43.369433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '571885dc-badb-4bf3-9539-c181d583738d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864324a0d0>]}
[0m23:02:43.424926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '571885dc-badb-4bf3-9539-c181d583738d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8643458a90>]}
[0m23:02:43.425359 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m23:02:43.432845 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m23:02:43.449614 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:02:43.450120 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/mart/pricing_summary_report.sql
[0m23:02:43.542385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '571885dc-badb-4bf3-9539-c181d583738d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86430256d0>]}
[0m23:02:43.551270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '571885dc-badb-4bf3-9539-c181d583738d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8642ec0450>]}
[0m23:02:43.551822 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m23:02:43.552256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '571885dc-badb-4bf3-9539-c181d583738d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86432a3650>]}
[0m23:02:43.553742 [info ] [MainThread]: 
[0m23:02:43.554379 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m23:02:43.555292 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m23:02:43.566377 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m23:02:43.566683 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m23:02:43.566915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:44.845922 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m23:02:44.847896 [debug] [ThreadPool]: On list_lakehouse: Close
[0m23:02:44.850633 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m23:02:44.855978 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m23:02:44.856231 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m23:02:44.856441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:02:46.027790 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m23:02:46.031024 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m23:02:46.035554 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m23:02:46.039983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '571885dc-badb-4bf3-9539-c181d583738d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8643248190>]}
[0m23:02:46.040474 [debug] [MainThread]: On master: COMMIT
[0m23:02:46.041084 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:02:46.041459 [info ] [MainThread]: 
[0m23:02:46.044260 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m23:02:46.044703 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m23:02:46.045351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m23:02:46.045709 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m23:02:46.048785 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 23:02:46.045892 => 23:02:46.048622
[0m23:02:46.050202 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  'dict object' has no attribute 'date_add'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:02:46.050479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '571885dc-badb-4bf3-9539-c181d583738d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8642cd3810>]}
[0m23:02:46.050823 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.01s]
[0m23:02:46.051179 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m23:02:46.052996 [debug] [MainThread]: On master: COMMIT
[0m23:02:46.053372 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:02:46.053541 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m23:02:46.053710 [info ] [MainThread]: 
[0m23:02:46.053929 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.50 seconds (2.50s).
[0m23:02:46.054363 [debug] [MainThread]: Command end result
[0m23:02:46.060758 [info ] [MainThread]: 
[0m23:02:46.061203 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:02:46.061544 [info ] [MainThread]: 
[0m23:02:46.061785 [error] [MainThread]:   Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  'dict object' has no attribute 'date_add'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:02:46.062137 [info ] [MainThread]: 
[0m23:02:46.062395 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:02:46.063077 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.8475804, "process_user_time": 1.440515, "process_kernel_time": 0.047385, "process_mem_max_rss": "112616", "process_out_blocks": "3512", "command_success": false, "process_in_blocks": "0"}
[0m23:02:46.063429 [debug] [MainThread]: Command `dbt run` failed at 23:02:46.063348 after 2.85 seconds
[0m23:02:46.063699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86432b5a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86432b57d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8642e6f950>]}
[0m23:02:46.063921 [debug] [MainThread]: Flushing usage events
[0m23:12:30.623185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c4c7b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c4e57d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c4e57c10>]}


============================== 23:12:30.624916 | ecb06d47-943b-4222-b092-470a7c0cc98a ==============================
[0m23:12:30.624916 [info ] [MainThread]: Running with dbt=1.7.3
[0m23:12:30.625282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models pricing_summary_report.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:12:30.747330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecb06d47-943b-4222-b092-470a7c0cc98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c4e27810>]}
[0m23:12:30.802138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecb06d47-943b-4222-b092-470a7c0cc98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c4c72910>]}
[0m23:12:30.802585 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m23:12:30.809771 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m23:12:30.826745 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m23:12:30.827214 [debug] [MainThread]: Partial parsing: added file: dbt_trino_iceberg://macros/dateadd.sql
[0m23:12:30.827501 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/mart/pricing_summary_report.sql
[0m23:12:30.918796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecb06d47-943b-4222-b092-470a7c0cc98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c4ae1550>]}
[0m23:12:30.927042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecb06d47-943b-4222-b092-470a7c0cc98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c48bc050>]}
[0m23:12:30.927390 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m23:12:30.927822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecb06d47-943b-4222-b092-470a7c0cc98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c5990f50>]}
[0m23:12:30.929072 [info ] [MainThread]: 
[0m23:12:30.929630 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m23:12:30.930538 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m23:12:30.941301 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m23:12:30.941533 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m23:12:30.941725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:32.130408 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m23:12:32.133052 [debug] [ThreadPool]: On list_lakehouse: Close
[0m23:12:32.136158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m23:12:32.145314 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m23:12:32.145542 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m23:12:32.145732 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:12:32.874187 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m23:12:32.877375 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m23:12:32.877813 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m23:12:32.879998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecb06d47-943b-4222-b092-470a7c0cc98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c486fd10>]}
[0m23:12:32.880291 [debug] [MainThread]: On master: COMMIT
[0m23:12:32.880701 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:12:32.880934 [info ] [MainThread]: 
[0m23:12:32.883415 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m23:12:32.883793 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m23:12:32.884358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m23:12:32.884624 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m23:12:32.888060 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 23:12:32.884758 => 23:12:32.887856
[0m23:12:32.889575 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  'dict object' has no attribute 'dateadd'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:12:32.889847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb06d47-943b-4222-b092-470a7c0cc98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c46ccad0>]}
[0m23:12:32.890198 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.01s]
[0m23:12:32.890559 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m23:12:32.891946 [debug] [MainThread]: On master: COMMIT
[0m23:12:32.892351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:12:32.892519 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m23:12:32.892685 [info ] [MainThread]: 
[0m23:12:32.892899 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.96 seconds (1.96s).
[0m23:12:32.893321 [debug] [MainThread]: Command end result
[0m23:12:32.899625 [info ] [MainThread]: 
[0m23:12:32.900859 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:12:32.901234 [info ] [MainThread]: 
[0m23:12:32.901592 [error] [MainThread]:   Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  'dict object' has no attribute 'dateadd'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:12:32.901974 [info ] [MainThread]: 
[0m23:12:32.902354 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:12:32.903043 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.304991, "process_user_time": 1.363681, "process_kernel_time": 0.112856, "process_mem_max_rss": "112592", "process_out_blocks": "3512", "command_success": false, "process_in_blocks": "0"}
[0m23:12:32.903368 [debug] [MainThread]: Command `dbt run` failed at 23:12:32.903291 after 2.31 seconds
[0m23:12:32.903604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c4e2a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c4823d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c936b690>]}
[0m23:12:32.903827 [debug] [MainThread]: Flushing usage events
[0m23:17:48.541296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51ebffcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51ebd2810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51ebd0850>]}


============================== 23:17:48.543079 | b2c933cf-b401-4fca-a93a-70957afdf5d4 ==============================
[0m23:17:48.543079 [info ] [MainThread]: Running with dbt=1.7.3
[0m23:17:48.543455 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models pricing_summary_report.sql', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:17:48.668081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2c933cf-b401-4fca-a93a-70957afdf5d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51e987110>]}
[0m23:17:48.721579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2c933cf-b401-4fca-a93a-70957afdf5d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51eb15f90>]}
[0m23:17:48.721998 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m23:17:48.729121 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m23:17:48.747058 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:17:48.747541 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/mart/pricing_summary_report.sql
[0m23:17:48.822594 [error] [MainThread]: Encountered an error:
Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  unexpected '}', expected ')'
    line 29
      f.ship_date <= {{dateadd('day', -90, var('highest_ship_date') }} --{{ dbt_utils.dateadd('day', -90, var('highest_ship_date')) }}
[0m23:17:48.823259 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.30771315, "process_user_time": 1.254897, "process_kernel_time": 0.055363, "process_mem_max_rss": "105152", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m23:17:48.823698 [debug] [MainThread]: Command `dbt run` failed at 23:17:48.823612 after 0.31 seconds
[0m23:17:48.823935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51ebd0850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51eba8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51f054910>]}
[0m23:17:48.824158 [debug] [MainThread]: Flushing usage events
[0m23:19:03.021595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc0ca574d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc0ca72490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc0ca56fd0>]}


============================== 23:19:03.023452 | 717f9437-9243-4529-869f-aafb6b571e2d ==============================
[0m23:19:03.023452 [info ] [MainThread]: Running with dbt=1.7.3
[0m23:19:03.023823 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models pricing_summary_report.sql', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:19:03.147541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '717f9437-9243-4529-869f-aafb6b571e2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc0c85c8d0>]}
[0m23:19:03.201655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '717f9437-9243-4529-869f-aafb6b571e2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc0c689a50>]}
[0m23:19:03.202184 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m23:19:03.209543 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m23:19:03.226668 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:19:03.227175 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/mart/pricing_summary_report.sql
[0m23:19:03.301575 [error] [MainThread]: Encountered an error:
Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  unexpected '}', expected ')'
    line 29
      f.ship_date <= {{dateadd('day', -90, var('highest_ship_date') }}
[0m23:19:03.302429 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.30691856, "process_user_time": 1.268945, "process_kernel_time": 0.046311, "process_mem_max_rss": "105012", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m23:19:03.302788 [debug] [MainThread]: Command `dbt run` failed at 23:19:03.302704 after 0.31 seconds
[0m23:19:03.303023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc0cec8dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc0c880110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc110f6c90>]}
[0m23:19:03.303246 [debug] [MainThread]: Flushing usage events
[0m23:56:15.251892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5a564f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5a566d8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5a566fe90>]}


============================== 23:56:15.253688 | 262c6305-b178-4a71-b4ee-bf4c3b707a98 ==============================
[0m23:56:15.253688 [info ] [MainThread]: Running with dbt=1.7.3
[0m23:56:15.254056 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models pricing_summary_report.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:56:15.381171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '262c6305-b178-4a71-b4ee-bf4c3b707a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5a5651f90>]}
[0m23:56:15.435848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '262c6305-b178-4a71-b4ee-bf4c3b707a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5a53f4650>]}
[0m23:56:15.436340 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m23:56:15.444128 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m23:56:15.461913 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:56:15.462433 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/mart/pricing_summary_report.sql
[0m23:56:15.556381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '262c6305-b178-4a71-b4ee-bf4c3b707a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5a5033e90>]}
[0m23:56:15.564912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '262c6305-b178-4a71-b4ee-bf4c3b707a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5a52a0550>]}
[0m23:56:15.565258 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 534 macros, 0 groups, 0 semantic models
[0m23:56:15.565541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '262c6305-b178-4a71-b4ee-bf4c3b707a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5a5afc990>]}
[0m23:56:15.566776 [info ] [MainThread]: 
[0m23:56:15.567323 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m23:56:15.568356 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m23:56:15.579173 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m23:56:15.579412 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m23:56:15.579581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:56:16.671388 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m23:56:16.672854 [debug] [ThreadPool]: On list_lakehouse: Close
[0m23:56:16.675927 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m23:56:16.681257 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m23:56:16.681501 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m23:56:16.681718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:56:17.311333 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m23:56:17.313733 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m23:56:17.314105 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m23:56:17.316847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '262c6305-b178-4a71-b4ee-bf4c3b707a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5a56ba710>]}
[0m23:56:17.317135 [debug] [MainThread]: On master: COMMIT
[0m23:56:17.317527 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:56:17.317758 [info ] [MainThread]: 
[0m23:56:17.320633 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m23:56:17.320943 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m23:56:17.321462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m23:56:17.321712 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m23:56:17.325188 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 23:56:17.321834 => 23:56:17.325016
[0m23:56:17.326705 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  'dict object' has no attribute 'dateadd'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:56:17.327003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '262c6305-b178-4a71-b4ee-bf4c3b707a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5a50be890>]}
[0m23:56:17.327357 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.01s]
[0m23:56:17.327724 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m23:56:17.329193 [debug] [MainThread]: On master: COMMIT
[0m23:56:17.329565 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:56:17.329731 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m23:56:17.329901 [info ] [MainThread]: 
[0m23:56:17.330113 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.76 seconds (1.76s).
[0m23:56:17.330570 [debug] [MainThread]: Command end result
[0m23:56:17.337384 [info ] [MainThread]: 
[0m23:56:17.337771 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:56:17.338069 [info ] [MainThread]: 
[0m23:56:17.338320 [error] [MainThread]:   Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  'dict object' has no attribute 'dateadd'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:56:17.338552 [info ] [MainThread]: 
[0m23:56:17.338803 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:56:17.339568 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.1173923, "process_user_time": 1.383086, "process_kernel_time": 0.100754, "process_mem_max_rss": "113456", "process_out_blocks": "3512", "command_success": false, "process_in_blocks": "0"}
[0m23:56:17.340004 [debug] [MainThread]: Command `dbt run` failed at 23:56:17.339900 after 2.12 seconds
[0m23:56:17.340342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5a9be7350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5a9be7390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5a5652b10>]}
[0m23:56:17.340570 [debug] [MainThread]: Flushing usage events
[0m23:57:03.675265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22ff2e7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe23029d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22ff2ca50>]}


============================== 23:57:03.677060 | b49a48b1-117b-4a4e-8ab5-523b412bb2ff ==============================
[0m23:57:03.677060 [info ] [MainThread]: Running with dbt=1.7.3
[0m23:57:03.677435 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:57:03.731856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b49a48b1-117b-4a4e-8ab5-523b412bb2ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22fe22310>]}
[0m23:57:03.738324 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-3qzrguol'
[0m23:57:03.738612 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:57:05.157256 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:57:05.158957 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:57:05.350068 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:57:05.355254 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:57:05.792385 [info ] [MainThread]: Installed from version 1.1.1
[0m23:57:05.792722 [info ] [MainThread]: Up to date!
[0m23:57:05.793062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b49a48b1-117b-4a4e-8ab5-523b412bb2ff', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22ff66890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22fe64450>]}
[0m23:57:05.793973 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.1451137, "process_user_time": 1.164131, "process_kernel_time": 0.037552, "process_mem_max_rss": "101244", "process_out_blocks": "2024", "process_in_blocks": "0"}
[0m23:57:05.794356 [debug] [MainThread]: Command `dbt deps` succeeded at 23:57:05.794260 after 2.15 seconds
[0m23:57:05.794611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe23455d150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe23446f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2345e6c50>]}
[0m23:57:05.794834 [debug] [MainThread]: Flushing usage events
[0m00:00:11.503018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5af474d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5af4c3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5af476490>]}


============================== 00:00:11.504910 | fd1929e0-5f92-43e2-a612-c833df62cc54 ==============================
[0m00:00:11.504910 [info ] [MainThread]: Running with dbt=1.7.3
[0m00:00:11.505296 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models pricing_summary_report.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:00:11.630029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd1929e0-5f92-43e2-a612-c833df62cc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5af2d57d0>]}
[0m00:00:11.683916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd1929e0-5f92-43e2-a612-c833df62cc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5af0da710>]}
[0m00:00:11.684368 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m00:00:11.691546 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m00:00:11.709247 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:00:11.709675 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://macros/dateadd.sql
[0m00:00:11.718562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd1929e0-5f92-43e2-a612-c833df62cc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5af127710>]}
[0m00:00:11.726797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd1929e0-5f92-43e2-a612-c833df62cc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5af176790>]}
[0m00:00:11.727222 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 536 macros, 0 groups, 0 semantic models
[0m00:00:11.727485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd1929e0-5f92-43e2-a612-c833df62cc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5af217d50>]}
[0m00:00:11.728612 [info ] [MainThread]: 
[0m00:00:11.729218 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m00:00:11.730296 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m00:00:11.741654 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m00:00:11.742043 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m00:00:11.742218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:12.964094 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m00:00:12.966575 [debug] [ThreadPool]: On list_lakehouse: Close
[0m00:00:12.968970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m00:00:12.975333 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m00:00:12.975563 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m00:00:12.975751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:13.820128 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m00:00:13.823114 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m00:00:13.823595 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m00:00:13.827201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd1929e0-5f92-43e2-a612-c833df62cc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5af3907d0>]}
[0m00:00:13.827630 [debug] [MainThread]: On master: COMMIT
[0m00:00:13.828079 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:00:13.828322 [info ] [MainThread]: 
[0m00:00:13.831271 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m00:00:13.831656 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m00:00:13.832202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m00:00:13.832437 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m00:00:13.836459 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 00:00:13.832563 => 00:00:13.836300
[0m00:00:13.847167 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  The "adapter_macro" macro has been deprecated. Instead, use the `adapter.dispatch` method to find a macro and call the result.  For more information, see: https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch) adapter_macro was called for: dbt_utils.date_add
  
  > in macro dateadd (macros/dateadd.sql)
  > called by model pricing_summary_report (models/mart/pricing_summary_report.sql)
[0m00:00:13.847589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd1929e0-5f92-43e2-a612-c833df62cc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5af03ffd0>]}
[0m00:00:13.847997 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.02s]
[0m00:00:13.848474 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m00:00:13.849820 [debug] [MainThread]: On master: COMMIT
[0m00:00:13.850210 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:13.850376 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m00:00:13.850550 [info ] [MainThread]: 
[0m00:00:13.850764 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.12 seconds (2.12s).
[0m00:00:13.851195 [debug] [MainThread]: Command end result
[0m00:00:13.857899 [info ] [MainThread]: 
[0m00:00:13.858335 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:00:13.858703 [info ] [MainThread]: 
[0m00:00:13.858964 [error] [MainThread]:   Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  The "adapter_macro" macro has been deprecated. Instead, use the `adapter.dispatch` method to find a macro and call the result.  For more information, see: https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch) adapter_macro was called for: dbt_utils.date_add
  
  > in macro dateadd (macros/dateadd.sql)
  > called by model pricing_summary_report (models/mart/pricing_summary_report.sql)
[0m00:00:13.859301 [info ] [MainThread]: 
[0m00:00:13.859612 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:00:13.860530 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.3845875, "process_user_time": 1.383168, "process_kernel_time": 0.046728, "process_mem_max_rss": "110352", "process_in_blocks": "128", "process_out_blocks": "3520", "command_success": false}
[0m00:00:13.861042 [debug] [MainThread]: Command `dbt run` failed at 00:00:13.860959 after 2.39 seconds
[0m00:00:13.861308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5af482790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5aefd8410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5b3ab9190>]}
[0m00:00:13.861572 [debug] [MainThread]: Flushing usage events
[0m00:02:19.523505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bce3a0850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bce1fa4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bce1facd0>]}


============================== 00:02:19.525207 | df5c8837-8ddf-4c5a-90e8-4e74237e8472 ==============================
[0m00:02:19.525207 [info ] [MainThread]: Running with dbt=1.7.3
[0m00:02:19.525585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models pricing_summary_report.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:02:19.648523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df5c8837-8ddf-4c5a-90e8-4e74237e8472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bce201590>]}
[0m00:02:19.701827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df5c8837-8ddf-4c5a-90e8-4e74237e8472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bcedab4d0>]}
[0m00:02:19.702304 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m00:02:19.709259 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m00:02:19.726126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:02:19.726579 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://macros/dateadd.sql
[0m00:02:19.729299 [error] [MainThread]: Encountered an error:
Compilation Error
  In adapter.dispatch, got a macro name of "dbt_utils.dateadd", but "." is not a valid macro name component. Did you mean `adapter.dispatch("dateadd", macro_namespace="dbt_utils")`?
[0m00:02:19.730114 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.23214135, "process_user_time": 1.226658, "process_kernel_time": 0.009222, "process_mem_max_rss": "103756", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m00:02:19.730547 [debug] [MainThread]: Command `dbt run` failed at 00:02:19.730453 after 0.23 seconds
[0m00:02:19.730855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bce3a2910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bcddfed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bcdfcb050>]}
[0m00:02:19.731084 [debug] [MainThread]: Flushing usage events
[0m00:07:05.180971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f678e761d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f678e59a490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f678e743990>]}


============================== 00:07:05.182769 | b94921a4-51c9-4a07-b92f-a428f902252d ==============================
[0m00:07:05.182769 [info ] [MainThread]: Running with dbt=1.7.3
[0m00:07:05.183141 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models pricing_summary_report.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:07:05.308294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b94921a4-51c9-4a07-b92f-a428f902252d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f678e5107d0>]}
[0m00:07:05.362779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b94921a4-51c9-4a07-b92f-a428f902252d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f678e4f0710>]}
[0m00:07:05.363208 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m00:07:05.370387 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m00:07:05.388392 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:07:05.388878 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://macros/dateadd.sql
[0m00:07:05.399360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b94921a4-51c9-4a07-b92f-a428f902252d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f678e5c7dd0>]}
[0m00:07:05.407727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b94921a4-51c9-4a07-b92f-a428f902252d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f678e369f90>]}
[0m00:07:05.408102 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m00:07:05.408370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b94921a4-51c9-4a07-b92f-a428f902252d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f678e513390>]}
[0m00:07:05.409524 [info ] [MainThread]: 
[0m00:07:05.410063 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m00:07:05.410975 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m00:07:05.422130 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m00:07:05.422392 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m00:07:05.422582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:06.990876 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m00:07:06.993728 [debug] [ThreadPool]: On list_lakehouse: Close
[0m00:07:06.997735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m00:07:07.004132 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m00:07:07.004424 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m00:07:07.004604 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:07:08.366637 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m00:07:08.369539 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m00:07:08.370115 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m00:07:08.373515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b94921a4-51c9-4a07-b92f-a428f902252d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f678e423d10>]}
[0m00:07:08.373830 [debug] [MainThread]: On master: COMMIT
[0m00:07:08.374252 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:07:08.374503 [info ] [MainThread]: 
[0m00:07:08.377463 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m00:07:08.377772 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m00:07:08.378248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m00:07:08.378505 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m00:07:08.382632 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 00:07:08.378648 => 00:07:08.382467
[0m00:07:08.384487 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  BaseDatabaseWrapper.dispatch() takes from 2 to 4 positional arguments but 5 were given
[0m00:07:08.384760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b94921a4-51c9-4a07-b92f-a428f902252d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f678e1b2450>]}
[0m00:07:08.385108 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.01s]
[0m00:07:08.385460 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m00:07:08.387130 [debug] [MainThread]: On master: COMMIT
[0m00:07:08.387620 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:07:08.387792 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m00:07:08.387970 [info ] [MainThread]: 
[0m00:07:08.388215 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.98 seconds (2.98s).
[0m00:07:08.388762 [debug] [MainThread]: Command end result
[0m00:07:08.395632 [info ] [MainThread]: 
[0m00:07:08.396017 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:07:08.396348 [info ] [MainThread]: 
[0m00:07:08.396656 [error] [MainThread]:   Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  BaseDatabaseWrapper.dispatch() takes from 2 to 4 positional arguments but 5 were given
[0m00:07:08.396904 [info ] [MainThread]: 
[0m00:07:08.397170 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:07:08.397783 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.242578, "process_user_time": 1.333266, "process_kernel_time": 0.08948, "process_mem_max_rss": "111380", "process_out_blocks": "3528", "command_success": false, "process_in_blocks": "0"}
[0m00:07:08.398107 [debug] [MainThread]: Command `dbt run` failed at 00:07:08.398028 after 3.24 seconds
[0m00:07:08.398341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f678e74d810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f678ebe4c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f678f2a9c50>]}
[0m00:07:08.398556 [debug] [MainThread]: Flushing usage events
[0m00:08:33.575968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f33a70d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f3808bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f4498750>]}


============================== 00:08:33.577720 | 057ab1fe-920b-4fb5-8450-a73ba73af67f ==============================
[0m00:08:33.577720 [info ] [MainThread]: Running with dbt=1.7.3
[0m00:08:33.578095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --models pricing_summary_report.sql', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:08:33.702253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '057ab1fe-920b-4fb5-8450-a73ba73af67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f31882d0>]}
[0m00:08:33.757736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '057ab1fe-920b-4fb5-8450-a73ba73af67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f33cb810>]}
[0m00:08:33.758175 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m00:08:33.765590 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m00:08:33.783431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:08:33.783883 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://macros/dateadd.sql
[0m00:08:33.793101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '057ab1fe-920b-4fb5-8450-a73ba73af67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f30744d0>]}
[0m00:08:33.802037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '057ab1fe-920b-4fb5-8450-a73ba73af67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f2f895d0>]}
[0m00:08:33.802423 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 536 macros, 0 groups, 0 semantic models
[0m00:08:33.802720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '057ab1fe-920b-4fb5-8450-a73ba73af67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f336bd10>]}
[0m00:08:33.803867 [info ] [MainThread]: 
[0m00:08:33.804427 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m00:08:33.805320 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m00:08:33.816726 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m00:08:33.817023 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m00:08:33.817199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:08:35.056784 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m00:08:35.057979 [debug] [ThreadPool]: On list_lakehouse: Close
[0m00:08:35.061310 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m00:08:35.067141 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m00:08:35.067540 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m00:08:35.067740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:08:35.887575 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m00:08:35.890532 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m00:08:35.891198 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m00:08:35.893738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '057ab1fe-920b-4fb5-8450-a73ba73af67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f3175f50>]}
[0m00:08:35.894026 [debug] [MainThread]: On master: COMMIT
[0m00:08:35.894424 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:08:35.894701 [info ] [MainThread]: 
[0m00:08:35.897317 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m00:08:35.897694 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m00:08:35.898272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m00:08:35.898550 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m00:08:35.903136 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 00:08:35.898707 => 00:08:35.902976
[0m00:08:35.905220 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  BaseDatabaseWrapper.dispatch() takes from 2 to 4 positional arguments but 5 were given
[0m00:08:35.905530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '057ab1fe-920b-4fb5-8450-a73ba73af67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f31af910>]}
[0m00:08:35.905898 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.01s]
[0m00:08:35.906259 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m00:08:35.907992 [debug] [MainThread]: On master: COMMIT
[0m00:08:35.908369 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:08:35.908542 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m00:08:35.908761 [info ] [MainThread]: 
[0m00:08:35.908983 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.10 seconds (2.10s).
[0m00:08:35.909498 [debug] [MainThread]: Command end result
[0m00:08:35.915589 [info ] [MainThread]: 
[0m00:08:35.915980 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:08:35.916251 [info ] [MainThread]: 
[0m00:08:35.916484 [error] [MainThread]:   Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  BaseDatabaseWrapper.dispatch() takes from 2 to 4 positional arguments but 5 were given
[0m00:08:35.916778 [info ] [MainThread]: 
[0m00:08:35.917038 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:08:35.917645 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.3676426, "process_user_time": 1.388137, "process_kernel_time": 0.037265, "process_mem_max_rss": "110376", "process_out_blocks": "3512", "command_success": false, "process_in_blocks": "0"}
[0m00:08:35.917993 [debug] [MainThread]: Command `dbt run` failed at 00:08:35.917920 after 2.37 seconds
[0m00:08:35.918215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f5e22d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f79c5110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f79c52d0>]}
[0m00:08:35.918423 [debug] [MainThread]: Flushing usage events
[0m00:12:33.629962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f498e709ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f498e309390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f498e30a010>]}


============================== 00:12:33.631764 | f8de06d3-3a93-4a07-a4d7-0b8c8bbb5d56 ==============================
[0m00:12:33.631764 [info ] [MainThread]: Running with dbt=1.7.3
[0m00:12:33.632172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models pricing_summary_report.sql', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:12:33.756565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8de06d3-3a93-4a07-a4d7-0b8c8bbb5d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f498e126cd0>]}
[0m00:12:33.810231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8de06d3-3a93-4a07-a4d7-0b8c8bbb5d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f498e174190>]}
[0m00:12:33.810726 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m00:12:33.817828 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m00:12:33.835368 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:12:33.835807 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://macros/dateadd.sql
[0m00:12:33.837470 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two macros named "dateadd" in the project "dbt_trino_iceberg".
   To fix this error, rename or remove one of the following macros:
      - macros/dateadd.sql
      - macros/dateadd.sql
[0m00:12:33.838065 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.23418199, "process_user_time": 1.193561, "process_kernel_time": 0.055514, "process_mem_max_rss": "103480", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m00:12:33.838398 [debug] [MainThread]: Command `dbt run` failed at 00:12:33.838312 after 0.23 seconds
[0m00:12:33.838653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f498e314310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f498e2f2790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49928335d0>]}
[0m00:12:33.838877 [debug] [MainThread]: Flushing usage events
[0m00:13:09.240098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cdfc284d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cdfc53e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cdfc2aad0>]}


============================== 00:13:09.241838 | 74316e14-9cfe-4a97-82be-051d75b84a17 ==============================
[0m00:13:09.241838 [info ] [MainThread]: Running with dbt=1.7.3
[0m00:13:09.242235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models pricing_summary_report.sql', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:13:09.366889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74316e14-9cfe-4a97-82be-051d75b84a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cdfc53090>]}
[0m00:13:09.422273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74316e14-9cfe-4a97-82be-051d75b84a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cdfa92c90>]}
[0m00:13:09.422779 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m00:13:09.430025 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m00:13:09.447050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:13:09.447349 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:13:09.451884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74316e14-9cfe-4a97-82be-051d75b84a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cdf6a5010>]}
[0m00:13:09.459907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74316e14-9cfe-4a97-82be-051d75b84a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cdf793d10>]}
[0m00:13:09.460624 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 536 macros, 0 groups, 0 semantic models
[0m00:13:09.460995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74316e14-9cfe-4a97-82be-051d75b84a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cdf9bbf50>]}
[0m00:13:09.462308 [info ] [MainThread]: 
[0m00:13:09.463007 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m00:13:09.464065 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m00:13:09.475118 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m00:13:09.475348 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m00:13:09.475517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:13:10.901588 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m00:13:10.904587 [debug] [ThreadPool]: On list_lakehouse: Close
[0m00:13:10.909069 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m00:13:10.915826 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m00:13:10.916053 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m00:13:10.916249 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:13:12.316841 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m00:13:12.320231 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m00:13:12.320852 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m00:13:12.324800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74316e14-9cfe-4a97-82be-051d75b84a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cdf8e8790>]}
[0m00:13:12.325133 [debug] [MainThread]: On master: COMMIT
[0m00:13:12.326248 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:13:12.326774 [info ] [MainThread]: 
[0m00:13:12.329212 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m00:13:12.329610 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m00:13:12.330192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m00:13:12.330458 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m00:13:12.335186 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 00:13:12.330607 => 00:13:12.335023
[0m00:13:12.337028 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  BaseDatabaseWrapper.dispatch() takes from 2 to 4 positional arguments but 5 were given
[0m00:13:12.337304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74316e14-9cfe-4a97-82be-051d75b84a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cdf69b610>]}
[0m00:13:12.337653 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.01s]
[0m00:13:12.338011 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m00:13:12.339766 [debug] [MainThread]: On master: COMMIT
[0m00:13:12.340139 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:13:12.340324 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m00:13:12.340502 [info ] [MainThread]: 
[0m00:13:12.340714 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.88 seconds (2.88s).
[0m00:13:12.341170 [debug] [MainThread]: Command end result
[0m00:13:12.348635 [info ] [MainThread]: 
[0m00:13:12.349102 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:13:12.349390 [info ] [MainThread]: 
[0m00:13:12.349635 [error] [MainThread]:   Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  BaseDatabaseWrapper.dispatch() takes from 2 to 4 positional arguments but 5 were given
[0m00:13:12.349873 [info ] [MainThread]: 
[0m00:13:12.350212 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:13:12.351241 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.1361306, "process_user_time": 1.326208, "process_kernel_time": 0.083467, "process_mem_max_rss": "110224", "process_out_blocks": "2376", "command_success": false, "process_in_blocks": "0"}
[0m00:13:12.351586 [debug] [MainThread]: Command `dbt run` failed at 00:13:12.351508 after 3.14 seconds
[0m00:13:12.351836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cdfc1b090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ce02f1e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cdfc2b050>]}
[0m00:13:12.352115 [debug] [MainThread]: Flushing usage events
[0m00:40:55.490909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b4c9f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b4c9ea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b50f8cd0>]}


============================== 00:40:55.492687 | 42f3229e-f2a6-4f6e-a8d7-1c33b0a027d8 ==============================
[0m00:40:55.492687 [info ] [MainThread]: Running with dbt=1.7.3
[0m00:40:55.493119 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models pricing_summary_report.sql', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:40:55.617856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42f3229e-f2a6-4f6e-a8d7-1c33b0a027d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b4a98cd0>]}
[0m00:40:55.675924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42f3229e-f2a6-4f6e-a8d7-1c33b0a027d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b4c4fa10>]}
[0m00:40:55.676344 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m00:40:55.683301 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m00:40:55.700842 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:40:55.701351 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/mart/pricing_summary_report.sql
[0m00:40:55.778568 [error] [MainThread]: Encountered an error:
Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  BaseDatabaseWrapper.dispatch() takes from 2 to 4 positional arguments but 5 were given
[0m00:40:55.779236 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.3137884, "process_user_time": 1.300499, "process_kernel_time": 0.036893, "process_mem_max_rss": "105348", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m00:40:55.779629 [debug] [MainThread]: Command `dbt run` failed at 00:40:55.779546 after 0.31 seconds
[0m00:40:55.779860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b4c53090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b486cb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b4c51250>]}
[0m00:40:55.780081 [debug] [MainThread]: Flushing usage events
[0m00:41:27.023129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d2139fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d2139fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d2139ef50>]}


============================== 00:41:27.024989 | d1a5975c-3fb1-41e3-8e9e-336f1c90fb31 ==============================
[0m00:41:27.024989 [info ] [MainThread]: Running with dbt=1.7.3
[0m00:41:27.025412 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models pricing_summary_report.sql', 'send_anonymous_usage_stats': 'True'}
[0m00:41:27.150747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1a5975c-3fb1-41e3-8e9e-336f1c90fb31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d211554d0>]}
[0m00:41:27.206705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1a5975c-3fb1-41e3-8e9e-336f1c90fb31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d211e6890>]}
[0m00:41:27.207186 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m00:41:27.214560 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m00:41:27.231733 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:41:27.232260 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/mart/pricing_summary_report.sql
[0m00:41:27.306491 [error] [MainThread]: Encountered an error:
Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  unexpected '}', expected ')'
    line 24
      f.ship_date <= {{dateadd('day', -90, var('highest_ship_date') }} --{{ dbt_utils.dateadd('day', -90, var('highest_ship_date')) }}
[0m00:41:27.307162 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.31771162, "process_user_time": 1.301764, "process_kernel_time": 0.083091, "process_mem_max_rss": "105036", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m00:41:27.307605 [debug] [MainThread]: Command `dbt run` failed at 00:41:27.307510 after 0.32 seconds
[0m00:41:27.307851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d211f6a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d211f6bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d211f7810>]}
[0m00:41:27.308089 [debug] [MainThread]: Flushing usage events
[0m00:41:47.772935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca1aff650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca1ff6710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca1affa10>]}


============================== 00:41:47.774708 | 04c3fb76-d866-4201-8e31-9de4301f16fc ==============================
[0m00:41:47.774708 [info ] [MainThread]: Running with dbt=1.7.3
[0m00:41:47.775080 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models pricing_summary_report.sql', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:41:47.900367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04c3fb76-d866-4201-8e31-9de4301f16fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca18b4610>]}
[0m00:41:47.955187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04c3fb76-d866-4201-8e31-9de4301f16fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca18ac690>]}
[0m00:41:47.955629 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m00:41:47.962879 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m00:41:47.979414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:41:47.979892 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/mart/pricing_summary_report.sql
[0m00:41:48.056551 [error] [MainThread]: Encountered an error:
Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  BaseDatabaseWrapper.dispatch() takes from 2 to 4 positional arguments but 5 were given
[0m00:41:48.057217 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.31001058, "process_user_time": 1.301136, "process_kernel_time": 0.036911, "process_mem_max_rss": "105132", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m00:41:48.057650 [debug] [MainThread]: Command `dbt run` failed at 00:41:48.057522 after 0.31 seconds
[0m00:41:48.057884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca1afce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca1afe690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca1afcd50>]}
[0m00:41:48.058112 [debug] [MainThread]: Flushing usage events
[0m00:42:12.744674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9004e7bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9004e7ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9004e78d10>]}


============================== 00:42:12.746511 | 6d089c90-8061-48a6-8c48-cab875e48309 ==============================
[0m00:42:12.746511 [info ] [MainThread]: Running with dbt=1.7.3
[0m00:42:12.746925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models pricing_summary_report.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:42:12.868552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d089c90-8061-48a6-8c48-cab875e48309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9004cc3d50>]}
[0m00:42:12.923406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d089c90-8061-48a6-8c48-cab875e48309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9004acf290>]}
[0m00:42:12.923912 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m00:42:12.931537 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m00:42:12.948255 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:42:12.948747 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/mart/pricing_summary_report.sql
[0m00:42:13.025662 [error] [MainThread]: Encountered an error:
Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  BaseDatabaseWrapper.dispatch() takes from 2 to 4 positional arguments but 5 were given
[0m00:42:13.026317 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.30764008, "process_user_time": 1.263364, "process_kernel_time": 0.055329, "process_mem_max_rss": "105360", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m00:42:13.026732 [debug] [MainThread]: Command `dbt run` failed at 00:42:13.026648 after 0.31 seconds
[0m00:42:13.026963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9004e9a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9004e871d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f900488f890>]}
[0m00:42:13.027197 [debug] [MainThread]: Flushing usage events
[0m00:42:43.375772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4588e64d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4588db1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4588d8150>]}


============================== 00:42:43.377622 | c0a9766e-b216-4d67-af5d-7a95ee4fecf9 ==============================
[0m00:42:43.377622 [info ] [MainThread]: Running with dbt=1.7.3
[0m00:42:43.377992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:42:43.503620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0a9766e-b216-4d67-af5d-7a95ee4fecf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb459192050>]}
[0m00:42:43.560096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0a9766e-b216-4d67-af5d-7a95ee4fecf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb459192050>]}
[0m00:42:43.560548 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m00:42:43.567907 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m00:42:43.575170 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:42:43.576012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c0a9766e-b216-4d67-af5d-7a95ee4fecf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb458388a50>]}
[0m00:42:44.269162 [error] [MainThread]: Encountered an error:
Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  BaseDatabaseWrapper.dispatch() takes from 2 to 4 positional arguments but 5 were given
[0m00:42:44.269860 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.92081106, "process_user_time": 1.832406, "process_kernel_time": 0.055527, "process_mem_max_rss": "107220", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m00:42:44.270264 [debug] [MainThread]: Command `dbt run` failed at 00:42:44.270178 after 0.92 seconds
[0m00:42:44.270505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb458932c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4588e6f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb45871b990>]}
[0m00:42:44.270739 [debug] [MainThread]: Flushing usage events
[0m00:47:48.758906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a25e5fa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a25e5cd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a25e8cb10>]}


============================== 00:47:48.760857 | 05bde325-3858-4e98-91db-f069c7c4fe6d ==============================
[0m00:47:48.760857 [info ] [MainThread]: Running with dbt=1.7.3
[0m00:47:48.761516 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models pricing_summary_report.sql', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:47:48.887843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05bde325-3858-4e98-91db-f069c7c4fe6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a25c4c390>]}
[0m00:47:48.942392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05bde325-3858-4e98-91db-f069c7c4fe6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a25cb2c50>]}
[0m00:47:48.942896 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m00:47:48.950230 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m00:47:48.957915 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:47:48.958268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '05bde325-3858-4e98-91db-f069c7c4fe6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a2590d350>]}
[0m00:47:49.665971 [error] [MainThread]: Encountered an error:
Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  BaseDatabaseWrapper.dispatch() takes from 2 to 4 positional arguments but 5 were given
[0m00:47:49.666724 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.9331721, "process_user_time": 1.856197, "process_kernel_time": 0.064643, "process_mem_max_rss": "105212", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m00:47:49.667129 [debug] [MainThread]: Command `dbt run` failed at 00:47:49.667048 after 0.93 seconds
[0m00:47:49.667357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a25e5e690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a25c09a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a25eaaf90>]}
[0m00:47:49.667596 [debug] [MainThread]: Flushing usage events
[0m00:48:14.812988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f437245ba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43724593d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f437245af50>]}


============================== 00:48:14.814778 | 2f407ea2-af20-47f0-a84b-210d8b9340dc ==============================
[0m00:48:14.814778 [info ] [MainThread]: Running with dbt=1.7.3
[0m00:48:14.815156 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models pricing_summary_report.sql', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:48:14.939207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f407ea2-af20-47f0-a84b-210d8b9340dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43721e7c50>]}
[0m00:48:14.994921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f407ea2-af20-47f0-a84b-210d8b9340dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43723aa5d0>]}
[0m00:48:14.995383 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m00:48:15.003108 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m00:48:15.010347 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:48:15.010695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2f407ea2-af20-47f0-a84b-210d8b9340dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43723cad50>]}
[0m00:48:15.835554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f407ea2-af20-47f0-a84b-210d8b9340dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4372146810>]}
[0m00:48:15.844700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f407ea2-af20-47f0-a84b-210d8b9340dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4370db3dd0>]}
[0m00:48:15.845045 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 536 macros, 0 groups, 0 semantic models
[0m00:48:15.845367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f407ea2-af20-47f0-a84b-210d8b9340dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4371fb3310>]}
[0m00:48:15.846600 [info ] [MainThread]: 
[0m00:48:15.847170 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m00:48:15.848171 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m00:48:15.859398 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m00:48:15.859715 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m00:48:15.859918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:48:17.399149 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m00:48:17.400304 [debug] [ThreadPool]: On list_lakehouse: Close
[0m00:48:17.403108 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m00:48:17.408361 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m00:48:17.408623 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m00:48:17.408844 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:48:18.153591 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m00:48:18.156510 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m00:48:18.157128 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m00:48:18.159834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f407ea2-af20-47f0-a84b-210d8b9340dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43722b8e90>]}
[0m00:48:18.160134 [debug] [MainThread]: On master: COMMIT
[0m00:48:18.160544 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:48:18.160780 [info ] [MainThread]: 
[0m00:48:18.163545 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m00:48:18.163861 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m00:48:18.164349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m00:48:18.164581 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m00:48:18.166811 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m00:48:18.167344 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 00:48:18.164710 => 00:48:18.167191
[0m00:48:18.167561 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.pricing_summary_report
[0m00:48:18.185192 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m00:48:18.187191 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.pricing_summary_report"
[0m00:48:18.187538 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.pricing_summary_report"} */

  
    

    create table "lakehouse"."dbt"."pricing_summary_report"
      
      
    as (
      
/*
1 Q1 - Pricing Summary Report Query
This query reports the amount of business that was billed, shipped, and returned. 
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 29)
*/

select 
    f.return_status_code,
    f.order_line_status_code,
    sum(f.quantity) as quantity,
    sum(f.gross_item_sales_amount) as gross_item_sales_amount,
    sum(f.discounted_item_sales_amount) as discounted_item_sales_amount,
    sum(f.net_item_sales_amount) as net_item_sales_amount,

    avg(f.quantity) as avg_quantity,
    avg(f.base_price) as avg_base_price,
    avg(f.discount_percentage) as avg_discount_percentage,

    sum(f.order_item_count) as order_item_count
    
from
    "lakehouse"."dbt"."fct_orders_items" f
where
    f.ship_date <= var('highest_ship_date') - interval '90' day 
group by
    1,2
    )
[0m00:48:18.187849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:48:18.684604 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231218_075520_00036_ijqrb
[0m00:48:18.685710 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=FUNCTION_NOT_FOUND, message="line 34:20: Function 'var' not registered", query_id=20231218_075520_00036_ijqrb)
[0m00:48:18.686920 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (execute): 00:48:18.167679 => 00:48:18.686436
[0m00:48:18.687740 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: ROLLBACK
[0m00:48:18.688289 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: Close
[0m00:48:18.693784 [debug] [Thread-1 (]: Database Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  TrinoUserError(type=USER_ERROR, name=FUNCTION_NOT_FOUND, message="line 34:20: Function 'var' not registered", query_id=20231218_075520_00036_ijqrb)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/pricing_summary_report.sql
[0m00:48:18.697113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f407ea2-af20-47f0-a84b-210d8b9340dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4370e07b50>]}
[0m00:48:18.698160 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.53s]
[0m00:48:18.699233 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m00:48:18.701647 [debug] [MainThread]: On master: COMMIT
[0m00:48:18.702089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:48:18.702265 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m00:48:18.702441 [info ] [MainThread]: 
[0m00:48:18.702674 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.86 seconds (2.86s).
[0m00:48:18.703199 [debug] [MainThread]: Command end result
[0m00:48:18.710299 [info ] [MainThread]: 
[0m00:48:18.710766 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:48:18.711064 [info ] [MainThread]: 
[0m00:48:18.711361 [error] [MainThread]:   Database Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  TrinoUserError(type=USER_ERROR, name=FUNCTION_NOT_FOUND, message="line 34:20: Function 'var' not registered", query_id=20231218_075520_00036_ijqrb)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/pricing_summary_report.sql
[0m00:48:18.711638 [info ] [MainThread]: 
[0m00:48:18.711934 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:48:18.712617 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.9252098, "process_user_time": 2.143162, "process_kernel_time": 0.064664, "process_mem_max_rss": "115364", "process_out_blocks": "3512", "command_success": false, "process_in_blocks": "0"}
[0m00:48:18.712938 [debug] [MainThread]: Command `dbt run` failed at 00:48:18.712864 after 3.93 seconds
[0m00:48:18.713160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f437244b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43769d3410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43720037d0>]}
[0m00:48:18.713369 [debug] [MainThread]: Flushing usage events
[0m00:50:43.526656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba57299bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba572dead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba572e70d0>]}


============================== 00:50:43.528693 | ffc06322-9d1c-4015-8678-9935b99c0f42 ==============================
[0m00:50:43.528693 [info ] [MainThread]: Running with dbt=1.7.3
[0m00:50:43.529155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models pricing_summary_report.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:50:43.665383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffc06322-9d1c-4015-8678-9935b99c0f42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba56ef8f10>]}
[0m00:50:43.724763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ffc06322-9d1c-4015-8678-9935b99c0f42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba5711e590>]}
[0m00:50:43.725294 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m00:50:43.733847 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m00:50:43.753996 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:50:43.754991 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/mart/pricing_summary_report.sql
[0m00:50:43.861029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ffc06322-9d1c-4015-8678-9935b99c0f42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba56cafd10>]}
[0m00:50:43.870701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ffc06322-9d1c-4015-8678-9935b99c0f42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba56d08510>]}
[0m00:50:43.871142 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 536 macros, 0 groups, 0 semantic models
[0m00:50:43.871451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffc06322-9d1c-4015-8678-9935b99c0f42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba56d585d0>]}
[0m00:50:43.872909 [info ] [MainThread]: 
[0m00:50:43.873734 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m00:50:43.874757 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m00:50:43.887703 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m00:50:43.888170 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m00:50:43.888422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:50:45.069779 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m00:50:45.070796 [debug] [ThreadPool]: On list_lakehouse: Close
[0m00:50:45.073728 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m00:50:45.079520 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m00:50:45.080067 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m00:50:45.080290 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:50:45.694464 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m00:50:45.695541 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m00:50:45.695774 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m00:50:45.698238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffc06322-9d1c-4015-8678-9935b99c0f42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba56f8ce10>]}
[0m00:50:45.698614 [debug] [MainThread]: On master: COMMIT
[0m00:50:45.699115 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:50:45.699391 [info ] [MainThread]: 
[0m00:50:45.702253 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m00:50:45.702662 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m00:50:45.703344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m00:50:45.703606 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m00:50:45.706762 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 00:50:45.703727 => 00:50:45.706548
[0m00:50:45.708515 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m00:50:45.708854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffc06322-9d1c-4015-8678-9935b99c0f42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba55d01510>]}
[0m00:50:45.709240 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.01s]
[0m00:50:45.709662 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m00:50:45.711646 [debug] [MainThread]: On master: COMMIT
[0m00:50:45.712186 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:50:45.712405 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m00:50:45.712588 [info ] [MainThread]: 
[0m00:50:45.712848 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.84 seconds (1.84s).
[0m00:50:45.713389 [debug] [MainThread]: Command end result
[0m00:50:45.720415 [info ] [MainThread]: 
[0m00:50:45.720934 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:50:45.721265 [info ] [MainThread]: 
[0m00:50:45.721566 [error] [MainThread]:   Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m00:50:45.721854 [info ] [MainThread]: 
[0m00:50:45.722218 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:50:45.722950 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.2324114, "process_user_time": 1.65022, "process_kernel_time": 0.037719, "process_mem_max_rss": "114736", "process_out_blocks": "3512", "command_success": false, "process_in_blocks": "0"}
[0m00:50:45.723301 [debug] [MainThread]: Command `dbt run` failed at 00:50:45.723218 after 2.23 seconds
[0m00:50:45.723553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba570fba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba570e0a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba5b7ef3d0>]}
[0m00:50:45.723778 [debug] [MainThread]: Flushing usage events
[0m00:51:08.393439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7114c91310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7114cb7950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7114c7dbd0>]}


============================== 00:51:08.395318 | 8f9d2961-c9d0-4317-bb0d-21b3d9179fc8 ==============================
[0m00:51:08.395318 [info ] [MainThread]: Running with dbt=1.7.3
[0m00:51:08.395727 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models pricing_summary_report.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:51:08.531026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f9d2961-c9d0-4317-bb0d-21b3d9179fc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7114aaf950>]}
[0m00:51:08.591718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f9d2961-c9d0-4317-bb0d-21b3d9179fc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7114b7fe50>]}
[0m00:51:08.592290 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m00:51:08.600659 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m00:51:08.619317 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:51:08.619909 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/mart/pricing_summary_report.sql
[0m00:51:08.732558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f9d2961-c9d0-4317-bb0d-21b3d9179fc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7114a87e50>]}
[0m00:51:08.742565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f9d2961-c9d0-4317-bb0d-21b3d9179fc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71148d4210>]}
[0m00:51:08.742970 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 536 macros, 0 groups, 0 semantic models
[0m00:51:08.743284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f9d2961-c9d0-4317-bb0d-21b3d9179fc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7114731d10>]}
[0m00:51:08.744647 [info ] [MainThread]: 
[0m00:51:08.745400 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m00:51:08.746445 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m00:51:08.758344 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m00:51:08.758654 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m00:51:08.758834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:51:10.186890 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m00:51:10.187956 [debug] [ThreadPool]: On list_lakehouse: Close
[0m00:51:10.190418 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m00:51:10.195997 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m00:51:10.196375 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m00:51:10.196621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:51:10.981610 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m00:51:10.982688 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m00:51:10.982910 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m00:51:10.985483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f9d2961-c9d0-4317-bb0d-21b3d9179fc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711467afd0>]}
[0m00:51:10.985911 [debug] [MainThread]: On master: COMMIT
[0m00:51:10.986424 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:51:10.986702 [info ] [MainThread]: 
[0m00:51:10.989380 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m00:51:10.989764 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m00:51:10.990412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m00:51:10.990667 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m00:51:10.993894 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 00:51:10.990788 => 00:51:10.993692
[0m00:51:10.995452 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m00:51:10.995808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f9d2961-c9d0-4317-bb0d-21b3d9179fc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7114698a50>]}
[0m00:51:10.996261 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.01s]
[0m00:51:10.996712 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m00:51:10.998563 [debug] [MainThread]: On master: COMMIT
[0m00:51:10.999061 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:51:10.999250 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m00:51:10.999456 [info ] [MainThread]: 
[0m00:51:10.999704 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.25 seconds (2.25s).
[0m00:51:11.000284 [debug] [MainThread]: Command end result
[0m00:51:11.006761 [info ] [MainThread]: 
[0m00:51:11.007956 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:51:11.008399 [info ] [MainThread]: 
[0m00:51:11.008784 [error] [MainThread]:   Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var 'highest_ship_date' not found in config:
  Vars supplied to pricing_summary_report = {}
[0m00:51:11.009118 [info ] [MainThread]: 
[0m00:51:11.009464 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:51:11.010534 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.64392, "process_user_time": 1.553275, "process_kernel_time": 0.065107, "process_mem_max_rss": "112732", "process_out_blocks": "3504", "command_success": false, "process_in_blocks": "0"}
[0m00:51:11.010985 [debug] [MainThread]: Command `dbt run` failed at 00:51:11.010888 after 2.64 seconds
[0m00:51:11.011252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71192d5110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71191e75d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7114cc8950>]}
[0m00:51:11.011639 [debug] [MainThread]: Flushing usage events
[0m00:51:47.879631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac32e3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac32b16d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac32b2f50>]}


============================== 00:51:47.881405 | 40c20743-9ac2-413f-9102-162004a82a8c ==============================
[0m00:51:47.881405 [info ] [MainThread]: Running with dbt=1.7.3
[0m00:51:47.881791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models pricing_summary_report.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:51:48.006375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40c20743-9ac2-413f-9102-162004a82a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac307bad0>]}
[0m00:51:48.061818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40c20743-9ac2-413f-9102-162004a82a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac3040910>]}
[0m00:51:48.062357 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m00:51:48.069720 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m00:51:48.076850 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:51:48.077174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '40c20743-9ac2-413f-9102-162004a82a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac2d45190>]}
[0m00:51:48.872492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40c20743-9ac2-413f-9102-162004a82a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac2d607d0>]}
[0m00:51:48.880641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40c20743-9ac2-413f-9102-162004a82a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac1afda90>]}
[0m00:51:48.881112 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 536 macros, 0 groups, 0 semantic models
[0m00:51:48.881516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40c20743-9ac2-413f-9102-162004a82a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac2d94210>]}
[0m00:51:48.882759 [info ] [MainThread]: 
[0m00:51:48.883296 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m00:51:48.884160 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m00:51:48.894902 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m00:51:48.895120 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m00:51:48.895291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:51:50.241569 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m00:51:50.244494 [debug] [ThreadPool]: On list_lakehouse: Close
[0m00:51:50.247202 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m00:51:50.252871 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m00:51:50.253117 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m00:51:50.253326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:51:51.166992 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m00:51:51.169018 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m00:51:51.169395 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m00:51:51.172500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40c20743-9ac2-413f-9102-162004a82a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac2c562d0>]}
[0m00:51:51.172815 [debug] [MainThread]: On master: COMMIT
[0m00:51:51.173247 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:51:51.173546 [info ] [MainThread]: 
[0m00:51:51.176714 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m00:51:51.177141 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m00:51:51.177782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m00:51:51.178005 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m00:51:51.180234 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m00:51:51.180653 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 00:51:51.178126 => 00:51:51.180506
[0m00:51:51.180865 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.pricing_summary_report
[0m00:51:51.198983 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m00:51:51.201403 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.pricing_summary_report"
[0m00:51:51.201693 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.pricing_summary_report"} */

  
    

    create table "lakehouse"."dbt"."pricing_summary_report"
      
      
    as (
      /*
1 Q1 - Pricing Summary Report Query
This query reports the amount of business that was billed, shipped, and returned. 
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 29)
*/

select 
    f.return_status_code,
    f.order_line_status_code,
    sum(f.quantity) as quantity,
    sum(f.gross_item_sales_amount) as gross_item_sales_amount,
    sum(f.discounted_item_sales_amount) as discounted_item_sales_amount,
    sum(f.net_item_sales_amount) as net_item_sales_amount,

    avg(f.quantity) as avg_quantity,
    avg(f.base_price) as avg_base_price,
    avg(f.discount_percentage) as avg_discount_percentage,

    sum(f.order_item_count) as order_item_count
    
from
    "lakehouse"."dbt"."fct_orders_items" f
where
    f.ship_date <= '1998-12-01'::date - interval '90' day  
group by
    1,2
    )
[0m00:51:51.201920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:51.564203 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231218_075837_00043_ijqrb
[0m00:51:51.565177 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 33:32: mismatched input ':'. Expecting: '%', ')', '*', '+', '-', '.', '/', 'AND', 'AT', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WINDOW', '[', '||'", query_id=20231218_075837_00043_ijqrb)
[0m00:51:51.566381 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (execute): 00:51:51.180989 => 00:51:51.565896
[0m00:51:51.567089 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: ROLLBACK
[0m00:51:51.567488 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: Close
[0m00:51:51.569882 [debug] [Thread-1 (]: Database Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 33:32: mismatched input ':'. Expecting: '%', ')', '*', '+', '-', '.', '/', 'AND', 'AT', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WINDOW', '[', '||'", query_id=20231218_075837_00043_ijqrb)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/pricing_summary_report.sql
[0m00:51:51.570859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40c20743-9ac2-413f-9102-162004a82a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac1a40250>]}
[0m00:51:51.571255 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.39s]
[0m00:51:51.571662 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m00:51:51.573274 [debug] [MainThread]: On master: COMMIT
[0m00:51:51.573654 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:51:51.573818 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m00:51:51.573991 [info ] [MainThread]: 
[0m00:51:51.574206 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.69 seconds (2.69s).
[0m00:51:51.574635 [debug] [MainThread]: Command end result
[0m00:51:51.580466 [info ] [MainThread]: 
[0m00:51:51.580838 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:51:51.581154 [info ] [MainThread]: 
[0m00:51:51.581413 [error] [MainThread]:   Database Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 33:32: mismatched input ':'. Expecting: '%', ')', '*', '+', '-', '.', '/', 'AND', 'AT', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WINDOW', '[', '||'", query_id=20231218_075837_00043_ijqrb)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/pricing_summary_report.sql
[0m00:51:51.581683 [info ] [MainThread]: 
[0m00:51:51.582023 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:51:51.582686 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.7280085, "process_user_time": 2.128273, "process_kernel_time": 0.037835, "process_mem_max_rss": "115108", "process_out_blocks": "3512", "command_success": false, "process_in_blocks": "0"}
[0m00:51:51.583049 [debug] [MainThread]: Command `dbt run` failed at 00:51:51.582971 after 3.73 seconds
[0m00:51:51.583269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac397a010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac2d82d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac3738dd0>]}
[0m00:51:51.583476 [debug] [MainThread]: Flushing usage events
[0m00:55:34.938315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca302111d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca3023a290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca301f71d0>]}


============================== 00:55:34.940088 | b1c37cd8-e180-41a5-83aa-5aed112c1c85 ==============================
[0m00:55:34.940088 [info ] [MainThread]: Running with dbt=1.7.3
[0m00:55:34.940527 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models pricing_summary_report.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:55:35.082824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1c37cd8-e180-41a5-83aa-5aed112c1c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca300276d0>]}
[0m00:55:35.137186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1c37cd8-e180-41a5-83aa-5aed112c1c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca300ffed0>]}
[0m00:55:35.137759 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m00:55:35.146075 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m00:55:35.163088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:55:35.163616 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/mart/pricing_summary_report.sql
[0m00:55:35.266153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1c37cd8-e180-41a5-83aa-5aed112c1c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2ffddd10>]}
[0m00:55:35.274526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1c37cd8-e180-41a5-83aa-5aed112c1c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2fe50090>]}
[0m00:55:35.274918 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 536 macros, 0 groups, 0 semantic models
[0m00:55:35.275183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1c37cd8-e180-41a5-83aa-5aed112c1c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2fca0490>]}
[0m00:55:35.276368 [info ] [MainThread]: 
[0m00:55:35.276941 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m00:55:35.277851 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m00:55:35.289616 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m00:55:35.289928 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m00:55:35.290109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:36.656106 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m00:55:36.658038 [debug] [ThreadPool]: On list_lakehouse: Close
[0m00:55:36.660433 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m00:55:36.665827 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m00:55:36.666080 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m00:55:36.666297 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:55:37.527787 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m00:55:37.530376 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m00:55:37.530924 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m00:55:37.534125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1c37cd8-e180-41a5-83aa-5aed112c1c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2fe00f50>]}
[0m00:55:37.534434 [debug] [MainThread]: On master: COMMIT
[0m00:55:37.534925 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:55:37.535197 [info ] [MainThread]: 
[0m00:55:37.537474 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m00:55:37.537802 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m00:55:37.538314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m00:55:37.538559 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m00:55:37.540698 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m00:55:37.541100 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 00:55:37.538686 => 00:55:37.540956
[0m00:55:37.541311 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.pricing_summary_report
[0m00:55:37.559789 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m00:55:37.561785 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.pricing_summary_report"
[0m00:55:37.562125 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.pricing_summary_report"} */

  
    

    create table "lakehouse"."dbt"."pricing_summary_report"
      
      
    as (
      /*
1 Q1 - Pricing Summary Report Query
This query reports the amount of business that was billed, shipped, and returned. 
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 29)
*/

select 
    f.return_status_code,
    f.order_line_status_code,
    sum(f.quantity) as quantity,
    sum(f.gross_item_sales_amount) as gross_item_sales_amount,
    sum(f.discounted_item_sales_amount) as discounted_item_sales_amount,
    sum(f.net_item_sales_amount) as net_item_sales_amount,

    avg(f.quantity) as avg_quantity,
    avg(f.base_price) as avg_base_price,
    avg(f.discount_percentage) as avg_discount_percentage,

    sum(f.order_item_count) as order_item_count
    
from
    "lakehouse"."dbt"."fct_orders_items" f
where
    f.ship_date <= 1998-12-01 - interval '90' day  
group by
    1,2
    )
[0m00:55:37.562389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:38.015451 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231218_080206_00046_ijqrb
[0m00:55:38.016288 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 33:31: Cannot apply operator: integer - interval day to second", query_id=20231218_080206_00046_ijqrb)
[0m00:55:38.017196 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (execute): 00:55:37.541430 => 00:55:38.016856
[0m00:55:38.017416 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: ROLLBACK
[0m00:55:38.017602 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: Close
[0m00:55:38.020009 [debug] [Thread-1 (]: Database Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 33:31: Cannot apply operator: integer - interval day to second", query_id=20231218_080206_00046_ijqrb)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/pricing_summary_report.sql
[0m00:55:38.020989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1c37cd8-e180-41a5-83aa-5aed112c1c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca300ff790>]}
[0m00:55:38.021384 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.48s]
[0m00:55:38.021795 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m00:55:38.023364 [debug] [MainThread]: On master: COMMIT
[0m00:55:38.023755 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:55:38.023924 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m00:55:38.024099 [info ] [MainThread]: 
[0m00:55:38.024313 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.75 seconds (2.75s).
[0m00:55:38.024817 [debug] [MainThread]: Command end result
[0m00:55:38.032122 [info ] [MainThread]: 
[0m00:55:38.032513 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:55:38.032822 [info ] [MainThread]: 
[0m00:55:38.033135 [error] [MainThread]:   Database Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 33:31: Cannot apply operator: integer - interval day to second", query_id=20231218_080206_00046_ijqrb)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/pricing_summary_report.sql
[0m00:55:38.033422 [info ] [MainThread]: 
[0m00:55:38.033728 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:55:38.034387 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.121933, "process_user_time": 1.440113, "process_kernel_time": 0.142116, "process_mem_max_rss": "113460", "process_out_blocks": "3528", "command_success": false, "process_in_blocks": "0"}
[0m00:55:38.034716 [debug] [MainThread]: Command `dbt run` failed at 00:55:38.034639 after 3.12 seconds
[0m00:55:38.034954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca301f6710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca3024f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca30840790>]}
[0m00:55:38.035170 [debug] [MainThread]: Flushing usage events
[0m00:56:51.955939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cbccdbcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cbcc8b390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cbcc8af90>]}


============================== 00:56:51.957683 | daa96cb3-9d58-4b94-bd57-d057aaf3ee78 ==============================
[0m00:56:51.957683 [info ] [MainThread]: Running with dbt=1.7.3
[0m00:56:51.958065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models pricing_summary_report.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:56:52.083353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'daa96cb3-9d58-4b94-bd57-d057aaf3ee78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cbccda110>]}
[0m00:56:52.139463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'daa96cb3-9d58-4b94-bd57-d057aaf3ee78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cbca30750>]}
[0m00:56:52.140080 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m00:56:52.147337 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m00:56:52.164825 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:56:52.165352 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/mart/pricing_summary_report.sql
[0m00:56:52.258072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'daa96cb3-9d58-4b94-bd57-d057aaf3ee78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cbc66e050>]}
[0m00:56:52.266151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'daa96cb3-9d58-4b94-bd57-d057aaf3ee78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cbc8e0390>]}
[0m00:56:52.266497 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 536 macros, 0 groups, 0 semantic models
[0m00:56:52.267024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'daa96cb3-9d58-4b94-bd57-d057aaf3ee78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cbc7393d0>]}
[0m00:56:52.268212 [info ] [MainThread]: 
[0m00:56:52.268786 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m00:56:52.269657 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m00:56:52.280395 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m00:56:52.280618 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m00:56:52.280804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:56:53.592885 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m00:56:53.593852 [debug] [ThreadPool]: On list_lakehouse: Close
[0m00:56:53.596040 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m00:56:53.601164 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m00:56:53.601405 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m00:56:53.601622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:56:54.740128 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m00:56:54.743469 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m00:56:54.744133 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m00:56:54.746813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'daa96cb3-9d58-4b94-bd57-d057aaf3ee78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cbc974750>]}
[0m00:56:54.747103 [debug] [MainThread]: On master: COMMIT
[0m00:56:54.747498 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:56:54.747729 [info ] [MainThread]: 
[0m00:56:54.750078 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m00:56:54.750394 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m00:56:54.750862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m00:56:54.751122 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m00:56:54.753294 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m00:56:54.753790 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 00:56:54.751246 => 00:56:54.753632
[0m00:56:54.754015 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.pricing_summary_report
[0m00:56:54.772829 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m00:56:54.774469 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.pricing_summary_report"
[0m00:56:54.774769 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.pricing_summary_report"} */

  
    

    create table "lakehouse"."dbt"."pricing_summary_report"
      
      
    as (
      /*
1 Q1 - Pricing Summary Report Query
This query reports the amount of business that was billed, shipped, and returned. 
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 29)
*/

select 
    f.return_status_code,
    f.order_line_status_code,
    sum(f.quantity) as quantity,
    sum(f.gross_item_sales_amount) as gross_item_sales_amount,
    sum(f.discounted_item_sales_amount) as discounted_item_sales_amount,
    sum(f.net_item_sales_amount) as net_item_sales_amount,

    avg(f.quantity) as avg_quantity,
    avg(f.base_price) as avg_base_price,
    avg(f.discount_percentage) as avg_discount_percentage,

    sum(f.order_item_count) as order_item_count
    
from
    "lakehouse"."dbt"."fct_orders_items" f
where
    f.ship_date <= CAST(1998-12-01 AS DATE) - INTERVAL '90' DAY 
group by
    1,2
    )
[0m00:56:54.774992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:56:55.149096 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231218_080317_00049_ijqrb
[0m00:56:55.150150 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 33:20: Cannot cast integer to date", query_id=20231218_080317_00049_ijqrb)
[0m00:56:55.151379 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (execute): 00:56:54.754135 => 00:56:55.150886
[0m00:56:55.151689 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: ROLLBACK
[0m00:56:55.151888 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: Close
[0m00:56:55.154285 [debug] [Thread-1 (]: Database Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 33:20: Cannot cast integer to date", query_id=20231218_080317_00049_ijqrb)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/pricing_summary_report.sql
[0m00:56:55.155268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daa96cb3-9d58-4b94-bd57-d057aaf3ee78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cbc8f8d50>]}
[0m00:56:55.155660 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.40s]
[0m00:56:55.156061 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m00:56:55.157888 [debug] [MainThread]: On master: COMMIT
[0m00:56:55.158277 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:56:55.158445 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m00:56:55.158618 [info ] [MainThread]: 
[0m00:56:55.158839 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.89 seconds (2.89s).
[0m00:56:55.159338 [debug] [MainThread]: Command end result
[0m00:56:55.166676 [info ] [MainThread]: 
[0m00:56:55.167075 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:56:55.167365 [info ] [MainThread]: 
[0m00:56:55.167606 [error] [MainThread]:   Database Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 33:20: Cannot cast integer to date", query_id=20231218_080317_00049_ijqrb)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/pricing_summary_report.sql
[0m00:56:55.167845 [info ] [MainThread]: 
[0m00:56:55.168145 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:56:55.168805 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.2389717, "process_user_time": 1.460777, "process_kernel_time": 0.065547, "process_mem_max_rss": "115124", "process_out_blocks": "3528", "command_success": false, "process_in_blocks": "0"}
[0m00:56:55.169134 [debug] [MainThread]: Command `dbt run` failed at 00:56:55.169058 after 3.24 seconds
[0m00:56:55.169363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cbd37ddd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cbcc8c790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cbcc8e650>]}
[0m00:56:55.169581 [debug] [MainThread]: Flushing usage events
[0m00:57:57.431145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c454be150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c454e3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c454bc110>]}


============================== 00:57:57.432893 | 2974bc62-d432-4600-a2b1-d108ba641ebe ==============================
[0m00:57:57.432893 [info ] [MainThread]: Running with dbt=1.7.3
[0m00:57:57.433282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models pricing_summary_report.sql', 'send_anonymous_usage_stats': 'True'}
[0m00:57:57.555679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2974bc62-d432-4600-a2b1-d108ba641ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c454cd0d0>]}
[0m00:57:57.609855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2974bc62-d432-4600-a2b1-d108ba641ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c45216d50>]}
[0m00:57:57.610322 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m00:57:57.617410 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m00:57:57.634530 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:57:57.635006 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/mart/pricing_summary_report.sql
[0m00:57:57.729061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2974bc62-d432-4600-a2b1-d108ba641ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c44eb3d10>]}
[0m00:57:57.737523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2974bc62-d432-4600-a2b1-d108ba641ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c44f00210>]}
[0m00:57:57.737872 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 536 macros, 0 groups, 0 semantic models
[0m00:57:57.738139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2974bc62-d432-4600-a2b1-d108ba641ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c44f5da50>]}
[0m00:57:57.739383 [info ] [MainThread]: 
[0m00:57:57.739946 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m00:57:57.740986 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m00:57:57.751701 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m00:57:57.751932 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m00:57:57.752104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:57:59.116182 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m00:57:59.118083 [debug] [ThreadPool]: On list_lakehouse: Close
[0m00:57:59.120429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m00:57:59.125599 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m00:57:59.125852 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m00:57:59.126327 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:58:00.107375 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m00:58:00.109755 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m00:58:00.109939 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m00:58:00.112069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2974bc62-d432-4600-a2b1-d108ba641ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c451dd750>]}
[0m00:58:00.112385 [debug] [MainThread]: On master: COMMIT
[0m00:58:00.112892 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:58:00.113184 [info ] [MainThread]: 
[0m00:58:00.115596 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m00:58:00.115992 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m00:58:00.116573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m00:58:00.116851 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m00:58:00.119287 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m00:58:00.119791 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 00:58:00.117006 => 00:58:00.119631
[0m00:58:00.120030 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.pricing_summary_report
[0m00:58:00.138141 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m00:58:00.139977 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.pricing_summary_report"
[0m00:58:00.140261 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.pricing_summary_report"} */

  
    

    create table "lakehouse"."dbt"."pricing_summary_report"
      
      
    as (
      /*
1 Q1 - Pricing Summary Report Query
This query reports the amount of business that was billed, shipped, and returned. 
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 29)
*/

select 
    f.return_status_code,
    f.order_line_status_code,
    sum(f.quantity) as quantity,
    sum(f.gross_item_sales_amount) as gross_item_sales_amount,
    sum(f.discounted_item_sales_amount) as discounted_item_sales_amount,
    sum(f.net_item_sales_amount) as net_item_sales_amount,

    avg(f.quantity) as avg_quantity,
    avg(f.base_price) as avg_base_price,
    avg(f.discount_percentage) as avg_discount_percentage,

    sum(f.order_item_count) as order_item_count
    
from
    "lakehouse"."dbt"."fct_orders_items" f
where
    f.ship_date <= CAST(1998-12-01 - INTERVAL '90' DAY AS DATE)
group by
    1,2
    )
[0m00:58:00.140486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:58:00.683962 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231218_080417_00052_ijqrb
[0m00:58:00.684356 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 33:36: Cannot apply operator: integer - interval day to second", query_id=20231218_080417_00052_ijqrb)
[0m00:58:00.684738 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (execute): 00:58:00.120155 => 00:58:00.684590
[0m00:58:00.684961 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: ROLLBACK
[0m00:58:00.685150 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: Close
[0m00:58:00.687716 [debug] [Thread-1 (]: Database Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 33:36: Cannot apply operator: integer - interval day to second", query_id=20231218_080417_00052_ijqrb)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/pricing_summary_report.sql
[0m00:58:00.688855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2974bc62-d432-4600-a2b1-d108ba641ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c44ec03d0>]}
[0m00:58:00.689353 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.57s]
[0m00:58:00.689839 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m00:58:00.692127 [debug] [MainThread]: On master: COMMIT
[0m00:58:00.692647 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:58:00.692818 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m00:58:00.693011 [info ] [MainThread]: 
[0m00:58:00.693282 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.95 seconds (2.95s).
[0m00:58:00.693855 [debug] [MainThread]: Command end result
[0m00:58:00.702874 [info ] [MainThread]: 
[0m00:58:00.703259 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:58:00.703540 [info ] [MainThread]: 
[0m00:58:00.703797 [error] [MainThread]:   Database Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 33:36: Cannot apply operator: integer - interval day to second", query_id=20231218_080417_00052_ijqrb)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/pricing_summary_report.sql
[0m00:58:00.704058 [info ] [MainThread]: 
[0m00:58:00.704330 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:58:00.705033 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.299493, "process_user_time": 1.496958, "process_kernel_time": 0.028244, "process_mem_max_rss": "115436", "process_out_blocks": "3528", "command_success": false, "process_in_blocks": "0"}
[0m00:58:00.705366 [debug] [MainThread]: Command `dbt run` failed at 00:58:00.705287 after 3.30 seconds
[0m00:58:00.705612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c452f8c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c452f8c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c49b6ec90>]}
[0m00:58:00.705826 [debug] [MainThread]: Flushing usage events
[0m01:04:19.894427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a0fe6390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a15adb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a1cfd8d0>]}


============================== 01:04:19.896213 | 722570bc-1790-49ab-8e5c-4d90d2696048 ==============================
[0m01:04:19.896213 [info ] [MainThread]: Running with dbt=1.7.3
[0m01:04:19.896580 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models pricing_summary_report.sql', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:04:20.022691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '722570bc-1790-49ab-8e5c-4d90d2696048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a1019ad0>]}
[0m01:04:20.077976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '722570bc-1790-49ab-8e5c-4d90d2696048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a10b0250>]}
[0m01:04:20.078429 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m01:04:20.086335 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m01:04:20.103605 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:04:20.104099 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/mart/pricing_summary_report.sql
[0m01:04:20.198742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '722570bc-1790-49ab-8e5c-4d90d2696048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a0b7ce10>]}
[0m01:04:20.207100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '722570bc-1790-49ab-8e5c-4d90d2696048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a0bb8ad0>]}
[0m01:04:20.207456 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 536 macros, 0 groups, 0 semantic models
[0m01:04:20.207805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '722570bc-1790-49ab-8e5c-4d90d2696048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a0cd5b10>]}
[0m01:04:20.209073 [info ] [MainThread]: 
[0m01:04:20.209662 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m01:04:20.210989 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m01:04:20.221839 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m01:04:20.222080 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m01:04:20.222263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:21.567484 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m01:04:21.570097 [debug] [ThreadPool]: On list_lakehouse: Close
[0m01:04:21.572474 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m01:04:21.578797 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m01:04:21.579016 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m01:04:21.579199 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:04:22.579147 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m01:04:22.581793 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m01:04:22.582227 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m01:04:22.585528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '722570bc-1790-49ab-8e5c-4d90d2696048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a0d5cb10>]}
[0m01:04:22.585907 [debug] [MainThread]: On master: COMMIT
[0m01:04:22.586352 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:04:22.586617 [info ] [MainThread]: 
[0m01:04:22.589033 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m01:04:22.589397 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m01:04:22.589934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m01:04:22.590260 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m01:04:22.592475 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m01:04:22.592943 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 01:04:22.590408 => 01:04:22.592789
[0m01:04:22.593177 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.pricing_summary_report
[0m01:04:22.611739 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m01:04:22.613995 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.pricing_summary_report"
[0m01:04:22.614307 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.pricing_summary_report"} */

  
    

    create table "lakehouse"."dbt"."pricing_summary_report"
      
      
    as (
      /*
1 Q1 - Pricing Summary Report Query
This query reports the amount of business that was billed, shipped, and returned. 
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 29)
*/

select 
    f.return_status_code,
    f.order_line_status_code,
    sum(f.quantity) as quantity,
    sum(f.gross_item_sales_amount) as gross_item_sales_amount,
    sum(f.discounted_item_sales_amount) as discounted_item_sales_amount,
    sum(f.net_item_sales_amount) as net_item_sales_amount,

    avg(f.quantity) as avg_quantity,
    avg(f.base_price) as avg_base_price,
    avg(f.discount_percentage) as avg_discount_percentage,

    sum(f.order_item_count) as order_item_count
    
from
    "lakehouse"."dbt"."fct_orders_items" f
where
    f.ship_date <= CAST(1998-12-01 AS DATE) - CAST('90' AS INTERVAL DAY)
group by
    1,2
    )
[0m01:04:22.614532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:23.108725 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231218_081010_00055_ijqrb
[0m01:04:23.109672 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 33:20: Cannot cast integer to date", query_id=20231218_081010_00055_ijqrb)
[0m01:04:23.110014 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (execute): 01:04:22.593318 => 01:04:23.109878
[0m01:04:23.110229 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: ROLLBACK
[0m01:04:23.110414 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: Close
[0m01:04:23.113180 [debug] [Thread-1 (]: Database Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 33:20: Cannot cast integer to date", query_id=20231218_081010_00055_ijqrb)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/pricing_summary_report.sql
[0m01:04:23.114139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '722570bc-1790-49ab-8e5c-4d90d2696048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff98b92e2d0>]}
[0m01:04:23.114528 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.52s]
[0m01:04:23.114956 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m01:04:23.116644 [debug] [MainThread]: On master: COMMIT
[0m01:04:23.117097 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:04:23.117263 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m01:04:23.117431 [info ] [MainThread]: 
[0m01:04:23.117654 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.91 seconds (2.91s).
[0m01:04:23.118195 [debug] [MainThread]: Command end result
[0m01:04:23.125093 [info ] [MainThread]: 
[0m01:04:23.125518 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:04:23.125843 [info ] [MainThread]: 
[0m01:04:23.126239 [error] [MainThread]:   Database Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 33:20: Cannot cast integer to date", query_id=20231218_081010_00055_ijqrb)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/pricing_summary_report.sql
[0m01:04:23.126488 [info ] [MainThread]: 
[0m01:04:23.126753 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m01:04:23.127422 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.2588172, "process_user_time": 1.456687, "process_kernel_time": 0.108572, "process_mem_max_rss": "115672", "process_out_blocks": "3536", "command_success": false, "process_in_blocks": "0"}
[0m01:04:23.127739 [debug] [MainThread]: Command `dbt run` failed at 01:04:23.127665 after 3.26 seconds
[0m01:04:23.127970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a11964d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a119e690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a0fe5e10>]}
[0m01:04:23.128181 [debug] [MainThread]: Flushing usage events
[0m01:05:25.294805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12a3eb2310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12a3eb1390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12a3eb1e10>]}


============================== 01:05:25.296556 | c9540770-55e8-4653-bb39-2e2cbdbd9b4c ==============================
[0m01:05:25.296556 [info ] [MainThread]: Running with dbt=1.7.3
[0m01:05:25.296939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models pricing_summary_report.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:05:25.421195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9540770-55e8-4653-bb39-2e2cbdbd9b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12a3c6f990>]}
[0m01:05:25.475830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9540770-55e8-4653-bb39-2e2cbdbd9b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12a3e0a610>]}
[0m01:05:25.476272 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m01:05:25.483618 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m01:05:25.500671 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:05:25.501152 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/mart/pricing_summary_report.sql
[0m01:05:25.594837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9540770-55e8-4653-bb39-2e2cbdbd9b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12a3b80f90>]}
[0m01:05:25.603174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9540770-55e8-4653-bb39-2e2cbdbd9b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12a2729010>]}
[0m01:05:25.603555 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 536 macros, 0 groups, 0 semantic models
[0m01:05:25.603827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9540770-55e8-4653-bb39-2e2cbdbd9b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12a393d950>]}
[0m01:05:25.605003 [info ] [MainThread]: 
[0m01:05:25.605655 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m01:05:25.606586 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m01:05:25.617672 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m01:05:25.617962 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m01:05:25.618141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:05:26.961872 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m01:05:26.964724 [debug] [ThreadPool]: On list_lakehouse: Close
[0m01:05:26.966952 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m01:05:26.973573 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m01:05:26.973918 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m01:05:26.974236 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:05:28.303540 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m01:05:28.306875 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m01:05:28.307569 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m01:05:28.310193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9540770-55e8-4653-bb39-2e2cbdbd9b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12a3a6cd90>]}
[0m01:05:28.310528 [debug] [MainThread]: On master: COMMIT
[0m01:05:28.310920 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:05:28.311152 [info ] [MainThread]: 
[0m01:05:28.313635 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m01:05:28.314002 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m01:05:28.314564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m01:05:28.314838 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m01:05:28.317002 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m01:05:28.317398 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 01:05:28.314984 => 01:05:28.317256
[0m01:05:28.317625 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.pricing_summary_report
[0m01:05:28.336784 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m01:05:28.338944 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.pricing_summary_report"
[0m01:05:28.339268 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.pricing_summary_report"} */

  
    

    create table "lakehouse"."dbt"."pricing_summary_report"
      
      
    as (
      /*
1 Q1 - Pricing Summary Report Query
This query reports the amount of business that was billed, shipped, and returned. 
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 29)
*/

select 
    f.return_status_code,
    f.order_line_status_code,
    sum(f.quantity) as quantity,
    sum(f.gross_item_sales_amount) as gross_item_sales_amount,
    sum(f.discounted_item_sales_amount) as discounted_item_sales_amount,
    sum(f.net_item_sales_amount) as net_item_sales_amount,

    avg(f.quantity) as avg_quantity,
    avg(f.base_price) as avg_base_price,
    avg(f.discount_percentage) as avg_discount_percentage,

    sum(f.order_item_count) as order_item_count
    
from
    "lakehouse"."dbt"."fct_orders_items" f
where
    f.ship_date <= date_parse('1998-12-01', '%Y-%m-%d') - CAST('90' AS INTERVAL DAY)
group by
    1,2
    )
[0m01:05:28.339492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:05:28.897921 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231218_081111_00058_ijqrb
[0m01:05:28.898884 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="INTERVAL DAY TO DAY type not supported", query_id=20231218_081111_00058_ijqrb)
[0m01:05:28.900177 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (execute): 01:05:28.317753 => 01:05:28.899619
[0m01:05:28.900986 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: ROLLBACK
[0m01:05:28.901435 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: Close
[0m01:05:28.904291 [debug] [Thread-1 (]: Database Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="INTERVAL DAY TO DAY type not supported", query_id=20231218_081111_00058_ijqrb)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/pricing_summary_report.sql
[0m01:05:28.905244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9540770-55e8-4653-bb39-2e2cbdbd9b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12a38a0e90>]}
[0m01:05:28.905634 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.59s]
[0m01:05:28.906068 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m01:05:28.907607 [debug] [MainThread]: On master: COMMIT
[0m01:05:28.907989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:05:28.908155 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m01:05:28.908330 [info ] [MainThread]: 
[0m01:05:28.908548 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.30 seconds (3.30s).
[0m01:05:28.909058 [debug] [MainThread]: Command end result
[0m01:05:28.916055 [info ] [MainThread]: 
[0m01:05:28.916483 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:05:28.916788 [info ] [MainThread]: 
[0m01:05:28.917024 [error] [MainThread]:   Database Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="INTERVAL DAY TO DAY type not supported", query_id=20231218_081111_00058_ijqrb)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/pricing_summary_report.sql
[0m01:05:28.917260 [info ] [MainThread]: 
[0m01:05:28.917534 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m01:05:28.918146 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.648623, "process_user_time": 1.458876, "process_kernel_time": 0.084708, "process_mem_max_rss": "113192", "process_out_blocks": "3536", "command_success": false, "process_in_blocks": "0"}
[0m01:05:28.918477 [debug] [MainThread]: Command `dbt run` failed at 01:05:28.918400 after 3.65 seconds
[0m01:05:28.918707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12a3e9e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12a4581dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12a3e09750>]}
[0m01:05:28.918920 [debug] [MainThread]: Flushing usage events
[0m01:06:30.934004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c073510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c722690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c0732d0>]}


============================== 01:06:30.935811 | e52a449f-a7d2-4fb7-bbc8-40b04731e31d ==============================
[0m01:06:30.935811 [info ] [MainThread]: Running with dbt=1.7.3
[0m01:06:30.936216 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models pricing_summary_report.sql', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:06:31.058993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e52a449f-a7d2-4fb7-bbc8-40b04731e31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c018790>]}
[0m01:06:31.114774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e52a449f-a7d2-4fb7-bbc8-40b04731e31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6be7e510>]}
[0m01:06:31.115258 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m01:06:31.122487 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m01:06:31.139566 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:06:31.140100 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/mart/pricing_summary_report.sql
[0m01:06:31.234886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e52a449f-a7d2-4fb7-bbc8-40b04731e31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6bdb9550>]}
[0m01:06:31.243188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e52a449f-a7d2-4fb7-bbc8-40b04731e31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6bcb6010>]}
[0m01:06:31.243547 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 536 macros, 0 groups, 0 semantic models
[0m01:06:31.243840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e52a449f-a7d2-4fb7-bbc8-40b04731e31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6bdaec50>]}
[0m01:06:31.245007 [info ] [MainThread]: 
[0m01:06:31.245587 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m01:06:31.246501 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m01:06:31.257212 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m01:06:31.257486 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m01:06:31.257738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:06:33.056864 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m01:06:33.057897 [debug] [ThreadPool]: On list_lakehouse: Close
[0m01:06:33.060582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m01:06:33.066074 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m01:06:33.066326 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m01:06:33.066533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:06:34.270590 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m01:06:34.273135 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m01:06:34.273606 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m01:06:34.276989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e52a449f-a7d2-4fb7-bbc8-40b04731e31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6bf3a710>]}
[0m01:06:34.277323 [debug] [MainThread]: On master: COMMIT
[0m01:06:34.277781 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:06:34.278040 [info ] [MainThread]: 
[0m01:06:34.280431 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m01:06:34.280794 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m01:06:34.281285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m01:06:34.281608 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m01:06:34.283834 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m01:06:34.284317 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 01:06:34.281738 => 01:06:34.284144
[0m01:06:34.284541 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.pricing_summary_report
[0m01:06:34.303630 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m01:06:34.305367 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.pricing_summary_report"
[0m01:06:34.305666 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.pricing_summary_report"} */

  
    

    create table "lakehouse"."dbt"."pricing_summary_report"
      
      
    as (
      /*
1 Q1 - Pricing Summary Report Query
This query reports the amount of business that was billed, shipped, and returned. 
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 29)
*/

select 
    f.return_status_code,
    f.order_line_status_code,
    sum(f.quantity) as quantity,
    sum(f.gross_item_sales_amount) as gross_item_sales_amount,
    sum(f.discounted_item_sales_amount) as discounted_item_sales_amount,
    sum(f.net_item_sales_amount) as net_item_sales_amount,

    avg(f.quantity) as avg_quantity,
    avg(f.base_price) as avg_base_price,
    avg(f.discount_percentage) as avg_discount_percentage,

    sum(f.order_item_count) as order_item_count
    
from
    "lakehouse"."dbt"."fct_orders_items" f
where
    f.ship_date <= date_add(date_parse('1998-12-01', '%Y-%m-%d'), -90)
group by
    1,2
    )
[0m01:06:34.305887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:34.806738 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231218_081212_00061_ijqrb
[0m01:06:34.807652 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=FUNCTION_NOT_FOUND, message="line 33:20: Unexpected parameters (timestamp(3), integer) for function date_add. Expected: date_add(varchar(x), bigint, date), date_add(varchar(x), bigint, timestamp(p)), date_add(varchar(x), bigint, timestamp(p) with time zone), date_add(varchar(x), bigint, time(p)), date_add(varchar(x), bigint, time(p) with time zone)", query_id=20231218_081212_00061_ijqrb)
[0m01:06:34.808649 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (execute): 01:06:34.284656 => 01:06:34.808328
[0m01:06:34.808876 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: ROLLBACK
[0m01:06:34.809087 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: Close
[0m01:06:34.811515 [debug] [Thread-1 (]: Database Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  TrinoUserError(type=USER_ERROR, name=FUNCTION_NOT_FOUND, message="line 33:20: Unexpected parameters (timestamp(3), integer) for function date_add. Expected: date_add(varchar(x), bigint, date), date_add(varchar(x), bigint, timestamp(p)), date_add(varchar(x), bigint, timestamp(p) with time zone), date_add(varchar(x), bigint, time(p)), date_add(varchar(x), bigint, time(p) with time zone)", query_id=20231218_081212_00061_ijqrb)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/pricing_summary_report.sql
[0m01:06:34.812666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e52a449f-a7d2-4fb7-bbc8-40b04731e31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6bee3110>]}
[0m01:06:34.813106 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.53s]
[0m01:06:34.813559 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m01:06:34.815179 [debug] [MainThread]: On master: COMMIT
[0m01:06:34.815577 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:06:34.815747 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m01:06:34.815921 [info ] [MainThread]: 
[0m01:06:34.816140 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.57 seconds (3.57s).
[0m01:06:34.816654 [debug] [MainThread]: Command end result
[0m01:06:34.823792 [info ] [MainThread]: 
[0m01:06:34.824180 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:06:34.824480 [info ] [MainThread]: 
[0m01:06:34.824837 [error] [MainThread]:   Database Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  TrinoUserError(type=USER_ERROR, name=FUNCTION_NOT_FOUND, message="line 33:20: Unexpected parameters (timestamp(3), integer) for function date_add. Expected: date_add(varchar(x), bigint, date), date_add(varchar(x), bigint, timestamp(p)), date_add(varchar(x), bigint, timestamp(p) with time zone), date_add(varchar(x), bigint, time(p)), date_add(varchar(x), bigint, time(p) with time zone)", query_id=20231218_081212_00061_ijqrb)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/pricing_summary_report.sql
[0m01:06:34.825165 [info ] [MainThread]: 
[0m01:06:34.825439 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m01:06:34.826066 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.9170387, "process_user_time": 1.472711, "process_kernel_time": 0.065662, "process_mem_max_rss": "115392", "process_out_blocks": "3536", "command_success": false, "process_in_blocks": "0"}
[0m01:06:34.826388 [debug] [MainThread]: Command `dbt run` failed at 01:06:34.826315 after 3.92 seconds
[0m01:06:34.826612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c2328d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c232f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c232210>]}
[0m01:06:34.826825 [debug] [MainThread]: Flushing usage events
[0m01:07:57.125422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86929d5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8692e64bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86929b7c50>]}


============================== 01:07:57.127311 | 398d12fb-5a9d-4f8c-ad7c-12c42c1be42d ==============================
[0m01:07:57.127311 [info ] [MainThread]: Running with dbt=1.7.3
[0m01:07:57.127737 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models pricing_summary_report.sql', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:07:57.253085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '398d12fb-5a9d-4f8c-ad7c-12c42c1be42d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869275e290>]}
[0m01:07:57.307645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '398d12fb-5a9d-4f8c-ad7c-12c42c1be42d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869275c9d0>]}
[0m01:07:57.308171 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m01:07:57.315524 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m01:07:57.332361 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:07:57.332861 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/mart/pricing_summary_report.sql
[0m01:07:57.425357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '398d12fb-5a9d-4f8c-ad7c-12c42c1be42d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86925ecb10>]}
[0m01:07:57.433328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '398d12fb-5a9d-4f8c-ad7c-12c42c1be42d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8692614550>]}
[0m01:07:57.433683 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 536 macros, 0 groups, 0 semantic models
[0m01:07:57.433954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '398d12fb-5a9d-4f8c-ad7c-12c42c1be42d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8692465d10>]}
[0m01:07:57.435233 [info ] [MainThread]: 
[0m01:07:57.435846 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m01:07:57.436769 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m01:07:57.447461 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m01:07:57.447698 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m01:07:57.447871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:07:58.902323 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m01:07:58.903284 [debug] [ThreadPool]: On list_lakehouse: Close
[0m01:07:58.905449 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m01:07:58.910636 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m01:07:58.910884 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m01:07:58.911104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:07:59.257199 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m01:07:59.259705 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m01:07:59.259891 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m01:07:59.262176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '398d12fb-5a9d-4f8c-ad7c-12c42c1be42d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86925c4b50>]}
[0m01:07:59.262465 [debug] [MainThread]: On master: COMMIT
[0m01:07:59.262861 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:07:59.263108 [info ] [MainThread]: 
[0m01:07:59.266311 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m01:07:59.266671 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m01:07:59.267201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m01:07:59.267466 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m01:07:59.269945 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m01:07:59.270366 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 01:07:59.267602 => 01:07:59.270219
[0m01:07:59.270587 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.pricing_summary_report
[0m01:07:59.289439 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m01:07:59.291168 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.pricing_summary_report"
[0m01:07:59.291458 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.pricing_summary_report"} */

  
    

    create table "lakehouse"."dbt"."pricing_summary_report"
      
      
    as (
      /*
1 Q1 - Pricing Summary Report Query
This query reports the amount of business that was billed, shipped, and returned. 
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 29)
*/

select 
    f.return_status_code,
    f.order_line_status_code,
    sum(f.quantity) as quantity,
    sum(f.gross_item_sales_amount) as gross_item_sales_amount,
    sum(f.discounted_item_sales_amount) as discounted_item_sales_amount,
    sum(f.net_item_sales_amount) as net_item_sales_amount,

    avg(f.quantity) as avg_quantity,
    avg(f.base_price) as avg_base_price,
    avg(f.discount_percentage) as avg_discount_percentage,

    sum(f.order_item_count) as order_item_count
    
from
    "lakehouse"."dbt"."fct_orders_items" f
where
    f.ship_date <= date_add(date_parse('1998-12-01', '%Y-%m-%d'), -90, 'day')
group by
    1,2
    )
[0m01:07:59.291685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:07:59.801260 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20231218_081330_00064_ijqrb
[0m01:07:59.802331 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=FUNCTION_NOT_FOUND, message="line 33:20: Unexpected parameters (timestamp(3), integer, varchar(3)) for function date_add. Expected: date_add(varchar(x), bigint, date), date_add(varchar(x), bigint, timestamp(p)), date_add(varchar(x), bigint, timestamp(p) with time zone), date_add(varchar(x), bigint, time(p)), date_add(varchar(x), bigint, time(p) with time zone)", query_id=20231218_081330_00064_ijqrb)
[0m01:07:59.803415 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (execute): 01:07:59.270708 => 01:07:59.803062
[0m01:07:59.803960 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: ROLLBACK
[0m01:07:59.804504 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: Close
[0m01:07:59.808763 [debug] [Thread-1 (]: Database Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  TrinoUserError(type=USER_ERROR, name=FUNCTION_NOT_FOUND, message="line 33:20: Unexpected parameters (timestamp(3), integer, varchar(3)) for function date_add. Expected: date_add(varchar(x), bigint, date), date_add(varchar(x), bigint, timestamp(p)), date_add(varchar(x), bigint, timestamp(p) with time zone), date_add(varchar(x), bigint, time(p)), date_add(varchar(x), bigint, time(p) with time zone)", query_id=20231218_081330_00064_ijqrb)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/pricing_summary_report.sql
[0m01:07:59.809788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '398d12fb-5a9d-4f8c-ad7c-12c42c1be42d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f869270c7d0>]}
[0m01:07:59.810180 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.54s]
[0m01:07:59.810606 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m01:07:59.812620 [debug] [MainThread]: On master: COMMIT
[0m01:07:59.813277 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:07:59.813475 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m01:07:59.813660 [info ] [MainThread]: 
[0m01:07:59.813896 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.38 seconds (2.38s).
[0m01:07:59.814378 [debug] [MainThread]: Command end result
[0m01:07:59.821435 [info ] [MainThread]: 
[0m01:07:59.821836 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:07:59.822190 [info ] [MainThread]: 
[0m01:07:59.822466 [error] [MainThread]:   Database Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  TrinoUserError(type=USER_ERROR, name=FUNCTION_NOT_FOUND, message="line 33:20: Unexpected parameters (timestamp(3), integer, varchar(3)) for function date_add. Expected: date_add(varchar(x), bigint, date), date_add(varchar(x), bigint, timestamp(p)), date_add(varchar(x), bigint, timestamp(p) with time zone), date_add(varchar(x), bigint, time(p)), date_add(varchar(x), bigint, time(p) with time zone)", query_id=20231218_081330_00064_ijqrb)
  compiled Code at target/run/dbt_trino_iceberg/models/mart/pricing_summary_report.sql
[0m01:07:59.822745 [info ] [MainThread]: 
[0m01:07:59.823043 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m01:07:59.823672 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.7265253, "process_user_time": 1.426444, "process_kernel_time": 0.075076, "process_mem_max_rss": "114004", "process_out_blocks": "3536", "command_success": false, "process_in_blocks": "0"}
[0m01:07:59.823988 [debug] [MainThread]: Command `dbt run` failed at 01:07:59.823913 after 2.73 seconds
[0m01:07:59.824211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8692a069d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86929c1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8696f4f390>]}
[0m01:07:59.824430 [debug] [MainThread]: Flushing usage events
[0m01:11:16.791195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163153dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1630e9f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1630e50f10>]}


============================== 01:11:16.793025 | fe75dbaa-5695-451a-9665-0c24bd52bdad ==============================
[0m01:11:16.793025 [info ] [MainThread]: Running with dbt=1.7.3
[0m01:11:16.793396 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models pricing_summary_report.sql', 'send_anonymous_usage_stats': 'True'}
[0m01:11:16.917876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe75dbaa-5695-451a-9665-0c24bd52bdad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1630c40350>]}
[0m01:11:16.971274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe75dbaa-5695-451a-9665-0c24bd52bdad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1630c000d0>]}
[0m01:11:16.971705 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m01:11:16.978718 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m01:11:16.995306 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:11:16.995825 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/mart/pricing_summary_report.sql
[0m01:11:17.088337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe75dbaa-5695-451a-9665-0c24bd52bdad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1630b656d0>]}
[0m01:11:17.096638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe75dbaa-5695-451a-9665-0c24bd52bdad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1630b55d10>]}
[0m01:11:17.096985 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 536 macros, 0 groups, 0 semantic models
[0m01:11:17.097319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe75dbaa-5695-451a-9665-0c24bd52bdad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1630e9fa50>]}
[0m01:11:17.098488 [info ] [MainThread]: 
[0m01:11:17.099070 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m01:11:17.099930 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m01:11:17.110765 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m01:11:17.110993 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m01:11:17.111167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:11:18.664043 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m01:11:18.666742 [debug] [ThreadPool]: On list_lakehouse: Close
[0m01:11:18.670399 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m01:11:18.676022 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m01:11:18.676448 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m01:11:18.676712 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:11:20.027724 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m01:11:20.030837 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m01:11:20.031487 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m01:11:20.034022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe75dbaa-5695-451a-9665-0c24bd52bdad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16308f8c90>]}
[0m01:11:20.034332 [debug] [MainThread]: On master: COMMIT
[0m01:11:20.034811 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:11:20.035089 [info ] [MainThread]: 
[0m01:11:20.037784 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m01:11:20.038132 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m01:11:20.038637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m01:11:20.038914 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m01:11:20.042156 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m01:11:20.042621 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 01:11:20.039055 => 01:11:20.042451
[0m01:11:20.042875 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.pricing_summary_report
[0m01:11:20.061189 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m01:11:20.063098 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.pricing_summary_report"
[0m01:11:20.063387 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.pricing_summary_report"} */

  
    

    create table "lakehouse"."dbt"."pricing_summary_report"
      
      
    as (
      /*
1 Q1 - Pricing Summary Report Query
This query reports the amount of business that was billed, shipped, and returned. 
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 29)
*/

select 
    f.return_status_code,
    f.order_line_status_code,
    sum(f.quantity) as quantity,
    sum(f.gross_item_sales_amount) as gross_item_sales_amount,
    sum(f.discounted_item_sales_amount) as discounted_item_sales_amount,
    sum(f.net_item_sales_amount) as net_item_sales_amount,

    avg(f.quantity) as avg_quantity,
    avg(f.base_price) as avg_base_price,
    avg(f.discount_percentage) as avg_discount_percentage,

    sum(f.order_item_count) as order_item_count
    
from
    "lakehouse"."dbt"."fct_orders_items" f
where
    f.ship_date <= date_add('day', -90, date_parse('1998-12-01', '%Y-%m-%d'))
group by
    1,2
    )
[0m01:11:20.063607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:23.433501 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.0 seconds
[0m01:11:23.445931 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (execute): 01:11:20.043014 => 01:11:23.445783
[0m01:11:23.446189 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: ROLLBACK
[0m01:11:23.446389 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: Close
[0m01:11:23.447518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe75dbaa-5695-451a-9665-0c24bd52bdad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16308ad250>]}
[0m01:11:23.447901 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt.pricing_summary_report ................... [[32mSUCCESS[0m in 3.41s]
[0m01:11:23.448307 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m01:11:23.449724 [debug] [MainThread]: On master: COMMIT
[0m01:11:23.450130 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:11:23.450299 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m01:11:23.450476 [info ] [MainThread]: 
[0m01:11:23.450689 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.35 seconds (6.35s).
[0m01:11:23.451191 [debug] [MainThread]: Command end result
[0m01:11:23.458237 [info ] [MainThread]: 
[0m01:11:23.458665 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:11:23.458995 [info ] [MainThread]: 
[0m01:11:23.459298 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:11:23.459942 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.694224, "process_user_time": 1.5926, "process_kernel_time": 0.065965, "process_mem_max_rss": "114988", "process_out_blocks": "3536", "process_in_blocks": "0"}
[0m01:11:23.460268 [debug] [MainThread]: Command `dbt run` succeeded at 01:11:23.460192 after 6.69 seconds
[0m01:11:23.460481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16312f8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16354b5110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16353c7650>]}
[0m01:11:23.460689 [debug] [MainThread]: Flushing usage events
[0m07:00:20.821310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27258485d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27258287d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2725828a10>]}


============================== 07:00:20.824737 | 42ebeb4e-1f4c-48cf-aa1f-4ad6589e916f ==============================
[0m07:00:20.824737 [info ] [MainThread]: Running with dbt=1.7.3
[0m07:00:20.825237 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models /models/staging/stg_tpch_orders.sql', 'send_anonymous_usage_stats': 'True'}
[0m07:00:20.962780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42ebeb4e-1f4c-48cf-aa1f-4ad6589e916f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2725607950>]}
[0m07:00:21.018164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42ebeb4e-1f4c-48cf-aa1f-4ad6589e916f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27255cd3d0>]}
[0m07:00:21.018792 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m07:00:21.026632 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m07:00:21.055420 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:00:21.056048 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/staging/stg_tpch_orders.sql
[0m07:00:21.158311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42ebeb4e-1f4c-48cf-aa1f-4ad6589e916f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27255f3e50>]}
[0m07:00:21.171514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42ebeb4e-1f4c-48cf-aa1f-4ad6589e916f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f272558cc10>]}
[0m07:00:21.171911 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 536 macros, 0 groups, 0 semantic models
[0m07:00:21.172766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42ebeb4e-1f4c-48cf-aa1f-4ad6589e916f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27256a7d50>]}
[0m07:00:21.173305 [error] [MainThread]: Encountered an error:
Non-relative patterns are unsupported
[0m07:00:21.179405 [error] [MainThread]: Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 75, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 197, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 244, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 284, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/runnable.py", line 454, in run
    self._runtime_initialize()
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/compile.py", line 147, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/runnable.py", line 147, in _runtime_initialize
    self.job_queue = self.get_graph_queue()
                     ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/runnable.py", line 140, in get_graph_queue
    return selector.get_graph_queue(spec)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 318, in get_graph_queue
    selected_nodes = self.get_selected(spec)
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 309, in get_selected
    selected_nodes, indirect_only = self.select_nodes(spec)
                                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 158, in select_nodes
    direct_nodes, indirect_nodes = self.select_nodes_recursively(spec)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in select_nodes_recursively
    bundles = [self.select_nodes_recursively(component) for component in spec]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in <listcomp>
    bundles = [self.select_nodes_recursively(component) for component in spec]
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in select_nodes_recursively
    bundles = [self.select_nodes_recursively(component) for component in spec]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in <listcomp>
    bundles = [self.select_nodes_recursively(component) for component in spec]
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in select_nodes_recursively
    bundles = [self.select_nodes_recursively(component) for component in spec]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in <listcomp>
    bundles = [self.select_nodes_recursively(component) for component in spec]
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 128, in select_nodes_recursively
    direct_nodes, indirect_nodes = self.get_nodes_from_criteria(spec)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 82, in get_nodes_from_criteria
    collected = self.select_included(nodes, spec)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 68, in select_included
    return set(method.search(included_nodes, spec.value))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector_methods.py", line 413, in search
    paths = set(p.relative_to(root) for p in root.glob(selector))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector_methods.py", line 413, in <genexpr>
    paths = set(p.relative_to(root) for p in root.glob(selector))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/pathlib.py", line 949, in glob
    raise NotImplementedError("Non-relative patterns are unsupported")
NotImplementedError: Non-relative patterns are unsupported

[0m07:00:21.180505 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.38676208, "process_user_time": 1.36801, "process_kernel_time": 0.480652, "process_mem_max_rss": "107624", "process_in_blocks": "192", "process_out_blocks": "2368", "command_success": false}
[0m07:00:21.180921 [debug] [MainThread]: Command `dbt run` failed at 07:00:21.180834 after 0.39 seconds
[0m07:00:21.181171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2725828790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2725518350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f272582a850>]}
[0m07:00:21.181386 [debug] [MainThread]: Flushing usage events
[0m07:06:28.376225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355e5aeb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355e5af510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355e5af2d0>]}


============================== 07:06:28.378385 | ce5a8f41-6d3d-41d9-a086-460a5e3840ca ==============================
[0m07:06:28.378385 [info ] [MainThread]: Running with dbt=1.7.3
[0m07:06:28.378772 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models ~models/staging/stg_tpch_orders.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:06:28.505039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce5a8f41-6d3d-41d9-a086-460a5e3840ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355e543d90>]}
[0m07:06:28.560737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce5a8f41-6d3d-41d9-a086-460a5e3840ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355e4dac90>]}
[0m07:06:28.561233 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m07:06:28.568489 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m07:06:28.589841 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:06:28.590132 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:06:28.594579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce5a8f41-6d3d-41d9-a086-460a5e3840ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355e5e3bd0>]}
[0m07:06:28.604065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce5a8f41-6d3d-41d9-a086-460a5e3840ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355e2d3e50>]}
[0m07:06:28.604489 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 536 macros, 0 groups, 0 semantic models
[0m07:06:28.604774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce5a8f41-6d3d-41d9-a086-460a5e3840ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355e543d90>]}
[0m07:06:28.605548 [warn ] [MainThread]: The selection criterion '~models/staging/stg_tpch_orders.sql' does not match any nodes
[0m07:06:28.606404 [info ] [MainThread]: 
[0m07:06:28.606632 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:06:28.607050 [debug] [MainThread]: Command end result
[0m07:06:28.613150 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.26280287, "process_user_time": 1.242701, "process_kernel_time": 0.156488, "process_mem_max_rss": "106260", "process_out_blocks": "2368", "process_in_blocks": "0"}
[0m07:06:28.613532 [debug] [MainThread]: Command `dbt run` succeeded at 07:06:28.613442 after 0.26 seconds
[0m07:06:28.613767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355e765950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355e765790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3562d8d0d0>]}
[0m07:06:28.613995 [debug] [MainThread]: Flushing usage events
[0m07:06:52.740168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0dc661410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0dc63fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0de02f050>]}


============================== 07:06:52.742040 | 0f71c76d-c6e2-4043-af22-505ef8ee127c ==============================
[0m07:06:52.742040 [info ] [MainThread]: Running with dbt=1.7.3
[0m07:06:52.742428 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models /home/vadim/models/staging/stg_tpch_orders.sql', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:06:52.864363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f71c76d-c6e2-4043-af22-505ef8ee127c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0dc696b50>]}
[0m07:06:52.919408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f71c76d-c6e2-4043-af22-505ef8ee127c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0dc498350>]}
[0m07:06:52.919842 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m07:06:52.927236 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m07:06:52.944253 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:06:52.944586 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:06:52.949298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f71c76d-c6e2-4043-af22-505ef8ee127c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0dc63f2d0>]}
[0m07:06:52.957918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f71c76d-c6e2-4043-af22-505ef8ee127c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0dc1c7e50>]}
[0m07:06:52.958288 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 536 macros, 0 groups, 0 semantic models
[0m07:06:52.958564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f71c76d-c6e2-4043-af22-505ef8ee127c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0dc35bcd0>]}
[0m07:06:52.959168 [error] [MainThread]: Encountered an error:
Non-relative patterns are unsupported
[0m07:06:52.960964 [error] [MainThread]: Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 75, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 197, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 244, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 284, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/runnable.py", line 454, in run
    self._runtime_initialize()
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/compile.py", line 147, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/runnable.py", line 147, in _runtime_initialize
    self.job_queue = self.get_graph_queue()
                     ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/runnable.py", line 140, in get_graph_queue
    return selector.get_graph_queue(spec)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 318, in get_graph_queue
    selected_nodes = self.get_selected(spec)
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 309, in get_selected
    selected_nodes, indirect_only = self.select_nodes(spec)
                                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 158, in select_nodes
    direct_nodes, indirect_nodes = self.select_nodes_recursively(spec)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in select_nodes_recursively
    bundles = [self.select_nodes_recursively(component) for component in spec]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in <listcomp>
    bundles = [self.select_nodes_recursively(component) for component in spec]
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in select_nodes_recursively
    bundles = [self.select_nodes_recursively(component) for component in spec]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in <listcomp>
    bundles = [self.select_nodes_recursively(component) for component in spec]
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in select_nodes_recursively
    bundles = [self.select_nodes_recursively(component) for component in spec]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in <listcomp>
    bundles = [self.select_nodes_recursively(component) for component in spec]
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 128, in select_nodes_recursively
    direct_nodes, indirect_nodes = self.get_nodes_from_criteria(spec)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 82, in get_nodes_from_criteria
    collected = self.select_included(nodes, spec)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 68, in select_included
    return set(method.search(included_nodes, spec.value))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector_methods.py", line 413, in search
    paths = set(p.relative_to(root) for p in root.glob(selector))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector_methods.py", line 413, in <genexpr>
    paths = set(p.relative_to(root) for p in root.glob(selector))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/pathlib.py", line 949, in glob
    raise NotImplementedError("Non-relative patterns are unsupported")
NotImplementedError: Non-relative patterns are unsupported

[0m07:06:52.961855 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.24667507, "process_user_time": 1.22368, "process_kernel_time": 0.046351, "process_mem_max_rss": "105592", "process_out_blocks": "1224", "command_success": false, "process_in_blocks": "0"}
[0m07:06:52.962231 [debug] [MainThread]: Command `dbt run` failed at 07:06:52.962148 after 0.25 seconds
[0m07:06:52.962506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0dc641110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0dc642a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e0bb7710>]}
[0m07:06:52.962714 [debug] [MainThread]: Flushing usage events
[0m07:06:58.447238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51435f71d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f514343b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5143cca450>]}


============================== 07:06:58.449087 | efa7c652-aad7-4ffa-8f00-9be086186c88 ==============================
[0m07:06:58.449087 [info ] [MainThread]: Running with dbt=1.7.3
[0m07:06:58.450569 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --models /home/vadim/models/staging/stg_tpch_orders.sql', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:06:58.577353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efa7c652-aad7-4ffa-8f00-9be086186c88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51461e1c10>]}
[0m07:06:58.634351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efa7c652-aad7-4ffa-8f00-9be086186c88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f514338fad0>]}
[0m07:06:58.634840 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m07:06:58.642791 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m07:06:58.659970 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:06:58.660269 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:06:58.664811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efa7c652-aad7-4ffa-8f00-9be086186c88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5143046550>]}
[0m07:06:58.674903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efa7c652-aad7-4ffa-8f00-9be086186c88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f514316f9d0>]}
[0m07:06:58.675344 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 536 macros, 0 groups, 0 semantic models
[0m07:06:58.675637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efa7c652-aad7-4ffa-8f00-9be086186c88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51433b5050>]}
[0m07:06:58.676091 [error] [MainThread]: Encountered an error:
Non-relative patterns are unsupported
[0m07:06:58.677671 [error] [MainThread]: Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 75, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 197, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 244, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 284, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/runnable.py", line 454, in run
    self._runtime_initialize()
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/compile.py", line 147, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/runnable.py", line 147, in _runtime_initialize
    self.job_queue = self.get_graph_queue()
                     ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/runnable.py", line 140, in get_graph_queue
    return selector.get_graph_queue(spec)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 318, in get_graph_queue
    selected_nodes = self.get_selected(spec)
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 309, in get_selected
    selected_nodes, indirect_only = self.select_nodes(spec)
                                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 158, in select_nodes
    direct_nodes, indirect_nodes = self.select_nodes_recursively(spec)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in select_nodes_recursively
    bundles = [self.select_nodes_recursively(component) for component in spec]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in <listcomp>
    bundles = [self.select_nodes_recursively(component) for component in spec]
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in select_nodes_recursively
    bundles = [self.select_nodes_recursively(component) for component in spec]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in <listcomp>
    bundles = [self.select_nodes_recursively(component) for component in spec]
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in select_nodes_recursively
    bundles = [self.select_nodes_recursively(component) for component in spec]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in <listcomp>
    bundles = [self.select_nodes_recursively(component) for component in spec]
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 128, in select_nodes_recursively
    direct_nodes, indirect_nodes = self.get_nodes_from_criteria(spec)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 82, in get_nodes_from_criteria
    collected = self.select_included(nodes, spec)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 68, in select_included
    return set(method.search(included_nodes, spec.value))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector_methods.py", line 413, in search
    paths = set(p.relative_to(root) for p in root.glob(selector))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector_methods.py", line 413, in <genexpr>
    paths = set(p.relative_to(root) for p in root.glob(selector))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/pathlib.py", line 949, in glob
    raise NotImplementedError("Non-relative patterns are unsupported")
NotImplementedError: Non-relative patterns are unsupported

[0m07:06:58.678457 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.25776485, "process_user_time": 1.243277, "process_kernel_time": 0.046047, "process_mem_max_rss": "106260", "process_out_blocks": "1224", "command_success": false, "process_in_blocks": "0"}
[0m07:06:58.678831 [debug] [MainThread]: Command `dbt run` failed at 07:06:58.678743 after 0.26 seconds
[0m07:06:58.679319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5147b2b510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5147b2b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f514315ca90>]}
[0m07:06:58.679538 [debug] [MainThread]: Flushing usage events
[0m07:07:29.618509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab1a9db590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab19cb4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab19483b10>]}


============================== 07:07:29.620324 | 05176662-76df-482a-af56-12915e585e43 ==============================
[0m07:07:29.620324 [info ] [MainThread]: Running with dbt=1.7.3
[0m07:07:29.620714 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models /home/vadim/models/staging/stg_tpch_orders.sql', 'send_anonymous_usage_stats': 'True'}
[0m07:07:29.746810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05176662-76df-482a-af56-12915e585e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab19413210>]}
[0m07:07:29.801945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05176662-76df-482a-af56-12915e585e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab19286310>]}
[0m07:07:29.802464 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m07:07:29.809618 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m07:07:29.826841 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:07:29.827192 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:07:29.832064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05176662-76df-482a-af56-12915e585e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab1916da10>]}
[0m07:07:29.840471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05176662-76df-482a-af56-12915e585e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab191af610>]}
[0m07:07:29.840814 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 536 macros, 0 groups, 0 semantic models
[0m07:07:29.841085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05176662-76df-482a-af56-12915e585e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab19350c10>]}
[0m07:07:29.841556 [error] [MainThread]: Encountered an error:
Non-relative patterns are unsupported
[0m07:07:29.843101 [error] [MainThread]: Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 75, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 197, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 244, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 284, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/runnable.py", line 454, in run
    self._runtime_initialize()
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/compile.py", line 147, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/runnable.py", line 147, in _runtime_initialize
    self.job_queue = self.get_graph_queue()
                     ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/runnable.py", line 140, in get_graph_queue
    return selector.get_graph_queue(spec)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 318, in get_graph_queue
    selected_nodes = self.get_selected(spec)
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 309, in get_selected
    selected_nodes, indirect_only = self.select_nodes(spec)
                                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 158, in select_nodes
    direct_nodes, indirect_nodes = self.select_nodes_recursively(spec)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in select_nodes_recursively
    bundles = [self.select_nodes_recursively(component) for component in spec]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in <listcomp>
    bundles = [self.select_nodes_recursively(component) for component in spec]
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in select_nodes_recursively
    bundles = [self.select_nodes_recursively(component) for component in spec]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in <listcomp>
    bundles = [self.select_nodes_recursively(component) for component in spec]
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in select_nodes_recursively
    bundles = [self.select_nodes_recursively(component) for component in spec]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in <listcomp>
    bundles = [self.select_nodes_recursively(component) for component in spec]
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 128, in select_nodes_recursively
    direct_nodes, indirect_nodes = self.get_nodes_from_criteria(spec)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 82, in get_nodes_from_criteria
    collected = self.select_included(nodes, spec)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 68, in select_included
    return set(method.search(included_nodes, spec.value))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector_methods.py", line 413, in search
    paths = set(p.relative_to(root) for p in root.glob(selector))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector_methods.py", line 413, in <genexpr>
    paths = set(p.relative_to(root) for p in root.glob(selector))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/pathlib.py", line 949, in glob
    raise NotImplementedError("Non-relative patterns are unsupported")
NotImplementedError: Non-relative patterns are unsupported

[0m07:07:29.843941 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.25067645, "process_user_time": 1.210786, "process_kernel_time": 0.064698, "process_mem_max_rss": "106336", "process_out_blocks": "1232", "command_success": false, "process_in_blocks": "0"}
[0m07:07:29.844407 [debug] [MainThread]: Command `dbt run` failed at 07:07:29.844299 after 0.25 seconds
[0m07:07:29.844750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab1962b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab1962a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab1962b050>]}
[0m07:07:29.845070 [debug] [MainThread]: Flushing usage events
[0m07:08:50.576720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9cbb6950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9cb92190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9cb90f50>]}


============================== 07:08:50.578722 | e7654909-72cf-4493-9da0-d3ff9534c8e7 ==============================
[0m07:08:50.578722 [info ] [MainThread]: Running with dbt=1.7.3
[0m07:08:50.579093 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models stg_tpch_orders.sql', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:08:50.704552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7654909-72cf-4493-9da0-d3ff9534c8e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9c915690>]}
[0m07:08:50.760647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7654909-72cf-4493-9da0-d3ff9534c8e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9cae58d0>]}
[0m07:08:50.761180 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m07:08:50.768740 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m07:08:50.787653 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:08:50.787998 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:08:50.792567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7654909-72cf-4493-9da0-d3ff9534c8e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9ca7b6d0>]}
[0m07:08:50.801501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7654909-72cf-4493-9da0-d3ff9534c8e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9c8e7ed0>]}
[0m07:08:50.801848 [info ] [MainThread]: Found 15 models, 8 sources, 0 exposures, 0 metrics, 536 macros, 0 groups, 0 semantic models
[0m07:08:50.802140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7654909-72cf-4493-9da0-d3ff9534c8e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9cb85d10>]}
[0m07:08:50.803367 [info ] [MainThread]: 
[0m07:08:50.804028 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m07:08:50.805130 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m07:08:50.818149 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m07:08:50.818441 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m07:08:50.818658 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:08:52.704773 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m07:08:52.707584 [debug] [ThreadPool]: On list_lakehouse: Close
[0m07:08:52.711243 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m07:08:52.717409 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m07:08:52.717656 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m07:08:52.717836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:08:54.557175 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m07:08:54.559699 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m07:08:54.559889 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m07:08:54.562184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7654909-72cf-4493-9da0-d3ff9534c8e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9c921a90>]}
[0m07:08:54.562474 [debug] [MainThread]: On master: COMMIT
[0m07:08:54.562898 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:08:54.563148 [info ] [MainThread]: 
[0m07:08:54.566218 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_orders
[0m07:08:54.566583 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.stg_tpch_orders ............................... [RUN]
[0m07:08:54.567215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.stg_tpch_orders)
[0m07:08:54.567474 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_orders
[0m07:08:54.570161 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_orders"
[0m07:08:54.570806 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_orders (compile): 07:08:54.567616 => 07:08:54.570654
[0m07:08:54.571027 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.stg_tpch_orders
[0m07:08:54.590081 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.stg_tpch_orders"
[0m07:08:54.591870 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.stg_tpch_orders"
[0m07:08:54.592204 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.stg_tpch_orders"} */

  
    

    create table "lakehouse"."dbt"."stg_tpch_orders"
      
      
    as (
      
select
    orderkey as order_key, 
    custkey as customer_key,
    orderstatus as order_status_code,
    totalprice as order_amount,
    orderdate as order_date,
    orderpriority as order_priority_code,
    clerk as order_clerk_name,
    shippriority as shipping_priority,
    comment as order_comment
from
    tpch.sf1.orders
    )
[0m07:08:54.592430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:09:10.212730 [debug] [Thread-1 (]: SQL status: SUCCESS in 16.0 seconds
[0m07:09:10.224270 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_orders (execute): 07:08:54.571148 => 07:09:10.224114
[0m07:09:10.224544 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_orders: ROLLBACK
[0m07:09:10.224742 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_orders: Close
[0m07:09:10.225883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7654909-72cf-4493-9da0-d3ff9534c8e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9c7ea710>]}
[0m07:09:10.226292 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt.stg_tpch_orders .......................... [[32mSUCCESS[0m in 15.66s]
[0m07:09:10.226702 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_orders
[0m07:09:10.228157 [debug] [MainThread]: On master: COMMIT
[0m07:09:10.228530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:09:10.228711 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.stg_tpch_orders' was properly closed.
[0m07:09:10.228891 [info ] [MainThread]: 
[0m07:09:10.229135 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 19.43 seconds (19.43s).
[0m07:09:10.229642 [debug] [MainThread]: Command end result
[0m07:09:10.235466 [info ] [MainThread]: 
[0m07:09:10.235839 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:09:10.236135 [info ] [MainThread]: 
[0m07:09:10.236430 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:09:10.237202 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.686527, "process_user_time": 1.513897, "process_kernel_time": 0.170313, "process_mem_max_rss": "110388", "process_out_blocks": "2392", "process_in_blocks": "0"}
[0m07:09:10.237628 [debug] [MainThread]: Command `dbt run` succeeded at 07:09:10.237519 after 19.69 seconds
[0m07:09:10.237892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9cbb7c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aa1107410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aa1107450>]}
[0m07:09:10.238111 [debug] [MainThread]: Flushing usage events
[0m07:25:23.343361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd345602790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3455da0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3455daf50>]}


============================== 07:25:23.345525 | f8661f5d-7aba-4c38-9377-ca95ad664708 ==============================
[0m07:25:23.345525 [info ] [MainThread]: Running with dbt=1.7.3
[0m07:25:23.345988 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m07:25:23.469569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8661f5d-7aba-4c38-9377-ca95ad664708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34534bd10>]}
[0m07:25:23.527216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8661f5d-7aba-4c38-9377-ca95ad664708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd345521a90>]}
[0m07:25:23.527754 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m07:25:23.536859 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m07:25:23.556012 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m07:25:23.556474 [debug] [MainThread]: Partial parsing: added file: dbt_trino_iceberg://snapshots/orders.sql
[0m07:25:23.659097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8661f5d-7aba-4c38-9377-ca95ad664708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3453a98d0>]}
[0m07:25:23.669724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8661f5d-7aba-4c38-9377-ca95ad664708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd345200690>]}
[0m07:25:23.670188 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 536 macros, 0 groups, 0 semantic models
[0m07:25:23.670610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8661f5d-7aba-4c38-9377-ca95ad664708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3452a7ed0>]}
[0m07:25:23.672136 [info ] [MainThread]: 
[0m07:25:23.672904 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m07:25:23.673797 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m07:25:23.685674 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m07:25:23.685998 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m07:25:23.686183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:25:25.687040 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m07:25:25.689817 [debug] [ThreadPool]: On list_lakehouse: Close
[0m07:25:25.692738 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_tpch)
[0m07:25:25.698734 [debug] [ThreadPool]: Using trino connection "list_lakehouse_tpch"
[0m07:25:25.698994 [debug] [ThreadPool]: On list_lakehouse_tpch: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_tpch"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'tpch') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'tpch'
[0m07:25:25.699177 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:25:27.285358 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m07:25:27.288845 [debug] [ThreadPool]: On list_lakehouse_tpch: ROLLBACK
[0m07:25:27.289392 [debug] [ThreadPool]: On list_lakehouse_tpch: Close
[0m07:25:27.292009 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_tpch, now list_lakehouse_dbt)
[0m07:25:27.294953 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m07:25:27.295190 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m07:25:27.295404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:25:28.566594 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m07:25:28.569239 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m07:25:28.572103 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m07:25:28.575300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8661f5d-7aba-4c38-9377-ca95ad664708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd345306b10>]}
[0m07:25:28.575865 [debug] [MainThread]: On master: COMMIT
[0m07:25:28.576467 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:25:28.576739 [info ] [MainThread]: 
[0m07:25:28.579991 [debug] [Thread-1 (]: Began running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m07:25:28.580425 [info ] [Thread-1 (]: 1 of 1 START snapshot tpch.orders_snapshot ..................................... [RUN]
[0m07:25:28.581073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now snapshot.dbt_trino_iceberg.orders_snapshot)
[0m07:25:28.581333 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_trino_iceberg.orders_snapshot
[0m07:25:28.584653 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (compile): 07:25:28.581498 => 07:25:28.584332
[0m07:25:28.585121 [debug] [Thread-1 (]: Began executing node snapshot.dbt_trino_iceberg.orders_snapshot
[0m07:25:28.624057 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m07:25:28.626161 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m07:25:28.626458 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

      
  
    

    create table "lakehouse"."tpch"."orders_snapshot"
      
      
    as (
      

    select *,
        lower(to_hex(md5(to_utf8(concat(coalesce(cast(orderkey as varchar), ''), '|',coalesce(cast(orderdate as varchar), '')))))) as dbt_scd_id,
        orderdate as dbt_updated_at,
        orderdate as dbt_valid_from,
        nullif(orderdate, orderdate) as dbt_valid_to
    from (
        



select * from tpch.sf1.orders

    ) sbq



    )
[0m07:25:28.626668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:25:41.417150 [debug] [Thread-1 (]: SQL status: SUCCESS in 13.0 seconds
[0m07:25:41.429910 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: COMMIT
[0m07:25:41.430614 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (execute): 07:25:28.585303 => 07:25:41.430479
[0m07:25:41.430851 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: Close
[0m07:25:41.432115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8661f5d-7aba-4c38-9377-ca95ad664708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34501d290>]}
[0m07:25:41.432584 [info ] [Thread-1 (]: 1 of 1 OK snapshotted tpch.orders_snapshot ..................................... [[32mSUCCESS[0m in 12.85s]
[0m07:25:41.432986 [debug] [Thread-1 (]: Finished running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m07:25:41.434705 [debug] [MainThread]: On master: COMMIT
[0m07:25:41.435113 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:25:41.435288 [debug] [MainThread]: Connection 'snapshot.dbt_trino_iceberg.orders_snapshot' was properly closed.
[0m07:25:41.435463 [info ] [MainThread]: 
[0m07:25:41.435678 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 17.76 seconds (17.76s).
[0m07:25:41.436173 [debug] [MainThread]: Command end result
[0m07:25:41.442831 [info ] [MainThread]: 
[0m07:25:41.443217 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:25:41.443531 [info ] [MainThread]: 
[0m07:25:41.443815 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:25:41.444476 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 18.127338, "process_user_time": 1.619771, "process_kernel_time": 0.208391, "process_mem_max_rss": "114168", "process_out_blocks": "3552", "process_in_blocks": "0"}
[0m07:25:41.444805 [debug] [MainThread]: Command `dbt snapshot` succeeded at 07:25:41.444729 after 18.13 seconds
[0m07:25:41.445030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd345603c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd349c351d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd349b47390>]}
[0m07:25:41.445239 [debug] [MainThread]: Flushing usage events
[0m08:37:18.642562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f264a16fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f264a18f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f264a78c890>]}


============================== 08:37:18.648240 | 6ac6c376-cdda-4c1e-b4d5-2ffe88288033 ==============================
[0m08:37:18.648240 [info ] [MainThread]: Running with dbt=1.7.3
[0m08:37:18.648690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'debug': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --debug snapshot', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:37:18.814714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ac6c376-cdda-4c1e-b4d5-2ffe88288033', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f264a1a9d50>]}
[0m08:37:18.889365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ac6c376-cdda-4c1e-b4d5-2ffe88288033', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f264a1475d0>]}
[0m08:37:18.889920 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m08:37:18.899948 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m08:37:18.934505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:37:18.934925 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:37:18.940430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ac6c376-cdda-4c1e-b4d5-2ffe88288033', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2649f0fe10>]}
[0m08:37:18.958980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ac6c376-cdda-4c1e-b4d5-2ffe88288033', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2649ccbd50>]}
[0m08:37:18.959606 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 536 macros, 0 groups, 0 semantic models
[0m08:37:18.960194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ac6c376-cdda-4c1e-b4d5-2ffe88288033', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2649e44a10>]}
[0m08:37:18.962278 [info ] [MainThread]: 
[0m08:37:18.963256 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m08:37:18.965245 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m08:37:18.977898 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m08:37:18.978330 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m08:37:18.978618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:37:21.120781 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m08:37:21.122184 [debug] [ThreadPool]: On list_lakehouse: Close
[0m08:37:21.126005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m08:37:21.133247 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m08:37:21.133676 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m08:37:21.134154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:37:22.335558 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m08:37:22.337037 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m08:37:22.337332 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m08:37:22.339126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now list_lakehouse_tpch)
[0m08:37:22.342228 [debug] [ThreadPool]: Using trino connection "list_lakehouse_tpch"
[0m08:37:22.342571 [debug] [ThreadPool]: On list_lakehouse_tpch: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_tpch"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'tpch') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'tpch'
[0m08:37:22.345125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:37:23.509746 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m08:37:23.511447 [debug] [ThreadPool]: On list_lakehouse_tpch: ROLLBACK
[0m08:37:23.511788 [debug] [ThreadPool]: On list_lakehouse_tpch: Close
[0m08:37:23.515108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ac6c376-cdda-4c1e-b4d5-2ffe88288033', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2649e465d0>]}
[0m08:37:23.515655 [debug] [MainThread]: On master: COMMIT
[0m08:37:23.516262 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:37:23.516563 [info ] [MainThread]: 
[0m08:37:23.521601 [debug] [Thread-1 (]: Began running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m08:37:23.522125 [info ] [Thread-1 (]: 1 of 1 START snapshot tpch.orders_snapshot ..................................... [RUN]
[0m08:37:23.522676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_tpch, now snapshot.dbt_trino_iceberg.orders_snapshot)
[0m08:37:23.522993 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_trino_iceberg.orders_snapshot
[0m08:37:23.525967 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (compile): 08:37:23.523209 => 08:37:23.525776
[0m08:37:23.526316 [debug] [Thread-1 (]: Began executing node snapshot.dbt_trino_iceberg.orders_snapshot
[0m08:37:23.558194 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m08:37:23.559142 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    describe "lakehouse"."tpch"."orders_snapshot"
[0m08:37:23.559934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:37:24.358163 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m08:37:24.360117 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (execute): 08:37:23.526514 => 08:37:24.359697
[0m08:37:24.360871 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: Close
[0m08:37:24.367677 [debug] [Thread-1 (]: Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m08:37:24.368824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac6c376-cdda-4c1e-b4d5-2ffe88288033', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26499da610>]}
[0m08:37:24.369807 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting tpch.orders_snapshot ................................. [[31mERROR[0m in 0.85s]
[0m08:37:24.370411 [debug] [Thread-1 (]: Finished running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m08:37:24.373361 [debug] [MainThread]: On master: COMMIT
[0m08:37:24.374581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:37:24.375179 [debug] [MainThread]: Connection 'snapshot.dbt_trino_iceberg.orders_snapshot' was properly closed.
[0m08:37:24.376246 [info ] [MainThread]: 
[0m08:37:24.377293 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.41 seconds (5.41s).
[0m08:37:24.378322 [debug] [MainThread]: Command end result
[0m08:37:24.398800 [info ] [MainThread]: 
[0m08:37:24.399282 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:37:24.399655 [info ] [MainThread]: 
[0m08:37:24.399950 [error] [MainThread]:   Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m08:37:24.400228 [info ] [MainThread]: 
[0m08:37:24.400555 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:37:24.401720 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 5.794871, "process_user_time": 1.806095, "process_kernel_time": 0.641759, "process_mem_max_rss": "110884", "process_out_blocks": "2400", "command_success": false, "process_in_blocks": "0"}
[0m08:37:24.402393 [debug] [MainThread]: Command `dbt snapshot` failed at 08:37:24.402252 after 5.80 seconds
[0m08:37:24.402831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f264a19ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f264a14d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f264e833910>]}
[0m08:37:24.403293 [debug] [MainThread]: Flushing usage events
[0m09:07:54.062110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f020cb15fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f020d1a9c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f020caedb10>]}


============================== 09:07:54.064590 | 2f97f884-e9eb-4f68-9381-691960a63edd ==============================
[0m09:07:54.064590 [info ] [MainThread]: Running with dbt=1.7.3
[0m09:07:54.064982 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m09:07:54.192131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f97f884-e9eb-4f68-9381-691960a63edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f020c87e0d0>]}
[0m09:07:54.247190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f97f884-e9eb-4f68-9381-691960a63edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f020c871650>]}
[0m09:07:54.247609 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m09:07:54.254984 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m09:07:54.285025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:07:54.285598 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://snapshots/orders.sql
[0m09:07:54.391724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f97f884-e9eb-4f68-9381-691960a63edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f020c4c1090>]}
[0m09:07:54.403564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f97f884-e9eb-4f68-9381-691960a63edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f020c5380d0>]}
[0m09:07:54.403946 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 536 macros, 0 groups, 0 semantic models
[0m09:07:54.404219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f97f884-e9eb-4f68-9381-691960a63edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f020c910ed0>]}
[0m09:07:54.405406 [info ] [MainThread]: 
[0m09:07:54.405939 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m09:07:54.406796 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m09:07:54.416860 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m09:07:54.417077 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m09:07:54.417235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:07:57.947765 [debug] [ThreadPool]: SQL status: SUCCESS in 4.0 seconds
[0m09:07:57.950041 [debug] [ThreadPool]: On list_lakehouse: Close
[0m09:07:57.953384 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m09:07:57.960707 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m09:07:57.961128 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m09:07:57.961360 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:08:00.856511 [debug] [ThreadPool]: SQL status: SUCCESS in 3.0 seconds
[0m09:08:00.859505 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m09:08:00.859968 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m09:08:00.863292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f97f884-e9eb-4f68-9381-691960a63edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f020c7f0a50>]}
[0m09:08:00.863608 [debug] [MainThread]: On master: COMMIT
[0m09:08:00.864063 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:08:00.864288 [info ] [MainThread]: 
[0m09:08:00.866750 [debug] [Thread-1 (]: Began running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m09:08:00.867040 [info ] [Thread-1 (]: 1 of 1 START snapshot dbt.orders_snapshot ...................................... [RUN]
[0m09:08:00.867478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now snapshot.dbt_trino_iceberg.orders_snapshot)
[0m09:08:00.867683 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_trino_iceberg.orders_snapshot
[0m09:08:00.870036 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (compile): 09:08:00.867791 => 09:08:00.869885
[0m09:08:00.870255 [debug] [Thread-1 (]: Began executing node snapshot.dbt_trino_iceberg.orders_snapshot
[0m09:08:00.900106 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m09:08:00.901691 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m09:08:00.901949 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

      
  
    

    create table "lakehouse"."dbt"."orders_snapshot"
      
      
    as (
      

    select *,
        lower(to_hex(md5(to_utf8(concat(coalesce(cast(orderkey as varchar), ''), '|',coalesce(cast(orderdate as varchar), '')))))) as dbt_scd_id,
        orderdate as dbt_updated_at,
        orderdate as dbt_valid_from,
        nullif(orderdate, orderdate) as dbt_valid_to
    from (
        



select * from tpch.sf1.orders

    ) sbq



    )
[0m09:08:00.902148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:08:24.559259 [debug] [Thread-1 (]: SQL status: SUCCESS in 24.0 seconds
[0m09:08:24.571790 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: COMMIT
[0m09:08:24.572515 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (execute): 09:08:00.870373 => 09:08:24.572375
[0m09:08:24.572824 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: Close
[0m09:08:24.573893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f97f884-e9eb-4f68-9381-691960a63edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f020c39a110>]}
[0m09:08:24.574354 [info ] [Thread-1 (]: 1 of 1 OK snapshotted dbt.orders_snapshot ...................................... [[32mSUCCESS[0m in 23.71s]
[0m09:08:24.574775 [debug] [Thread-1 (]: Finished running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m09:08:24.576241 [debug] [MainThread]: On master: COMMIT
[0m09:08:24.576620 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:08:24.576779 [debug] [MainThread]: Connection 'snapshot.dbt_trino_iceberg.orders_snapshot' was properly closed.
[0m09:08:24.576941 [info ] [MainThread]: 
[0m09:08:24.577142 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 30.17 seconds (30.17s).
[0m09:08:24.577602 [debug] [MainThread]: Command end result
[0m09:08:24.584220 [info ] [MainThread]: 
[0m09:08:24.584597 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:08:24.584871 [info ] [MainThread]: 
[0m09:08:24.585179 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:08:24.585989 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 30.552206, "process_user_time": 1.645789, "process_kernel_time": 0.431518, "process_mem_max_rss": "113136", "process_out_blocks": "3544", "process_in_blocks": "0"}
[0m09:08:24.586337 [debug] [MainThread]: Command `dbt snapshot` succeeded at 09:08:24.586244 after 30.55 seconds
[0m09:08:24.586645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f020cad3d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02102f5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f021101b490>]}
[0m09:08:24.586878 [debug] [MainThread]: Flushing usage events
[0m09:09:00.566267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37a6810e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37a636b8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37a6368150>]}


============================== 09:09:00.567905 | 1418dbf2-b22f-4159-8a22-3b1b0a04bcde ==============================
[0m09:09:00.567905 [info ] [MainThread]: Running with dbt=1.7.3
[0m09:09:00.568244 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m09:09:00.688406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1418dbf2-b22f-4159-8a22-3b1b0a04bcde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37a63aa650>]}
[0m09:09:00.739685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1418dbf2-b22f-4159-8a22-3b1b0a04bcde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37a61bcb90>]}
[0m09:09:00.740150 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m09:09:00.747233 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m09:09:00.763405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:09:00.763685 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:09:00.767976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1418dbf2-b22f-4159-8a22-3b1b0a04bcde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37a6367610>]}
[0m09:09:00.775831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1418dbf2-b22f-4159-8a22-3b1b0a04bcde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37a5eefed0>]}
[0m09:09:00.776321 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 536 macros, 0 groups, 0 semantic models
[0m09:09:00.776682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1418dbf2-b22f-4159-8a22-3b1b0a04bcde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37a60f3650>]}
[0m09:09:00.778292 [info ] [MainThread]: 
[0m09:09:00.779012 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m09:09:00.779853 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m09:09:00.790531 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m09:09:00.790811 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m09:09:00.790979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:09:02.175333 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m09:09:02.177582 [debug] [ThreadPool]: On list_lakehouse: Close
[0m09:09:02.180420 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m09:09:02.185440 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m09:09:02.185672 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m09:09:02.185873 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:09:03.641495 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m09:09:03.644192 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m09:09:03.644396 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m09:09:03.647121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1418dbf2-b22f-4159-8a22-3b1b0a04bcde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37a62773d0>]}
[0m09:09:03.647392 [debug] [MainThread]: On master: COMMIT
[0m09:09:03.647758 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:09:03.647973 [info ] [MainThread]: 
[0m09:09:03.650921 [debug] [Thread-1 (]: Began running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m09:09:03.651207 [info ] [Thread-1 (]: 1 of 1 START snapshot dbt.orders_snapshot ...................................... [RUN]
[0m09:09:03.651685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now snapshot.dbt_trino_iceberg.orders_snapshot)
[0m09:09:03.651912 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_trino_iceberg.orders_snapshot
[0m09:09:03.654733 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (compile): 09:09:03.652194 => 09:09:03.654587
[0m09:09:03.654957 [debug] [Thread-1 (]: Began executing node snapshot.dbt_trino_iceberg.orders_snapshot
[0m09:09:03.682958 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m09:09:03.683276 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    describe "lakehouse"."dbt"."orders_snapshot"
[0m09:09:03.683475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:09:04.950315 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m09:09:04.953207 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (execute): 09:09:03.655078 => 09:09:04.953058
[0m09:09:04.953432 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: Close
[0m09:09:04.955968 [debug] [Thread-1 (]: Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m09:09:04.956257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1418dbf2-b22f-4159-8a22-3b1b0a04bcde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37a5f55bd0>]}
[0m09:09:04.956687 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting dbt.orders_snapshot .................................. [[31mERROR[0m in 1.30s]
[0m09:09:04.957061 [debug] [Thread-1 (]: Finished running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m09:09:04.958521 [debug] [MainThread]: On master: COMMIT
[0m09:09:04.958967 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:09:04.959126 [debug] [MainThread]: Connection 'snapshot.dbt_trino_iceberg.orders_snapshot' was properly closed.
[0m09:09:04.959282 [info ] [MainThread]: 
[0m09:09:04.959482 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.18 seconds (4.18s).
[0m09:09:04.959927 [debug] [MainThread]: Command end result
[0m09:09:04.970009 [info ] [MainThread]: 
[0m09:09:04.970355 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:09:04.970645 [info ] [MainThread]: 
[0m09:09:04.970888 [error] [MainThread]:   Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m09:09:04.971114 [info ] [MainThread]: 
[0m09:09:04.971330 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:09:04.972042 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 4.430588, "process_user_time": 1.409773, "process_kernel_time": 0.098585, "process_mem_max_rss": "110788", "process_out_blocks": "2400", "command_success": false, "process_in_blocks": "0"}
[0m09:09:04.972356 [debug] [MainThread]: Command `dbt snapshot` failed at 09:09:04.972281 after 4.43 seconds
[0m09:09:04.972572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37aaa578d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37aaa56bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37aaa57750>]}
[0m09:09:04.972770 [debug] [MainThread]: Flushing usage events
[0m10:02:36.872007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bfec49c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bfe57c690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bfea04cd0>]}


============================== 10:02:36.875255 | c734b1bb-73d2-42df-b145-9aa3ce01fe76 ==============================
[0m10:02:36.875255 [info ] [MainThread]: Running with dbt=1.7.3
[0m10:02:36.875622 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:02:37.008453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c734b1bb-73d2-42df-b145-9aa3ce01fe76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bfe38c710>]}
[0m10:02:37.066314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c734b1bb-73d2-42df-b145-9aa3ce01fe76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bfe3e8250>]}
[0m10:02:37.066780 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m10:02:37.074343 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m10:02:37.107942 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:02:37.108289 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:02:37.113471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c734b1bb-73d2-42df-b145-9aa3ce01fe76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bfdff5d50>]}
[0m10:02:37.135814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c734b1bb-73d2-42df-b145-9aa3ce01fe76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bfe0e3a90>]}
[0m10:02:37.136318 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 536 macros, 0 groups, 0 semantic models
[0m10:02:37.136787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c734b1bb-73d2-42df-b145-9aa3ce01fe76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bfe46bd10>]}
[0m10:02:37.138645 [info ] [MainThread]: 
[0m10:02:37.139414 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m10:02:37.140436 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m10:02:37.150575 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m10:02:37.150790 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m10:02:37.150948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:02:39.083891 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m10:02:39.085985 [debug] [ThreadPool]: On list_lakehouse: Close
[0m10:02:39.089447 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m10:02:39.094908 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m10:02:39.095135 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m10:02:39.095301 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:02:40.423061 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m10:02:40.425850 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m10:02:40.426359 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m10:02:40.429822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c734b1bb-73d2-42df-b145-9aa3ce01fe76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bfe2016d0>]}
[0m10:02:40.430095 [debug] [MainThread]: On master: COMMIT
[0m10:02:40.430477 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:02:40.430697 [info ] [MainThread]: 
[0m10:02:40.433606 [debug] [Thread-1 (]: Began running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m10:02:40.433908 [info ] [Thread-1 (]: 1 of 1 START snapshot dbt.orders_snapshot ...................................... [RUN]
[0m10:02:40.434342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now snapshot.dbt_trino_iceberg.orders_snapshot)
[0m10:02:40.434551 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_trino_iceberg.orders_snapshot
[0m10:02:40.437342 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (compile): 10:02:40.434835 => 10:02:40.437197
[0m10:02:40.437561 [debug] [Thread-1 (]: Began executing node snapshot.dbt_trino_iceberg.orders_snapshot
[0m10:02:40.466500 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m10:02:40.466812 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    describe "lakehouse"."dbt"."orders_snapshot"
[0m10:02:40.467137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:02:41.748083 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m10:02:41.750142 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (execute): 10:02:40.437674 => 10:02:41.749990
[0m10:02:41.750368 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: Close
[0m10:02:41.754576 [debug] [Thread-1 (]: Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m10:02:41.754851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c734b1bb-73d2-42df-b145-9aa3ce01fe76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bfe1bd6d0>]}
[0m10:02:41.755281 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting dbt.orders_snapshot .................................. [[31mERROR[0m in 1.32s]
[0m10:02:41.755659 [debug] [Thread-1 (]: Finished running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m10:02:41.757028 [debug] [MainThread]: On master: COMMIT
[0m10:02:41.757389 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:02:41.757545 [debug] [MainThread]: Connection 'snapshot.dbt_trino_iceberg.orders_snapshot' was properly closed.
[0m10:02:41.757701 [info ] [MainThread]: 
[0m10:02:41.757898 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.62 seconds (4.62s).
[0m10:02:41.758372 [debug] [MainThread]: Command end result
[0m10:02:41.764382 [info ] [MainThread]: 
[0m10:02:41.764751 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:02:41.765817 [info ] [MainThread]: 
[0m10:02:41.766158 [error] [MainThread]:   Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m10:02:41.766444 [info ] [MainThread]: 
[0m10:02:41.766711 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:02:41.767528 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 4.924514, "process_user_time": 1.586815, "process_kernel_time": 0.467907, "process_mem_max_rss": "111072", "process_out_blocks": "2392", "command_success": false, "process_in_blocks": "0"}
[0m10:02:41.767863 [debug] [MainThread]: Command `dbt snapshot` failed at 10:02:41.767777 after 4.92 seconds
[0m10:02:41.768110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c02c4b790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c02c4b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c02c4ba90>]}
[0m10:02:41.768331 [debug] [MainThread]: Flushing usage events
[0m11:17:50.279652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a799dd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a7980cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a79805d0>]}


============================== 11:17:50.282634 | 30f105f7-f975-4b63-8401-734393795397 ==============================
[0m11:17:50.282634 [info ] [MainThread]: Running with dbt=1.7.3
[0m11:17:50.283057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --debug snapshot', 'send_anonymous_usage_stats': 'True'}
[0m11:17:50.419999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30f105f7-f975-4b63-8401-734393795397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a77c4250>]}
[0m11:17:50.479625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30f105f7-f975-4b63-8401-734393795397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a7753190>]}
[0m11:17:50.480122 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m11:17:50.488230 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m11:17:50.524054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:17:50.524524 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:17:50.529588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30f105f7-f975-4b63-8401-734393795397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a741a610>]}
[0m11:17:50.552988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30f105f7-f975-4b63-8401-734393795397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a76fb5d0>]}
[0m11:17:50.553469 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 536 macros, 0 groups, 0 semantic models
[0m11:17:50.553782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30f105f7-f975-4b63-8401-734393795397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a768d390>]}
[0m11:17:50.555222 [info ] [MainThread]: 
[0m11:17:50.555775 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m11:17:50.556708 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m11:17:50.569413 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m11:17:50.569905 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m11:17:50.570342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:17:52.346406 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m11:17:52.348537 [debug] [ThreadPool]: On list_lakehouse: Close
[0m11:17:52.351002 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m11:17:52.356807 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m11:17:52.357110 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m11:17:52.357440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:17:53.671008 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m11:17:53.673634 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m11:17:53.673882 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m11:17:53.676298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30f105f7-f975-4b63-8401-734393795397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a77f8f50>]}
[0m11:17:53.676723 [debug] [MainThread]: On master: COMMIT
[0m11:17:53.677262 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:17:53.677499 [info ] [MainThread]: 
[0m11:17:53.680413 [debug] [Thread-1 (]: Began running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m11:17:53.680793 [info ] [Thread-1 (]: 1 of 1 START snapshot dbt.orders_snapshot ...................................... [RUN]
[0m11:17:53.681302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now snapshot.dbt_trino_iceberg.orders_snapshot)
[0m11:17:53.681656 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_trino_iceberg.orders_snapshot
[0m11:17:53.684796 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (compile): 11:17:53.682096 => 11:17:53.684639
[0m11:17:53.685088 [debug] [Thread-1 (]: Began executing node snapshot.dbt_trino_iceberg.orders_snapshot
[0m11:17:53.713812 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m11:17:53.714198 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    describe "lakehouse"."dbt"."orders_snapshot"
[0m11:17:53.714511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:54.995120 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m11:17:54.997491 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (execute): 11:17:53.685290 => 11:17:54.997184
[0m11:17:54.997961 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: Close
[0m11:17:55.000851 [debug] [Thread-1 (]: Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m11:17:55.001266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30f105f7-f975-4b63-8401-734393795397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a76d7950>]}
[0m11:17:55.001975 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting dbt.orders_snapshot .................................. [[31mERROR[0m in 1.32s]
[0m11:17:55.002368 [debug] [Thread-1 (]: Finished running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m11:17:55.003854 [debug] [MainThread]: On master: COMMIT
[0m11:17:55.004325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:17:55.004533 [debug] [MainThread]: Connection 'snapshot.dbt_trino_iceberg.orders_snapshot' was properly closed.
[0m11:17:55.004793 [info ] [MainThread]: 
[0m11:17:55.005052 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.45 seconds (4.45s).
[0m11:17:55.005474 [debug] [MainThread]: Command end result
[0m11:17:55.016089 [info ] [MainThread]: 
[0m11:17:55.016649 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:17:55.016883 [info ] [MainThread]: 
[0m11:17:55.017102 [error] [MainThread]:   Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m11:17:55.017382 [info ] [MainThread]: 
[0m11:17:55.017623 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:17:55.018369 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 4.769337, "process_user_time": 1.559786, "process_kernel_time": 0.519928, "process_mem_max_rss": "110464", "process_out_blocks": "2400", "command_success": false, "process_in_blocks": "0"}
[0m11:17:55.018804 [debug] [MainThread]: Command `dbt snapshot` failed at 11:17:55.018696 after 4.77 seconds
[0m11:17:55.019134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ac0936d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a79d42d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a79cb310>]}
[0m11:17:55.019436 [debug] [MainThread]: Flushing usage events
[0m12:40:21.625209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b78bcd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b7d64cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b78e7290>]}


============================== 12:40:21.628057 | 0a899fbe-a962-4014-b0fe-c3b66f6e63f9 ==============================
[0m12:40:21.628057 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:40:21.628525 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m12:40:21.765380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a899fbe-a962-4014-b0fe-c3b66f6e63f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b7642d90>]}
[0m12:40:21.829872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a899fbe-a962-4014-b0fe-c3b66f6e63f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b7642d90>]}
[0m12:40:21.830437 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m12:40:21.838986 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:40:21.883626 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m12:40:21.884142 [debug] [MainThread]: Partial parsing: added file: dbt_trino_iceberg://macros/timestamp_macro.sql
[0m12:40:21.884426 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://snapshots/orders.sql
[0m12:40:21.986056 [error] [MainThread]: Encountered an error:
Parsing Error
  at path ['updated_at']: Undefined is not valid under any of the given schemas
[0m12:40:21.987025 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 0.39239356, "process_user_time": 1.483677, "process_kernel_time": 0.531316, "process_mem_max_rss": "105032", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m12:40:21.987544 [debug] [MainThread]: Command `dbt snapshot` failed at 12:40:21.987460 after 0.39 seconds
[0m12:40:21.987805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b78babd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b78baa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b76a3110>]}
[0m12:40:21.988061 [debug] [MainThread]: Flushing usage events
[0m13:17:29.116475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccf00e4bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccefc56050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccefc56010>]}


============================== 13:17:29.118818 | 4b1b36f7-bcc1-4413-9a99-61792121a378 ==============================
[0m13:17:29.118818 [info ] [MainThread]: Running with dbt=1.7.3
[0m13:17:29.119217 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:17:29.246720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b1b36f7-bcc1-4413-9a99-61792121a378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccefc7fe90>]}
[0m13:17:29.303400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b1b36f7-bcc1-4413-9a99-61792121a378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccef9ba610>]}
[0m13:17:29.303817 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m13:17:29.311205 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m13:17:29.341515 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m13:17:29.342043 [debug] [MainThread]: Partial parsing: added file: dbt_trino_iceberg://macros/timestamp_macro.sql
[0m13:17:29.342283 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://snapshots/orders.sql
[0m13:17:29.421824 [error] [MainThread]: Encountered an error:
Parsing Error
  at path ['check_cols']: Undefined is not valid under any of the given schemas
[0m13:17:29.422751 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 0.3336909, "process_user_time": 1.341593, "process_kernel_time": 0.300356, "process_mem_max_rss": "105016", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m13:17:29.423091 [debug] [MainThread]: Command `dbt snapshot` failed at 13:17:29.423017 after 0.33 seconds
[0m13:17:29.423307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccefc3d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccef8c1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccef65b110>]}
[0m13:17:29.423517 [debug] [MainThread]: Flushing usage events
[0m13:18:26.835927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb119474050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb119457dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb119455010>]}


============================== 13:18:26.837680 | b243367c-6b35-49b5-b21c-82de82cd9988 ==============================
[0m13:18:26.837680 [info ] [MainThread]: Running with dbt=1.7.3
[0m13:18:26.838030 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:18:26.955091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b243367c-6b35-49b5-b21c-82de82cd9988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11926a510>]}
[0m13:18:27.008226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b243367c-6b35-49b5-b21c-82de82cd9988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1190b11d0>]}
[0m13:18:27.008768 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m13:18:27.015406 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m13:18:27.032277 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m13:18:27.032751 [debug] [MainThread]: Partial parsing: added file: dbt_trino_iceberg://macros/timestamp_macro.sql
[0m13:18:27.033076 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://snapshots/orders.sql
[0m13:18:27.111938 [error] [MainThread]: Encountered an error:
Parsing Error
  at path []: Snapshots must be configured with a 'strategy', 'unique_key', and 'target_schema'.
[0m13:18:27.112679 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 0.30138233, "process_user_time": 1.317303, "process_kernel_time": 0.049897, "process_mem_max_rss": "105080", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m13:18:27.113039 [debug] [MainThread]: Command `dbt snapshot` failed at 13:18:27.112957 after 0.30 seconds
[0m13:18:27.113264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb119ae0dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11db23810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11db237d0>]}
[0m13:18:27.113471 [debug] [MainThread]: Flushing usage events
[0m13:19:30.054184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954bfa3a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954bfe9f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954c68dd10>]}


============================== 13:19:30.055833 | 4d3d7aee-c49b-43c4-bcc1-93de431c43f8 ==============================
[0m13:19:30.055833 [info ] [MainThread]: Running with dbt=1.7.3
[0m13:19:30.056173 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:19:30.170397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d3d7aee-c49b-43c4-bcc1-93de431c43f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954bd52850>]}
[0m13:19:30.223571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d3d7aee-c49b-43c4-bcc1-93de431c43f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954bd2e690>]}
[0m13:19:30.224059 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m13:19:30.232054 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m13:19:30.249314 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m13:19:30.249748 [debug] [MainThread]: Partial parsing: added file: dbt_trino_iceberg://macros/timestamp_macro.sql
[0m13:19:30.249993 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://snapshots/orders.sql
[0m13:19:30.309338 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  expected token ',', got 'check_cols'
    line 9
      check_cols='all'
[0m13:19:30.310083 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 0.28002763, "process_user_time": 1.265304, "process_kernel_time": 0.069741, "process_mem_max_rss": "104880", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m13:19:30.310445 [debug] [MainThread]: Command `dbt snapshot` failed at 13:19:30.310371 after 0.28 seconds
[0m13:19:30.310684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954bf9fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954bfbac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954bd97110>]}
[0m13:19:30.310906 [debug] [MainThread]: Flushing usage events
[0m13:19:54.689150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f208db33250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f208db32e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f208db32ad0>]}


============================== 13:19:54.691054 | 5f03c5b0-41ee-4fe7-9988-f9f9b91d4d93 ==============================
[0m13:19:54.691054 [info ] [MainThread]: Running with dbt=1.7.3
[0m13:19:54.691469 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m13:19:54.821843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f03c5b0-41ee-4fe7-9988-f9f9b91d4d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f208dba2c10>]}
[0m13:19:54.886469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f03c5b0-41ee-4fe7-9988-f9f9b91d4d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f208d8cfd90>]}
[0m13:19:54.886967 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m13:19:54.894458 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m13:19:54.911276 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m13:19:54.911756 [debug] [MainThread]: Partial parsing: added file: dbt_trino_iceberg://macros/timestamp_macro.sql
[0m13:19:54.912016 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://snapshots/orders.sql
[0m13:19:55.019585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f03c5b0-41ee-4fe7-9988-f9f9b91d4d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f208d931cd0>]}
[0m13:19:55.031376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f03c5b0-41ee-4fe7-9988-f9f9b91d4d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f208d79c650>]}
[0m13:19:55.031743 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 537 macros, 0 groups, 0 semantic models
[0m13:19:55.032012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f03c5b0-41ee-4fe7-9988-f9f9b91d4d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f208d7d6850>]}
[0m13:19:55.033290 [info ] [MainThread]: 
[0m13:19:55.033915 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:19:55.034810 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m13:19:55.045642 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m13:19:55.045980 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m13:19:55.046149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:56.933013 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m13:19:56.934313 [debug] [ThreadPool]: On list_lakehouse: Close
[0m13:19:56.937033 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m13:19:56.943024 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m13:19:56.943318 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m13:19:56.943486 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:58.273576 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:19:58.275836 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m13:19:58.276312 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m13:19:58.280469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f03c5b0-41ee-4fe7-9988-f9f9b91d4d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f208d911190>]}
[0m13:19:58.281016 [debug] [MainThread]: On master: COMMIT
[0m13:19:58.281573 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:19:58.281879 [info ] [MainThread]: 
[0m13:19:58.285437 [debug] [Thread-1 (]: Began running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m13:19:58.285746 [info ] [Thread-1 (]: 1 of 1 START snapshot dbt.orders_snapshot ...................................... [RUN]
[0m13:19:58.286210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now snapshot.dbt_trino_iceberg.orders_snapshot)
[0m13:19:58.286441 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_trino_iceberg.orders_snapshot
[0m13:19:58.288751 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (compile): 13:19:58.286552 => 13:19:58.288588
[0m13:19:58.288963 [debug] [Thread-1 (]: Began executing node snapshot.dbt_trino_iceberg.orders_snapshot
[0m13:19:58.321099 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m13:19:58.321418 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */
select * from (
        



select * from tpch.sf1.orders

    ) as __dbt_sbq
    where false
    limit 0
[0m13:19:58.321615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:59.339881 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:19:59.347518 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m13:19:59.347770 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    describe "lakehouse"."dbt"."orders_snapshot"
[0m13:20:00.641547 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:20:00.650884 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m13:20:00.651146 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    describe "lakehouse"."dbt"."orders_snapshot"
[0m13:20:02.633277 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m13:20:02.634942 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (execute): 13:19:58.289118 => 13:20:02.634659
[0m13:20:02.635359 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: Close
[0m13:20:02.639162 [debug] [Thread-1 (]: Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m13:20:02.639488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f03c5b0-41ee-4fe7-9988-f9f9b91d4d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f208d4361d0>]}
[0m13:20:02.639940 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting dbt.orders_snapshot .................................. [[31mERROR[0m in 4.35s]
[0m13:20:02.640328 [debug] [Thread-1 (]: Finished running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m13:20:02.641965 [debug] [MainThread]: On master: COMMIT
[0m13:20:02.642355 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:20:02.642509 [debug] [MainThread]: Connection 'snapshot.dbt_trino_iceberg.orders_snapshot' was properly closed.
[0m13:20:02.642669 [info ] [MainThread]: 
[0m13:20:02.642869 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.61 seconds (7.61s).
[0m13:20:02.643374 [debug] [MainThread]: Command end result
[0m13:20:02.651020 [info ] [MainThread]: 
[0m13:20:02.651364 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:20:02.651729 [info ] [MainThread]: 
[0m13:20:02.652042 [error] [MainThread]:   Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m13:20:02.652274 [info ] [MainThread]: 
[0m13:20:02.652882 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:20:02.653684 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 7.9904113, "process_user_time": 1.746443, "process_kernel_time": 0.074543, "process_mem_max_rss": "114144", "process_out_blocks": "3544", "command_success": false, "process_in_blocks": "0"}
[0m13:20:02.654010 [debug] [MainThread]: Command `dbt snapshot` failed at 13:20:02.653935 after 7.99 seconds
[0m13:20:02.654231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f208db32d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f208db302d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2092243650>]}
[0m13:20:02.654444 [debug] [MainThread]: Flushing usage events
[0m13:31:40.336135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08ffb8d990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08ffb8ce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08ff033210>]}


============================== 13:31:40.338313 | 937c3cd8-9c4c-4c27-9df3-d29af8ff01ea ==============================
[0m13:31:40.338313 [info ] [MainThread]: Running with dbt=1.7.3
[0m13:31:40.338728 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:31:40.461469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '937c3cd8-9c4c-4c27-9df3-d29af8ff01ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08fee813d0>]}
[0m13:31:40.514627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '937c3cd8-9c4c-4c27-9df3-d29af8ff01ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08ff70a010>]}
[0m13:31:40.515058 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m13:31:40.522413 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m13:31:40.540535 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m13:31:40.540935 [debug] [MainThread]: Partial parsing: added file: dbt_trino_iceberg://macros/current_timestamp.sql
[0m13:31:40.541116 [debug] [MainThread]: Partial parsing: deleted file: dbt_trino_iceberg://macros/timestamp_macro.sql
[0m13:31:40.541315 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://snapshots/orders.sql
[0m13:31:40.637151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '937c3cd8-9c4c-4c27-9df3-d29af8ff01ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08fed14a50>]}
[0m13:31:40.646983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '937c3cd8-9c4c-4c27-9df3-d29af8ff01ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08fea94250>]}
[0m13:31:40.647387 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 537 macros, 0 groups, 0 semantic models
[0m13:31:40.647670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '937c3cd8-9c4c-4c27-9df3-d29af8ff01ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08feae7490>]}
[0m13:31:40.649127 [info ] [MainThread]: 
[0m13:31:40.649740 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:31:40.650778 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m13:31:40.662500 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m13:31:40.662829 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m13:31:40.662995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:31:42.094420 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:31:42.095293 [debug] [ThreadPool]: On list_lakehouse: Close
[0m13:31:42.097860 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m13:31:42.102818 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m13:31:42.103055 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m13:31:42.103249 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:31:43.078089 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:31:43.079378 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m13:31:43.079609 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m13:31:43.082385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '937c3cd8-9c4c-4c27-9df3-d29af8ff01ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08fea5afd0>]}
[0m13:31:43.082670 [debug] [MainThread]: On master: COMMIT
[0m13:31:43.083139 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:31:43.083384 [info ] [MainThread]: 
[0m13:31:43.086095 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_customers
[0m13:31:43.086535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.stg_tpch_customers)
[0m13:31:43.086765 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_customers
[0m13:31:43.089023 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_customers"
[0m13:31:43.089722 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_customers (compile): 13:31:43.086933 => 13:31:43.089575
[0m13:31:43.090257 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_customers
[0m13:31:43.090524 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m13:31:43.090895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_customers, now model.dbt_trino_iceberg.stg_tpch_line_item)
[0m13:31:43.091243 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_line_item
[0m13:31:43.093684 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_line_item"
[0m13:31:43.094178 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_line_item (compile): 13:31:43.091453 => 13:31:43.094035
[0m13:31:43.094743 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m13:31:43.094989 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_nation
[0m13:31:43.095355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_line_item, now model.dbt_trino_iceberg.stg_tpch_nation)
[0m13:31:43.095562 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_nation
[0m13:31:43.097284 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_nation"
[0m13:31:43.097681 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_nation (compile): 13:31:43.095688 => 13:31:43.097549
[0m13:31:43.098163 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_nation
[0m13:31:43.098400 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_orders
[0m13:31:43.098705 [info ] [Thread-1 (]: 1 of 8 START sql table model dbt.stg_tpch_orders ............................... [RUN]
[0m13:31:43.099319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_nation, now model.dbt_trino_iceberg.stg_tpch_orders)
[0m13:31:43.099638 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_orders
[0m13:31:43.101438 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_orders"
[0m13:31:43.102039 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_orders (compile): 13:31:43.099790 => 13:31:43.101895
[0m13:31:43.102334 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.stg_tpch_orders
[0m13:31:43.119487 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."stg_tpch_orders"
[0m13:31:43.120832 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.stg_tpch_orders"
[0m13:31:43.121078 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.stg_tpch_orders"} */

    drop table if exists "lakehouse"."dbt"."stg_tpch_orders"
[0m13:31:43.121265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:44.083252 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:31:44.091962 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.stg_tpch_orders"
[0m13:31:44.093423 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.stg_tpch_orders"
[0m13:31:44.093715 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.stg_tpch_orders"} */

  
    

    create table "lakehouse"."dbt"."stg_tpch_orders"
      
      
    as (
      
select
    orderkey as order_key, 
    custkey as customer_key,
    orderstatus as order_status_code,
    totalprice as order_amount,
    orderdate as order_date,
    orderpriority as order_priority_code,
    clerk as order_clerk_name,
    shippriority as shipping_priority,
    comment as order_comment
from
    tpch.sf1.orders
    )
[0m13:32:02.154058 [debug] [Thread-1 (]: SQL status: SUCCESS in 18.0 seconds
[0m13:32:02.164617 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_orders (execute): 13:31:43.102487 => 13:32:02.164486
[0m13:32:02.165144 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_orders: ROLLBACK
[0m13:32:02.165348 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_orders: Close
[0m13:32:02.166459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '937c3cd8-9c4c-4c27-9df3-d29af8ff01ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08fea76610>]}
[0m13:32:02.166838 [info ] [Thread-1 (]: 1 of 8 OK created sql table model dbt.stg_tpch_orders .......................... [[32mSUCCESS[0m in 19.07s]
[0m13:32:02.167202 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_orders
[0m13:32:02.167485 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part
[0m13:32:02.168261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_orders, now model.dbt_trino_iceberg.stg_tpch_part)
[0m13:32:02.168545 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part
[0m13:32:02.170632 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part"
[0m13:32:02.171180 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part (compile): 13:32:02.168725 => 13:32:02.171039
[0m13:32:02.171657 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part
[0m13:32:02.171957 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m13:32:02.172345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part, now model.dbt_trino_iceberg.stg_tpch_part_suppliers)
[0m13:32:02.172576 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m13:32:02.174460 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part_suppliers"
[0m13:32:02.175024 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part_suppliers (compile): 13:32:02.172756 => 13:32:02.174888
[0m13:32:02.175483 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m13:32:02.175716 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_region
[0m13:32:02.176119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part_suppliers, now model.dbt_trino_iceberg.stg_tpch_region)
[0m13:32:02.176324 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_region
[0m13:32:02.178762 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_region"
[0m13:32:02.179275 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_region (compile): 13:32:02.176464 => 13:32:02.179129
[0m13:32:02.179760 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_region
[0m13:32:02.180006 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m13:32:02.180641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_region, now model.dbt_trino_iceberg.stg_tpch_supplier)
[0m13:32:02.180981 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_supplier
[0m13:32:02.182870 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_supplier"
[0m13:32:02.183335 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_supplier (compile): 13:32:02.181117 => 13:32:02.183202
[0m13:32:02.183802 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m13:32:02.184059 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.int_order_items
[0m13:32:02.184352 [info ] [Thread-1 (]: 2 of 8 START sql table model dbt.int_order_items ............................... [RUN]
[0m13:32:02.185089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_supplier, now model.dbt_trino_iceberg.int_order_items)
[0m13:32:02.185431 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.int_order_items
[0m13:32:02.205379 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.int_order_items"
[0m13:32:02.206025 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_order_items (compile): 13:32:02.185583 => 13:32:02.205838
[0m13:32:02.206290 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.int_order_items
[0m13:32:02.210060 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."int_order_items"
[0m13:32:02.210665 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_order_items"
[0m13:32:02.210873 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_order_items"} */

    drop table if exists "lakehouse"."dbt"."int_order_items"
[0m13:32:02.211050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:03.459517 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:32:03.461156 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.int_order_items"
[0m13:32:03.467003 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_order_items"
[0m13:32:03.467320 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_order_items"} */

  
    

    create table "lakehouse"."dbt"."int_order_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_line_item as (

select
    orderkey as order_key,
    partkey as part_key,
    suppkey as supplier_key,
    linenumber as order_line_number,
    quantity as quantity,
    extendedprice as extended_price,
    discount as discount_percentage,
    tax as tax_rate,
    returnflag as return_status_code,
    linestatus as order_line_status_code,
    shipdate as ship_date,
    commitdate as commit_date,
    receiptdate as receipt_date,
    shipinstruct as ship_instructions_desc,
    shipmode as ship_mode_name,
    comment as order_line_comment
from
    tpch.sf1.lineitem
), orders as (
    
    select * from "lakehouse"."dbt"."stg_tpch_orders"

),
line_items as (

    select * from __dbt__cte__stg_tpch_line_item

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(o.order_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l.order_line_number as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as order_item_key,

    o.order_key,
    o.order_date,
    o.customer_key,
    o.order_status_code,
    
    l.part_key,
    l.supplier_key,
    l.return_status_code,
    l.order_line_number,
    l.order_line_status_code,
    l.ship_date,
    l.commit_date,
    l.receipt_date,
    l.ship_mode_name,

    l.quantity,
    
    -- extended_price is actually the line item total,
    -- so we back out the extended price per item
    (l.extended_price/nullif(l.quantity, 0)) as base_price,
    l.discount_percentage,
    ((l.extended_price/nullif(l.quantity, 0)) * (1 - l.discount_percentage)) as discounted_price,

    l.extended_price as gross_item_sales_amount,
    (l.extended_price * (1 - l.discount_percentage)) as discounted_item_sales_amount,
    -- We model discounts as negative amounts
    (-1 * l.extended_price * l.discount_percentage) as item_discount_amount,
    l.tax_rate,
    ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate) as item_tax_amount,
    (
        l.extended_price + 
        (-1 * l.extended_price * l.discount_percentage) + 
        ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate)
    ) as net_item_sales_amount

from
    orders o
    join
    line_items l
        on o.order_key = l.order_key
order by
    o.order_date
    )
[0m13:32:45.604721 [debug] [Thread-1 (]: SQL status: SUCCESS in 42.0 seconds
[0m13:32:45.607194 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_order_items (execute): 13:32:02.206409 => 13:32:45.607039
[0m13:32:45.607463 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: ROLLBACK
[0m13:32:45.607693 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: Close
[0m13:32:45.608948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '937c3cd8-9c4c-4c27-9df3-d29af8ff01ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08fe9567d0>]}
[0m13:32:45.609290 [info ] [Thread-1 (]: 2 of 8 OK created sql table model dbt.int_order_items .......................... [[32mSUCCESS[0m in 43.42s]
[0m13:32:45.609786 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.int_order_items
[0m13:32:45.610199 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_suppliers
[0m13:32:45.610597 [info ] [Thread-1 (]: 3 of 8 START sql table model dbt.dim_suppliers ................................. [RUN]
[0m13:32:45.611469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.int_order_items, now model.dbt_trino_iceberg.dim_suppliers)
[0m13:32:45.611877 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_suppliers
[0m13:32:45.617954 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_suppliers"
[0m13:32:45.618458 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (compile): 13:32:45.612112 => 13:32:45.618319
[0m13:32:45.618653 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_suppliers
[0m13:32:45.621418 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."dim_suppliers"
[0m13:32:45.621851 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m13:32:45.622048 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt"."dim_suppliers"
[0m13:32:45.622218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:46.974998 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:32:46.976178 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_suppliers"
[0m13:32:46.978615 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m13:32:46.978903 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt"."dim_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m13:32:48.660769 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m13:32:48.662280 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (execute): 13:32:45.618793 => 13:32:48.662139
[0m13:32:48.662540 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: ROLLBACK
[0m13:32:48.662727 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: Close
[0m13:32:48.663773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '937c3cd8-9c4c-4c27-9df3-d29af8ff01ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08fe8fbc90>]}
[0m13:32:48.664142 [info ] [Thread-1 (]: 3 of 8 OK created sql table model dbt.dim_suppliers ............................ [[32mSUCCESS[0m in 3.05s]
[0m13:32:48.664608 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_suppliers
[0m13:32:48.664886 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.int_parts_suppliers
[0m13:32:48.665146 [info ] [Thread-1 (]: 4 of 8 START sql table model dbt.int_parts_suppliers ........................... [RUN]
[0m13:32:48.665727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_suppliers, now model.dbt_trino_iceberg.int_parts_suppliers)
[0m13:32:48.665940 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.int_parts_suppliers
[0m13:32:48.674510 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.int_parts_suppliers"
[0m13:32:48.675456 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_parts_suppliers (compile): 13:32:48.666070 => 13:32:48.675086
[0m13:32:48.675826 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.int_parts_suppliers
[0m13:32:48.680245 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."int_parts_suppliers"
[0m13:32:48.680811 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_parts_suppliers"
[0m13:32:48.681077 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_parts_suppliers"} */

    drop table if exists "lakehouse"."dbt"."int_parts_suppliers"
[0m13:32:48.681352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:49.632720 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:32:49.633932 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.int_parts_suppliers"
[0m13:32:49.677056 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_parts_suppliers"
[0m13:32:49.677641 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_parts_suppliers"} */

  
    

    create table "lakehouse"."dbt"."int_parts_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
part_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(p.part_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(s.supplier_key as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
			as part_supplier_key,
    --p.part_supplier_key,
	p.part_key,
    p.part_name,
    p.part_manufacturer_name,
    p.part_brand_name,
    p.part_type_name,
    p.part_size,
    p.part_container_desc,
    p.retail_price,

    s.supplier_key,
    s.supplier_name,
    s.nation_key,

    ps.supplier_availabe_quantity,
    ps.supplier_cost_amount
from
    parts p
    join
    part_suppliers ps
        on p.part_key = ps.part_key
    join
    suppliers s
        on ps.supplier_key = s.supplier_key
order by
    p.part_key
    )
[0m13:32:59.334909 [debug] [Thread-1 (]: SQL status: SUCCESS in 10.0 seconds
[0m13:32:59.336901 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_parts_suppliers (execute): 13:32:48.675946 => 13:32:59.336730
[0m13:32:59.337193 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: ROLLBACK
[0m13:32:59.337439 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: Close
[0m13:32:59.338791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '937c3cd8-9c4c-4c27-9df3-d29af8ff01ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08fef406d0>]}
[0m13:32:59.339174 [info ] [Thread-1 (]: 4 of 8 OK created sql table model dbt.int_parts_suppliers ...................... [[32mSUCCESS[0m in 10.67s]
[0m13:32:59.339540 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.int_parts_suppliers
[0m13:32:59.339811 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.fct_orders_items
[0m13:32:59.340089 [info ] [Thread-1 (]: 5 of 8 START sql table model dbt.fct_orders_items .............................. [RUN]
[0m13:32:59.340571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.int_parts_suppliers, now model.dbt_trino_iceberg.fct_orders_items)
[0m13:32:59.340790 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.fct_orders_items
[0m13:32:59.348820 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.fct_orders_items"
[0m13:32:59.349494 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (compile): 13:32:59.341217 => 13:32:59.349282
[0m13:32:59.349778 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.fct_orders_items
[0m13:32:59.352593 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."fct_orders_items"
[0m13:32:59.353076 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m13:32:59.353272 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

    drop table if exists "lakehouse"."dbt"."fct_orders_items"
[0m13:32:59.353440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:01.715872 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m13:33:01.718228 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.fct_orders_items"
[0m13:33:01.722190 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m13:33:01.722462 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

  
    

    create table "lakehouse"."dbt"."fct_orders_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), orders_items as (
    
    select * from "lakehouse"."dbt"."int_order_items"

),
parts_suppliers as (
    
    select * from __dbt__cte__stg_tpch_part_suppliers

),
final as (
    select 

        o.order_item_key,
        o.order_key,
        o.order_date,
        o.customer_key,
        o.order_status_code,
        
        o.part_key,
        o.supplier_key,
        o.return_status_code,
        o.order_line_number,
        o.order_line_status_code,
        o.ship_date,
        o.commit_date,
        o.receipt_date,
        o.ship_mode_name,
        ps.supplier_cost_amount,
        
        o.base_price,
        o.discount_percentage,
        o.discounted_price,
        o.tax_rate,
        
        1 as order_item_count,
        o.quantity,

        o.gross_item_sales_amount,
        o.discounted_item_sales_amount,
        o.item_discount_amount,
        o.item_tax_amount,
        o.net_item_sales_amount

    from
        orders_items o
        join
        parts_suppliers ps
            on o.part_key = ps.part_key and
                o.supplier_key = ps.supplier_key
)
select *

from
    final f
order by
    f.order_date
    )
[0m13:33:36.041062 [debug] [Thread-1 (]: SQL status: SUCCESS in 34.0 seconds
[0m13:33:36.044816 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (execute): 13:32:59.349907 => 13:33:36.044657
[0m13:33:36.045093 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: ROLLBACK
[0m13:33:36.045313 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: Close
[0m13:33:36.046994 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '937c3cd8-9c4c-4c27-9df3-d29af8ff01ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08ff36ded0>]}
[0m13:33:36.047459 [info ] [Thread-1 (]: 5 of 8 OK created sql table model dbt.fct_orders_items ......................... [[32mSUCCESS[0m in 36.71s]
[0m13:33:36.047851 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.fct_orders_items
[0m13:33:36.048202 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_part_suppliers
[0m13:33:36.048483 [info ] [Thread-1 (]: 6 of 8 START sql table model dbt.dim_part_suppliers ............................ [RUN]
[0m13:33:36.049525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.fct_orders_items, now model.dbt_trino_iceberg.dim_part_suppliers)
[0m13:33:36.049736 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_part_suppliers
[0m13:33:36.059894 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m13:33:36.060800 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (compile): 13:33:36.049850 => 13:33:36.060546
[0m13:33:36.061039 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_part_suppliers
[0m13:33:36.064287 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."dim_part_suppliers"
[0m13:33:36.064793 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m13:33:36.065002 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

    drop table if exists "lakehouse"."dbt"."dim_part_suppliers"
[0m13:33:36.065184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:37.388444 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:33:37.390051 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m13:33:37.397209 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m13:33:37.397503 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from "lakehouse"."dbt"."int_parts_suppliers"

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
order by
    f.part_key,
    f.supplier_key
    )
[0m13:33:48.643291 [debug] [Thread-1 (]: SQL status: SUCCESS in 11.0 seconds
[0m13:33:48.644979 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (execute): 13:33:36.061153 => 13:33:48.644827
[0m13:33:48.645242 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: ROLLBACK
[0m13:33:48.645449 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: Close
[0m13:33:48.646667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '937c3cd8-9c4c-4c27-9df3-d29af8ff01ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08fec31c90>]}
[0m13:33:48.647100 [info ] [Thread-1 (]: 6 of 8 OK created sql table model dbt.dim_part_suppliers ....................... [[32mSUCCESS[0m in 12.60s]
[0m13:33:48.647561 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_part_suppliers
[0m13:33:48.647881 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m13:33:48.648196 [info ] [Thread-1 (]: 7 of 8 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m13:33:48.648789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_part_suppliers, now model.dbt_trino_iceberg.pricing_summary_report)
[0m13:33:48.649053 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m13:33:48.651467 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m13:33:48.653083 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 13:33:48.649215 => 13:33:48.652662
[0m13:33:48.653768 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.pricing_summary_report
[0m13:33:48.659143 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."pricing_summary_report"
[0m13:33:48.659939 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.pricing_summary_report"
[0m13:33:48.660282 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.pricing_summary_report"} */

    drop table if exists "lakehouse"."dbt"."pricing_summary_report"
[0m13:33:48.660597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:50.278756 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m13:33:50.281229 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m13:33:50.284008 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.pricing_summary_report"
[0m13:33:50.284328 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.pricing_summary_report"} */

  
    

    create table "lakehouse"."dbt"."pricing_summary_report"
      
      
    as (
      /*
1 Q1 - Pricing Summary Report Query
This query reports the amount of business that was billed, shipped, and returned. 
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 29)
*/

select 
    f.return_status_code,
    f.order_line_status_code,
    sum(f.quantity) as quantity,
    sum(f.gross_item_sales_amount) as gross_item_sales_amount,
    sum(f.discounted_item_sales_amount) as discounted_item_sales_amount,
    sum(f.net_item_sales_amount) as net_item_sales_amount,

    avg(f.quantity) as avg_quantity,
    avg(f.base_price) as avg_base_price,
    avg(f.discount_percentage) as avg_discount_percentage,

    sum(f.order_item_count) as order_item_count
    
from
    "lakehouse"."dbt"."fct_orders_items" f
where
    f.ship_date <= date_add('day', -90, date_parse('1998-12-01', '%Y-%m-%d'))
group by
    1,2
    )
[0m13:33:53.028589 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.0 seconds
[0m13:33:53.031485 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (execute): 13:33:48.654063 => 13:33:53.031348
[0m13:33:53.031691 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: ROLLBACK
[0m13:33:53.031867 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: Close
[0m13:33:53.032913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '937c3cd8-9c4c-4c27-9df3-d29af8ff01ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08febc3f50>]}
[0m13:33:53.033247 [info ] [Thread-1 (]: 7 of 8 OK created sql table model dbt.pricing_summary_report ................... [[32mSUCCESS[0m in 4.38s]
[0m13:33:53.033630 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m13:33:53.033925 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m13:33:53.034197 [info ] [Thread-1 (]: 8 of 8 START sql table model dbt.minimum_cost_suppliers ........................ [RUN]
[0m13:33:53.034670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.pricing_summary_report, now model.dbt_trino_iceberg.minimum_cost_suppliers)
[0m13:33:53.035064 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m13:33:53.036921 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m13:33:53.037374 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (compile): 13:33:53.035205 => 13:33:53.037239
[0m13:33:53.037572 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m13:33:53.040294 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."minimum_cost_suppliers"
[0m13:33:53.040744 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m13:33:53.040936 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.minimum_cost_suppliers"} */

    drop table if exists "lakehouse"."dbt"."minimum_cost_suppliers"
[0m13:33:53.041104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:54.131112 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:33:54.133035 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m13:33:54.138565 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m13:33:54.138944 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.minimum_cost_suppliers"} */

  
    

    create table "lakehouse"."dbt"."minimum_cost_suppliers"
      
      
    as (
      /*
2 Q2 - Minimum Cost Supplier Query
This query finds which supplier should be selected to place an order for a given part in a given region
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 30)
*/

with parts_suppliers as (

    select
        s.supplier_account_balance,
        s.supplier_name,
        s.supplier_nation_key,
        s.supplier_region_key,
        s.supplier_nation_name,
        s.supplier_region_name,
        s.part_key,
        s.part_manufacturer_name,
        s.part_size,
        s.part_type_name,
        s.supplier_cost_amount,
        s.supplier_address,
        s.supplier_phone_number,
        rank() over(partition by s.supplier_region_key, s.part_key order by s.supplier_cost_amount) as supplier_cost_rank,
        row_number() over(partition by s.supplier_region_key, s.part_key, s.supplier_cost_amount order by s.supplier_account_balance desc) as supplier_rank
    from
        "lakehouse"."dbt"."dim_part_suppliers" s
)
select
    s.*
from
    parts_suppliers s
where
    s.supplier_cost_rank = 1 and 
    s.supplier_rank <= 100
order by 
    s.supplier_name, s.part_key
    )
[0m13:34:02.466294 [debug] [Thread-1 (]: SQL status: SUCCESS in 8.0 seconds
[0m13:34:02.469067 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (execute): 13:33:53.037686 => 13:34:02.468914
[0m13:34:02.469300 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: ROLLBACK
[0m13:34:02.469474 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: Close
[0m13:34:02.470930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '937c3cd8-9c4c-4c27-9df3-d29af8ff01ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08fe8d1a10>]}
[0m13:34:02.471360 [info ] [Thread-1 (]: 8 of 8 OK created sql table model dbt.minimum_cost_suppliers ................... [[32mSUCCESS[0m in 9.44s]
[0m13:34:02.471801 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m13:34:02.474080 [debug] [MainThread]: On master: COMMIT
[0m13:34:02.474566 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:34:02.474739 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.minimum_cost_suppliers' was properly closed.
[0m13:34:02.474988 [info ] [MainThread]: 
[0m13:34:02.475374 [info ] [MainThread]: Finished running 8 table models in 0 hours 2 minutes and 21.83 seconds (141.83s).
[0m13:34:02.477137 [debug] [MainThread]: Command end result
[0m13:34:02.491816 [info ] [MainThread]: 
[0m13:34:02.492362 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:34:02.492699 [info ] [MainThread]: 
[0m13:34:02.493037 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m13:34:02.494073 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 142.1838, "process_user_time": 2.374597, "process_kernel_time": 0.19544, "process_mem_max_rss": "114756", "process_out_blocks": "3944", "process_in_blocks": "0"}
[0m13:34:02.494473 [debug] [MainThread]: Command `dbt run` succeeded at 13:34:02.494392 after 142.18 seconds
[0m13:34:02.494741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f090357b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f090357b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09036f2c10>]}
[0m13:34:02.494991 [debug] [MainThread]: Flushing usage events
[0m13:36:23.336069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6fe447a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6fe8ec6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6fe458110>]}


============================== 13:36:23.337886 | 4c6be505-0788-4eeb-af2d-e42a1e60100b ==============================
[0m13:36:23.337886 [info ] [MainThread]: Running with dbt=1.7.3
[0m13:36:23.338249 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m13:36:23.463155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c6be505-0788-4eeb-af2d-e42a1e60100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6fe27e310>]}
[0m13:36:23.518078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c6be505-0788-4eeb-af2d-e42a1e60100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6fe238990>]}
[0m13:36:23.518586 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m13:36:23.525763 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m13:36:23.545510 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:36:23.545836 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:36:23.552480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c6be505-0788-4eeb-af2d-e42a1e60100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6fe2486d0>]}
[0m13:36:23.561580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c6be505-0788-4eeb-af2d-e42a1e60100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6fdfcbf50>]}
[0m13:36:23.561913 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 537 macros, 0 groups, 0 semantic models
[0m13:36:23.562168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c6be505-0788-4eeb-af2d-e42a1e60100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6fe0c8c50>]}
[0m13:36:23.563331 [info ] [MainThread]: 
[0m13:36:23.563861 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:36:23.564871 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m13:36:23.576110 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m13:36:23.576433 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m13:36:23.576603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:25.302089 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m13:36:25.303016 [debug] [ThreadPool]: On list_lakehouse: Close
[0m13:36:25.305400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m13:36:25.310496 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m13:36:25.310765 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m13:36:25.310968 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:36:26.269794 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:36:26.271219 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m13:36:26.271524 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m13:36:26.274372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c6be505-0788-4eeb-af2d-e42a1e60100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6ff0436d0>]}
[0m13:36:26.274749 [debug] [MainThread]: On master: COMMIT
[0m13:36:26.275145 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:36:26.275368 [info ] [MainThread]: 
[0m13:36:26.278087 [debug] [Thread-1 (]: Began running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m13:36:26.278376 [info ] [Thread-1 (]: 1 of 1 START snapshot dbt.orders_snapshot ...................................... [RUN]
[0m13:36:26.278889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now snapshot.dbt_trino_iceberg.orders_snapshot)
[0m13:36:26.279137 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_trino_iceberg.orders_snapshot
[0m13:36:26.282192 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (compile): 13:36:26.279253 => 13:36:26.282003
[0m13:36:26.282458 [debug] [Thread-1 (]: Began executing node snapshot.dbt_trino_iceberg.orders_snapshot
[0m13:36:26.312253 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m13:36:26.312566 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    describe "lakehouse"."dbt"."orders_snapshot"
[0m13:36:26.312764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:26.922109 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:36:26.924441 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (execute): 13:36:26.282577 => 13:36:26.924133
[0m13:36:26.924978 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: Close
[0m13:36:26.928311 [debug] [Thread-1 (]: Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m13:36:26.928633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c6be505-0788-4eeb-af2d-e42a1e60100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6fe353c10>]}
[0m13:36:26.929174 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting dbt.orders_snapshot .................................. [[31mERROR[0m in 0.65s]
[0m13:36:26.929566 [debug] [Thread-1 (]: Finished running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m13:36:26.930897 [debug] [MainThread]: On master: COMMIT
[0m13:36:26.931267 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:36:26.931421 [debug] [MainThread]: Connection 'snapshot.dbt_trino_iceberg.orders_snapshot' was properly closed.
[0m13:36:26.931581 [info ] [MainThread]: 
[0m13:36:26.931782 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 3.37 seconds (3.37s).
[0m13:36:26.932251 [debug] [MainThread]: Command end result
[0m13:36:26.938646 [info ] [MainThread]: 
[0m13:36:26.939101 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:36:26.939418 [info ] [MainThread]: 
[0m13:36:26.939706 [error] [MainThread]:   Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m13:36:26.939933 [info ] [MainThread]: 
[0m13:36:26.940202 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:36:26.940911 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 3.6311364, "process_user_time": 1.4587, "process_kernel_time": 0.116696, "process_mem_max_rss": "110772", "process_out_blocks": "2392", "command_success": false, "process_in_blocks": "0"}
[0m13:36:26.941321 [debug] [MainThread]: Command `dbt snapshot` failed at 13:36:26.941229 after 3.63 seconds
[0m13:36:26.941661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe702b33710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7029bb490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7029bb4d0>]}
[0m13:36:26.941938 [debug] [MainThread]: Flushing usage events
[0m14:02:28.045482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b6567f050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b65c3e0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b6566e290>]}


============================== 14:02:28.047766 | 85954373-0377-4106-8f56-45ab69443086 ==============================
[0m14:02:28.047766 [info ] [MainThread]: Running with dbt=1.7.3
[0m14:02:28.048295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:02:28.169176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85954373-0377-4106-8f56-45ab69443086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b65467dd0>]}
[0m14:02:28.222275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85954373-0377-4106-8f56-45ab69443086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b660cc790>]}
[0m14:02:28.222700 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m14:02:28.229843 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m14:02:28.237858 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:02:28.238279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '85954373-0377-4106-8f56-45ab69443086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b652d6590>]}
[0m14:02:29.086791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85954373-0377-4106-8f56-45ab69443086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b6560a710>]}
[0m14:02:29.095617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85954373-0377-4106-8f56-45ab69443086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b6538a5d0>]}
[0m14:02:29.095974 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 537 macros, 0 groups, 0 semantic models
[0m14:02:29.096266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85954373-0377-4106-8f56-45ab69443086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b6559bf90>]}
[0m14:02:29.097653 [info ] [MainThread]: 
[0m14:02:29.098300 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:02:29.099751 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m14:02:29.110042 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m14:02:29.110268 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m14:02:29.110431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:02:31.348532 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m14:02:31.349470 [debug] [ThreadPool]: On list_lakehouse: Close
[0m14:02:31.351781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m14:02:31.357340 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m14:02:31.357595 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m14:02:31.357766 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:02:32.452785 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:02:32.454106 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m14:02:32.454350 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m14:02:32.457341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85954373-0377-4106-8f56-45ab69443086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b655c47d0>]}
[0m14:02:32.457713 [debug] [MainThread]: On master: COMMIT
[0m14:02:32.458117 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:02:32.458384 [info ] [MainThread]: 
[0m14:02:32.460933 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_customers
[0m14:02:32.461554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.stg_tpch_customers)
[0m14:02:32.461772 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_customers
[0m14:02:32.464517 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_customers"
[0m14:02:32.465081 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_customers (compile): 14:02:32.461886 => 14:02:32.464904
[0m14:02:32.465719 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_customers
[0m14:02:32.466104 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m14:02:32.466495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_customers, now model.dbt_trino_iceberg.stg_tpch_line_item)
[0m14:02:32.466728 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_line_item
[0m14:02:32.468797 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_line_item"
[0m14:02:32.469548 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_line_item (compile): 14:02:32.466868 => 14:02:32.469354
[0m14:02:32.470189 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m14:02:32.470478 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_nation
[0m14:02:32.470899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_line_item, now model.dbt_trino_iceberg.stg_tpch_nation)
[0m14:02:32.471108 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_nation
[0m14:02:32.473162 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_nation"
[0m14:02:32.474018 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_nation (compile): 14:02:32.471236 => 14:02:32.473811
[0m14:02:32.474741 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_nation
[0m14:02:32.475017 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_orders
[0m14:02:32.475293 [info ] [Thread-1 (]: 1 of 8 START sql table model dbt.stg_tpch_orders ............................... [RUN]
[0m14:02:32.475998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_nation, now model.dbt_trino_iceberg.stg_tpch_orders)
[0m14:02:32.476208 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_orders
[0m14:02:32.478118 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_orders"
[0m14:02:32.478550 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_orders (compile): 14:02:32.476321 => 14:02:32.478421
[0m14:02:32.478763 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.stg_tpch_orders
[0m14:02:32.496078 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."stg_tpch_orders"
[0m14:02:32.497556 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.stg_tpch_orders"
[0m14:02:32.497902 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.stg_tpch_orders"} */

    drop table if exists "lakehouse"."dbt"."stg_tpch_orders"
[0m14:02:32.498200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:02:33.494128 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:02:33.503012 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.stg_tpch_orders"
[0m14:02:33.504389 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.stg_tpch_orders"
[0m14:02:33.504633 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.stg_tpch_orders"} */

  
    

    create table "lakehouse"."dbt"."stg_tpch_orders"
      
      
    as (
      
select
    orderkey as order_key, 
    custkey as customer_key,
    orderstatus as order_status_code,
    totalprice as order_amount,
    orderdate as order_date,
    orderpriority as order_priority_code,
    clerk as order_clerk_name,
    shippriority as shipping_priority,
    comment as order_comment
from
    tpch.sf1.orders
    )
[0m14:02:40.917967 [debug] [Thread-1 (]: SQL status: SUCCESS in 7.0 seconds
[0m14:02:40.930306 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_orders (execute): 14:02:32.478894 => 14:02:40.930161
[0m14:02:40.930566 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_orders: ROLLBACK
[0m14:02:40.930751 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_orders: Close
[0m14:02:40.931821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85954373-0377-4106-8f56-45ab69443086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b47e6a990>]}
[0m14:02:40.932214 [info ] [Thread-1 (]: 1 of 8 OK created sql table model dbt.stg_tpch_orders .......................... [[32mSUCCESS[0m in 8.46s]
[0m14:02:40.932608 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_orders
[0m14:02:40.932955 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part
[0m14:02:40.933349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_orders, now model.dbt_trino_iceberg.stg_tpch_part)
[0m14:02:40.933600 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part
[0m14:02:40.936020 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part"
[0m14:02:40.936638 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part (compile): 14:02:40.934024 => 14:02:40.936493
[0m14:02:40.937112 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part
[0m14:02:40.937363 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m14:02:40.937770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part, now model.dbt_trino_iceberg.stg_tpch_part_suppliers)
[0m14:02:40.937989 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m14:02:40.939870 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part_suppliers"
[0m14:02:40.940553 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part_suppliers (compile): 14:02:40.938113 => 14:02:40.940399
[0m14:02:40.941024 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m14:02:40.941257 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_region
[0m14:02:40.941623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part_suppliers, now model.dbt_trino_iceberg.stg_tpch_region)
[0m14:02:40.941838 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_region
[0m14:02:40.944425 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_region"
[0m14:02:40.945290 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_region (compile): 14:02:40.941990 => 14:02:40.945128
[0m14:02:40.945815 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_region
[0m14:02:40.946101 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m14:02:40.946521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_region, now model.dbt_trino_iceberg.stg_tpch_supplier)
[0m14:02:40.946749 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_supplier
[0m14:02:40.948629 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_supplier"
[0m14:02:40.949207 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_supplier (compile): 14:02:40.946875 => 14:02:40.949052
[0m14:02:40.949695 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m14:02:40.949933 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.int_order_items
[0m14:02:40.950198 [info ] [Thread-1 (]: 2 of 8 START sql table model dbt.int_order_items ............................... [RUN]
[0m14:02:40.950980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_supplier, now model.dbt_trino_iceberg.int_order_items)
[0m14:02:40.951200 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.int_order_items
[0m14:02:40.964513 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.int_order_items"
[0m14:02:40.965137 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_order_items (compile): 14:02:40.951316 => 14:02:40.964951
[0m14:02:40.965370 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.int_order_items
[0m14:02:40.968400 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."int_order_items"
[0m14:02:40.968941 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_order_items"
[0m14:02:40.969150 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_order_items"} */

    drop table if exists "lakehouse"."dbt"."int_order_items"
[0m14:02:40.969322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:02:42.317890 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:02:42.319485 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.int_order_items"
[0m14:02:42.323757 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_order_items"
[0m14:02:42.324038 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_order_items"} */

  
    

    create table "lakehouse"."dbt"."int_order_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_line_item as (

select
    orderkey as order_key,
    partkey as part_key,
    suppkey as supplier_key,
    linenumber as order_line_number,
    quantity as quantity,
    extendedprice as extended_price,
    discount as discount_percentage,
    tax as tax_rate,
    returnflag as return_status_code,
    linestatus as order_line_status_code,
    shipdate as ship_date,
    commitdate as commit_date,
    receiptdate as receipt_date,
    shipinstruct as ship_instructions_desc,
    shipmode as ship_mode_name,
    comment as order_line_comment
from
    tpch.sf1.lineitem
), orders as (
    
    select * from "lakehouse"."dbt"."stg_tpch_orders"

),
line_items as (

    select * from __dbt__cte__stg_tpch_line_item

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(o.order_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l.order_line_number as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as order_item_key,

    o.order_key,
    o.order_date,
    o.customer_key,
    o.order_status_code,
    
    l.part_key,
    l.supplier_key,
    l.return_status_code,
    l.order_line_number,
    l.order_line_status_code,
    l.ship_date,
    l.commit_date,
    l.receipt_date,
    l.ship_mode_name,

    l.quantity,
    
    -- extended_price is actually the line item total,
    -- so we back out the extended price per item
    (l.extended_price/nullif(l.quantity, 0)) as base_price,
    l.discount_percentage,
    ((l.extended_price/nullif(l.quantity, 0)) * (1 - l.discount_percentage)) as discounted_price,

    l.extended_price as gross_item_sales_amount,
    (l.extended_price * (1 - l.discount_percentage)) as discounted_item_sales_amount,
    -- We model discounts as negative amounts
    (-1 * l.extended_price * l.discount_percentage) as item_discount_amount,
    l.tax_rate,
    ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate) as item_tax_amount,
    (
        l.extended_price + 
        (-1 * l.extended_price * l.discount_percentage) + 
        ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate)
    ) as net_item_sales_amount

from
    orders o
    join
    line_items l
        on o.order_key = l.order_key
order by
    o.order_date
    )
[0m14:03:09.057122 [debug] [Thread-1 (]: SQL status: SUCCESS in 27.0 seconds
[0m14:03:09.058669 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_order_items (execute): 14:02:40.965483 => 14:03:09.058541
[0m14:03:09.058896 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: ROLLBACK
[0m14:03:09.059074 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: Close
[0m14:03:09.060202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85954373-0377-4106-8f56-45ab69443086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b47f06790>]}
[0m14:03:09.060541 [info ] [Thread-1 (]: 2 of 8 OK created sql table model dbt.int_order_items .......................... [[32mSUCCESS[0m in 28.11s]
[0m14:03:09.060896 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.int_order_items
[0m14:03:09.061197 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_suppliers
[0m14:03:09.061456 [info ] [Thread-1 (]: 3 of 8 START sql table model dbt.dim_suppliers ................................. [RUN]
[0m14:03:09.062231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.int_order_items, now model.dbt_trino_iceberg.dim_suppliers)
[0m14:03:09.062444 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_suppliers
[0m14:03:09.068033 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_suppliers"
[0m14:03:09.069138 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (compile): 14:03:09.062568 => 14:03:09.068818
[0m14:03:09.069545 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_suppliers
[0m14:03:09.072711 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."dim_suppliers"
[0m14:03:09.073375 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m14:03:09.073813 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt"."dim_suppliers"
[0m14:03:09.074137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:03:10.713838 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m14:03:10.715688 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_suppliers"
[0m14:03:10.718330 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m14:03:10.718589 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt"."dim_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m14:03:12.003619 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:03:12.005179 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (execute): 14:03:09.069727 => 14:03:12.005057
[0m14:03:12.005615 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: ROLLBACK
[0m14:03:12.005875 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: Close
[0m14:03:12.007515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85954373-0377-4106-8f56-45ab69443086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b47e63190>]}
[0m14:03:12.007875 [info ] [Thread-1 (]: 3 of 8 OK created sql table model dbt.dim_suppliers ............................ [[32mSUCCESS[0m in 2.95s]
[0m14:03:12.008241 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_suppliers
[0m14:03:12.008536 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.int_parts_suppliers
[0m14:03:12.008839 [info ] [Thread-1 (]: 4 of 8 START sql table model dbt.int_parts_suppliers ........................... [RUN]
[0m14:03:12.009451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_suppliers, now model.dbt_trino_iceberg.int_parts_suppliers)
[0m14:03:12.009682 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.int_parts_suppliers
[0m14:03:12.019424 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.int_parts_suppliers"
[0m14:03:12.019982 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_parts_suppliers (compile): 14:03:12.009796 => 14:03:12.019818
[0m14:03:12.020193 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.int_parts_suppliers
[0m14:03:12.024924 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."int_parts_suppliers"
[0m14:03:12.025412 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_parts_suppliers"
[0m14:03:12.025613 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_parts_suppliers"} */

    drop table if exists "lakehouse"."dbt"."int_parts_suppliers"
[0m14:03:12.025783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:03:13.243445 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:03:13.244514 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.int_parts_suppliers"
[0m14:03:13.247678 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_parts_suppliers"
[0m14:03:13.247932 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_parts_suppliers"} */

  
    

    create table "lakehouse"."dbt"."int_parts_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
part_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(p.part_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(s.supplier_key as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
			as part_supplier_key,
    --p.part_supplier_key,
	p.part_key,
    p.part_name,
    p.part_manufacturer_name,
    p.part_brand_name,
    p.part_type_name,
    p.part_size,
    p.part_container_desc,
    p.retail_price,

    s.supplier_key,
    s.supplier_name,
    s.nation_key,

    ps.supplier_availabe_quantity,
    ps.supplier_cost_amount
from
    parts p
    join
    part_suppliers ps
        on p.part_key = ps.part_key
    join
    suppliers s
        on ps.supplier_key = s.supplier_key
order by
    p.part_key
    )
[0m14:03:20.907638 [debug] [Thread-1 (]: SQL status: SUCCESS in 8.0 seconds
[0m14:03:20.909572 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_parts_suppliers (execute): 14:03:12.020300 => 14:03:20.909372
[0m14:03:20.909872 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: ROLLBACK
[0m14:03:20.910084 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: Close
[0m14:03:20.911317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85954373-0377-4106-8f56-45ab69443086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b47e4a9d0>]}
[0m14:03:20.911728 [info ] [Thread-1 (]: 4 of 8 OK created sql table model dbt.int_parts_suppliers ...................... [[32mSUCCESS[0m in 8.90s]
[0m14:03:20.912121 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.int_parts_suppliers
[0m14:03:20.912406 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.fct_orders_items
[0m14:03:20.912695 [info ] [Thread-1 (]: 5 of 8 START sql table model dbt.fct_orders_items .............................. [RUN]
[0m14:03:20.913508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.int_parts_suppliers, now model.dbt_trino_iceberg.fct_orders_items)
[0m14:03:20.913742 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.fct_orders_items
[0m14:03:20.921675 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.fct_orders_items"
[0m14:03:20.922198 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (compile): 14:03:20.913857 => 14:03:20.922044
[0m14:03:20.922407 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.fct_orders_items
[0m14:03:20.926160 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."fct_orders_items"
[0m14:03:20.927927 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m14:03:20.928385 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

    drop table if exists "lakehouse"."dbt"."fct_orders_items"
[0m14:03:20.928655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:03:22.381100 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:03:22.382375 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.fct_orders_items"
[0m14:03:22.385790 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m14:03:22.386095 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

  
    

    create table "lakehouse"."dbt"."fct_orders_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), orders_items as (
    
    select * from "lakehouse"."dbt"."int_order_items"

),
parts_suppliers as (
    
    select * from __dbt__cte__stg_tpch_part_suppliers

),
final as (
    select 

        o.order_item_key,
        o.order_key,
        o.order_date,
        o.customer_key,
        o.order_status_code,
        
        o.part_key,
        o.supplier_key,
        o.return_status_code,
        o.order_line_number,
        o.order_line_status_code,
        o.ship_date,
        o.commit_date,
        o.receipt_date,
        o.ship_mode_name,
        ps.supplier_cost_amount,
        
        o.base_price,
        o.discount_percentage,
        o.discounted_price,
        o.tax_rate,
        
        1 as order_item_count,
        o.quantity,

        o.gross_item_sales_amount,
        o.discounted_item_sales_amount,
        o.item_discount_amount,
        o.item_tax_amount,
        o.net_item_sales_amount

    from
        orders_items o
        join
        parts_suppliers ps
            on o.part_key = ps.part_key and
                o.supplier_key = ps.supplier_key
)
select *

from
    final f
order by
    f.order_date
    )
[0m14:03:53.286202 [debug] [Thread-1 (]: SQL status: SUCCESS in 31.0 seconds
[0m14:03:53.289910 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (execute): 14:03:20.922521 => 14:03:53.289607
[0m14:03:53.290542 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: ROLLBACK
[0m14:03:53.290971 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: Close
[0m14:03:53.293297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85954373-0377-4106-8f56-45ab69443086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b47e7f650>]}
[0m14:03:53.293929 [info ] [Thread-1 (]: 5 of 8 OK created sql table model dbt.fct_orders_items ......................... [[32mSUCCESS[0m in 32.38s]
[0m14:03:53.294564 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.fct_orders_items
[0m14:03:53.295184 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_part_suppliers
[0m14:03:53.295744 [info ] [Thread-1 (]: 6 of 8 START sql table model dbt.dim_part_suppliers ............................ [RUN]
[0m14:03:53.296717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.fct_orders_items, now model.dbt_trino_iceberg.dim_part_suppliers)
[0m14:03:53.297152 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_part_suppliers
[0m14:03:53.309170 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m14:03:53.309839 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (compile): 14:03:53.297704 => 14:03:53.309616
[0m14:03:53.310121 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_part_suppliers
[0m14:03:53.313564 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."dim_part_suppliers"
[0m14:03:53.314130 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m14:03:53.314379 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

    drop table if exists "lakehouse"."dbt"."dim_part_suppliers"
[0m14:03:53.314582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:03:54.651691 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:03:54.653600 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m14:03:54.707937 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m14:03:54.718113 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from "lakehouse"."dbt"."int_parts_suppliers"

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
order by
    f.part_key,
    f.supplier_key
    )
[0m14:04:04.240126 [debug] [Thread-1 (]: SQL status: SUCCESS in 10.0 seconds
[0m14:04:04.242524 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (execute): 14:03:53.310252 => 14:04:04.242306
[0m14:04:04.242875 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: ROLLBACK
[0m14:04:04.243108 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: Close
[0m14:04:04.244369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85954373-0377-4106-8f56-45ab69443086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b47ebb090>]}
[0m14:04:04.244813 [info ] [Thread-1 (]: 6 of 8 OK created sql table model dbt.dim_part_suppliers ....................... [[32mSUCCESS[0m in 10.95s]
[0m14:04:04.245238 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_part_suppliers
[0m14:04:04.245609 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m14:04:04.245898 [info ] [Thread-1 (]: 7 of 8 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m14:04:04.246440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_part_suppliers, now model.dbt_trino_iceberg.pricing_summary_report)
[0m14:04:04.246674 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m14:04:04.249258 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m14:04:04.250233 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 14:04:04.246809 => 14:04:04.250080
[0m14:04:04.250443 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.pricing_summary_report
[0m14:04:04.254189 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."pricing_summary_report"
[0m14:04:04.254768 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.pricing_summary_report"
[0m14:04:04.254990 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.pricing_summary_report"} */

    drop table if exists "lakehouse"."dbt"."pricing_summary_report"
[0m14:04:04.255170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:05.503424 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:04:05.505148 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m14:04:05.507286 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.pricing_summary_report"
[0m14:04:05.507518 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.pricing_summary_report"} */

  
    

    create table "lakehouse"."dbt"."pricing_summary_report"
      
      
    as (
      /*
1 Q1 - Pricing Summary Report Query
This query reports the amount of business that was billed, shipped, and returned. 
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 29)
*/

select 
    f.return_status_code,
    f.order_line_status_code,
    sum(f.quantity) as quantity,
    sum(f.gross_item_sales_amount) as gross_item_sales_amount,
    sum(f.discounted_item_sales_amount) as discounted_item_sales_amount,
    sum(f.net_item_sales_amount) as net_item_sales_amount,

    avg(f.quantity) as avg_quantity,
    avg(f.base_price) as avg_base_price,
    avg(f.discount_percentage) as avg_discount_percentage,

    sum(f.order_item_count) as order_item_count
    
from
    "lakehouse"."dbt"."fct_orders_items" f
where
    f.ship_date <= date_add('day', -90, date_parse('1998-12-01', '%Y-%m-%d'))
group by
    1,2
    )
[0m14:04:08.354009 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.0 seconds
[0m14:04:08.355761 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (execute): 14:04:04.250591 => 14:04:08.355635
[0m14:04:08.356025 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: ROLLBACK
[0m14:04:08.356223 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: Close
[0m14:04:08.357320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85954373-0377-4106-8f56-45ab69443086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b47c919d0>]}
[0m14:04:08.357671 [info ] [Thread-1 (]: 7 of 8 OK created sql table model dbt.pricing_summary_report ................... [[32mSUCCESS[0m in 4.11s]
[0m14:04:08.358040 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m14:04:08.358331 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m14:04:08.358620 [info ] [Thread-1 (]: 8 of 8 START sql table model dbt.minimum_cost_suppliers ........................ [RUN]
[0m14:04:08.359173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.pricing_summary_report, now model.dbt_trino_iceberg.minimum_cost_suppliers)
[0m14:04:08.359395 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m14:04:08.363055 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m14:04:08.363966 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (compile): 14:04:08.359531 => 14:04:08.363779
[0m14:04:08.364183 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m14:04:08.368159 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."minimum_cost_suppliers"
[0m14:04:08.368844 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m14:04:08.369063 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.minimum_cost_suppliers"} */

    drop table if exists "lakehouse"."dbt"."minimum_cost_suppliers"
[0m14:04:08.369246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:09.156885 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:04:09.158043 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m14:04:09.160174 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m14:04:09.160433 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.minimum_cost_suppliers"} */

  
    

    create table "lakehouse"."dbt"."minimum_cost_suppliers"
      
      
    as (
      /*
2 Q2 - Minimum Cost Supplier Query
This query finds which supplier should be selected to place an order for a given part in a given region
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 30)
*/

with parts_suppliers as (

    select
        s.supplier_account_balance,
        s.supplier_name,
        s.supplier_nation_key,
        s.supplier_region_key,
        s.supplier_nation_name,
        s.supplier_region_name,
        s.part_key,
        s.part_manufacturer_name,
        s.part_size,
        s.part_type_name,
        s.supplier_cost_amount,
        s.supplier_address,
        s.supplier_phone_number,
        rank() over(partition by s.supplier_region_key, s.part_key order by s.supplier_cost_amount) as supplier_cost_rank,
        row_number() over(partition by s.supplier_region_key, s.part_key, s.supplier_cost_amount order by s.supplier_account_balance desc) as supplier_rank
    from
        "lakehouse"."dbt"."dim_part_suppliers" s
)
select
    s.*
from
    parts_suppliers s
where
    s.supplier_cost_rank = 1 and 
    s.supplier_rank <= 100
order by 
    s.supplier_name, s.part_key
    )
[0m14:04:16.470482 [debug] [Thread-1 (]: SQL status: SUCCESS in 7.0 seconds
[0m14:04:16.472843 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (execute): 14:04:08.364296 => 14:04:16.472625
[0m14:04:16.473177 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: ROLLBACK
[0m14:04:16.473384 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: Close
[0m14:04:16.474664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85954373-0377-4106-8f56-45ab69443086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b65449a50>]}
[0m14:04:16.475070 [info ] [Thread-1 (]: 8 of 8 OK created sql table model dbt.minimum_cost_suppliers ................... [[32mSUCCESS[0m in 8.12s]
[0m14:04:16.475489 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m14:04:16.477145 [debug] [MainThread]: On master: COMMIT
[0m14:04:16.477494 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:16.477646 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.minimum_cost_suppliers' was properly closed.
[0m14:04:16.477854 [info ] [MainThread]: 
[0m14:04:16.478060 [info ] [MainThread]: Finished running 8 table models in 0 hours 1 minutes and 47.38 seconds (107.38s).
[0m14:04:16.479328 [debug] [MainThread]: Command end result
[0m14:04:16.486821 [info ] [MainThread]: 
[0m14:04:16.487284 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:04:16.487660 [info ] [MainThread]: 
[0m14:04:16.487976 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m14:04:16.488902 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 108.46928, "process_user_time": 2.950228, "process_kernel_time": 0.207033, "process_mem_max_rss": "119972", "process_out_blocks": "3904", "process_in_blocks": "0"}
[0m14:04:16.489294 [debug] [MainThread]: Command `dbt run` succeeded at 14:04:16.489219 after 108.47 seconds
[0m14:04:16.489551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b69e54fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b655ac310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b69d67450>]}
[0m14:04:16.489810 [debug] [MainThread]: Flushing usage events
[0m14:04:22.477965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3160dfa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3160dcd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe31611fc10>]}


============================== 14:04:22.479751 | 7ac33e04-36c0-4456-a2fa-8e533209d2a0 ==============================
[0m14:04:22.479751 [info ] [MainThread]: Running with dbt=1.7.3
[0m14:04:22.480092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m14:04:22.599411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ac33e04-36c0-4456-a2fa-8e533209d2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe315ea4d10>]}
[0m14:04:22.653765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ac33e04-36c0-4456-a2fa-8e533209d2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe315f55690>]}
[0m14:04:22.654201 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m14:04:22.661225 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m14:04:22.679390 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:04:22.679669 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:04:22.683938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ac33e04-36c0-4456-a2fa-8e533209d2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe315b86650>]}
[0m14:04:22.692732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ac33e04-36c0-4456-a2fa-8e533209d2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe315e47a50>]}
[0m14:04:22.693188 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 537 macros, 0 groups, 0 semantic models
[0m14:04:22.693458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ac33e04-36c0-4456-a2fa-8e533209d2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe315df6f50>]}
[0m14:04:22.694808 [info ] [MainThread]: 
[0m14:04:22.695382 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:04:22.696179 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m14:04:22.707205 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m14:04:22.707482 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m14:04:22.707649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:24.271616 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m14:04:24.273144 [debug] [ThreadPool]: On list_lakehouse: Close
[0m14:04:24.276564 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m14:04:24.282288 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m14:04:24.282577 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m14:04:24.282751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:25.702461 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:04:25.704266 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m14:04:25.704559 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m14:04:25.707054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ac33e04-36c0-4456-a2fa-8e533209d2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe315e1c8d0>]}
[0m14:04:25.707324 [debug] [MainThread]: On master: COMMIT
[0m14:04:25.707694 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:04:25.707908 [info ] [MainThread]: 
[0m14:04:25.710691 [debug] [Thread-1 (]: Began running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m14:04:25.710982 [info ] [Thread-1 (]: 1 of 1 START snapshot dbt.orders_snapshot ...................................... [RUN]
[0m14:04:25.711456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now snapshot.dbt_trino_iceberg.orders_snapshot)
[0m14:04:25.711679 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_trino_iceberg.orders_snapshot
[0m14:04:25.714501 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (compile): 14:04:25.711975 => 14:04:25.714355
[0m14:04:25.714718 [debug] [Thread-1 (]: Began executing node snapshot.dbt_trino_iceberg.orders_snapshot
[0m14:04:25.743466 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m14:04:25.743945 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    describe "lakehouse"."dbt"."orders_snapshot"
[0m14:04:25.744167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:26.857736 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:04:26.859495 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (execute): 14:04:25.714837 => 14:04:26.859236
[0m14:04:26.859908 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: Close
[0m14:04:26.862962 [debug] [Thread-1 (]: Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m14:04:26.863263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ac33e04-36c0-4456-a2fa-8e533209d2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe315e3f350>]}
[0m14:04:26.863703 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting dbt.orders_snapshot .................................. [[31mERROR[0m in 1.15s]
[0m14:04:26.864112 [debug] [Thread-1 (]: Finished running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m14:04:26.865970 [debug] [MainThread]: On master: COMMIT
[0m14:04:26.866333 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:26.866493 [debug] [MainThread]: Connection 'snapshot.dbt_trino_iceberg.orders_snapshot' was properly closed.
[0m14:04:26.866657 [info ] [MainThread]: 
[0m14:04:26.866855 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.17 seconds (4.17s).
[0m14:04:26.867238 [debug] [MainThread]: Command end result
[0m14:04:26.873681 [info ] [MainThread]: 
[0m14:04:26.874043 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:04:26.874260 [info ] [MainThread]: 
[0m14:04:26.874462 [error] [MainThread]:   Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m14:04:26.874694 [info ] [MainThread]: 
[0m14:04:26.874918 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:04:26.875533 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 4.423232, "process_user_time": 1.432134, "process_kernel_time": 0.100149, "process_mem_max_rss": "110800", "process_out_blocks": "2392", "command_success": false, "process_in_blocks": "0"}
[0m14:04:26.875837 [debug] [MainThread]: Command `dbt snapshot` failed at 14:04:26.875768 after 4.42 seconds
[0m14:04:26.876070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe31a7cb710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3160f6f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3160f7a10>]}
[0m14:04:26.876284 [debug] [MainThread]: Flushing usage events
[0m14:29:57.155237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1b3a37d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1ba69b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1b3a3cd0>]}


============================== 14:29:57.157166 | 68b04bff-50bb-4613-ba16-0a56549de4c0 ==============================
[0m14:29:57.157166 [info ] [MainThread]: Running with dbt=1.7.3
[0m14:29:57.157558 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --debug snapshot', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:29:57.285791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68b04bff-50bb-4613-ba16-0a56549de4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1b2905d0>]}
[0m14:29:57.345347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68b04bff-50bb-4613-ba16-0a56549de4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1b2905d0>]}
[0m14:29:57.345834 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m14:29:57.353469 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m14:29:57.372202 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:29:57.372630 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:29:57.377050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68b04bff-50bb-4613-ba16-0a56549de4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1bf01310>]}
[0m14:29:57.386309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68b04bff-50bb-4613-ba16-0a56549de4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1b0efbd0>]}
[0m14:29:57.386866 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 537 macros, 0 groups, 0 semantic models
[0m14:29:57.387213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68b04bff-50bb-4613-ba16-0a56549de4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1b1a4a10>]}
[0m14:29:57.388815 [info ] [MainThread]: 
[0m14:29:57.389503 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:29:57.390375 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m14:29:57.401956 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m14:29:57.402342 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m14:29:57.402942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:59.070252 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m14:29:59.071673 [debug] [ThreadPool]: On list_lakehouse: Close
[0m14:29:59.074494 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m14:29:59.080200 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m14:29:59.080526 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m14:29:59.080818 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:30:00.816521 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m14:30:00.817892 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m14:30:00.818109 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m14:30:00.820793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68b04bff-50bb-4613-ba16-0a56549de4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1b1c1550>]}
[0m14:30:00.821118 [debug] [MainThread]: On master: COMMIT
[0m14:30:00.821610 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:30:00.821818 [info ] [MainThread]: 
[0m14:30:00.823955 [debug] [Thread-1 (]: Began running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m14:30:00.824283 [info ] [Thread-1 (]: 1 of 1 START snapshot dbt.orders_snapshot ...................................... [RUN]
[0m14:30:00.824827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now snapshot.dbt_trino_iceberg.orders_snapshot)
[0m14:30:00.825086 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_trino_iceberg.orders_snapshot
[0m14:30:00.828715 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (compile): 14:30:00.825596 => 14:30:00.828486
[0m14:30:00.829249 [debug] [Thread-1 (]: Began executing node snapshot.dbt_trino_iceberg.orders_snapshot
[0m14:30:00.859187 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m14:30:00.859579 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    describe "lakehouse"."dbt"."orders_snapshot"
[0m14:30:00.859890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:01.761734 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:30:01.763223 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (execute): 14:30:00.829451 => 14:30:01.763022
[0m14:30:01.763728 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: Close
[0m14:30:01.766389 [debug] [Thread-1 (]: Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m14:30:01.766805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68b04bff-50bb-4613-ba16-0a56549de4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1af56a50>]}
[0m14:30:01.767387 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting dbt.orders_snapshot .................................. [[31mERROR[0m in 0.94s]
[0m14:30:01.767832 [debug] [Thread-1 (]: Finished running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m14:30:01.769378 [debug] [MainThread]: On master: COMMIT
[0m14:30:01.769878 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:30:01.770097 [debug] [MainThread]: Connection 'snapshot.dbt_trino_iceberg.orders_snapshot' was properly closed.
[0m14:30:01.770359 [info ] [MainThread]: 
[0m14:30:01.770600 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.38 seconds (4.38s).
[0m14:30:01.771045 [debug] [MainThread]: Command end result
[0m14:30:01.777664 [info ] [MainThread]: 
[0m14:30:01.778046 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:30:01.778274 [info ] [MainThread]: 
[0m14:30:01.778486 [error] [MainThread]:   Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m14:30:01.778769 [info ] [MainThread]: 
[0m14:30:01.779002 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:30:01.779633 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 4.6511574, "process_user_time": 1.520042, "process_kernel_time": 0.099349, "process_mem_max_rss": "110468", "process_out_blocks": "2392", "command_success": false, "process_in_blocks": "0"}
[0m14:30:01.780153 [debug] [MainThread]: Command `dbt snapshot` failed at 14:30:01.780055 after 4.65 seconds
[0m14:30:01.780489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1b38e710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1b382850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1b283850>]}
[0m14:30:01.780788 [debug] [MainThread]: Flushing usage events
[0m14:53:33.104044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f651cbf6750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f651cbf7950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f651cbdaa10>]}


============================== 14:53:33.106109 | eab7fe2d-58c5-40fd-91cb-9b7e752061f2 ==============================
[0m14:53:33.106109 [info ] [MainThread]: Running with dbt=1.7.3
[0m14:53:33.106518 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --debug snapshot', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:53:33.230201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eab7fe2d-58c5-40fd-91cb-9b7e752061f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f651c95d450>]}
[0m14:53:33.285484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eab7fe2d-58c5-40fd-91cb-9b7e752061f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f651c993810>]}
[0m14:53:33.286004 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m14:53:33.292741 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m14:53:33.310562 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:53:33.310897 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:53:33.315789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eab7fe2d-58c5-40fd-91cb-9b7e752061f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f651c80c3d0>]}
[0m14:53:33.325597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eab7fe2d-58c5-40fd-91cb-9b7e752061f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f651c733cd0>]}
[0m14:53:33.326060 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 537 macros, 0 groups, 0 semantic models
[0m14:53:33.326376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eab7fe2d-58c5-40fd-91cb-9b7e752061f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f651cabbd50>]}
[0m14:53:33.327839 [info ] [MainThread]: 
[0m14:53:33.328647 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:53:33.329671 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m14:53:33.341544 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m14:53:33.341905 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m14:53:33.342231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:35.028873 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m14:53:35.029953 [debug] [ThreadPool]: On list_lakehouse: Close
[0m14:53:35.032302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m14:53:35.037637 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m14:53:35.038031 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m14:53:35.038337 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:36.558574 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m14:53:36.560094 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m14:53:36.560465 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m14:53:36.563419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eab7fe2d-58c5-40fd-91cb-9b7e752061f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f651c85a310>]}
[0m14:53:36.563777 [debug] [MainThread]: On master: COMMIT
[0m14:53:36.564293 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:53:36.564519 [info ] [MainThread]: 
[0m14:53:36.567217 [debug] [Thread-1 (]: Began running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m14:53:36.567743 [info ] [Thread-1 (]: 1 of 1 START snapshot dbt.orders_snapshot ...................................... [RUN]
[0m14:53:36.568480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now snapshot.dbt_trino_iceberg.orders_snapshot)
[0m14:53:36.568809 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_trino_iceberg.orders_snapshot
[0m14:53:36.572021 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (compile): 14:53:36.569012 => 14:53:36.571843
[0m14:53:36.572364 [debug] [Thread-1 (]: Began executing node snapshot.dbt_trino_iceberg.orders_snapshot
[0m14:53:36.602277 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m14:53:36.602682 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    describe "lakehouse"."dbt"."orders_snapshot"
[0m14:53:36.603010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:37.863859 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:53:37.865493 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (execute): 14:53:36.572569 => 14:53:37.865292
[0m14:53:37.865857 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: Close
[0m14:53:37.868516 [debug] [Thread-1 (]: Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m14:53:37.869051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eab7fe2d-58c5-40fd-91cb-9b7e752061f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f651c726e50>]}
[0m14:53:37.869698 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting dbt.orders_snapshot .................................. [[31mERROR[0m in 1.30s]
[0m14:53:37.870196 [debug] [Thread-1 (]: Finished running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m14:53:37.871538 [debug] [MainThread]: On master: COMMIT
[0m14:53:37.871969 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:37.872198 [debug] [MainThread]: Connection 'snapshot.dbt_trino_iceberg.orders_snapshot' was properly closed.
[0m14:53:37.872444 [info ] [MainThread]: 
[0m14:53:37.872686 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.54 seconds (4.54s).
[0m14:53:37.873071 [debug] [MainThread]: Command end result
[0m14:53:37.881304 [info ] [MainThread]: 
[0m14:53:37.881674 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:53:37.881901 [info ] [MainThread]: 
[0m14:53:37.882133 [error] [MainThread]:   Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m14:53:37.882348 [info ] [MainThread]: 
[0m14:53:37.882617 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:53:37.883272 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 4.8055415, "process_user_time": 1.388593, "process_kernel_time": 0.177267, "process_mem_max_rss": "110348", "process_out_blocks": "2392", "command_success": false, "process_in_blocks": "0"}
[0m14:53:37.883676 [debug] [MainThread]: Command `dbt snapshot` failed at 14:53:37.883594 after 4.81 seconds
[0m14:53:37.884012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f651cbaea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6521211110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f651c8b3310>]}
[0m14:53:37.884321 [debug] [MainThread]: Flushing usage events
[0m14:56:31.141523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20abca4dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20abce3e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20abca4c10>]}


============================== 14:56:31.143381 | acc73c95-c810-407e-9d98-e19fff839e9d ==============================
[0m14:56:31.143381 [info ] [MainThread]: Running with dbt=1.7.3
[0m14:56:31.143800 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --debug snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:56:31.268016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acc73c95-c810-407e-9d98-e19fff839e9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20abd0bad0>]}
[0m14:56:31.323652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'acc73c95-c810-407e-9d98-e19fff839e9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20aba3bcd0>]}
[0m14:56:31.324135 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m14:56:31.331853 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m14:56:31.348808 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:56:31.349483 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://snapshots/orders.sql
[0m14:56:31.451097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acc73c95-c810-407e-9d98-e19fff839e9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20abae9550>]}
[0m14:56:31.460039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acc73c95-c810-407e-9d98-e19fff839e9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ab736a90>]}
[0m14:56:31.460581 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 537 macros, 0 groups, 0 semantic models
[0m14:56:31.460861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acc73c95-c810-407e-9d98-e19fff839e9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ab7581d0>]}
[0m14:56:31.462125 [info ] [MainThread]: 
[0m14:56:31.462690 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:56:31.463615 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m14:56:31.474182 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m14:56:31.474557 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m14:56:31.474891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:33.176318 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m14:56:33.177885 [debug] [ThreadPool]: On list_lakehouse: Close
[0m14:56:33.180874 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m14:56:33.186529 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m14:56:33.186844 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m14:56:33.187120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:56:34.585043 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:56:34.587233 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m14:56:34.587549 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m14:56:34.590381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acc73c95-c810-407e-9d98-e19fff839e9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ab666b50>]}
[0m14:56:34.590838 [debug] [MainThread]: On master: COMMIT
[0m14:56:34.591392 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:56:34.591654 [info ] [MainThread]: 
[0m14:56:34.594427 [debug] [Thread-1 (]: Began running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m14:56:34.594823 [info ] [Thread-1 (]: 1 of 1 START snapshot dbt.orders_snapshot ...................................... [RUN]
[0m14:56:34.595386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now snapshot.dbt_trino_iceberg.orders_snapshot)
[0m14:56:34.595640 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_trino_iceberg.orders_snapshot
[0m14:56:34.598181 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (compile): 14:56:34.595819 => 14:56:34.598028
[0m14:56:34.598474 [debug] [Thread-1 (]: Began executing node snapshot.dbt_trino_iceberg.orders_snapshot
[0m14:56:34.628720 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m14:56:34.629121 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    describe "lakehouse"."dbt"."orders_snapshot"
[0m14:56:34.629427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:36.124415 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:56:36.126201 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (execute): 14:56:34.598723 => 14:56:36.125939
[0m14:56:36.126654 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: Close
[0m14:56:36.129254 [debug] [Thread-1 (]: Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m14:56:36.129597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acc73c95-c810-407e-9d98-e19fff839e9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ab5c77d0>]}
[0m14:56:36.130198 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting dbt.orders_snapshot .................................. [[31mERROR[0m in 1.53s]
[0m14:56:36.130576 [debug] [Thread-1 (]: Finished running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m14:56:36.132106 [debug] [MainThread]: On master: COMMIT
[0m14:56:36.132601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:56:36.132877 [debug] [MainThread]: Connection 'snapshot.dbt_trino_iceberg.orders_snapshot' was properly closed.
[0m14:56:36.133151 [info ] [MainThread]: 
[0m14:56:36.133392 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.67 seconds (4.67s).
[0m14:56:36.133822 [debug] [MainThread]: Command end result
[0m14:56:36.148244 [info ] [MainThread]: 
[0m14:56:36.148722 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:56:36.149107 [info ] [MainThread]: 
[0m14:56:36.149331 [error] [MainThread]:   Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m14:56:36.149562 [info ] [MainThread]: 
[0m14:56:36.149849 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:56:36.150392 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 5.0401616, "process_user_time": 1.585078, "process_kernel_time": 0.058706, "process_mem_max_rss": "113072", "process_out_blocks": "3536", "command_success": false, "process_in_blocks": "0"}
[0m14:56:36.150832 [debug] [MainThread]: Command `dbt snapshot` failed at 14:56:36.150738 after 5.04 seconds
[0m14:56:36.151119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20abca7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20abcafb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20b023b2d0>]}
[0m14:56:36.151387 [debug] [MainThread]: Flushing usage events
[0m14:59:44.545313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c5e986d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c5e984a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c5e986a10>]}


============================== 14:59:44.547346 | f3d76317-31a9-44a5-9b91-776ab93c6472 ==============================
[0m14:59:44.547346 [info ] [MainThread]: Running with dbt=1.7.3
[0m14:59:44.547777 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m14:59:44.671921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3d76317-31a9-44a5-9b91-776ab93c6472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c5e9c7e90>]}
[0m14:59:44.724527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3d76317-31a9-44a5-9b91-776ab93c6472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c5e71b090>]}
[0m14:59:44.724940 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m14:59:44.731549 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m14:59:44.748803 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:59:44.749408 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://snapshots/orders.sql
[0m14:59:44.831580 [error] [MainThread]: Encountered an error:
Parsing Error
  at path []: A snapshot configured with the check strategy must specify a check_cols configuration.
[0m14:59:44.832265 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 0.31229067, "process_user_time": 1.380174, "process_kernel_time": 0.040005, "process_mem_max_rss": "105304", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m14:59:44.832665 [debug] [MainThread]: Command `dbt snapshot` failed at 14:59:44.832577 after 0.31 seconds
[0m14:59:44.832905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c5e984750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c5e986790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c602cb010>]}
[0m14:59:44.833123 [debug] [MainThread]: Flushing usage events
[0m15:00:06.016294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04e98b0bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04e9432c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04e9431150>]}


============================== 15:00:06.018071 | a2dacd6d-d652-4bb2-872e-3784e4f5616e ==============================
[0m15:00:06.018071 [info ] [MainThread]: Running with dbt=1.7.3
[0m15:00:06.018464 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:00:06.138552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2dacd6d-d652-4bb2-872e-3784e4f5616e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04e91b5450>]}
[0m15:00:06.190782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2dacd6d-d652-4bb2-872e-3784e4f5616e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04e946fd90>]}
[0m15:00:06.191191 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m15:00:06.198791 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m15:00:06.215497 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:00:06.215985 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://snapshots/orders.sql
[0m15:00:06.315800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2dacd6d-d652-4bb2-872e-3784e4f5616e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04e8ea0c90>]}
[0m15:00:06.325009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2dacd6d-d652-4bb2-872e-3784e4f5616e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04e9068050>]}
[0m15:00:06.325646 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 537 macros, 0 groups, 0 semantic models
[0m15:00:06.326092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2dacd6d-d652-4bb2-872e-3784e4f5616e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04e8ecf190>]}
[0m15:00:06.328456 [info ] [MainThread]: 
[0m15:00:06.329305 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m15:00:06.330331 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m15:00:06.340763 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m15:00:06.341028 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m15:00:06.341206 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:08.271060 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m15:00:08.272188 [debug] [ThreadPool]: On list_lakehouse: Close
[0m15:00:08.275199 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m15:00:08.280269 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m15:00:08.280634 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m15:00:08.280854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:09.817065 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m15:00:09.819515 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m15:00:09.819787 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m15:00:09.822450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2dacd6d-d652-4bb2-872e-3784e4f5616e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04e8ecf190>]}
[0m15:00:09.822775 [debug] [MainThread]: On master: COMMIT
[0m15:00:09.823184 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:00:09.823407 [info ] [MainThread]: 
[0m15:00:09.826074 [debug] [Thread-1 (]: Began running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m15:00:09.826403 [info ] [Thread-1 (]: 1 of 1 START snapshot dbt.orders_snapshot ...................................... [RUN]
[0m15:00:09.826886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now snapshot.dbt_trino_iceberg.orders_snapshot)
[0m15:00:09.827120 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_trino_iceberg.orders_snapshot
[0m15:00:09.829576 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (compile): 15:00:09.827252 => 15:00:09.829430
[0m15:00:09.829785 [debug] [Thread-1 (]: Began executing node snapshot.dbt_trino_iceberg.orders_snapshot
[0m15:00:09.863594 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m15:00:09.863910 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */
select * from (
        



select * from tpch.sf1.orders

    ) as __dbt_sbq
    where false
    limit 0
[0m15:00:09.864103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:10.893293 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m15:00:10.901871 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m15:00:10.902159 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    describe "lakehouse"."dbt"."orders_snapshot"
[0m15:00:11.929711 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m15:00:11.937083 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m15:00:11.937361 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    describe "lakehouse"."dbt"."orders_snapshot"
[0m15:00:13.631222 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m15:00:13.632990 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (execute): 15:00:09.829916 => 15:00:13.632685
[0m15:00:13.633409 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: Close
[0m15:00:13.635986 [debug] [Thread-1 (]: Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m15:00:13.636306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2dacd6d-d652-4bb2-872e-3784e4f5616e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04e8c879d0>]}
[0m15:00:13.636751 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting dbt.orders_snapshot .................................. [[31mERROR[0m in 3.81s]
[0m15:00:13.637141 [debug] [Thread-1 (]: Finished running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m15:00:13.638609 [debug] [MainThread]: On master: COMMIT
[0m15:00:13.639057 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:00:13.639217 [debug] [MainThread]: Connection 'snapshot.dbt_trino_iceberg.orders_snapshot' was properly closed.
[0m15:00:13.639381 [info ] [MainThread]: 
[0m15:00:13.639584 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.31 seconds (7.31s).
[0m15:00:13.639977 [debug] [MainThread]: Command end result
[0m15:00:13.646673 [info ] [MainThread]: 
[0m15:00:13.647134 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:00:13.647429 [info ] [MainThread]: 
[0m15:00:13.647692 [error] [MainThread]:   Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m15:00:13.647985 [info ] [MainThread]: 
[0m15:00:13.648251 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:00:13.648848 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 7.6578054, "process_user_time": 1.644726, "process_kernel_time": 0.030838, "process_mem_max_rss": "114112", "process_out_blocks": "3544", "command_success": false, "process_in_blocks": "0"}
[0m15:00:13.649164 [debug] [MainThread]: Command `dbt snapshot` failed at 15:00:13.649077 after 7.66 seconds
[0m15:00:13.649379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04e9432c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04e9413ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04e98b0cd0>]}
[0m15:00:13.649590 [debug] [MainThread]: Flushing usage events
[0m16:05:03.930789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecde039150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecde4c8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecde4c8790>]}


============================== 16:05:03.932768 | 74e21ed2-f90d-4f21-ab94-1bc7e24fdf53 ==============================
[0m16:05:03.932768 [info ] [MainThread]: Running with dbt=1.7.3
[0m16:05:03.933175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:05:04.060778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74e21ed2-f90d-4f21-ab94-1bc7e24fdf53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecdde58dd0>]}
[0m16:05:04.116157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74e21ed2-f90d-4f21-ab94-1bc7e24fdf53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecdde6a250>]}
[0m16:05:04.116666 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m16:05:04.124622 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m16:05:04.142524 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:05:04.143024 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://snapshots/orders.sql
[0m16:05:04.247705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74e21ed2-f90d-4f21-ab94-1bc7e24fdf53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecdda3e7d0>]}
[0m16:05:04.257286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74e21ed2-f90d-4f21-ab94-1bc7e24fdf53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecddc686d0>]}
[0m16:05:04.257634 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 537 macros, 0 groups, 0 semantic models
[0m16:05:04.257938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74e21ed2-f90d-4f21-ab94-1bc7e24fdf53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecddac6dd0>]}
[0m16:05:04.259465 [info ] [MainThread]: 
[0m16:05:04.260171 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:05:04.261277 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m16:05:04.272480 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m16:05:04.272778 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m16:05:04.272956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:06.559842 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m16:05:06.562446 [debug] [ThreadPool]: On list_lakehouse: Close
[0m16:05:06.564751 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m16:05:06.570582 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m16:05:06.571047 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m16:05:06.571237 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:05:08.539785 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m16:05:08.540965 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m16:05:08.541152 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m16:05:08.543672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74e21ed2-f90d-4f21-ab94-1bc7e24fdf53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecdde7e610>]}
[0m16:05:08.543969 [debug] [MainThread]: On master: COMMIT
[0m16:05:08.544368 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:05:08.544607 [info ] [MainThread]: 
[0m16:05:08.547710 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_customers
[0m16:05:08.548199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.stg_tpch_customers)
[0m16:05:08.548422 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_customers
[0m16:05:08.550560 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_customers"
[0m16:05:08.551403 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_customers (compile): 16:05:08.548541 => 16:05:08.551241
[0m16:05:08.551942 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_customers
[0m16:05:08.552229 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m16:05:08.552650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_customers, now model.dbt_trino_iceberg.stg_tpch_line_item)
[0m16:05:08.552890 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_line_item
[0m16:05:08.554910 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_line_item"
[0m16:05:08.555551 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_line_item (compile): 16:05:08.553038 => 16:05:08.555387
[0m16:05:08.556069 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m16:05:08.556325 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_nation
[0m16:05:08.556739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_line_item, now model.dbt_trino_iceberg.stg_tpch_nation)
[0m16:05:08.556963 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_nation
[0m16:05:08.558930 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_nation"
[0m16:05:08.559569 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_nation (compile): 16:05:08.557111 => 16:05:08.559404
[0m16:05:08.560154 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_nation
[0m16:05:08.560412 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_orders
[0m16:05:08.560688 [info ] [Thread-1 (]: 1 of 8 START sql table model dbt.stg_tpch_orders ............................... [RUN]
[0m16:05:08.561177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_nation, now model.dbt_trino_iceberg.stg_tpch_orders)
[0m16:05:08.561409 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_orders
[0m16:05:08.563283 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_orders"
[0m16:05:08.564120 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_orders (compile): 16:05:08.561544 => 16:05:08.563932
[0m16:05:08.564455 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.stg_tpch_orders
[0m16:05:08.581646 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."stg_tpch_orders"
[0m16:05:08.583194 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.stg_tpch_orders"
[0m16:05:08.583484 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.stg_tpch_orders"} */

    drop table if exists "lakehouse"."dbt"."stg_tpch_orders"
[0m16:05:08.583732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:09.293095 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m16:05:09.304171 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.stg_tpch_orders"
[0m16:05:09.305573 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.stg_tpch_orders"
[0m16:05:09.305841 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.stg_tpch_orders"} */

  
    

    create table "lakehouse"."dbt"."stg_tpch_orders"
      
      
    as (
      
select
    orderkey as order_key, 
    custkey as customer_key,
    orderstatus as order_status_code,
    totalprice as order_amount,
    orderdate as order_date,
    orderpriority as order_priority_code,
    clerk as order_clerk_name,
    shippriority as shipping_priority,
    comment as order_comment
from
    tpch.sf1.orders
    )
[0m16:05:29.105412 [debug] [Thread-1 (]: SQL status: SUCCESS in 20.0 seconds
[0m16:05:29.118809 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_orders (execute): 16:05:08.564621 => 16:05:29.118651
[0m16:05:29.119092 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_orders: ROLLBACK
[0m16:05:29.119295 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_orders: Close
[0m16:05:29.120562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74e21ed2-f90d-4f21-ab94-1bc7e24fdf53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecdd905e50>]}
[0m16:05:29.121041 [info ] [Thread-1 (]: 1 of 8 OK created sql table model dbt.stg_tpch_orders .......................... [[32mSUCCESS[0m in 20.56s]
[0m16:05:29.121472 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_orders
[0m16:05:29.121988 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part
[0m16:05:29.122809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_orders, now model.dbt_trino_iceberg.stg_tpch_part)
[0m16:05:29.123145 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part
[0m16:05:29.125996 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part"
[0m16:05:29.126963 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part (compile): 16:05:29.123396 => 16:05:29.126779
[0m16:05:29.127568 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part
[0m16:05:29.127847 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m16:05:29.128478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part, now model.dbt_trino_iceberg.stg_tpch_part_suppliers)
[0m16:05:29.128708 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m16:05:29.131006 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part_suppliers"
[0m16:05:29.131601 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part_suppliers (compile): 16:05:29.128829 => 16:05:29.131454
[0m16:05:29.132132 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m16:05:29.132394 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_region
[0m16:05:29.132883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part_suppliers, now model.dbt_trino_iceberg.stg_tpch_region)
[0m16:05:29.133109 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_region
[0m16:05:29.135445 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_region"
[0m16:05:29.136000 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_region (compile): 16:05:29.133247 => 16:05:29.135838
[0m16:05:29.136560 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_region
[0m16:05:29.136843 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m16:05:29.137250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_region, now model.dbt_trino_iceberg.stg_tpch_supplier)
[0m16:05:29.137475 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_supplier
[0m16:05:29.139693 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_supplier"
[0m16:05:29.140383 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_supplier (compile): 16:05:29.137612 => 16:05:29.140212
[0m16:05:29.140931 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m16:05:29.141205 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.int_order_items
[0m16:05:29.141487 [info ] [Thread-1 (]: 2 of 8 START sql table model dbt.int_order_items ............................... [RUN]
[0m16:05:29.141960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_supplier, now model.dbt_trino_iceberg.int_order_items)
[0m16:05:29.142263 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.int_order_items
[0m16:05:29.163741 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.int_order_items"
[0m16:05:29.164665 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_order_items (compile): 16:05:29.142409 => 16:05:29.164453
[0m16:05:29.164994 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.int_order_items
[0m16:05:29.170263 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."int_order_items"
[0m16:05:29.171019 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_order_items"
[0m16:05:29.171390 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_order_items"} */

    drop table if exists "lakehouse"."dbt"."int_order_items"
[0m16:05:29.171656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:30.516723 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m16:05:30.517853 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.int_order_items"
[0m16:05:30.522636 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_order_items"
[0m16:05:30.522996 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_order_items"} */

  
    

    create table "lakehouse"."dbt"."int_order_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_line_item as (

select
    orderkey as order_key,
    partkey as part_key,
    suppkey as supplier_key,
    linenumber as order_line_number,
    quantity as quantity,
    extendedprice as extended_price,
    discount as discount_percentage,
    tax as tax_rate,
    returnflag as return_status_code,
    linestatus as order_line_status_code,
    shipdate as ship_date,
    commitdate as commit_date,
    receiptdate as receipt_date,
    shipinstruct as ship_instructions_desc,
    shipmode as ship_mode_name,
    comment as order_line_comment
from
    tpch.sf1.lineitem
), orders as (
    
    select * from "lakehouse"."dbt"."stg_tpch_orders"

),
line_items as (

    select * from __dbt__cte__stg_tpch_line_item

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(o.order_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l.order_line_number as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as order_item_key,

    o.order_key,
    o.order_date,
    o.customer_key,
    o.order_status_code,
    
    l.part_key,
    l.supplier_key,
    l.return_status_code,
    l.order_line_number,
    l.order_line_status_code,
    l.ship_date,
    l.commit_date,
    l.receipt_date,
    l.ship_mode_name,

    l.quantity,
    
    -- extended_price is actually the line item total,
    -- so we back out the extended price per item
    (l.extended_price/nullif(l.quantity, 0)) as base_price,
    l.discount_percentage,
    ((l.extended_price/nullif(l.quantity, 0)) * (1 - l.discount_percentage)) as discounted_price,

    l.extended_price as gross_item_sales_amount,
    (l.extended_price * (1 - l.discount_percentage)) as discounted_item_sales_amount,
    -- We model discounts as negative amounts
    (-1 * l.extended_price * l.discount_percentage) as item_discount_amount,
    l.tax_rate,
    ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate) as item_tax_amount,
    (
        l.extended_price + 
        (-1 * l.extended_price * l.discount_percentage) + 
        ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate)
    ) as net_item_sales_amount

from
    orders o
    join
    line_items l
        on o.order_key = l.order_key
order by
    o.order_date
    )
[0m16:06:07.869046 [debug] [Thread-1 (]: SQL status: SUCCESS in 37.0 seconds
[0m16:06:07.872058 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_order_items (execute): 16:05:29.165180 => 16:06:07.871926
[0m16:06:07.872311 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: ROLLBACK
[0m16:06:07.872506 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: Close
[0m16:06:07.873846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74e21ed2-f90d-4f21-ab94-1bc7e24fdf53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecdd956650>]}
[0m16:06:07.874321 [info ] [Thread-1 (]: 2 of 8 OK created sql table model dbt.int_order_items .......................... [[32mSUCCESS[0m in 38.73s]
[0m16:06:07.874780 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.int_order_items
[0m16:06:07.875134 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_suppliers
[0m16:06:07.875438 [info ] [Thread-1 (]: 3 of 8 START sql table model dbt.dim_suppliers ................................. [RUN]
[0m16:06:07.876012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.int_order_items, now model.dbt_trino_iceberg.dim_suppliers)
[0m16:06:07.876255 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_suppliers
[0m16:06:07.881698 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_suppliers"
[0m16:06:07.882623 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (compile): 16:06:07.876410 => 16:06:07.882460
[0m16:06:07.882838 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_suppliers
[0m16:06:07.885764 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."dim_suppliers"
[0m16:06:07.886232 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m16:06:07.886443 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt"."dim_suppliers"
[0m16:06:07.886626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:09.215831 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m16:06:09.219270 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_suppliers"
[0m16:06:09.222070 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m16:06:09.222321 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt"."dim_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m16:06:10.679419 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m16:06:10.682541 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (execute): 16:06:07.882960 => 16:06:10.682272
[0m16:06:10.683012 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: ROLLBACK
[0m16:06:10.683366 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: Close
[0m16:06:10.685109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74e21ed2-f90d-4f21-ab94-1bc7e24fdf53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecdda08050>]}
[0m16:06:10.685661 [info ] [Thread-1 (]: 3 of 8 OK created sql table model dbt.dim_suppliers ............................ [[32mSUCCESS[0m in 2.81s]
[0m16:06:10.686254 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_suppliers
[0m16:06:10.686610 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.int_parts_suppliers
[0m16:06:10.686931 [info ] [Thread-1 (]: 4 of 8 START sql table model dbt.int_parts_suppliers ........................... [RUN]
[0m16:06:10.687713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_suppliers, now model.dbt_trino_iceberg.int_parts_suppliers)
[0m16:06:10.687999 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.int_parts_suppliers
[0m16:06:10.698585 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.int_parts_suppliers"
[0m16:06:10.699824 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_parts_suppliers (compile): 16:06:10.688155 => 16:06:10.699496
[0m16:06:10.701769 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.int_parts_suppliers
[0m16:06:10.705876 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."int_parts_suppliers"
[0m16:06:10.706655 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_parts_suppliers"
[0m16:06:10.706982 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_parts_suppliers"} */

    drop table if exists "lakehouse"."dbt"."int_parts_suppliers"
[0m16:06:10.707188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:11.339699 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m16:06:11.340829 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.int_parts_suppliers"
[0m16:06:11.345318 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_parts_suppliers"
[0m16:06:11.345662 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_parts_suppliers"} */

  
    

    create table "lakehouse"."dbt"."int_parts_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
part_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(p.part_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(s.supplier_key as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
			as part_supplier_key,
    --p.part_supplier_key,
	p.part_key,
    p.part_name,
    p.part_manufacturer_name,
    p.part_brand_name,
    p.part_type_name,
    p.part_size,
    p.part_container_desc,
    p.retail_price,

    s.supplier_key,
    s.supplier_name,
    s.nation_key,

    ps.supplier_availabe_quantity,
    ps.supplier_cost_amount
from
    parts p
    join
    part_suppliers ps
        on p.part_key = ps.part_key
    join
    suppliers s
        on ps.supplier_key = s.supplier_key
order by
    p.part_key
    )
[0m16:06:18.482461 [debug] [Thread-1 (]: SQL status: SUCCESS in 7.0 seconds
[0m16:06:18.484434 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_parts_suppliers (execute): 16:06:10.701913 => 16:06:18.484280
[0m16:06:18.484673 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: ROLLBACK
[0m16:06:18.485026 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: Close
[0m16:06:18.486827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74e21ed2-f90d-4f21-ab94-1bc7e24fdf53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecddf55510>]}
[0m16:06:18.487381 [info ] [Thread-1 (]: 4 of 8 OK created sql table model dbt.int_parts_suppliers ...................... [[32mSUCCESS[0m in 7.80s]
[0m16:06:18.487892 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.int_parts_suppliers
[0m16:06:18.488240 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.fct_orders_items
[0m16:06:18.488596 [info ] [Thread-1 (]: 5 of 8 START sql table model dbt.fct_orders_items .............................. [RUN]
[0m16:06:18.489698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.int_parts_suppliers, now model.dbt_trino_iceberg.fct_orders_items)
[0m16:06:18.489946 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.fct_orders_items
[0m16:06:18.499193 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.fct_orders_items"
[0m16:06:18.500156 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (compile): 16:06:18.490078 => 16:06:18.499852
[0m16:06:18.500413 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.fct_orders_items
[0m16:06:18.504300 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."fct_orders_items"
[0m16:06:18.504978 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m16:06:18.505238 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

    drop table if exists "lakehouse"."dbt"."fct_orders_items"
[0m16:06:18.505487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:19.599498 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m16:06:19.603374 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.fct_orders_items"
[0m16:06:19.607963 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m16:06:19.608251 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

  
    

    create table "lakehouse"."dbt"."fct_orders_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), orders_items as (
    
    select * from "lakehouse"."dbt"."int_order_items"

),
parts_suppliers as (
    
    select * from __dbt__cte__stg_tpch_part_suppliers

),
final as (
    select 

        o.order_item_key,
        o.order_key,
        o.order_date,
        o.customer_key,
        o.order_status_code,
        
        o.part_key,
        o.supplier_key,
        o.return_status_code,
        o.order_line_number,
        o.order_line_status_code,
        o.ship_date,
        o.commit_date,
        o.receipt_date,
        o.ship_mode_name,
        ps.supplier_cost_amount,
        
        o.base_price,
        o.discount_percentage,
        o.discounted_price,
        o.tax_rate,
        
        1 as order_item_count,
        o.quantity,

        o.gross_item_sales_amount,
        o.discounted_item_sales_amount,
        o.item_discount_amount,
        o.item_tax_amount,
        o.net_item_sales_amount

    from
        orders_items o
        join
        parts_suppliers ps
            on o.part_key = ps.part_key and
                o.supplier_key = ps.supplier_key
)
select *

from
    final f
order by
    f.order_date
    )
[0m16:06:51.959985 [debug] [Thread-1 (]: SQL status: SUCCESS in 32.0 seconds
[0m16:06:51.962371 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (execute): 16:06:18.500533 => 16:06:51.962220
[0m16:06:51.962620 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: ROLLBACK
[0m16:06:51.962860 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: Close
[0m16:06:51.964108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74e21ed2-f90d-4f21-ab94-1bc7e24fdf53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecde8a8290>]}
[0m16:06:51.964534 [info ] [Thread-1 (]: 5 of 8 OK created sql table model dbt.fct_orders_items ......................... [[32mSUCCESS[0m in 33.47s]
[0m16:06:51.964912 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.fct_orders_items
[0m16:06:51.965249 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_part_suppliers
[0m16:06:51.965932 [info ] [Thread-1 (]: 6 of 8 START sql table model dbt.dim_part_suppliers ............................ [RUN]
[0m16:06:51.966435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.fct_orders_items, now model.dbt_trino_iceberg.dim_part_suppliers)
[0m16:06:51.966677 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_part_suppliers
[0m16:06:51.976111 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m16:06:51.976680 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (compile): 16:06:51.966816 => 16:06:51.976515
[0m16:06:51.976907 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_part_suppliers
[0m16:06:51.979734 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."dim_part_suppliers"
[0m16:06:51.980202 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m16:06:51.980413 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

    drop table if exists "lakehouse"."dbt"."dim_part_suppliers"
[0m16:06:51.980597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:53.367299 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m16:06:53.369513 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m16:06:53.375348 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m16:06:53.375656 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from "lakehouse"."dbt"."int_parts_suppliers"

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
order by
    f.part_key,
    f.supplier_key
    )
[0m16:07:04.743556 [debug] [Thread-1 (]: SQL status: SUCCESS in 11.0 seconds
[0m16:07:04.747029 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (execute): 16:06:51.977027 => 16:07:04.746846
[0m16:07:04.747392 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: ROLLBACK
[0m16:07:04.747729 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: Close
[0m16:07:04.749425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74e21ed2-f90d-4f21-ab94-1bc7e24fdf53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecddd0fcd0>]}
[0m16:07:04.750070 [info ] [Thread-1 (]: 6 of 8 OK created sql table model dbt.dim_part_suppliers ....................... [[32mSUCCESS[0m in 12.78s]
[0m16:07:04.750630 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_part_suppliers
[0m16:07:04.751007 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m16:07:04.751822 [info ] [Thread-1 (]: 7 of 8 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m16:07:04.752532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_part_suppliers, now model.dbt_trino_iceberg.pricing_summary_report)
[0m16:07:04.752818 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m16:07:04.755189 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m16:07:04.755771 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 16:07:04.752939 => 16:07:04.755609
[0m16:07:04.755992 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.pricing_summary_report
[0m16:07:04.759127 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."pricing_summary_report"
[0m16:07:04.759712 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.pricing_summary_report"
[0m16:07:04.759928 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.pricing_summary_report"} */

    drop table if exists "lakehouse"."dbt"."pricing_summary_report"
[0m16:07:04.760114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:06.116738 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m16:07:06.118364 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m16:07:06.120800 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.pricing_summary_report"
[0m16:07:06.121095 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.pricing_summary_report"} */

  
    

    create table "lakehouse"."dbt"."pricing_summary_report"
      
      
    as (
      /*
1 Q1 - Pricing Summary Report Query
This query reports the amount of business that was billed, shipped, and returned. 
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 29)
*/

select 
    f.return_status_code,
    f.order_line_status_code,
    sum(f.quantity) as quantity,
    sum(f.gross_item_sales_amount) as gross_item_sales_amount,
    sum(f.discounted_item_sales_amount) as discounted_item_sales_amount,
    sum(f.net_item_sales_amount) as net_item_sales_amount,

    avg(f.quantity) as avg_quantity,
    avg(f.base_price) as avg_base_price,
    avg(f.discount_percentage) as avg_discount_percentage,

    sum(f.order_item_count) as order_item_count
    
from
    "lakehouse"."dbt"."fct_orders_items" f
where
    f.ship_date <= date_add('day', -90, date_parse('1998-12-01', '%Y-%m-%d'))
group by
    1,2
    )
[0m16:07:08.679792 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.0 seconds
[0m16:07:08.682765 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (execute): 16:07:04.756109 => 16:07:08.682637
[0m16:07:08.682983 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: ROLLBACK
[0m16:07:08.683188 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: Close
[0m16:07:08.684335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74e21ed2-f90d-4f21-ab94-1bc7e24fdf53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecdd9d6c50>]}
[0m16:07:08.684694 [info ] [Thread-1 (]: 7 of 8 OK created sql table model dbt.pricing_summary_report ................... [[32mSUCCESS[0m in 3.93s]
[0m16:07:08.685076 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m16:07:08.685386 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m16:07:08.685688 [info ] [Thread-1 (]: 8 of 8 START sql table model dbt.minimum_cost_suppliers ........................ [RUN]
[0m16:07:08.686444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.pricing_summary_report, now model.dbt_trino_iceberg.minimum_cost_suppliers)
[0m16:07:08.686706 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m16:07:08.689343 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m16:07:08.690060 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (compile): 16:07:08.686869 => 16:07:08.689832
[0m16:07:08.690293 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m16:07:08.693207 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."minimum_cost_suppliers"
[0m16:07:08.693769 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m16:07:08.693986 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.minimum_cost_suppliers"} */

    drop table if exists "lakehouse"."dbt"."minimum_cost_suppliers"
[0m16:07:08.694172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:09.938159 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m16:07:09.939366 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m16:07:09.946831 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m16:07:09.947308 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.minimum_cost_suppliers"} */

  
    

    create table "lakehouse"."dbt"."minimum_cost_suppliers"
      
      
    as (
      /*
2 Q2 - Minimum Cost Supplier Query
This query finds which supplier should be selected to place an order for a given part in a given region
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 30)
*/

with parts_suppliers as (

    select
        s.supplier_account_balance,
        s.supplier_name,
        s.supplier_nation_key,
        s.supplier_region_key,
        s.supplier_nation_name,
        s.supplier_region_name,
        s.part_key,
        s.part_manufacturer_name,
        s.part_size,
        s.part_type_name,
        s.supplier_cost_amount,
        s.supplier_address,
        s.supplier_phone_number,
        rank() over(partition by s.supplier_region_key, s.part_key order by s.supplier_cost_amount) as supplier_cost_rank,
        row_number() over(partition by s.supplier_region_key, s.part_key, s.supplier_cost_amount order by s.supplier_account_balance desc) as supplier_rank
    from
        "lakehouse"."dbt"."dim_part_suppliers" s
)
select
    s.*
from
    parts_suppliers s
where
    s.supplier_cost_rank = 1 and 
    s.supplier_rank <= 100
order by 
    s.supplier_name, s.part_key
    )
[0m16:07:16.612489 [debug] [Thread-1 (]: SQL status: SUCCESS in 7.0 seconds
[0m16:07:16.614253 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (execute): 16:07:08.690413 => 16:07:16.614119
[0m16:07:16.614510 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: ROLLBACK
[0m16:07:16.614701 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: Close
[0m16:07:16.616017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74e21ed2-f90d-4f21-ab94-1bc7e24fdf53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecddf8a290>]}
[0m16:07:16.616388 [info ] [Thread-1 (]: 8 of 8 OK created sql table model dbt.minimum_cost_suppliers ................... [[32mSUCCESS[0m in 7.93s]
[0m16:07:16.616804 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m16:07:16.618909 [debug] [MainThread]: On master: COMMIT
[0m16:07:16.619349 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:07:16.619522 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.minimum_cost_suppliers' was properly closed.
[0m16:07:16.619729 [info ] [MainThread]: 
[0m16:07:16.619950 [info ] [MainThread]: Finished running 8 table models in 0 hours 2 minutes and 12.36 seconds (132.36s).
[0m16:07:16.620951 [debug] [MainThread]: Command end result
[0m16:07:16.628835 [info ] [MainThread]: 
[0m16:07:16.629295 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:07:16.629647 [info ] [MainThread]: 
[0m16:07:16.629979 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m16:07:16.630934 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 132.72601, "process_user_time": 2.25028, "process_kernel_time": 0.218381, "process_mem_max_rss": "116528", "process_out_blocks": "3960", "process_in_blocks": "0"}
[0m16:07:16.631353 [debug] [MainThread]: Command `dbt run` succeeded at 16:07:16.631271 after 132.73 seconds
[0m16:07:16.631616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fece263b450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fece2729190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fece27b2c90>]}
[0m16:07:16.631885 [debug] [MainThread]: Flushing usage events
[0m16:24:18.792053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc88607d090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8860ab3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8860aae90>]}


============================== 16:24:18.793904 | 3525445c-5a43-4adc-ac91-bf5e063bb6cd ==============================
[0m16:24:18.793904 [info ] [MainThread]: Running with dbt=1.7.3
[0m16:24:18.794273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m16:24:18.918954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3525445c-5a43-4adc-ac91-bf5e063bb6cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc885de6290>]}
[0m16:24:18.973973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3525445c-5a43-4adc-ac91-bf5e063bb6cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc885e0c6d0>]}
[0m16:24:18.974489 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m16:24:18.981603 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m16:24:18.999735 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:24:19.000203 [debug] [MainThread]: Partial parsing: added file: dbt_trino_iceberg://macros/create_schema.sql
[0m16:24:19.011255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3525445c-5a43-4adc-ac91-bf5e063bb6cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc885e57490>]}
[0m16:24:19.020127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3525445c-5a43-4adc-ac91-bf5e063bb6cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc885d12ad0>]}
[0m16:24:19.020561 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m16:24:19.020832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3525445c-5a43-4adc-ac91-bf5e063bb6cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc885d3de10>]}
[0m16:24:19.022066 [info ] [MainThread]: 
[0m16:24:19.022962 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:24:19.024071 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m16:24:19.035394 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m16:24:19.035643 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m16:24:19.035818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:20.604255 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m16:24:20.606488 [debug] [ThreadPool]: On list_lakehouse: Close
[0m16:24:20.609823 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m16:24:20.615388 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m16:24:20.615632 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m16:24:20.615842 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:24:21.449740 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:24:21.452351 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m16:24:21.452755 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m16:24:21.455416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3525445c-5a43-4adc-ac91-bf5e063bb6cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc886c5b9d0>]}
[0m16:24:21.455727 [debug] [MainThread]: On master: COMMIT
[0m16:24:21.456150 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:24:21.456413 [info ] [MainThread]: 
[0m16:24:21.459478 [debug] [Thread-1 (]: Began running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m16:24:21.459796 [info ] [Thread-1 (]: 1 of 1 START snapshot dbt.orders_snapshot ...................................... [RUN]
[0m16:24:21.460302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now snapshot.dbt_trino_iceberg.orders_snapshot)
[0m16:24:21.460528 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_trino_iceberg.orders_snapshot
[0m16:24:21.463056 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (compile): 16:24:21.460649 => 16:24:21.462898
[0m16:24:21.463301 [debug] [Thread-1 (]: Began executing node snapshot.dbt_trino_iceberg.orders_snapshot
[0m16:24:21.492954 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m16:24:21.493284 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    describe "lakehouse"."dbt"."orders_snapshot"
[0m16:24:21.493486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:22.502917 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m16:24:22.506312 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (execute): 16:24:21.463436 => 16:24:22.505946
[0m16:24:22.506634 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: Close
[0m16:24:22.509993 [debug] [Thread-1 (]: Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m16:24:22.510307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3525445c-5a43-4adc-ac91-bf5e063bb6cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc885bff310>]}
[0m16:24:22.510782 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting dbt.orders_snapshot .................................. [[31mERROR[0m in 1.05s]
[0m16:24:22.511186 [debug] [Thread-1 (]: Finished running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m16:24:22.512740 [debug] [MainThread]: On master: COMMIT
[0m16:24:22.513137 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:24:22.513307 [debug] [MainThread]: Connection 'snapshot.dbt_trino_iceberg.orders_snapshot' was properly closed.
[0m16:24:22.513483 [info ] [MainThread]: 
[0m16:24:22.513711 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 3.49 seconds (3.49s).
[0m16:24:22.514203 [debug] [MainThread]: Command end result
[0m16:24:22.521341 [info ] [MainThread]: 
[0m16:24:22.521693 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:24:22.521996 [info ] [MainThread]: 
[0m16:24:22.522362 [error] [MainThread]:   Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m16:24:22.522622 [info ] [MainThread]: 
[0m16:24:22.522877 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:24:22.523513 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 3.7575035, "process_user_time": 1.430706, "process_kernel_time": 0.094125, "process_mem_max_rss": "111596", "process_out_blocks": "3536", "command_success": false, "process_in_blocks": "0"}
[0m16:24:22.523862 [debug] [MainThread]: Command `dbt snapshot` failed at 16:24:22.523763 after 3.76 seconds
[0m16:24:22.524109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc88606e9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc88a72f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc88a5b7550>]}
[0m16:24:22.524324 [debug] [MainThread]: Flushing usage events
[0m16:31:07.378638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aed7276d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aed727350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aed76bb10>]}


============================== 16:31:07.380499 | ed98c827-8c73-4918-9174-34b2fabf57d1 ==============================
[0m16:31:07.380499 [info ] [MainThread]: Running with dbt=1.7.3
[0m16:31:07.380880 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot --model order2.sql', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:31:07.503330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed98c827-8c73-4918-9174-34b2fabf57d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aed537c10>]}
[0m16:31:07.556738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed98c827-8c73-4918-9174-34b2fabf57d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aed78f410>]}
[0m16:31:07.557169 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m16:31:07.564066 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m16:31:07.582055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:31:07.582552 [debug] [MainThread]: Partial parsing: added file: dbt_trino_iceberg://snapshots/order2.sql
[0m16:31:07.594213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed98c827-8c73-4918-9174-34b2fabf57d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aed45a190>]}
[0m16:31:07.603182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed98c827-8c73-4918-9174-34b2fabf57d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aed361f50>]}
[0m16:31:07.603555 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m16:31:07.603819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed98c827-8c73-4918-9174-34b2fabf57d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aed2b3fd0>]}
[0m16:31:07.604455 [warn ] [MainThread]: The selection criterion 'order2.sql' does not match any nodes
[0m16:31:07.605185 [info ] [MainThread]: 
[0m16:31:07.605441 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:31:07.605782 [debug] [MainThread]: Command end result
[0m16:31:07.611964 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.25892574, "process_user_time": 1.236969, "process_kernel_time": 0.027693, "process_mem_max_rss": "106372", "process_out_blocks": "3520", "process_in_blocks": "0"}
[0m16:31:07.612361 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:31:07.612271 after 0.26 seconds
[0m16:31:07.612596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1af1cbf4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1af1dad2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1af1e3ac90>]}
[0m16:31:07.612821 [debug] [MainThread]: Flushing usage events
[0m16:31:25.817442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe59e0bf090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe59e0bf490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe59e0bf210>]}


============================== 16:31:25.819186 | 6df9a1c4-c319-488f-bf73-f3c6cb1417d0 ==============================
[0m16:31:25.819186 [info ] [MainThread]: Running with dbt=1.7.3
[0m16:31:25.819557 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:31:25.943853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6df9a1c4-c319-488f-bf73-f3c6cb1417d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe59dcfd450>]}
[0m16:31:25.999473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6df9a1c4-c319-488f-bf73-f3c6cb1417d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe59df27190>]}
[0m16:31:25.999940 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m16:31:26.006986 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m16:31:26.024528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:31:26.024877 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:31:26.029360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6df9a1c4-c319-488f-bf73-f3c6cb1417d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe59e560c90>]}
[0m16:31:26.038406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6df9a1c4-c319-488f-bf73-f3c6cb1417d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe59dc435d0>]}
[0m16:31:26.038752 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m16:31:26.039043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6df9a1c4-c319-488f-bf73-f3c6cb1417d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe59dd45390>]}
[0m16:31:26.040276 [info ] [MainThread]: 
[0m16:31:26.040836 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:31:26.041946 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m16:31:26.053334 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m16:31:26.053646 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m16:31:26.053830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:27.492159 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:31:27.495507 [debug] [ThreadPool]: On list_lakehouse: Close
[0m16:31:27.498162 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m16:31:27.504079 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m16:31:27.504589 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m16:31:27.504775 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:28.905462 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:31:28.908059 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m16:31:28.908512 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m16:31:28.911419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6df9a1c4-c319-488f-bf73-f3c6cb1417d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe59eabb490>]}
[0m16:31:28.911762 [debug] [MainThread]: On master: COMMIT
[0m16:31:28.912175 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:31:28.912407 [info ] [MainThread]: 
[0m16:31:28.915580 [debug] [Thread-1 (]: Began running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m16:31:28.915899 [info ] [Thread-1 (]: 1 of 1 START snapshot dbt.orders_snapshot ...................................... [RUN]
[0m16:31:28.916621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now snapshot.dbt_trino_iceberg.orders_snapshot)
[0m16:31:28.916856 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_trino_iceberg.orders_snapshot
[0m16:31:28.920213 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (compile): 16:31:28.916983 => 16:31:28.920016
[0m16:31:28.920548 [debug] [Thread-1 (]: Began executing node snapshot.dbt_trino_iceberg.orders_snapshot
[0m16:31:28.949878 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m16:31:28.950214 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    describe "lakehouse"."dbt"."orders_snapshot"
[0m16:31:28.950438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:29.847517 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m16:31:29.849505 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (execute): 16:31:28.920683 => 16:31:29.849355
[0m16:31:29.849740 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: Close
[0m16:31:29.852054 [debug] [Thread-1 (]: Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m16:31:29.852349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6df9a1c4-c319-488f-bf73-f3c6cb1417d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe59da60990>]}
[0m16:31:29.852829 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting dbt.orders_snapshot .................................. [[31mERROR[0m in 0.94s]
[0m16:31:29.853347 [debug] [Thread-1 (]: Finished running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m16:31:29.854791 [debug] [MainThread]: On master: COMMIT
[0m16:31:29.855210 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:29.855378 [debug] [MainThread]: Connection 'snapshot.dbt_trino_iceberg.orders_snapshot' was properly closed.
[0m16:31:29.855556 [info ] [MainThread]: 
[0m16:31:29.855776 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 3.82 seconds (3.82s).
[0m16:31:29.856246 [debug] [MainThread]: Command end result
[0m16:31:29.862953 [info ] [MainThread]: 
[0m16:31:29.864176 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:31:29.864495 [info ] [MainThread]: 
[0m16:31:29.864869 [error] [MainThread]:   Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m16:31:29.865195 [info ] [MainThread]: 
[0m16:31:29.865533 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:31:29.866201 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 4.074626, "process_user_time": 1.41607, "process_kernel_time": 0.093162, "process_mem_max_rss": "111244", "process_out_blocks": "2392", "command_success": false, "process_in_blocks": "0"}
[0m16:31:29.866522 [debug] [MainThread]: Command `dbt snapshot` failed at 16:31:29.866448 after 4.08 seconds
[0m16:31:29.866747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5a277b8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5a277b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe59e0c4350>]}
[0m16:31:29.866956 [debug] [MainThread]: Flushing usage events
[0m09:12:28.479152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94655b3bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94655b1ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94655b3ad0>]}


============================== 09:12:28.480963 | 0159233d-dbdf-45f8-bd26-140138733f33 ==============================
[0m09:12:28.480963 [info ] [MainThread]: Running with dbt=1.7.3
[0m09:12:28.481307 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m09:12:28.602622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0159233d-dbdf-45f8-bd26-140138733f33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9465380210>]}
[0m09:12:28.655278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0159233d-dbdf-45f8-bd26-140138733f33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94653e99d0>]}
[0m09:12:28.655714 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m09:12:28.662566 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m09:12:28.681951 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:12:28.682384 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://snapshots/order2.sql
[0m09:12:28.693887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0159233d-dbdf-45f8-bd26-140138733f33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9465382d50>]}
[0m09:12:28.703345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0159233d-dbdf-45f8-bd26-140138733f33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9465025b50>]}
[0m09:12:28.703790 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m09:12:28.704052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0159233d-dbdf-45f8-bd26-140138733f33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9465356890>]}
[0m09:12:28.705356 [info ] [MainThread]: 
[0m09:12:28.705929 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m09:12:28.707728 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m09:12:28.718823 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m09:12:28.719099 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m09:12:28.719259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:12:30.412835 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m09:12:30.414247 [debug] [ThreadPool]: On list_lakehouse: Close
[0m09:12:30.417150 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m09:12:30.422188 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m09:12:30.422480 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m09:12:30.422683 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:12:32.133615 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m09:12:32.135859 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m09:12:32.136066 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m09:12:32.139093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0159233d-dbdf-45f8-bd26-140138733f33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9465211890>]}
[0m09:12:32.139511 [debug] [MainThread]: On master: COMMIT
[0m09:12:32.140079 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:12:32.140429 [info ] [MainThread]: 
[0m09:12:32.144294 [debug] [Thread-1 (]: Began running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m09:12:32.144753 [info ] [Thread-1 (]: 1 of 1 START snapshot dbt.orders_snapshot ...................................... [RUN]
[0m09:12:32.145548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now snapshot.dbt_trino_iceberg.orders_snapshot)
[0m09:12:32.145891 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_trino_iceberg.orders_snapshot
[0m09:12:32.148911 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (compile): 09:12:32.146104 => 09:12:32.148770
[0m09:12:32.149141 [debug] [Thread-1 (]: Began executing node snapshot.dbt_trino_iceberg.orders_snapshot
[0m09:12:32.178079 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m09:12:32.178386 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    describe "lakehouse"."dbt"."orders_snapshot"
[0m09:12:32.178578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:35.409044 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.0 seconds
[0m09:12:35.412320 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (execute): 09:12:32.149254 => 09:12:35.411841
[0m09:12:35.413062 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: Close
[0m09:12:35.417115 [debug] [Thread-1 (]: Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m09:12:35.417488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0159233d-dbdf-45f8-bd26-140138733f33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9465040c10>]}
[0m09:12:35.417941 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting dbt.orders_snapshot .................................. [[31mERROR[0m in 3.27s]
[0m09:12:35.418318 [debug] [Thread-1 (]: Finished running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m09:12:35.420053 [debug] [MainThread]: On master: COMMIT
[0m09:12:35.420545 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:12:35.420760 [debug] [MainThread]: Connection 'snapshot.dbt_trino_iceberg.orders_snapshot' was properly closed.
[0m09:12:35.420980 [info ] [MainThread]: 
[0m09:12:35.421262 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.72 seconds (6.72s).
[0m09:12:35.421856 [debug] [MainThread]: Command end result
[0m09:12:35.429718 [info ] [MainThread]: 
[0m09:12:35.430067 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:12:35.430454 [info ] [MainThread]: 
[0m09:12:35.430805 [error] [MainThread]:   Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m09:12:35.431153 [info ] [MainThread]: 
[0m09:12:35.431470 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:12:35.432256 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 6.979254, "process_user_time": 1.563788, "process_kernel_time": 0.100242, "process_mem_max_rss": "111604", "process_out_blocks": "3544", "command_success": false, "process_in_blocks": "0"}
[0m09:12:35.432538 [debug] [MainThread]: Command `dbt snapshot` failed at 09:12:35.432471 after 6.98 seconds
[0m09:12:35.432744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9469c7b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9469b03490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9465256990>]}
[0m09:12:35.432992 [debug] [MainThread]: Flushing usage events
[0m10:01:41.428688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f273e1c7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f273e1c4f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f273e1c7c50>]}


============================== 10:01:41.431564 | bb1a4ceb-8b96-49e5-9ea5-6fc8e57e0ce1 ==============================
[0m10:01:41.431564 [info ] [MainThread]: Running with dbt=1.7.3
[0m10:01:41.432071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:01:41.552826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb1a4ceb-8b96-49e5-9ea5-6fc8e57e0ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f273dfe8790>]}
[0m10:01:41.604795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb1a4ceb-8b96-49e5-9ea5-6fc8e57e0ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f273e1c7610>]}
[0m10:01:41.605207 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m10:01:41.612182 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m10:01:41.634684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:01:41.635067 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:01:41.639799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb1a4ceb-8b96-49e5-9ea5-6fc8e57e0ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f273dfeb890>]}
[0m10:01:41.650864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb1a4ceb-8b96-49e5-9ea5-6fc8e57e0ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f273dd4bf10>]}
[0m10:01:41.651294 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m10:01:41.651590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb1a4ceb-8b96-49e5-9ea5-6fc8e57e0ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f273dec2e50>]}
[0m10:01:41.652976 [info ] [MainThread]: 
[0m10:01:41.653654 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m10:01:41.655064 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m10:01:41.666397 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m10:01:41.666631 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m10:01:41.666797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:01:43.570796 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m10:01:43.572596 [debug] [ThreadPool]: On list_lakehouse: Close
[0m10:01:43.575046 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m10:01:43.581329 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m10:01:43.581540 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m10:01:43.581705 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:01:45.067749 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m10:01:45.070563 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m10:01:45.070991 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m10:01:45.073852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb1a4ceb-8b96-49e5-9ea5-6fc8e57e0ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f273dfaac90>]}
[0m10:01:45.074259 [debug] [MainThread]: On master: COMMIT
[0m10:01:45.074810 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:01:45.075148 [info ] [MainThread]: 
[0m10:01:45.079666 [debug] [Thread-1 (]: Began running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m10:01:45.080035 [info ] [Thread-1 (]: 1 of 1 START snapshot dbt.orders_snapshot ...................................... [RUN]
[0m10:01:45.080546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now snapshot.dbt_trino_iceberg.orders_snapshot)
[0m10:01:45.080792 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_trino_iceberg.orders_snapshot
[0m10:01:45.083745 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (compile): 10:01:45.081127 => 10:01:45.083599
[0m10:01:45.083965 [debug] [Thread-1 (]: Began executing node snapshot.dbt_trino_iceberg.orders_snapshot
[0m10:01:45.115271 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m10:01:45.117114 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m10:01:45.117480 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

      
  
    

    create table "lakehouse"."dbt"."orders_snapshot"
      
      
    as (
      

    select *,
        lower(to_hex(md5(to_utf8(concat(coalesce(cast(orderkey as varchar), ''), '|',coalesce(cast(orderdate as varchar), '')))))) as dbt_scd_id,
        orderdate as dbt_updated_at,
        orderdate as dbt_valid_from,
        nullif(orderdate, orderdate) as dbt_valid_to
    from (
        



select * from tpch.sf1.orders

    ) sbq



    )
[0m10:01:45.117707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:02:14.205221 [debug] [Thread-1 (]: SQL status: SUCCESS in 29.0 seconds
[0m10:02:14.218628 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: COMMIT
[0m10:02:14.219363 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (execute): 10:01:45.084083 => 10:02:14.219167
[0m10:02:14.219598 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: Close
[0m10:02:14.220811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb1a4ceb-8b96-49e5-9ea5-6fc8e57e0ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f273e20fdd0>]}
[0m10:02:14.221345 [info ] [Thread-1 (]: 1 of 1 OK snapshotted dbt.orders_snapshot ...................................... [[32mSUCCESS[0m in 29.14s]
[0m10:02:14.221835 [debug] [Thread-1 (]: Finished running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m10:02:14.224031 [debug] [MainThread]: On master: COMMIT
[0m10:02:14.224583 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:02:14.224806 [debug] [MainThread]: Connection 'snapshot.dbt_trino_iceberg.orders_snapshot' was properly closed.
[0m10:02:14.225056 [info ] [MainThread]: 
[0m10:02:14.225391 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 32.57 seconds (32.57s).
[0m10:02:14.226016 [debug] [MainThread]: Command end result
[0m10:02:14.233527 [info ] [MainThread]: 
[0m10:02:14.233915 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:02:14.234293 [info ] [MainThread]: 
[0m10:02:14.234646 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:02:14.235823 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 32.832985, "process_user_time": 1.676835, "process_kernel_time": 0.202028, "process_mem_max_rss": "111080", "process_out_blocks": "2408", "process_in_blocks": "0"}
[0m10:02:14.236438 [debug] [MainThread]: Command `dbt snapshot` succeeded at 10:02:14.236348 after 32.83 seconds
[0m10:02:14.236752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f273fb03010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2742829090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f274273b490>]}
[0m10:02:14.237100 [debug] [MainThread]: Flushing usage events
[0m10:02:36.647588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3369414510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3368dec910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3368deffd0>]}


============================== 10:02:36.649208 | 6a74a829-18ab-4077-ac2b-a7dbe17b862a ==============================
[0m10:02:36.649208 [info ] [MainThread]: Running with dbt=1.7.3
[0m10:02:36.649611 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m10:02:36.765170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a74a829-18ab-4077-ac2b-a7dbe17b862a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3368c14390>]}
[0m10:02:36.817493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a74a829-18ab-4077-ac2b-a7dbe17b862a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3368c21f10>]}
[0m10:02:36.817994 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m10:02:36.824837 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m10:02:36.841017 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:02:36.841341 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:02:36.845894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a74a829-18ab-4077-ac2b-a7dbe17b862a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3368e0d4d0>]}
[0m10:02:36.854098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a74a829-18ab-4077-ac2b-a7dbe17b862a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3368953d50>]}
[0m10:02:36.854535 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m10:02:36.854827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a74a829-18ab-4077-ac2b-a7dbe17b862a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3368ad2190>]}
[0m10:02:36.856030 [info ] [MainThread]: 
[0m10:02:36.856601 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m10:02:36.858235 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m10:02:36.870545 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m10:02:36.870817 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m10:02:36.870998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:02:38.921100 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m10:02:38.923705 [debug] [ThreadPool]: On list_lakehouse: Close
[0m10:02:38.926910 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m10:02:38.933373 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m10:02:38.933580 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m10:02:38.933746 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:02:40.184476 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m10:02:40.186915 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m10:02:40.187466 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m10:02:40.192774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a74a829-18ab-4077-ac2b-a7dbe17b862a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3368bb3c10>]}
[0m10:02:40.193536 [debug] [MainThread]: On master: COMMIT
[0m10:02:40.194640 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:02:40.195124 [info ] [MainThread]: 
[0m10:02:40.197714 [debug] [Thread-1 (]: Began running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m10:02:40.197999 [info ] [Thread-1 (]: 1 of 1 START snapshot dbt.orders_snapshot ...................................... [RUN]
[0m10:02:40.198691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now snapshot.dbt_trino_iceberg.orders_snapshot)
[0m10:02:40.198897 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_trino_iceberg.orders_snapshot
[0m10:02:40.201631 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (compile): 10:02:40.199011 => 10:02:40.201473
[0m10:02:40.201844 [debug] [Thread-1 (]: Began executing node snapshot.dbt_trino_iceberg.orders_snapshot
[0m10:02:40.229396 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m10:02:40.229895 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    describe "lakehouse"."dbt"."orders_snapshot"
[0m10:02:40.230102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:02:41.410578 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m10:02:41.412455 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (execute): 10:02:40.201976 => 10:02:41.412261
[0m10:02:41.412763 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: Close
[0m10:02:41.415889 [debug] [Thread-1 (]: Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m10:02:41.416171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a74a829-18ab-4077-ac2b-a7dbe17b862a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3368b31bd0>]}
[0m10:02:41.416616 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting dbt.orders_snapshot .................................. [[31mERROR[0m in 1.22s]
[0m10:02:41.417050 [debug] [Thread-1 (]: Finished running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m10:02:41.418845 [debug] [MainThread]: On master: COMMIT
[0m10:02:41.419345 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:02:41.419564 [debug] [MainThread]: Connection 'snapshot.dbt_trino_iceberg.orders_snapshot' was properly closed.
[0m10:02:41.419886 [info ] [MainThread]: 
[0m10:02:41.420174 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.56 seconds (4.56s).
[0m10:02:41.420787 [debug] [MainThread]: Command end result
[0m10:02:41.427985 [info ] [MainThread]: 
[0m10:02:41.428374 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:02:41.428691 [info ] [MainThread]: 
[0m10:02:41.429006 [error] [MainThread]:   Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m10:02:41.429332 [info ] [MainThread]: 
[0m10:02:41.429704 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:02:41.430633 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 4.8073874, "process_user_time": 1.437912, "process_kernel_time": 0.081009, "process_mem_max_rss": "110344", "process_out_blocks": "2400", "command_success": false, "process_in_blocks": "0"}
[0m10:02:41.430969 [debug] [MainThread]: Command `dbt snapshot` failed at 10:02:41.430897 after 4.81 seconds
[0m10:02:41.431210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3368dcf110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3368dcf010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f336d4bb750>]}
[0m10:02:41.431443 [debug] [MainThread]: Flushing usage events
[0m10:09:03.474071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda7a478410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda7a47a2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda7c2ffb10>]}


============================== 10:09:03.475745 | 34a999b3-b1d8-4be9-a4ea-fd8870eb4a28 ==============================
[0m10:09:03.475745 [info ] [MainThread]: Running with dbt=1.7.3
[0m10:09:03.476099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:09:03.592772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34a999b3-b1d8-4be9-a4ea-fd8870eb4a28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda7a20f010>]}
[0m10:09:03.645404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34a999b3-b1d8-4be9-a4ea-fd8870eb4a28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda7a1fff90>]}
[0m10:09:03.645917 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m10:09:03.652996 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m10:09:03.670521 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m10:09:03.671079 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://snapshots/orders.sql
[0m10:09:03.671341 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://snapshots/order2.sql
[0m10:09:03.729790 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  expected token ',', got ':'
    line 5
      materialized: 'snapshot'
[0m10:09:03.730556 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 0.2806768, "process_user_time": 1.276029, "process_kernel_time": 0.129596, "process_mem_max_rss": "104808", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m10:09:03.730944 [debug] [MainThread]: Command `dbt snapshot` failed at 10:09:03.730866 after 0.28 seconds
[0m10:09:03.731160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda7a47a2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda7a026a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda7a2b9510>]}
[0m10:09:03.731461 [debug] [MainThread]: Flushing usage events
[0m10:09:21.861053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07efb17a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07efb3ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07efb3ea10>]}


============================== 10:09:21.863333 | 2b953ce4-3c54-4f3f-8917-e3a470959b66 ==============================
[0m10:09:21.863333 [info ] [MainThread]: Running with dbt=1.7.3
[0m10:09:21.863791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:09:21.981464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b953ce4-3c54-4f3f-8917-e3a470959b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07ef9050d0>]}
[0m10:09:22.035754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b953ce4-3c54-4f3f-8917-e3a470959b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07f1154490>]}
[0m10:09:22.036207 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m10:09:22.042953 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m10:09:22.059034 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m10:09:22.059511 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://snapshots/order2.sql
[0m10:09:22.059752 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://snapshots/orders.sql
[0m10:09:22.120450 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  expected token ',', got ':'
    line 5
      materialized: 'snapshot',
[0m10:09:22.121481 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 0.28480896, "process_user_time": 1.271784, "process_kernel_time": 0.070098, "process_mem_max_rss": "105000", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m10:09:22.122021 [debug] [MainThread]: Command `dbt snapshot` failed at 10:09:22.121895 after 0.29 seconds
[0m10:09:22.122398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07efb570d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07efb1fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07ef81afd0>]}
[0m10:09:22.122723 [debug] [MainThread]: Flushing usage events
[0m10:14:58.039346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f165610ed10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16568d2e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1655606ed0>]}


============================== 10:14:58.041262 | f652831c-633e-4a4c-80fa-32e0c5003f30 ==============================
[0m10:14:58.041262 [info ] [MainThread]: Running with dbt=1.7.3
[0m10:14:58.041659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:14:58.171340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f652831c-633e-4a4c-80fa-32e0c5003f30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1655350fd0>]}
[0m10:14:58.228738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f652831c-633e-4a4c-80fa-32e0c5003f30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1655336350>]}
[0m10:14:58.229196 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m10:14:58.236880 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m10:14:58.255272 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m10:14:58.255846 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://snapshots/orders.sql
[0m10:14:58.256119 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://snapshots/order2.sql
[0m10:14:58.362692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f652831c-633e-4a4c-80fa-32e0c5003f30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1654ffea90>]}
[0m10:14:58.372276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f652831c-633e-4a4c-80fa-32e0c5003f30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f165500b0d0>]}
[0m10:14:58.372648 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m10:14:58.372948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f652831c-633e-4a4c-80fa-32e0c5003f30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1655084c90>]}
[0m10:14:58.374335 [info ] [MainThread]: 
[0m10:14:58.374988 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m10:14:58.375808 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m10:14:58.387270 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m10:14:58.387621 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m10:14:58.387791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:00.457581 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m10:15:00.459275 [debug] [ThreadPool]: On list_lakehouse: Close
[0m10:15:00.463290 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m10:15:00.471068 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m10:15:00.471293 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m10:15:00.471470 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:15:01.859989 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m10:15:01.861328 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m10:15:01.861596 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m10:15:01.864568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f652831c-633e-4a4c-80fa-32e0c5003f30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16553ee610>]}
[0m10:15:01.864939 [debug] [MainThread]: On master: COMMIT
[0m10:15:01.865461 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:15:01.865773 [info ] [MainThread]: 
[0m10:15:01.868872 [debug] [Thread-1 (]: Began running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m10:15:01.869313 [info ] [Thread-1 (]: 1 of 1 START snapshot dbt.orders_snapshot ...................................... [RUN]
[0m10:15:01.869929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now snapshot.dbt_trino_iceberg.orders_snapshot)
[0m10:15:01.870210 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_trino_iceberg.orders_snapshot
[0m10:15:01.872482 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (compile): 10:15:01.870320 => 10:15:01.872335
[0m10:15:01.872694 [debug] [Thread-1 (]: Began executing node snapshot.dbt_trino_iceberg.orders_snapshot
[0m10:15:01.904760 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m10:15:01.906572 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m10:15:01.906824 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

      
  
    

    create table "lakehouse"."dbt"."orders_snapshot"
      
      
    as (
      

    select *,
        lower(to_hex(md5(to_utf8(concat(coalesce(cast(orderkey as varchar), ''), '|',coalesce(cast(orderdate as varchar), '')))))) as dbt_scd_id,
        orderdate as dbt_updated_at,
        orderdate as dbt_valid_from,
        nullif(orderdate, orderdate) as dbt_valid_to
    from (
        


select * from tpch.sf1.orders

    ) sbq



    )
[0m10:15:01.907018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:15:18.972252 [debug] [Thread-1 (]: SQL status: SUCCESS in 17.0 seconds
[0m10:15:18.984288 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: COMMIT
[0m10:15:18.984952 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (execute): 10:15:01.872808 => 10:15:18.984830
[0m10:15:18.985169 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: Close
[0m10:15:18.986515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f652831c-633e-4a4c-80fa-32e0c5003f30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1655217e90>]}
[0m10:15:18.986979 [info ] [Thread-1 (]: 1 of 1 OK snapshotted dbt.orders_snapshot ...................................... [[32mSUCCESS[0m in 17.12s]
[0m10:15:18.987488 [debug] [Thread-1 (]: Finished running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m10:15:18.989426 [debug] [MainThread]: On master: COMMIT
[0m10:15:18.989923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:15:18.990145 [debug] [MainThread]: Connection 'snapshot.dbt_trino_iceberg.orders_snapshot' was properly closed.
[0m10:15:18.990402 [info ] [MainThread]: 
[0m10:15:18.990736 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 20.62 seconds (20.62s).
[0m10:15:18.991422 [debug] [MainThread]: Command end result
[0m10:15:18.998652 [info ] [MainThread]: 
[0m10:15:18.999002 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:15:18.999396 [info ] [MainThread]: 
[0m10:15:18.999811 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:15:19.000697 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 20.990032, "process_user_time": 1.619243, "process_kernel_time": 0.179915, "process_mem_max_rss": "113976", "process_out_blocks": "3560", "process_in_blocks": "0"}
[0m10:15:19.001071 [debug] [MainThread]: Command `dbt snapshot` succeeded at 10:15:19.000983 after 20.99 seconds
[0m10:15:19.001277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1655612b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1659b334d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1659c21090>]}
[0m10:15:19.001470 [debug] [MainThread]: Flushing usage events
[0m10:16:09.201573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260e45c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260ce820d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260cf0c990>]}


============================== 10:16:09.203273 | 82241f12-a6a8-4d2a-a392-b210620b0521 ==============================
[0m10:16:09.203273 [info ] [MainThread]: Running with dbt=1.7.3
[0m10:16:09.203627 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:16:09.332666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82241f12-a6a8-4d2a-a392-b210620b0521', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260cdf13d0>]}
[0m10:16:09.384312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82241f12-a6a8-4d2a-a392-b210620b0521', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260c988110>]}
[0m10:16:09.384716 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m10:16:09.391415 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m10:16:09.411971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:16:09.412385 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:16:09.416632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82241f12-a6a8-4d2a-a392-b210620b0521', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260c8bc390>]}
[0m10:16:09.426777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82241f12-a6a8-4d2a-a392-b210620b0521', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260c5ef9d0>]}
[0m10:16:09.427102 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m10:16:09.427429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82241f12-a6a8-4d2a-a392-b210620b0521', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260c7f3ad0>]}
[0m10:16:09.428683 [info ] [MainThread]: 
[0m10:16:09.429277 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m10:16:09.430895 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m10:16:09.444435 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m10:16:09.444719 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m10:16:09.444882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:11.106275 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m10:16:11.107530 [debug] [ThreadPool]: On list_lakehouse: Close
[0m10:16:11.110568 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m10:16:11.116721 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m10:16:11.117009 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m10:16:11.117180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:16:12.210234 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m10:16:12.211518 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m10:16:12.211793 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m10:16:12.214746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82241f12-a6a8-4d2a-a392-b210620b0521', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260c7fc510>]}
[0m10:16:12.215087 [debug] [MainThread]: On master: COMMIT
[0m10:16:12.215493 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:16:12.215749 [info ] [MainThread]: 
[0m10:16:12.218589 [debug] [Thread-1 (]: Began running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m10:16:12.219094 [info ] [Thread-1 (]: 1 of 1 START snapshot dbt.orders_snapshot ...................................... [RUN]
[0m10:16:12.220066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now snapshot.dbt_trino_iceberg.orders_snapshot)
[0m10:16:12.220373 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_trino_iceberg.orders_snapshot
[0m10:16:12.225632 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (compile): 10:16:12.220645 => 10:16:12.225413
[0m10:16:12.226013 [debug] [Thread-1 (]: Began executing node snapshot.dbt_trino_iceberg.orders_snapshot
[0m10:16:12.258468 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m10:16:12.258795 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    describe "lakehouse"."dbt"."orders_snapshot"
[0m10:16:12.258998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:12.932102 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m10:16:12.933653 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (execute): 10:16:12.226152 => 10:16:12.933431
[0m10:16:12.933981 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: Close
[0m10:16:12.936646 [debug] [Thread-1 (]: Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m10:16:12.937012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82241f12-a6a8-4d2a-a392-b210620b0521', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260c64df90>]}
[0m10:16:12.937580 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting dbt.orders_snapshot .................................. [[31mERROR[0m in 0.72s]
[0m10:16:12.938050 [debug] [Thread-1 (]: Finished running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m10:16:12.940126 [debug] [MainThread]: On master: COMMIT
[0m10:16:12.940648 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:16:12.940872 [debug] [MainThread]: Connection 'snapshot.dbt_trino_iceberg.orders_snapshot' was properly closed.
[0m10:16:12.941100 [info ] [MainThread]: 
[0m10:16:12.941431 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 3.51 seconds (3.51s).
[0m10:16:12.942090 [debug] [MainThread]: Command end result
[0m10:16:12.949984 [info ] [MainThread]: 
[0m10:16:12.950490 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:16:12.950784 [info ] [MainThread]: 
[0m10:16:12.951051 [error] [MainThread]:   Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m10:16:12.951338 [info ] [MainThread]: 
[0m10:16:12.951631 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:16:12.952498 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 3.7745137, "process_user_time": 1.444599, "process_kernel_time": 0.069261, "process_mem_max_rss": "110764", "process_out_blocks": "2392", "command_success": false, "process_in_blocks": "0"}
[0m10:16:12.952814 [debug] [MainThread]: Command `dbt snapshot` failed at 10:16:12.952738 after 3.77 seconds
[0m10:16:12.953046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260c8ae050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260c8bcd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260c797c10>]}
[0m10:16:12.953287 [debug] [MainThread]: Flushing usage events
[0m13:07:07.431774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efef3566d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efef33b2b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efef5d36c50>]}


============================== 13:07:07.436933 | 770b96fa-66a5-4f5b-9210-e1b6911fefc6 ==============================
[0m13:07:07.436933 [info ] [MainThread]: Running with dbt=1.7.3
[0m13:07:07.437609 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --debug snapshot', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:07:07.602618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '770b96fa-66a5-4f5b-9210-e1b6911fefc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efef3473fd0>]}
[0m13:07:07.675844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '770b96fa-66a5-4f5b-9210-e1b6911fefc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efef356f510>]}
[0m13:07:07.676507 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m13:07:07.689401 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m13:07:07.736996 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:07:07.737547 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:07:07.742710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '770b96fa-66a5-4f5b-9210-e1b6911fefc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efef3300890>]}
[0m13:07:07.770798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '770b96fa-66a5-4f5b-9210-e1b6911fefc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efef30ebd50>]}
[0m13:07:07.771363 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m13:07:07.771683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '770b96fa-66a5-4f5b-9210-e1b6911fefc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efef30a60d0>]}
[0m13:07:07.773440 [info ] [MainThread]: 
[0m13:07:07.774142 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:07:07.775518 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m13:07:07.788894 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m13:07:07.789459 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m13:07:07.789749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:07:09.540930 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m13:07:09.542005 [debug] [ThreadPool]: On list_lakehouse: Close
[0m13:07:09.545505 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m13:07:09.552680 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m13:07:09.553399 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m13:07:09.554190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:07:10.620126 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:07:10.621451 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m13:07:10.621712 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m13:07:10.624737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '770b96fa-66a5-4f5b-9210-e1b6911fefc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efef33f02d0>]}
[0m13:07:10.625233 [debug] [MainThread]: On master: COMMIT
[0m13:07:10.625792 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:07:10.626032 [info ] [MainThread]: 
[0m13:07:10.629457 [debug] [Thread-1 (]: Began running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m13:07:10.629971 [info ] [Thread-1 (]: 1 of 1 START snapshot dbt.orders_snapshot ...................................... [RUN]
[0m13:07:10.631124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now snapshot.dbt_trino_iceberg.orders_snapshot)
[0m13:07:10.631693 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_trino_iceberg.orders_snapshot
[0m13:07:10.635383 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (compile): 13:07:10.631948 => 13:07:10.635181
[0m13:07:10.635797 [debug] [Thread-1 (]: Began executing node snapshot.dbt_trino_iceberg.orders_snapshot
[0m13:07:10.678440 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m13:07:10.679200 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    describe "lakehouse"."dbt"."orders_snapshot"
[0m13:07:10.679748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:07:11.626385 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:07:11.627971 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (execute): 13:07:10.636040 => 13:07:11.627798
[0m13:07:11.628287 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: Close
[0m13:07:11.632376 [debug] [Thread-1 (]: Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m13:07:11.633062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770b96fa-66a5-4f5b-9210-e1b6911fefc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efef2f0e3d0>]}
[0m13:07:11.633854 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting dbt.orders_snapshot .................................. [[31mERROR[0m in 1.00s]
[0m13:07:11.634361 [debug] [Thread-1 (]: Finished running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m13:07:11.636645 [debug] [MainThread]: On master: COMMIT
[0m13:07:11.637514 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:07:11.637852 [debug] [MainThread]: Connection 'snapshot.dbt_trino_iceberg.orders_snapshot' was properly closed.
[0m13:07:11.638165 [info ] [MainThread]: 
[0m13:07:11.638522 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 3.86 seconds (3.86s).
[0m13:07:11.639025 [debug] [MainThread]: Command end result
[0m13:07:11.651855 [info ] [MainThread]: 
[0m13:07:11.652391 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:07:11.652749 [info ] [MainThread]: 
[0m13:07:11.653079 [error] [MainThread]:   Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m13:07:11.653349 [info ] [MainThread]: 
[0m13:07:11.653729 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:07:11.654883 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 4.2588353, "process_user_time": 1.858389, "process_kernel_time": 0.670238, "process_mem_max_rss": "110636", "process_out_blocks": "2400", "command_success": false, "process_in_blocks": "0"}
[0m13:07:11.655497 [debug] [MainThread]: Command `dbt snapshot` failed at 13:07:11.655372 after 4.26 seconds
[0m13:07:11.655923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efef356ed10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efef33b2c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efef3a0c850>]}
[0m13:07:11.656353 [debug] [MainThread]: Flushing usage events
[0m13:13:21.535638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbf616150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbf44b7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbf6152d0>]}


============================== 13:13:21.539066 | 60b8f671-e678-4bc5-a491-fee2e0e81847 ==============================
[0m13:13:21.539066 [info ] [MainThread]: Running with dbt=1.7.3
[0m13:13:21.539473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --debug snapshot', 'send_anonymous_usage_stats': 'True'}
[0m13:13:21.684723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60b8f671-e678-4bc5-a491-fee2e0e81847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbf240a90>]}
[0m13:13:21.755487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60b8f671-e678-4bc5-a491-fee2e0e81847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbf393e90>]}
[0m13:13:21.756081 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m13:13:21.764158 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m13:13:21.795269 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:13:21.796031 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:13:21.801950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60b8f671-e678-4bc5-a491-fee2e0e81847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbf1f08d0>]}
[0m13:13:21.819920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60b8f671-e678-4bc5-a491-fee2e0e81847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbf17bdd0>]}
[0m13:13:21.820576 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m13:13:21.820912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60b8f671-e678-4bc5-a491-fee2e0e81847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbf2ce150>]}
[0m13:13:21.822277 [info ] [MainThread]: 
[0m13:13:21.822887 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:13:21.824473 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m13:13:21.839780 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m13:13:21.840196 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m13:13:21.840475 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:23.522586 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m13:13:23.523733 [debug] [ThreadPool]: On list_lakehouse: Close
[0m13:13:23.526590 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m13:13:23.532734 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m13:13:23.533144 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m13:13:23.533553 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:13:25.078238 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m13:13:25.079622 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m13:13:25.079941 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m13:13:25.082960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60b8f671-e678-4bc5-a491-fee2e0e81847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbf602590>]}
[0m13:13:25.083337 [debug] [MainThread]: On master: COMMIT
[0m13:13:25.083913 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:13:25.084143 [info ] [MainThread]: 
[0m13:13:25.087228 [debug] [Thread-1 (]: Began running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m13:13:25.087725 [info ] [Thread-1 (]: 1 of 1 START snapshot dbt.orders_snapshot ...................................... [RUN]
[0m13:13:25.088297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now snapshot.dbt_trino_iceberg.orders_snapshot)
[0m13:13:25.088662 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_trino_iceberg.orders_snapshot
[0m13:13:25.092120 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (compile): 13:13:25.089231 => 13:13:25.091874
[0m13:13:25.092616 [debug] [Thread-1 (]: Began executing node snapshot.dbt_trino_iceberg.orders_snapshot
[0m13:13:25.136187 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m13:13:25.138477 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m13:13:25.138860 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

      
  
    

    create table "lakehouse"."dbt"."orders_snapshot"
      
      
    as (
      

    select *,
        lower(to_hex(md5(to_utf8(concat(coalesce(cast(orderkey as varchar), ''), '|',coalesce(cast(orderdate as varchar), '')))))) as dbt_scd_id,
        orderdate as dbt_updated_at,
        orderdate as dbt_valid_from,
        nullif(orderdate, orderdate) as dbt_valid_to
    from (
        


select * from tpch.sf1.orders

    ) sbq



    )
[0m13:13:25.139276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:13:36.963190 [debug] [Thread-1 (]: SQL status: SUCCESS in 12.0 seconds
[0m13:13:36.977533 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: COMMIT
[0m13:13:36.979072 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (execute): 13:13:25.092878 => 13:13:36.978784
[0m13:13:36.979573 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: Close
[0m13:13:36.981595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60b8f671-e678-4bc5-a491-fee2e0e81847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbf192010>]}
[0m13:13:36.982323 [info ] [Thread-1 (]: 1 of 1 OK snapshotted dbt.orders_snapshot ...................................... [[32mSUCCESS[0m in 11.89s]
[0m13:13:36.982924 [debug] [Thread-1 (]: Finished running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m13:13:36.985176 [debug] [MainThread]: On master: COMMIT
[0m13:13:36.986084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:13:36.986503 [debug] [MainThread]: Connection 'snapshot.dbt_trino_iceberg.orders_snapshot' was properly closed.
[0m13:13:36.986946 [info ] [MainThread]: 
[0m13:13:36.987440 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 15.16 seconds (15.16s).
[0m13:13:36.988130 [debug] [MainThread]: Command end result
[0m13:13:36.997104 [info ] [MainThread]: 
[0m13:13:36.997889 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:13:36.998714 [info ] [MainThread]: 
[0m13:13:36.999102 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:13:37.000313 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 15.504077, "process_user_time": 1.704441, "process_kernel_time": 0.356743, "process_mem_max_rss": "110460", "process_out_blocks": "2400", "process_in_blocks": "0"}
[0m13:13:37.001039 [debug] [MainThread]: Command `dbt snapshot` succeeded at 13:13:37.000918 after 15.50 seconds
[0m13:13:37.001512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc3c250d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbf370250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbf3ac310>]}
[0m13:13:37.002010 [debug] [MainThread]: Flushing usage events
[0m13:14:25.943765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f918fd550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f918fd090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f918fdcd0>]}


============================== 13:14:25.946006 | d1b29189-6fd8-4c9b-9d6c-9e02f213f1f4 ==============================
[0m13:14:25.946006 [info ] [MainThread]: Running with dbt=1.7.3
[0m13:14:25.946443 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --debug snapshot', 'send_anonymous_usage_stats': 'True'}
[0m13:14:26.082581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1b29189-6fd8-4c9b-9d6c-9e02f213f1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f916bf6d0>]}
[0m13:14:26.146015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1b29189-6fd8-4c9b-9d6c-9e02f213f1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f916846d0>]}
[0m13:14:26.146629 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m13:14:26.154019 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m13:14:26.175853 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:14:26.176751 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:14:26.181992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1b29189-6fd8-4c9b-9d6c-9e02f213f1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f915196d0>]}
[0m13:14:26.195007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1b29189-6fd8-4c9b-9d6c-9e02f213f1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f91657e50>]}
[0m13:14:26.195492 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m13:14:26.195874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1b29189-6fd8-4c9b-9d6c-9e02f213f1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f915b0610>]}
[0m13:14:26.197359 [info ] [MainThread]: 
[0m13:14:26.198227 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:14:26.199393 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m13:14:26.212764 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m13:14:26.213326 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m13:14:26.213649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:27.637073 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:14:27.638294 [debug] [ThreadPool]: On list_lakehouse: Close
[0m13:14:27.641559 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m13:14:27.648435 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m13:14:27.648850 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m13:14:27.649554 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:14:28.599751 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:14:28.601141 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m13:14:28.601548 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m13:14:28.604510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1b29189-6fd8-4c9b-9d6c-9e02f213f1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f9186db50>]}
[0m13:14:28.605045 [debug] [MainThread]: On master: COMMIT
[0m13:14:28.605831 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:14:28.606164 [info ] [MainThread]: 
[0m13:14:28.609345 [debug] [Thread-1 (]: Began running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m13:14:28.609732 [info ] [Thread-1 (]: 1 of 1 START snapshot dbt.orders_snapshot ...................................... [RUN]
[0m13:14:28.610456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now snapshot.dbt_trino_iceberg.orders_snapshot)
[0m13:14:28.610713 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_trino_iceberg.orders_snapshot
[0m13:14:28.614216 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (compile): 13:14:28.611180 => 13:14:28.614045
[0m13:14:28.614544 [debug] [Thread-1 (]: Began executing node snapshot.dbt_trino_iceberg.orders_snapshot
[0m13:14:28.654507 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m13:14:28.655062 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    describe "lakehouse"."dbt"."orders_snapshot"
[0m13:14:28.655421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:14:29.460121 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:14:29.462510 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (execute): 13:14:28.614989 => 13:14:29.462157
[0m13:14:29.463083 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: Close
[0m13:14:29.468440 [debug] [Thread-1 (]: Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m13:14:29.469448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b29189-6fd8-4c9b-9d6c-9e02f213f1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f914589d0>]}
[0m13:14:29.470296 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting dbt.orders_snapshot .................................. [[31mERROR[0m in 0.86s]
[0m13:14:29.470853 [debug] [Thread-1 (]: Finished running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m13:14:29.472977 [debug] [MainThread]: On master: COMMIT
[0m13:14:29.473788 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:14:29.474171 [debug] [MainThread]: Connection 'snapshot.dbt_trino_iceberg.orders_snapshot' was properly closed.
[0m13:14:29.474676 [info ] [MainThread]: 
[0m13:14:29.475141 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 3.28 seconds (3.28s).
[0m13:14:29.475975 [debug] [MainThread]: Command end result
[0m13:14:29.486498 [info ] [MainThread]: 
[0m13:14:29.487075 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:14:29.487389 [info ] [MainThread]: 
[0m13:14:29.487668 [error] [MainThread]:   Compilation Error in snapshot orders_snapshot (snapshots/orders.sql)
  Snapshot target is not a snapshot table (missing "dbt_scd_id", "dbt_valid_from", "dbt_valid_to")
  
  > in macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by snapshot orders_snapshot (snapshots/orders.sql)
[0m13:14:29.488068 [info ] [MainThread]: 
[0m13:14:29.488722 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:14:29.490146 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 3.5735552, "process_user_time": 1.620373, "process_kernel_time": 0.110025, "process_mem_max_rss": "111268", "process_out_blocks": "2400", "command_success": false, "process_in_blocks": "0"}
[0m13:14:29.491136 [debug] [MainThread]: Command `dbt snapshot` failed at 13:14:29.490930 after 3.57 seconds
[0m13:14:29.491683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f91937090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f95e77390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f95e772d0>]}
[0m13:14:29.492328 [debug] [MainThread]: Flushing usage events
[0m18:30:04.835143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ae4187990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ae3fb3950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ae4187d10>]}


============================== 18:30:04.838256 | c9cd4f81-ff9b-40d7-9da3-edc5c99afb14 ==============================
[0m18:30:04.838256 [info ] [MainThread]: Running with dbt=1.7.3
[0m18:30:04.838774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:30:04.980972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9cd4f81-ff9b-40d7-9da3-edc5c99afb14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ae4167c50>]}
[0m18:30:05.045214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9cd4f81-ff9b-40d7-9da3-edc5c99afb14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ae3ee5a10>]}
[0m18:30:05.045713 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m18:30:05.054272 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m18:30:05.087182 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:30:05.087840 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:30:05.092747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9cd4f81-ff9b-40d7-9da3-edc5c99afb14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ae3c1a710>]}
[0m18:30:05.110482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9cd4f81-ff9b-40d7-9da3-edc5c99afb14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ae3cebdd0>]}
[0m18:30:05.110844 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m18:30:05.111124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9cd4f81-ff9b-40d7-9da3-edc5c99afb14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ae40843d0>]}
[0m18:30:05.112780 [info ] [MainThread]: 
[0m18:30:05.113591 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m18:30:05.114732 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m18:30:05.127597 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m18:30:05.127962 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m18:30:05.128176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:06.346656 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m18:30:06.348332 [debug] [ThreadPool]: On list_lakehouse: Close
[0m18:30:06.351753 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m18:30:06.357098 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m18:30:06.357367 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m18:30:06.357593 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:30:07.663126 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m18:30:07.665724 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m18:30:07.666179 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m18:30:07.669031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9cd4f81-ff9b-40d7-9da3-edc5c99afb14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ae4b67210>]}
[0m18:30:07.669365 [debug] [MainThread]: On master: COMMIT
[0m18:30:07.669770 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:30:07.670008 [info ] [MainThread]: 
[0m18:30:07.674008 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_customers
[0m18:30:07.674470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.stg_tpch_customers)
[0m18:30:07.674698 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_customers
[0m18:30:07.677346 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_customers"
[0m18:30:07.678374 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_customers (compile): 18:30:07.674820 => 18:30:07.678217
[0m18:30:07.678910 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_customers
[0m18:30:07.679197 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m18:30:07.679634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_customers, now model.dbt_trino_iceberg.stg_tpch_line_item)
[0m18:30:07.679874 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_line_item
[0m18:30:07.682085 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_line_item"
[0m18:30:07.682748 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_line_item (compile): 18:30:07.680022 => 18:30:07.682588
[0m18:30:07.683331 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m18:30:07.683588 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_nation
[0m18:30:07.683969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_line_item, now model.dbt_trino_iceberg.stg_tpch_nation)
[0m18:30:07.684196 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_nation
[0m18:30:07.686063 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_nation"
[0m18:30:07.686671 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_nation (compile): 18:30:07.684334 => 18:30:07.686507
[0m18:30:07.687171 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_nation
[0m18:30:07.687424 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_orders
[0m18:30:07.687763 [info ] [Thread-1 (]: 1 of 8 START sql table model dbt.stg_tpch_orders ............................... [RUN]
[0m18:30:07.688455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_nation, now model.dbt_trino_iceberg.stg_tpch_orders)
[0m18:30:07.688725 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_orders
[0m18:30:07.691467 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_orders"
[0m18:30:07.692256 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_orders (compile): 18:30:07.688862 => 18:30:07.692028
[0m18:30:07.692573 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.stg_tpch_orders
[0m18:30:07.709172 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."stg_tpch_orders"
[0m18:30:07.710868 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.stg_tpch_orders"
[0m18:30:07.711177 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.stg_tpch_orders"} */

    drop table if exists "lakehouse"."dbt"."stg_tpch_orders"
[0m18:30:07.711387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:08.364070 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:30:08.375147 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.stg_tpch_orders"
[0m18:30:08.376857 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.stg_tpch_orders"
[0m18:30:08.377146 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.stg_tpch_orders"} */

  
    

    create table "lakehouse"."dbt"."stg_tpch_orders"
      
      
    as (
      
select
    orderkey as order_key, 
    custkey as customer_key,
    orderstatus as order_status_code,
    totalprice as order_amount,
    orderdate as order_date,
    orderpriority as order_priority_code,
    clerk as order_clerk_name,
    shippriority as shipping_priority,
    comment as order_comment
from
    tpch.sf1.orders
    )
[0m18:30:25.873604 [debug] [Thread-1 (]: SQL status: SUCCESS in 17.0 seconds
[0m18:30:25.887855 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_orders (execute): 18:30:07.692693 => 18:30:25.887652
[0m18:30:25.888204 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_orders: ROLLBACK
[0m18:30:25.888427 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_orders: Close
[0m18:30:25.889587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9cd4f81-ff9b-40d7-9da3-edc5c99afb14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ae3d3a390>]}
[0m18:30:25.890030 [info ] [Thread-1 (]: 1 of 8 OK created sql table model dbt.stg_tpch_orders .......................... [[32mSUCCESS[0m in 18.20s]
[0m18:30:25.890439 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_orders
[0m18:30:25.890759 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part
[0m18:30:25.891218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_orders, now model.dbt_trino_iceberg.stg_tpch_part)
[0m18:30:25.891475 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part
[0m18:30:25.893656 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part"
[0m18:30:25.894562 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part (compile): 18:30:25.891621 => 18:30:25.894382
[0m18:30:25.895334 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part
[0m18:30:25.895747 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m18:30:25.896486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part, now model.dbt_trino_iceberg.stg_tpch_part_suppliers)
[0m18:30:25.896716 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m18:30:25.898878 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part_suppliers"
[0m18:30:25.899457 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part_suppliers (compile): 18:30:25.896843 => 18:30:25.899292
[0m18:30:25.900010 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m18:30:25.900270 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_region
[0m18:30:25.900661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part_suppliers, now model.dbt_trino_iceberg.stg_tpch_region)
[0m18:30:25.900897 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_region
[0m18:30:25.902993 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_region"
[0m18:30:25.903607 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_region (compile): 18:30:25.901038 => 18:30:25.903401
[0m18:30:25.904150 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_region
[0m18:30:25.904403 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m18:30:25.904796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_region, now model.dbt_trino_iceberg.stg_tpch_supplier)
[0m18:30:25.905021 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_supplier
[0m18:30:25.907882 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_supplier"
[0m18:30:25.908513 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_supplier (compile): 18:30:25.905155 => 18:30:25.908359
[0m18:30:25.909008 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m18:30:25.909292 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.int_order_items
[0m18:30:25.909613 [info ] [Thread-1 (]: 2 of 8 START sql table model dbt.int_order_items ............................... [RUN]
[0m18:30:25.910457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_supplier, now model.dbt_trino_iceberg.int_order_items)
[0m18:30:25.910679 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.int_order_items
[0m18:30:25.929678 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.int_order_items"
[0m18:30:25.930880 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_order_items (compile): 18:30:25.910796 => 18:30:25.930628
[0m18:30:25.931242 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.int_order_items
[0m18:30:25.934472 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."int_order_items"
[0m18:30:25.935020 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_order_items"
[0m18:30:25.935260 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_order_items"} */

    drop table if exists "lakehouse"."dbt"."int_order_items"
[0m18:30:25.935464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:27.534922 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m18:30:27.537682 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.int_order_items"
[0m18:30:27.542746 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_order_items"
[0m18:30:27.543045 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_order_items"} */

  
    

    create table "lakehouse"."dbt"."int_order_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_line_item as (

select
    orderkey as order_key,
    partkey as part_key,
    suppkey as supplier_key,
    linenumber as order_line_number,
    quantity as quantity,
    extendedprice as extended_price,
    discount as discount_percentage,
    tax as tax_rate,
    returnflag as return_status_code,
    linestatus as order_line_status_code,
    shipdate as ship_date,
    commitdate as commit_date,
    receiptdate as receipt_date,
    shipinstruct as ship_instructions_desc,
    shipmode as ship_mode_name,
    comment as order_line_comment
from
    tpch.sf1.lineitem
), orders as (
    
    select * from "lakehouse"."dbt"."stg_tpch_orders"

),
line_items as (

    select * from __dbt__cte__stg_tpch_line_item

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(o.order_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l.order_line_number as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as order_item_key,

    o.order_key,
    o.order_date,
    o.customer_key,
    o.order_status_code,
    
    l.part_key,
    l.supplier_key,
    l.return_status_code,
    l.order_line_number,
    l.order_line_status_code,
    l.ship_date,
    l.commit_date,
    l.receipt_date,
    l.ship_mode_name,

    l.quantity,
    
    -- extended_price is actually the line item total,
    -- so we back out the extended price per item
    (l.extended_price/nullif(l.quantity, 0)) as base_price,
    l.discount_percentage,
    ((l.extended_price/nullif(l.quantity, 0)) * (1 - l.discount_percentage)) as discounted_price,

    l.extended_price as gross_item_sales_amount,
    (l.extended_price * (1 - l.discount_percentage)) as discounted_item_sales_amount,
    -- We model discounts as negative amounts
    (-1 * l.extended_price * l.discount_percentage) as item_discount_amount,
    l.tax_rate,
    ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate) as item_tax_amount,
    (
        l.extended_price + 
        (-1 * l.extended_price * l.discount_percentage) + 
        ((l.extended_price + (-1 * l.extended_price * l.discount_percentage)) * l.tax_rate)
    ) as net_item_sales_amount

from
    orders o
    join
    line_items l
        on o.order_key = l.order_key
order by
    o.order_date
    )
[0m18:31:08.326571 [debug] [Thread-1 (]: SQL status: SUCCESS in 41.0 seconds
[0m18:31:08.329603 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_order_items (execute): 18:30:25.931378 => 18:31:08.329406
[0m18:31:08.329944 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: ROLLBACK
[0m18:31:08.330236 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: Close
[0m18:31:08.331427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9cd4f81-ff9b-40d7-9da3-edc5c99afb14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ae3b46210>]}
[0m18:31:08.331910 [info ] [Thread-1 (]: 2 of 8 OK created sql table model dbt.int_order_items .......................... [[32mSUCCESS[0m in 42.42s]
[0m18:31:08.332378 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.int_order_items
[0m18:31:08.332816 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_suppliers
[0m18:31:08.333580 [info ] [Thread-1 (]: 3 of 8 START sql table model dbt.dim_suppliers ................................. [RUN]
[0m18:31:08.334443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.int_order_items, now model.dbt_trino_iceberg.dim_suppliers)
[0m18:31:08.334683 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_suppliers
[0m18:31:08.339910 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_suppliers"
[0m18:31:08.340521 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (compile): 18:31:08.334807 => 18:31:08.340298
[0m18:31:08.340811 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_suppliers
[0m18:31:08.343817 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."dim_suppliers"
[0m18:31:08.344291 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m18:31:08.344586 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt"."dim_suppliers"
[0m18:31:08.344785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:09.447295 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:31:09.448720 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_suppliers"
[0m18:31:09.452695 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m18:31:09.452968 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt"."dim_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

)
select 
	s.supplier_key,
	s.supplier_name,
	s.supplier_address,
	n.nation_key as supplier_nation_key,
	n.nation_name as supplier_nation_name,
	r.region_key as supplier_region_key,
	r.region_name as supplier_region_name,
	s.supplier_phone_number,
	s.supplier_account_balance
from
	suppliers s
	join
	nations n
		on s.nation_key = n.nation_key
	join
	regions r
		on n.region_key = r.region_key
order by
    s.supplier_key
    )
[0m18:31:11.520419 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m18:31:11.522039 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (execute): 18:31:08.340991 => 18:31:11.521892
[0m18:31:11.522275 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: ROLLBACK
[0m18:31:11.522464 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: Close
[0m18:31:11.523583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9cd4f81-ff9b-40d7-9da3-edc5c99afb14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ae3d12990>]}
[0m18:31:11.523959 [info ] [Thread-1 (]: 3 of 8 OK created sql table model dbt.dim_suppliers ............................ [[32mSUCCESS[0m in 3.19s]
[0m18:31:11.524348 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_suppliers
[0m18:31:11.524644 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.int_parts_suppliers
[0m18:31:11.524946 [info ] [Thread-1 (]: 4 of 8 START sql table model dbt.int_parts_suppliers ........................... [RUN]
[0m18:31:11.525485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_suppliers, now model.dbt_trino_iceberg.int_parts_suppliers)
[0m18:31:11.525728 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.int_parts_suppliers
[0m18:31:11.534373 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.int_parts_suppliers"
[0m18:31:11.535021 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_parts_suppliers (compile): 18:31:11.525941 => 18:31:11.534801
[0m18:31:11.535323 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.int_parts_suppliers
[0m18:31:11.538818 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."int_parts_suppliers"
[0m18:31:11.539428 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_parts_suppliers"
[0m18:31:11.539656 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_parts_suppliers"} */

    drop table if exists "lakehouse"."dbt"."int_parts_suppliers"
[0m18:31:11.539847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:12.311240 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:31:12.312769 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.int_parts_suppliers"
[0m18:31:12.316644 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_parts_suppliers"
[0m18:31:12.316930 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_parts_suppliers"} */

  
    

    create table "lakehouse"."dbt"."int_parts_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
part_suppliers as (

    select * from __dbt__cte__stg_tpch_part_suppliers

)
select 

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(p.part_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(s.supplier_key as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) 
			as part_supplier_key,
    --p.part_supplier_key,
	p.part_key,
    p.part_name,
    p.part_manufacturer_name,
    p.part_brand_name,
    p.part_type_name,
    p.part_size,
    p.part_container_desc,
    p.retail_price,

    s.supplier_key,
    s.supplier_name,
    s.nation_key,

    ps.supplier_availabe_quantity,
    ps.supplier_cost_amount
from
    parts p
    join
    part_suppliers ps
        on p.part_key = ps.part_key
    join
    suppliers s
        on ps.supplier_key = s.supplier_key
order by
    p.part_key
    )
[0m18:31:22.833680 [debug] [Thread-1 (]: SQL status: SUCCESS in 11.0 seconds
[0m18:31:22.835564 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_parts_suppliers (execute): 18:31:11.535495 => 18:31:22.835404
[0m18:31:22.835837 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: ROLLBACK
[0m18:31:22.836063 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: Close
[0m18:31:22.837501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9cd4f81-ff9b-40d7-9da3-edc5c99afb14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ae3b1ee10>]}
[0m18:31:22.838125 [info ] [Thread-1 (]: 4 of 8 OK created sql table model dbt.int_parts_suppliers ...................... [[32mSUCCESS[0m in 11.31s]
[0m18:31:22.838600 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.int_parts_suppliers
[0m18:31:22.838935 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.fct_orders_items
[0m18:31:22.839285 [info ] [Thread-1 (]: 5 of 8 START sql table model dbt.fct_orders_items .............................. [RUN]
[0m18:31:22.839997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.int_parts_suppliers, now model.dbt_trino_iceberg.fct_orders_items)
[0m18:31:22.840327 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.fct_orders_items
[0m18:31:22.850581 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.fct_orders_items"
[0m18:31:22.851448 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (compile): 18:31:22.840718 => 18:31:22.851234
[0m18:31:22.851769 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.fct_orders_items
[0m18:31:22.856223 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."fct_orders_items"
[0m18:31:22.856917 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m18:31:22.857164 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

    drop table if exists "lakehouse"."dbt"."fct_orders_items"
[0m18:31:22.857375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:25.276414 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m18:31:25.278248 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.fct_orders_items"
[0m18:31:25.282197 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m18:31:25.282562 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

  
    

    create table "lakehouse"."dbt"."fct_orders_items"
      
      
    as (
      with  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
	suppkey as supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from
    tpch.sf1.partsupp
), orders_items as (
    
    select * from "lakehouse"."dbt"."int_order_items"

),
parts_suppliers as (
    
    select * from __dbt__cte__stg_tpch_part_suppliers

),
final as (
    select 

        o.order_item_key,
        o.order_key,
        o.order_date,
        o.customer_key,
        o.order_status_code,
        
        o.part_key,
        o.supplier_key,
        o.return_status_code,
        o.order_line_number,
        o.order_line_status_code,
        o.ship_date,
        o.commit_date,
        o.receipt_date,
        o.ship_mode_name,
        ps.supplier_cost_amount,
        
        o.base_price,
        o.discount_percentage,
        o.discounted_price,
        o.tax_rate,
        
        1 as order_item_count,
        o.quantity,

        o.gross_item_sales_amount,
        o.discounted_item_sales_amount,
        o.item_discount_amount,
        o.item_tax_amount,
        o.net_item_sales_amount

    from
        orders_items o
        join
        parts_suppliers ps
            on o.part_key = ps.part_key and
                o.supplier_key = ps.supplier_key
)
select *

from
    final f
order by
    f.order_date
    )
[0m18:32:01.206299 [debug] [Thread-1 (]: SQL status: SUCCESS in 36.0 seconds
[0m18:32:01.208816 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (execute): 18:31:22.851939 => 18:32:01.208625
[0m18:32:01.209128 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: ROLLBACK
[0m18:32:01.209398 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: Close
[0m18:32:01.210707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9cd4f81-ff9b-40d7-9da3-edc5c99afb14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ae3bfd2d0>]}
[0m18:32:01.211080 [info ] [Thread-1 (]: 5 of 8 OK created sql table model dbt.fct_orders_items ......................... [[32mSUCCESS[0m in 38.37s]
[0m18:32:01.211504 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.fct_orders_items
[0m18:32:01.211852 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_part_suppliers
[0m18:32:01.212121 [info ] [Thread-1 (]: 6 of 8 START sql table model dbt.dim_part_suppliers ............................ [RUN]
[0m18:32:01.213107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.fct_orders_items, now model.dbt_trino_iceberg.dim_part_suppliers)
[0m18:32:01.213442 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_part_suppliers
[0m18:32:01.224342 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m18:32:01.225008 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (compile): 18:32:01.213568 => 18:32:01.224814
[0m18:32:01.225259 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_part_suppliers
[0m18:32:01.228260 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."dim_part_suppliers"
[0m18:32:01.228768 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m18:32:01.228978 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

    drop table if exists "lakehouse"."dbt"."dim_part_suppliers"
[0m18:32:01.229227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:02.563184 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:32:02.565146 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m18:32:02.570816 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m18:32:02.571098 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt"."dim_part_suppliers"
      
      
    as (
      with  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from
    tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from
    tpch.sf1.part
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from
    tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select
    regionkey as region_key,
    name as region_name,
    comment as region_comment
from
    tpch.sf1.region
), suppliers as (

    select * from __dbt__cte__stg_tpch_supplier

),
parts as (
    
    select * from __dbt__cte__stg_tpch_part

),
parts_suppliers as (

    select * from "lakehouse"."dbt"."int_parts_suppliers"

),
nations as (

    select * from __dbt__cte__stg_tpch_nation
),
regions as (

    select * from __dbt__cte__stg_tpch_region

),
final as (

    select 
        ps.part_supplier_key,

        p.part_key,
        p.part_name,
        p.part_manufacturer_name,
        p.part_brand_name,
        p.part_type_name,
        p.part_size,
        p.part_container_desc,
        p.retail_price,

        s.supplier_key,
        s.supplier_name,
        supplier_address,
        s.supplier_phone_number,
        s.supplier_account_balance,
        n.nation_key as supplier_nation_key,
        n.nation_name as supplier_nation_name,
        r.region_key as supplier_region_key,
        r.region_name as supplier_region_name,

        ps.supplier_availabe_quantity,
        ps.supplier_cost_amount
    from
        parts p
        join
        parts_suppliers ps
            on p.part_key = ps.part_key
        join
        suppliers s
            on ps.supplier_key = s.supplier_key
        join
        nations n
            on s.nation_key = n.nation_key
        join
        regions r
            on n.region_key = r.region_key
)
select *

from
    final f
order by
    f.part_key,
    f.supplier_key
    )
[0m18:32:14.134441 [debug] [Thread-1 (]: SQL status: SUCCESS in 12.0 seconds
[0m18:32:14.140501 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (execute): 18:32:01.225383 => 18:32:14.140342
[0m18:32:14.140780 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: ROLLBACK
[0m18:32:14.140981 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: Close
[0m18:32:14.142294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9cd4f81-ff9b-40d7-9da3-edc5c99afb14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ae3b6f050>]}
[0m18:32:14.142712 [info ] [Thread-1 (]: 6 of 8 OK created sql table model dbt.dim_part_suppliers ....................... [[32mSUCCESS[0m in 12.93s]
[0m18:32:14.143206 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_part_suppliers
[0m18:32:14.143592 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m18:32:14.144038 [info ] [Thread-1 (]: 7 of 8 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m18:32:14.144533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_part_suppliers, now model.dbt_trino_iceberg.pricing_summary_report)
[0m18:32:14.144781 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m18:32:14.147101 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m18:32:14.147935 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 18:32:14.144924 => 18:32:14.147728
[0m18:32:14.148251 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.pricing_summary_report
[0m18:32:14.151535 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."pricing_summary_report"
[0m18:32:14.152415 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.pricing_summary_report"
[0m18:32:14.152817 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.pricing_summary_report"} */

    drop table if exists "lakehouse"."dbt"."pricing_summary_report"
[0m18:32:14.153044 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:15.442270 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:32:15.443565 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m18:32:15.445724 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.pricing_summary_report"
[0m18:32:15.446026 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.pricing_summary_report"} */

  
    

    create table "lakehouse"."dbt"."pricing_summary_report"
      
      
    as (
      /*
1 Q1 - Pricing Summary Report Query
This query reports the amount of business that was billed, shipped, and returned. 
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 29)
*/

select 
    f.return_status_code,
    f.order_line_status_code,
    sum(f.quantity) as quantity,
    sum(f.gross_item_sales_amount) as gross_item_sales_amount,
    sum(f.discounted_item_sales_amount) as discounted_item_sales_amount,
    sum(f.net_item_sales_amount) as net_item_sales_amount,

    avg(f.quantity) as avg_quantity,
    avg(f.base_price) as avg_base_price,
    avg(f.discount_percentage) as avg_discount_percentage,

    sum(f.order_item_count) as order_item_count
    
from
    "lakehouse"."dbt"."fct_orders_items" f
where
    f.ship_date <= date_add('day', -90, date_parse('1998-12-01', '%Y-%m-%d'))
group by
    1,2
    )
[0m18:32:18.108820 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.0 seconds
[0m18:32:18.111323 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (execute): 18:32:14.148383 => 18:32:18.111186
[0m18:32:18.111562 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: ROLLBACK
[0m18:32:18.111756 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: Close
[0m18:32:18.112881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9cd4f81-ff9b-40d7-9da3-edc5c99afb14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ae3afb310>]}
[0m18:32:18.113294 [info ] [Thread-1 (]: 7 of 8 OK created sql table model dbt.pricing_summary_report ................... [[32mSUCCESS[0m in 3.97s]
[0m18:32:18.113693 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m18:32:18.114026 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m18:32:18.114487 [info ] [Thread-1 (]: 8 of 8 START sql table model dbt.minimum_cost_suppliers ........................ [RUN]
[0m18:32:18.114948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.pricing_summary_report, now model.dbt_trino_iceberg.minimum_cost_suppliers)
[0m18:32:18.115183 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m18:32:18.117243 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m18:32:18.117717 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (compile): 18:32:18.115319 => 18:32:18.117566
[0m18:32:18.117936 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m18:32:18.163549 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."minimum_cost_suppliers"
[0m18:32:18.164212 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m18:32:18.164435 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.minimum_cost_suppliers"} */

    drop table if exists "lakehouse"."dbt"."minimum_cost_suppliers"
[0m18:32:18.164624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:19.131591 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:32:19.134208 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m18:32:19.137119 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m18:32:19.137388 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.minimum_cost_suppliers"} */

  
    

    create table "lakehouse"."dbt"."minimum_cost_suppliers"
      
      
    as (
      /*
2 Q2 - Minimum Cost Supplier Query
This query finds which supplier should be selected to place an order for a given part in a given region
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 30)
*/

with parts_suppliers as (

    select
        s.supplier_account_balance,
        s.supplier_name,
        s.supplier_nation_key,
        s.supplier_region_key,
        s.supplier_nation_name,
        s.supplier_region_name,
        s.part_key,
        s.part_manufacturer_name,
        s.part_size,
        s.part_type_name,
        s.supplier_cost_amount,
        s.supplier_address,
        s.supplier_phone_number,
        rank() over(partition by s.supplier_region_key, s.part_key order by s.supplier_cost_amount) as supplier_cost_rank,
        row_number() over(partition by s.supplier_region_key, s.part_key, s.supplier_cost_amount order by s.supplier_account_balance desc) as supplier_rank
    from
        "lakehouse"."dbt"."dim_part_suppliers" s
)
select
    s.*
from
    parts_suppliers s
where
    s.supplier_cost_rank = 1 and 
    s.supplier_rank <= 100
order by 
    s.supplier_name, s.part_key
    )
[0m18:32:27.134706 [debug] [Thread-1 (]: SQL status: SUCCESS in 8.0 seconds
[0m18:32:27.137749 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (execute): 18:32:18.118066 => 18:32:27.137470
[0m18:32:27.138226 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: ROLLBACK
[0m18:32:27.138540 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: Close
[0m18:32:27.139749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9cd4f81-ff9b-40d7-9da3-edc5c99afb14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ae48a1e10>]}
[0m18:32:27.140189 [info ] [Thread-1 (]: 8 of 8 OK created sql table model dbt.minimum_cost_suppliers ................... [[32mSUCCESS[0m in 9.02s]
[0m18:32:27.140718 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m18:32:27.142389 [debug] [MainThread]: On master: COMMIT
[0m18:32:27.142776 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:32:27.142942 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.minimum_cost_suppliers' was properly closed.
[0m18:32:27.143143 [info ] [MainThread]: 
[0m18:32:27.143355 [info ] [MainThread]: Finished running 8 table models in 0 hours 2 minutes and 22.03 seconds (142.03s).
[0m18:32:27.144393 [debug] [MainThread]: Command end result
[0m18:32:27.151700 [info ] [MainThread]: 
[0m18:32:27.152072 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:32:27.152390 [info ] [MainThread]: 
[0m18:32:27.152669 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m18:32:27.153596 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 142.35043, "process_user_time": 2.51667, "process_kernel_time": 0.720421, "process_mem_max_rss": "113392", "process_out_blocks": "2816", "process_in_blocks": "0"}
[0m18:32:27.154081 [debug] [MainThread]: Command `dbt run` succeeded at 18:32:27.153982 after 142.35 seconds
[0m18:32:27.154329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ae4187d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ae88311d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ae87432d0>]}
[0m18:32:27.154613 [debug] [MainThread]: Flushing usage events
[0m18:32:39.657952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7084a8b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7084a8bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7084a92a90>]}


============================== 18:32:39.660074 | 6ad4fb71-2e38-4f57-8e0b-158d10d9b535 ==============================
[0m18:32:39.660074 [info ] [MainThread]: Running with dbt=1.7.3
[0m18:32:39.660592 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:32:39.790596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ad4fb71-2e38-4f57-8e0b-158d10d9b535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7084aaf0d0>]}
[0m18:32:39.848352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ad4fb71-2e38-4f57-8e0b-158d10d9b535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70847df990>]}
[0m18:32:39.848914 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m18:32:39.856626 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m18:32:39.874849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:32:39.875197 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:32:39.880689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ad4fb71-2e38-4f57-8e0b-158d10d9b535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7084a65550>]}
[0m18:32:39.892810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ad4fb71-2e38-4f57-8e0b-158d10d9b535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70847bf910>]}
[0m18:32:39.893215 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m18:32:39.893518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ad4fb71-2e38-4f57-8e0b-158d10d9b535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7084835bd0>]}
[0m18:32:39.895125 [info ] [MainThread]: 
[0m18:32:39.895764 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m18:32:39.896851 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m18:32:39.909084 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m18:32:39.909458 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m18:32:39.909667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:41.890426 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m18:32:41.892398 [debug] [ThreadPool]: On list_lakehouse: Close
[0m18:32:41.895323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m18:32:41.900730 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m18:32:41.900987 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m18:32:41.901202 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:32:42.628475 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m18:32:42.631831 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m18:32:42.632292 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m18:32:42.635842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ad4fb71-2e38-4f57-8e0b-158d10d9b535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7084834c50>]}
[0m18:32:42.636166 [debug] [MainThread]: On master: COMMIT
[0m18:32:42.636609 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:32:42.636853 [info ] [MainThread]: 
[0m18:32:42.640019 [debug] [Thread-1 (]: Began running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m18:32:42.640413 [info ] [Thread-1 (]: 1 of 1 START snapshot dbt.orders_snapshot ...................................... [RUN]
[0m18:32:42.641174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now snapshot.dbt_trino_iceberg.orders_snapshot)
[0m18:32:42.641465 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_trino_iceberg.orders_snapshot
[0m18:32:42.644906 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (compile): 18:32:42.641622 => 18:32:42.644662
[0m18:32:42.645316 [debug] [Thread-1 (]: Began executing node snapshot.dbt_trino_iceberg.orders_snapshot
[0m18:32:42.678592 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m18:32:42.678943 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    describe "lakehouse"."dbt"."orders_snapshot"
[0m18:32:42.679155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:44.087694 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:32:44.108813 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m18:32:44.109240 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

        
  
    

    create table "lakehouse"."dbt"."orders_snapshot__dbt_tmp"
      
      
    as (
      with snapshot_query as (

        


select * from tpch.sf1.orders


    ),

    snapshotted_data as (

        select *,
            orderkey as dbt_unique_key

        from "lakehouse"."dbt"."orders_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            orderkey as dbt_unique_key,
            orderdate as dbt_updated_at,
            orderdate as dbt_valid_from,
            nullif(orderdate, orderdate) as dbt_valid_to,
            lower(to_hex(md5(to_utf8(concat(coalesce(cast(orderkey as varchar), ''), '|',coalesce(cast(orderdate as varchar), '')))))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            orderkey as dbt_unique_key,
            orderdate as dbt_updated_at,
            orderdate as dbt_valid_from,
            orderdate as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.orderdate)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.orderdate)
        )
    )

    select * from insertions
    union all
    select * from updates

    )
[0m18:32:47.280235 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.0 seconds
[0m18:32:47.282730 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m18:32:47.283087 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    describe "lakehouse"."dbt"."orders_snapshot__dbt_tmp"
[0m18:32:48.159482 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:32:48.163686 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m18:32:48.164003 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    describe "lakehouse"."dbt"."orders_snapshot"
[0m18:32:48.492797 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:32:48.496051 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m18:32:48.496508 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    describe "lakehouse"."dbt"."orders_snapshot__dbt_tmp"
[0m18:32:48.898057 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:32:48.901705 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m18:32:48.901993 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    describe "lakehouse"."dbt"."orders_snapshot"
[0m18:32:49.452907 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:32:49.460005 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m18:32:49.460292 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    describe "lakehouse"."dbt"."orders_snapshot__dbt_tmp"
[0m18:32:49.886529 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:32:49.892294 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m18:32:49.894691 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m18:32:49.894980 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

      merge into "lakehouse"."dbt"."orders_snapshot" as DBT_INTERNAL_DEST
    using "lakehouse"."dbt"."orders_snapshot__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("orderkey", "custkey", "orderstatus", "totalprice", "orderdate", "orderpriority", "clerk", "shippriority", "comment", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
        values (DBT_INTERNAL_SOURCE."orderkey", DBT_INTERNAL_SOURCE."custkey", DBT_INTERNAL_SOURCE."orderstatus", DBT_INTERNAL_SOURCE."totalprice", DBT_INTERNAL_SOURCE."orderdate", DBT_INTERNAL_SOURCE."orderpriority", DBT_INTERNAL_SOURCE."clerk", DBT_INTERNAL_SOURCE."shippriority", DBT_INTERNAL_SOURCE."comment", DBT_INTERNAL_SOURCE."dbt_updated_at", DBT_INTERNAL_SOURCE."dbt_valid_from", DBT_INTERNAL_SOURCE."dbt_valid_to", DBT_INTERNAL_SOURCE."dbt_scd_id")
[0m18:32:52.956068 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.0 seconds
[0m18:32:52.968467 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: COMMIT
[0m18:32:52.973386 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."orders_snapshot__dbt_tmp"
[0m18:32:52.974975 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m18:32:52.975241 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    drop table if exists "lakehouse"."dbt"."orders_snapshot__dbt_tmp"
[0m18:32:53.708781 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:32:53.711058 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (execute): 18:32:42.645510 => 18:32:53.710816
[0m18:32:53.711547 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: Close
[0m18:32:53.713179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ad4fb71-2e38-4f57-8e0b-158d10d9b535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7084693310>]}
[0m18:32:53.713703 [info ] [Thread-1 (]: 1 of 1 OK snapshotted dbt.orders_snapshot ...................................... [[32mSUCCESS[0m in 11.07s]
[0m18:32:53.714126 [debug] [Thread-1 (]: Finished running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m18:32:53.715904 [debug] [MainThread]: On master: COMMIT
[0m18:32:53.716286 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:32:53.716451 [debug] [MainThread]: Connection 'snapshot.dbt_trino_iceberg.orders_snapshot' was properly closed.
[0m18:32:53.716622 [info ] [MainThread]: 
[0m18:32:53.716833 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 13.82 seconds (13.82s).
[0m18:32:53.717286 [debug] [MainThread]: Command end result
[0m18:32:53.730217 [info ] [MainThread]: 
[0m18:32:53.730716 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:32:53.731026 [info ] [MainThread]: 
[0m18:32:53.731317 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:32:53.732004 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 14.101571, "process_user_time": 1.623374, "process_kernel_time": 0.075947, "process_mem_max_rss": "110996", "process_out_blocks": "2424", "process_in_blocks": "0"}
[0m18:32:53.732347 [debug] [MainThread]: Command `dbt snapshot` succeeded at 18:32:53.732271 after 14.10 seconds
[0m18:32:53.732572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7088fdf450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70890cd010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f708915aa90>]}
[0m18:32:53.732787 [debug] [MainThread]: Flushing usage events
[0m18:33:10.336150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5c3dc690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5c3dc050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5c3de1d0>]}


============================== 18:33:10.338340 | fcd87955-ce6e-49cc-935e-8540563901f4 ==============================
[0m18:33:10.338340 [info ] [MainThread]: Running with dbt=1.7.3
[0m18:33:10.338715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:33:10.466404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcd87955-ce6e-49cc-935e-8540563901f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5c1b2f10>]}
[0m18:33:10.525286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcd87955-ce6e-49cc-935e-8540563901f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5c234190>]}
[0m18:33:10.525744 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m18:33:10.533116 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m18:33:10.552679 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:33:10.553092 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:33:10.558314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcd87955-ce6e-49cc-935e-8540563901f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5be20150>]}
[0m18:33:10.567228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcd87955-ce6e-49cc-935e-8540563901f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5bf43e90>]}
[0m18:33:10.567606 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m18:33:10.567879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcd87955-ce6e-49cc-935e-8540563901f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5c1b1590>]}
[0m18:33:10.569461 [info ] [MainThread]: 
[0m18:33:10.570545 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m18:33:10.571842 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m18:33:10.583095 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m18:33:10.583371 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m18:33:10.583547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:33:12.947079 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m18:33:12.949109 [debug] [ThreadPool]: On list_lakehouse: Close
[0m18:33:12.952468 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m18:33:12.958251 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m18:33:12.958656 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m18:33:12.958858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:33:14.309685 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m18:33:14.311758 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m18:33:14.312006 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m18:33:14.314516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcd87955-ce6e-49cc-935e-8540563901f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5c248310>]}
[0m18:33:14.314821 [debug] [MainThread]: On master: COMMIT
[0m18:33:14.315210 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:33:14.315481 [info ] [MainThread]: 
[0m18:33:14.318268 [debug] [Thread-1 (]: Began running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m18:33:14.318617 [info ] [Thread-1 (]: 1 of 1 START snapshot dbt.orders_snapshot ...................................... [RUN]
[0m18:33:14.319307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now snapshot.dbt_trino_iceberg.orders_snapshot)
[0m18:33:14.319549 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_trino_iceberg.orders_snapshot
[0m18:33:14.322472 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (compile): 18:33:14.319697 => 18:33:14.322317
[0m18:33:14.322699 [debug] [Thread-1 (]: Began executing node snapshot.dbt_trino_iceberg.orders_snapshot
[0m18:33:14.354972 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m18:33:14.355314 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    describe "lakehouse"."dbt"."orders_snapshot"
[0m18:33:14.355533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:14.987417 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:33:15.007116 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m18:33:15.007514 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

        
  
    

    create table "lakehouse"."dbt"."orders_snapshot__dbt_tmp"
      
      
    as (
      with snapshot_query as (

        


select * from tpch.sf1.orders


    ),

    snapshotted_data as (

        select *,
            orderkey as dbt_unique_key

        from "lakehouse"."dbt"."orders_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            orderkey as dbt_unique_key,
            orderdate as dbt_updated_at,
            orderdate as dbt_valid_from,
            nullif(orderdate, orderdate) as dbt_valid_to,
            lower(to_hex(md5(to_utf8(concat(coalesce(cast(orderkey as varchar), ''), '|',coalesce(cast(orderdate as varchar), '')))))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            orderkey as dbt_unique_key,
            orderdate as dbt_updated_at,
            orderdate as dbt_valid_from,
            orderdate as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.orderdate)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.orderdate)
        )
    )

    select * from insertions
    union all
    select * from updates

    )
[0m18:33:17.342548 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m18:33:17.345975 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m18:33:17.346295 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    describe "lakehouse"."dbt"."orders_snapshot__dbt_tmp"
[0m18:33:18.215534 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:33:18.219843 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m18:33:18.220081 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    describe "lakehouse"."dbt"."orders_snapshot"
[0m18:33:18.610645 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:33:18.614006 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m18:33:18.614246 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    describe "lakehouse"."dbt"."orders_snapshot__dbt_tmp"
[0m18:33:19.239753 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:33:19.243647 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m18:33:19.243871 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    describe "lakehouse"."dbt"."orders_snapshot"
[0m18:33:19.659294 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:33:19.666841 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m18:33:19.667114 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    describe "lakehouse"."dbt"."orders_snapshot__dbt_tmp"
[0m18:33:20.081011 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:33:20.087022 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m18:33:20.089450 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m18:33:20.089806 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

      merge into "lakehouse"."dbt"."orders_snapshot" as DBT_INTERNAL_DEST
    using "lakehouse"."dbt"."orders_snapshot__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("orderkey", "custkey", "orderstatus", "totalprice", "orderdate", "orderpriority", "clerk", "shippriority", "comment", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
        values (DBT_INTERNAL_SOURCE."orderkey", DBT_INTERNAL_SOURCE."custkey", DBT_INTERNAL_SOURCE."orderstatus", DBT_INTERNAL_SOURCE."totalprice", DBT_INTERNAL_SOURCE."orderdate", DBT_INTERNAL_SOURCE."orderpriority", DBT_INTERNAL_SOURCE."clerk", DBT_INTERNAL_SOURCE."shippriority", DBT_INTERNAL_SOURCE."comment", DBT_INTERNAL_SOURCE."dbt_updated_at", DBT_INTERNAL_SOURCE."dbt_valid_from", DBT_INTERNAL_SOURCE."dbt_valid_to", DBT_INTERNAL_SOURCE."dbt_scd_id")
[0m18:33:20.621232 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:33:20.633253 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: COMMIT
[0m18:33:20.637640 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."orders_snapshot__dbt_tmp"
[0m18:33:20.639095 [debug] [Thread-1 (]: Using trino connection "snapshot.dbt_trino_iceberg.orders_snapshot"
[0m18:33:20.639373 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "snapshot.dbt_trino_iceberg.orders_snapshot"} */

    drop table if exists "lakehouse"."dbt"."orders_snapshot__dbt_tmp"
[0m18:33:21.003365 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:33:21.005479 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (execute): 18:33:14.322822 => 18:33:21.005246
[0m18:33:21.005843 [debug] [Thread-1 (]: On snapshot.dbt_trino_iceberg.orders_snapshot: Close
[0m18:33:21.007536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcd87955-ce6e-49cc-935e-8540563901f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5be70590>]}
[0m18:33:21.008237 [info ] [Thread-1 (]: 1 of 1 OK snapshotted dbt.orders_snapshot ...................................... [[32mSUCCESS[0m in 6.69s]
[0m18:33:21.008629 [debug] [Thread-1 (]: Finished running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m18:33:21.010432 [debug] [MainThread]: On master: COMMIT
[0m18:33:21.010817 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:33:21.010983 [debug] [MainThread]: Connection 'snapshot.dbt_trino_iceberg.orders_snapshot' was properly closed.
[0m18:33:21.011152 [info ] [MainThread]: 
[0m18:33:21.011364 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 10.44 seconds (10.44s).
[0m18:33:21.011913 [debug] [MainThread]: Command end result
[0m18:33:21.017978 [info ] [MainThread]: 
[0m18:33:21.018424 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:33:21.018759 [info ] [MainThread]: 
[0m18:33:21.019060 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:33:21.019790 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 10.710475, "process_user_time": 1.626566, "process_kernel_time": 0.066584, "process_mem_max_rss": "110992", "process_out_blocks": "2416", "process_in_blocks": "0"}
[0m18:33:21.020245 [debug] [MainThread]: Command `dbt snapshot` succeeded at 18:33:21.020130 after 10.71 seconds
[0m18:33:21.020556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5d9cbf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc609ed190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc60a7ab90>]}
[0m18:33:21.020884 [debug] [MainThread]: Flushing usage events
[0m21:09:44.160692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23a9175490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23a961cbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23a9177110>]}


============================== 21:09:44.163336 | 7d0bf9d8-7060-4f0c-8ba2-cabae1f3e7f2 ==============================
[0m21:09:44.163336 [info ] [MainThread]: Running with dbt=1.7.3
[0m21:09:44.163731 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m21:09:44.309593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d0bf9d8-7060-4f0c-8ba2-cabae1f3e7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23a8fc6110>]}
[0m21:09:44.371813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d0bf9d8-7060-4f0c-8ba2-cabae1f3e7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23a8f28650>]}
[0m21:09:44.372270 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m21:09:44.380583 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m21:09:44.420672 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 68 files changed.
[0m21:09:44.421054 [debug] [MainThread]: Partial parsing: deleted file: dbt_trino_iceberg://macros/create_schema.sql
[0m21:09:44.421283 [debug] [MainThread]: Partial parsing: deleted file: dbt_trino_iceberg://snapshots/order2.sql
[0m21:09:44.421701 [debug] [MainThread]: Partial parsing: deleted file: dbt_trino_iceberg://macros/current_timestamp.sql
[0m21:09:44.421924 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/safe_add.sql
[0m21:09:44.422117 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/recency.sql
[0m21:09:44.422424 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/staging/stg_tpch_orders.sql
[0m21:09:44.422645 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/staging/stg_tpch_customers.sql
[0m21:09:44.422907 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m21:09:44.423136 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/deduplicate.sql
[0m21:09:44.423328 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m21:09:44.423522 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_single_value.sql
[0m21:09:44.423722 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m21:09:44.423916 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/safe_subtract.sql
[0m21:09:44.424108 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m21:09:44.424297 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/surrogate_key.sql
[0m21:09:44.424488 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/mart/dim_part_suppliers.sql
[0m21:09:44.424706 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m21:09:44.424974 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/generate_series.sql
[0m21:09:44.425319 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://macros/dateadd.sql
[0m21:09:44.425524 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m21:09:44.425693 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m21:09:44.425885 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m21:09:44.426080 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/union.sql
[0m21:09:44.426305 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/nullcheck.sql
[0m21:09:44.426500 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/width_bucket.sql
[0m21:09:44.426719 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m21:09:44.426938 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/haversine_distance.sql
[0m21:09:44.427127 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/web/get_url_parameter.sql
[0m21:09:44.427424 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/staging/stg_tpch_region.sql
[0m21:09:44.427652 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m21:09:44.427852 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m21:09:44.428086 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/groupby.sql
[0m21:09:44.428266 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/date_spine.sql
[0m21:09:44.428574 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m21:09:44.428913 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/mart/pricing_summary_report.sql
[0m21:09:44.429254 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/intermediate/int_parts_suppliers.sql
[0m21:09:44.429508 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m21:09:44.429700 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/pivot.sql
[0m21:09:44.429886 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m21:09:44.430111 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m21:09:44.430353 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/web/get_url_path.sql
[0m21:09:44.430587 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/mart/fct_orders_items.sql
[0m21:09:44.430842 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m21:09:44.431120 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/safe_divide.sql
[0m21:09:44.431416 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/staging/stg_tpch_part_suppliers.sql
[0m21:09:44.431651 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m21:09:44.431898 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://snapshots/orders.sql
[0m21:09:44.432222 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m21:09:44.432425 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_constant.sql
[0m21:09:44.432592 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/unpivot.sql
[0m21:09:44.432780 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/web/get_url_host.sql
[0m21:09:44.432966 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/mart/dim_suppliers.sql
[0m21:09:44.433134 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/equality.sql
[0m21:09:44.433328 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/intermediate/int_order_items.sql
[0m21:09:44.433497 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m21:09:44.433729 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m21:09:44.433920 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m21:09:44.434086 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m21:09:44.434283 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m21:09:44.434472 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/staging/stg_tpch_supplier.sql
[0m21:09:44.434659 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m21:09:44.434919 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/staging/stg_tpch_nation.sql
[0m21:09:44.435131 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/mart/minimum_cost_suppliers.sql
[0m21:09:44.435307 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_column_values.sql
[0m21:09:44.435471 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m21:09:44.435646 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/nullcheck_table.sql
[0m21:09:44.435840 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/staging/stg_tpch_part.sql
[0m21:09:44.436002 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/star.sql
[0m21:09:44.436163 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m21:09:44.436355 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/staging/stg_tpch_line_item.sql
[0m21:09:44.436552 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m21:09:44.888712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d0bf9d8-7060-4f0c-8ba2-cabae1f3e7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23a8b73e90>]}
[0m21:09:44.891096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d0bf9d8-7060-4f0c-8ba2-cabae1f3e7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23a8ca61d0>]}
[0m21:09:44.891463 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 536 macros, 0 groups, 0 semantic models
[0m21:09:44.891722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d0bf9d8-7060-4f0c-8ba2-cabae1f3e7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f239b9cf890>]}
[0m21:09:44.893355 [info ] [MainThread]: 
[0m21:09:44.893906 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m21:09:44.895478 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_dbt'
[0m21:09:44.908722 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m21:09:44.909004 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m21:09:44.909190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:09:47.201714 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m21:09:47.204508 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m21:09:47.204703 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m21:09:47.207266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d0bf9d8-7060-4f0c-8ba2-cabae1f3e7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23a8c6f1d0>]}
[0m21:09:47.207756 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:09:47.208008 [info ] [MainThread]: 
[0m21:09:47.211735 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_customers
[0m21:09:47.212245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.stg_tpch_customers)
[0m21:09:47.212485 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_customers
[0m21:09:47.214689 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_customers"
[0m21:09:47.215481 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_customers (compile): 21:09:47.212630 => 21:09:47.215327
[0m21:09:47.216607 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_customers
[0m21:09:47.216906 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m21:09:47.217332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_customers, now model.dbt_trino_iceberg.stg_tpch_line_item)
[0m21:09:47.217579 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_line_item
[0m21:09:47.261261 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_line_item"
[0m21:09:47.262192 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_line_item (compile): 21:09:47.217771 => 21:09:47.261936
[0m21:09:47.263065 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m21:09:47.263424 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_nation
[0m21:09:47.264209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_line_item, now model.dbt_trino_iceberg.stg_tpch_nation)
[0m21:09:47.264466 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_nation
[0m21:09:47.266549 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_nation"
[0m21:09:47.267078 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_nation (compile): 21:09:47.264594 => 21:09:47.266926
[0m21:09:47.267650 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_nation
[0m21:09:47.267966 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_orders
[0m21:09:47.268374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_nation, now model.dbt_trino_iceberg.stg_tpch_orders)
[0m21:09:47.268634 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_orders
[0m21:09:47.270771 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_orders"
[0m21:09:47.271454 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_orders (compile): 21:09:47.268836 => 21:09:47.271297
[0m21:09:47.271669 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.stg_tpch_orders
[0m21:09:47.271909 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_orders (execute): 21:09:47.271788 => 21:09:47.271795
[0m21:09:47.272426 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_orders
[0m21:09:47.272832 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part
[0m21:09:47.273226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_orders, now model.dbt_trino_iceberg.stg_tpch_part)
[0m21:09:47.273459 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part
[0m21:09:47.275321 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part"
[0m21:09:47.275918 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part (compile): 21:09:47.273598 => 21:09:47.275733
[0m21:09:47.276444 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part
[0m21:09:47.276730 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m21:09:47.277361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part, now model.dbt_trino_iceberg.stg_tpch_part_suppliers)
[0m21:09:47.277608 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m21:09:47.279542 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part_suppliers"
[0m21:09:47.280076 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part_suppliers (compile): 21:09:47.277762 => 21:09:47.279934
[0m21:09:47.280592 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m21:09:47.280917 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_region
[0m21:09:47.281305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part_suppliers, now model.dbt_trino_iceberg.stg_tpch_region)
[0m21:09:47.281597 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_region
[0m21:09:47.283532 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_region"
[0m21:09:47.284070 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_region (compile): 21:09:47.281789 => 21:09:47.283925
[0m21:09:47.284604 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_region
[0m21:09:47.284855 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m21:09:47.285235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_region, now model.dbt_trino_iceberg.stg_tpch_supplier)
[0m21:09:47.285457 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_supplier
[0m21:09:47.287309 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_supplier"
[0m21:09:47.287913 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_supplier (compile): 21:09:47.285593 => 21:09:47.287750
[0m21:09:47.288507 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m21:09:47.288786 [debug] [Thread-1 (]: Began running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m21:09:47.289175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_supplier, now snapshot.dbt_trino_iceberg.orders_snapshot)
[0m21:09:47.289400 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_trino_iceberg.orders_snapshot
[0m21:09:47.291703 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (compile): 21:09:47.289545 => 21:09:47.291557
[0m21:09:47.291963 [debug] [Thread-1 (]: Began executing node snapshot.dbt_trino_iceberg.orders_snapshot
[0m21:09:47.292233 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (execute): 21:09:47.292109 => 21:09:47.292115
[0m21:09:47.292748 [debug] [Thread-1 (]: Finished running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m21:09:47.293025 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.int_order_items
[0m21:09:47.293416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_trino_iceberg.orders_snapshot, now model.dbt_trino_iceberg.int_order_items)
[0m21:09:47.293641 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.int_order_items
[0m21:09:47.306579 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.int_order_items"
[0m21:09:47.307089 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_order_items (compile): 21:09:47.293775 => 21:09:47.306928
[0m21:09:47.307310 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.int_order_items
[0m21:09:47.307548 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_order_items (execute): 21:09:47.307435 => 21:09:47.307440
[0m21:09:47.308087 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.int_order_items
[0m21:09:47.308386 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_suppliers
[0m21:09:47.308844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.int_order_items, now model.dbt_trino_iceberg.dim_suppliers)
[0m21:09:47.309074 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_suppliers
[0m21:09:47.314299 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_suppliers"
[0m21:09:47.315492 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (compile): 21:09:47.309217 => 21:09:47.315258
[0m21:09:47.315804 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_suppliers
[0m21:09:47.316124 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (execute): 21:09:47.315978 => 21:09:47.315985
[0m21:09:47.316777 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_suppliers
[0m21:09:47.317146 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.int_parts_suppliers
[0m21:09:47.320175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_suppliers, now model.dbt_trino_iceberg.int_parts_suppliers)
[0m21:09:47.320611 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.int_parts_suppliers
[0m21:09:47.329537 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.int_parts_suppliers"
[0m21:09:47.330339 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_parts_suppliers (compile): 21:09:47.320784 => 21:09:47.330045
[0m21:09:47.330665 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.int_parts_suppliers
[0m21:09:47.331052 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_parts_suppliers (execute): 21:09:47.330827 => 21:09:47.330838
[0m21:09:47.331789 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.int_parts_suppliers
[0m21:09:47.332127 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.fct_orders_items
[0m21:09:47.332600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.int_parts_suppliers, now model.dbt_trino_iceberg.fct_orders_items)
[0m21:09:47.332889 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.fct_orders_items
[0m21:09:47.342559 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.fct_orders_items"
[0m21:09:47.343353 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (compile): 21:09:47.333029 => 21:09:47.343175
[0m21:09:47.343578 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.fct_orders_items
[0m21:09:47.343828 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (execute): 21:09:47.343710 => 21:09:47.343716
[0m21:09:47.344574 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.fct_orders_items
[0m21:09:47.344918 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_part_suppliers
[0m21:09:47.345391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.fct_orders_items, now model.dbt_trino_iceberg.dim_part_suppliers)
[0m21:09:47.345627 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_part_suppliers
[0m21:09:47.354998 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m21:09:47.355646 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (compile): 21:09:47.345767 => 21:09:47.355466
[0m21:09:47.355913 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_part_suppliers
[0m21:09:47.356170 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (execute): 21:09:47.356049 => 21:09:47.356054
[0m21:09:47.356678 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_part_suppliers
[0m21:09:47.356930 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m21:09:47.357351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_part_suppliers, now model.dbt_trino_iceberg.pricing_summary_report)
[0m21:09:47.357588 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m21:09:47.360253 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 21:09:47.357733 => 21:09:47.360104
[0m21:09:47.363183 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var ' highest_ship_date ' not found in config:
  Vars supplied to pricing_summary_report = {
      "dbt_trino_iceberg": {
          "highest_ship_date": "1998-12-01"
      },
      "highest_ship_date": "1998-12-01"
  }
[0m21:09:47.363579 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m21:09:47.363859 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m21:09:47.364263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.pricing_summary_report, now model.dbt_trino_iceberg.minimum_cost_suppliers)
[0m21:09:47.364492 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m21:09:47.366510 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m21:09:47.367188 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (compile): 21:09:47.364631 => 21:09:47.366969
[0m21:09:47.367442 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m21:09:47.367677 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (execute): 21:09:47.367560 => 21:09:47.367566
[0m21:09:47.368189 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m21:09:47.368655 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:09:47.369091 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.minimum_cost_suppliers' was properly closed.
[0m21:09:47.369407 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
    Required var ' highest_ship_date ' not found in config:
    Vars supplied to pricing_summary_report = {
        "dbt_trino_iceberg": {
            "highest_ship_date": "1998-12-01"
        },
        "highest_ship_date": "1998-12-01"
    }
[0m21:09:47.370114 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 3.24372, "process_user_time": 1.983237, "process_kernel_time": 0.528245, "process_mem_max_rss": "114012", "process_out_blocks": "1392", "command_success": false, "process_in_blocks": "0"}
[0m21:09:47.370480 [debug] [MainThread]: Command `dbt docs generate` failed at 21:09:47.370403 after 3.24 seconds
[0m21:09:47.370723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23a917f810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f239b8896d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23a91cb910>]}
[0m21:09:47.370958 [debug] [MainThread]: Flushing usage events
[0m21:13:54.713725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9e164610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9e1645d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9e167290>]}


============================== 21:13:54.715648 | 1c9da2ec-015d-4d91-95c8-bd2849cd0cfe ==============================
[0m21:13:54.715648 [info ] [MainThread]: Running with dbt=1.7.3
[0m21:13:54.716188 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:13:54.856790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c9da2ec-015d-4d91-95c8-bd2849cd0cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9e05c190>]}
[0m21:13:54.919577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c9da2ec-015d-4d91-95c8-bd2849cd0cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9e04f9d0>]}
[0m21:13:54.920051 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m21:13:54.927752 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m21:13:54.937445 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:13:54.937875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1c9da2ec-015d-4d91-95c8-bd2849cd0cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9dbe2890>]}
[0m21:13:55.867101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c9da2ec-015d-4d91-95c8-bd2849cd0cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9cc84950>]}
[0m21:13:55.885549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c9da2ec-015d-4d91-95c8-bd2849cd0cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9ca521d0>]}
[0m21:13:55.885913 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 536 macros, 0 groups, 0 semantic models
[0m21:13:55.886225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c9da2ec-015d-4d91-95c8-bd2849cd0cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9ccc6a10>]}
[0m21:13:55.887725 [info ] [MainThread]: 
[0m21:13:55.888330 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m21:13:55.889457 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m21:13:55.901113 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m21:13:55.901427 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m21:13:55.901610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:57.969821 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m21:13:57.971168 [debug] [ThreadPool]: On list_lakehouse: Close
[0m21:13:57.974302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m21:13:57.981105 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m21:13:57.981354 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m21:13:57.981546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:13:59.478777 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m21:13:59.481133 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m21:13:59.481551 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m21:13:59.484744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c9da2ec-015d-4d91-95c8-bd2849cd0cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9dc9b590>]}
[0m21:13:59.485063 [debug] [MainThread]: On master: COMMIT
[0m21:13:59.485462 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:13:59.485698 [info ] [MainThread]: 
[0m21:13:59.488689 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_customers
[0m21:13:59.489127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.stg_tpch_customers)
[0m21:13:59.489351 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_customers
[0m21:13:59.492196 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_customers"
[0m21:13:59.492733 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_customers (compile): 21:13:59.489689 => 21:13:59.492554
[0m21:13:59.493280 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_customers
[0m21:13:59.493575 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m21:13:59.493996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_customers, now model.dbt_trino_iceberg.stg_tpch_line_item)
[0m21:13:59.494237 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_line_item
[0m21:13:59.496306 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_line_item"
[0m21:13:59.496814 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_line_item (compile): 21:13:59.494384 => 21:13:59.496635
[0m21:13:59.497361 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m21:13:59.497627 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_nation
[0m21:13:59.498108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_line_item, now model.dbt_trino_iceberg.stg_tpch_nation)
[0m21:13:59.498442 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_nation
[0m21:13:59.500776 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_nation"
[0m21:13:59.501570 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_nation (compile): 21:13:59.498663 => 21:13:59.501329
[0m21:13:59.502239 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_nation
[0m21:13:59.502513 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_orders
[0m21:13:59.502811 [info ] [Thread-1 (]: 1 of 8 START sql table model dbt.stg_tpch_orders ............................... [RUN]
[0m21:13:59.503316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_nation, now model.dbt_trino_iceberg.stg_tpch_orders)
[0m21:13:59.503602 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_orders
[0m21:13:59.505640 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_orders"
[0m21:13:59.506232 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_orders (compile): 21:13:59.503756 => 21:13:59.506067
[0m21:13:59.506473 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.stg_tpch_orders
[0m21:13:59.522855 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."stg_tpch_orders"
[0m21:13:59.524399 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.stg_tpch_orders"
[0m21:13:59.524665 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.stg_tpch_orders"} */

    drop table if exists "lakehouse"."dbt"."stg_tpch_orders"
[0m21:13:59.524868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:14:00.522533 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:14:00.534059 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.stg_tpch_orders"
[0m21:14:00.535424 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.stg_tpch_orders"
[0m21:14:00.535682 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.stg_tpch_orders"} */

  
    

    create table "lakehouse"."dbt"."stg_tpch_orders"
      
      
    as (
      
select
    orderkey as order_key,
    custkey as customer_key,
    orderstatus as order_status_code,
    totalprice as order_amount,
    orderdate as order_date,
    orderpriority as order_priority_code,
    clerk as order_clerk_name,
    shippriority as shipping_priority,
    comment as order_comment
from tpch.sf1.orders
    )
[0m21:14:10.587944 [debug] [Thread-1 (]: SQL status: SUCCESS in 10.0 seconds
[0m21:14:10.601024 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_orders (execute): 21:13:59.506619 => 21:14:10.600870
[0m21:14:10.601309 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_orders: ROLLBACK
[0m21:14:10.601512 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.stg_tpch_orders: Close
[0m21:14:10.602668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c9da2ec-015d-4d91-95c8-bd2849cd0cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9ca37390>]}
[0m21:14:10.603076 [info ] [Thread-1 (]: 1 of 8 OK created sql table model dbt.stg_tpch_orders .......................... [[32mSUCCESS[0m in 11.10s]
[0m21:14:10.603495 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_orders
[0m21:14:10.603841 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part
[0m21:14:10.604257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_orders, now model.dbt_trino_iceberg.stg_tpch_part)
[0m21:14:10.604501 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part
[0m21:14:10.606644 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part"
[0m21:14:10.607863 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part (compile): 21:14:10.604648 => 21:14:10.607308
[0m21:14:10.608480 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part
[0m21:14:10.608767 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m21:14:10.609328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part, now model.dbt_trino_iceberg.stg_tpch_part_suppliers)
[0m21:14:10.609555 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m21:14:10.611499 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part_suppliers"
[0m21:14:10.611929 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part_suppliers (compile): 21:14:10.609675 => 21:14:10.611791
[0m21:14:10.612411 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m21:14:10.612674 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_region
[0m21:14:10.613155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part_suppliers, now model.dbt_trino_iceberg.stg_tpch_region)
[0m21:14:10.613397 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_region
[0m21:14:10.615295 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_region"
[0m21:14:10.615863 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_region (compile): 21:14:10.613536 => 21:14:10.615701
[0m21:14:10.616383 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_region
[0m21:14:10.616639 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m21:14:10.617015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_region, now model.dbt_trino_iceberg.stg_tpch_supplier)
[0m21:14:10.617279 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_supplier
[0m21:14:10.619199 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_supplier"
[0m21:14:10.619572 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_supplier (compile): 21:14:10.617425 => 21:14:10.619430
[0m21:14:10.620253 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m21:14:10.620525 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.int_order_items
[0m21:14:10.620829 [info ] [Thread-1 (]: 2 of 8 START sql table model dbt.int_order_items ............................... [RUN]
[0m21:14:10.621285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_supplier, now model.dbt_trino_iceberg.int_order_items)
[0m21:14:10.621557 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.int_order_items
[0m21:14:10.636275 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.int_order_items"
[0m21:14:10.636946 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_order_items (compile): 21:14:10.621707 => 21:14:10.636749
[0m21:14:10.637190 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.int_order_items
[0m21:14:10.640517 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."int_order_items"
[0m21:14:10.641026 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_order_items"
[0m21:14:10.641238 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_order_items"} */

    drop table if exists "lakehouse"."dbt"."int_order_items"
[0m21:14:10.641424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:14:11.823148 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:14:11.824871 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.int_order_items"
[0m21:14:11.829169 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_order_items"
[0m21:14:11.829475 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_order_items"} */

  
    

    create table "lakehouse"."dbt"."int_order_items"
      
      
    as (
      with
     __dbt__cte__stg_tpch_line_item as (

select
    orderkey as order_key,
    partkey as part_key,
    suppkey as supplier_key,
    linenumber as order_line_number,
    quantity as quantity,
    extendedprice as extended_price,
    discount as discount_percentage,
    tax as tax_rate,
    returnflag as return_status_code,
    linestatus as order_line_status_code,
    shipdate as ship_date,
    commitdate as commit_date,
    receiptdate as receipt_date,
    shipinstruct as ship_instructions_desc,
    shipmode as ship_mode_name,
    comment as order_line_comment
from tpch.sf1.lineitem
), orders as (select * from "lakehouse"."dbt"."stg_tpch_orders"),
    line_items as (select * from __dbt__cte__stg_tpch_line_item)
select

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(o.order_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l.order_line_number as varchar), '_dbt_utils_surrogate_key_null_') as varchar)))))
    as order_item_key,

    o.order_key,
    o.order_date,
    o.customer_key,
    o.order_status_code,

    l.part_key,
    l.supplier_key,
    l.return_status_code,
    l.order_line_number,
    l.order_line_status_code,
    l.ship_date,
    l.commit_date,
    l.receipt_date,
    l.ship_mode_name,

    l.quantity,

    -- extended_price is actually the line item total,
    -- so we back out the extended price per item
    (l.extended_price / nullif(l.quantity, 0)) as base_price,
    l.discount_percentage,
    (
        (l.extended_price / nullif(l.quantity, 0)) * (1 - l.discount_percentage)
    ) as discounted_price,

    l.extended_price as gross_item_sales_amount,
    (l.extended_price * (1 - l.discount_percentage)) as discounted_item_sales_amount,
    -- We model discounts as negative amounts
    (-1 * l.extended_price * l.discount_percentage) as item_discount_amount,
    l.tax_rate,
    (
        (l.extended_price + (-1 * l.extended_price * l.discount_percentage))
        * l.tax_rate
    ) as item_tax_amount,
    (
        l.extended_price
        + (-1 * l.extended_price * l.discount_percentage)
        + (
            (l.extended_price + (-1 * l.extended_price * l.discount_percentage))
            * l.tax_rate
        )
    ) as net_item_sales_amount

from orders o
join line_items l on o.order_key = l.order_key
order by o.order_date
    )
[0m21:14:43.542276 [debug] [Thread-1 (]: SQL status: SUCCESS in 32.0 seconds
[0m21:14:43.545168 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_order_items (execute): 21:14:10.637340 => 21:14:43.545037
[0m21:14:43.545400 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: ROLLBACK
[0m21:14:43.545589 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_order_items: Close
[0m21:14:43.546699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c9da2ec-015d-4d91-95c8-bd2849cd0cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9caad6d0>]}
[0m21:14:43.547100 [info ] [Thread-1 (]: 2 of 8 OK created sql table model dbt.int_order_items .......................... [[32mSUCCESS[0m in 32.93s]
[0m21:14:43.547489 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.int_order_items
[0m21:14:43.547828 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_suppliers
[0m21:14:43.548143 [info ] [Thread-1 (]: 3 of 8 START sql table model dbt.dim_suppliers ................................. [RUN]
[0m21:14:43.548641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.int_order_items, now model.dbt_trino_iceberg.dim_suppliers)
[0m21:14:43.548883 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_suppliers
[0m21:14:43.554006 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_suppliers"
[0m21:14:43.554769 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (compile): 21:14:43.549024 => 21:14:43.554606
[0m21:14:43.554994 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_suppliers
[0m21:14:43.558133 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."dim_suppliers"
[0m21:14:43.558642 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m21:14:43.558950 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt"."dim_suppliers"
[0m21:14:43.559146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:14:44.841514 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:14:44.845082 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_suppliers"
[0m21:14:44.848257 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m21:14:44.848510 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt"."dim_suppliers"
      
      
    as (
      with
     __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from tpch.sf1.supplier
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select regionkey as region_key, name as region_name, comment as region_comment
from tpch.sf1.region
), suppliers as (select * from __dbt__cte__stg_tpch_supplier),
    nations as (select * from __dbt__cte__stg_tpch_nation),
    regions as (select * from __dbt__cte__stg_tpch_region)
select
    s.supplier_key,
    s.supplier_name,
    s.supplier_address,
    n.nation_key as supplier_nation_key,
    n.nation_name as supplier_nation_name,
    r.region_key as supplier_region_key,
    r.region_name as supplier_region_name,
    s.supplier_phone_number,
    s.supplier_account_balance
from suppliers s
join nations n on s.nation_key = n.nation_key
join regions r on n.region_key = r.region_key
order by s.supplier_key
    )
[0m21:14:46.610425 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m21:14:46.615375 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (execute): 21:14:43.555114 => 21:14:46.615097
[0m21:14:46.615849 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: ROLLBACK
[0m21:14:46.616265 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: Close
[0m21:14:46.618062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c9da2ec-015d-4d91-95c8-bd2849cd0cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9ca86fd0>]}
[0m21:14:46.618532 [info ] [Thread-1 (]: 3 of 8 OK created sql table model dbt.dim_suppliers ............................ [[32mSUCCESS[0m in 3.07s]
[0m21:14:46.619009 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_suppliers
[0m21:14:46.619350 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.int_parts_suppliers
[0m21:14:46.619702 [info ] [Thread-1 (]: 4 of 8 START sql table model dbt.int_parts_suppliers ........................... [RUN]
[0m21:14:46.620188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_suppliers, now model.dbt_trino_iceberg.int_parts_suppliers)
[0m21:14:46.620450 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.int_parts_suppliers
[0m21:14:46.629421 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.int_parts_suppliers"
[0m21:14:46.629864 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_parts_suppliers (compile): 21:14:46.620588 => 21:14:46.629708
[0m21:14:46.630085 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.int_parts_suppliers
[0m21:14:46.632908 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."int_parts_suppliers"
[0m21:14:46.633367 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_parts_suppliers"
[0m21:14:46.633575 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_parts_suppliers"} */

    drop table if exists "lakehouse"."dbt"."int_parts_suppliers"
[0m21:14:46.633761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:14:47.428799 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:14:47.430454 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.int_parts_suppliers"
[0m21:14:47.434153 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.int_parts_suppliers"
[0m21:14:47.434731 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.int_parts_suppliers"} */

  
    

    create table "lakehouse"."dbt"."int_parts_suppliers"
      
      
    as (
      with
     __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from tpch.sf1.part
),  __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
    suppkey as supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from tpch.sf1.partsupp
), parts as (select * from __dbt__cte__stg_tpch_part),
    suppliers as (select * from __dbt__cte__stg_tpch_supplier),
    part_suppliers as (select * from __dbt__cte__stg_tpch_part_suppliers)
select

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(p.part_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(s.supplier_key as varchar), '_dbt_utils_surrogate_key_null_') as varchar)))))
    as part_supplier_key,
    -- p.part_supplier_key,
    p.part_key,
    p.part_name,
    p.part_manufacturer_name,
    p.part_brand_name,
    p.part_type_name,
    p.part_size,
    p.part_container_desc,
    p.retail_price,

    s.supplier_key,
    s.supplier_name,
    s.nation_key,

    ps.supplier_availabe_quantity,
    ps.supplier_cost_amount
from parts p
join part_suppliers ps on p.part_key = ps.part_key
join suppliers s on ps.supplier_key = s.supplier_key
order by p.part_key
    )
[0m21:14:55.686929 [debug] [Thread-1 (]: SQL status: SUCCESS in 8.0 seconds
[0m21:14:55.695151 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_parts_suppliers (execute): 21:14:46.630208 => 21:14:55.694891
[0m21:14:55.695462 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: ROLLBACK
[0m21:14:55.695704 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.int_parts_suppliers: Close
[0m21:14:55.697650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c9da2ec-015d-4d91-95c8-bd2849cd0cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9ca1ac50>]}
[0m21:14:55.698393 [info ] [Thread-1 (]: 4 of 8 OK created sql table model dbt.int_parts_suppliers ...................... [[32mSUCCESS[0m in 9.08s]
[0m21:14:55.698836 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.int_parts_suppliers
[0m21:14:55.699301 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.fct_orders_items
[0m21:14:55.699929 [info ] [Thread-1 (]: 5 of 8 START sql table model dbt.fct_orders_items .............................. [RUN]
[0m21:14:55.700508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.int_parts_suppliers, now model.dbt_trino_iceberg.fct_orders_items)
[0m21:14:55.700788 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.fct_orders_items
[0m21:14:55.711642 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.fct_orders_items"
[0m21:14:55.712378 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (compile): 21:14:55.700954 => 21:14:55.712206
[0m21:14:55.712615 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.fct_orders_items
[0m21:14:55.715881 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."fct_orders_items"
[0m21:14:55.716468 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m21:14:55.716707 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

    drop table if exists "lakehouse"."dbt"."fct_orders_items"
[0m21:14:55.716904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:14:57.442618 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m21:14:57.445492 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.fct_orders_items"
[0m21:14:57.449735 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m21:14:57.450002 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

  
    

    create table "lakehouse"."dbt"."fct_orders_items"
      
      
    as (
      with
     __dbt__cte__stg_tpch_part_suppliers as (

select
    partkey as part_key,
    suppkey as supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from tpch.sf1.partsupp
), orders_items as (select * from "lakehouse"."dbt"."int_order_items"),
    parts_suppliers as (select * from __dbt__cte__stg_tpch_part_suppliers),
    final as (
        select

            o.order_item_key,
            o.order_key,
            o.order_date,
            o.customer_key,
            o.order_status_code,

            o.part_key,
            o.supplier_key,
            o.return_status_code,
            o.order_line_number,
            o.order_line_status_code,
            o.ship_date,
            o.commit_date,
            o.receipt_date,
            o.ship_mode_name,
            ps.supplier_cost_amount,
            
            o.base_price,
            o.discount_percentage,
            o.discounted_price,
            o.tax_rate,

            1 as order_item_count,
            o.quantity,

            o.gross_item_sales_amount,
            o.discounted_item_sales_amount,
            o.item_discount_amount,
            o.item_tax_amount,
            o.net_item_sales_amount

        from orders_items o
        join
            parts_suppliers ps
            on o.part_key = ps.part_key
            and o.supplier_key = ps.supplier_key
    )
select *

from final f
order by f.order_date
    )
[0m21:15:29.570781 [debug] [Thread-1 (]: SQL status: SUCCESS in 32.0 seconds
[0m21:15:29.573424 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (execute): 21:14:55.712733 => 21:15:29.573207
[0m21:15:29.573776 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: ROLLBACK
[0m21:15:29.574007 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: Close
[0m21:15:29.575145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c9da2ec-015d-4d91-95c8-bd2849cd0cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da0d89890>]}
[0m21:15:29.575610 [info ] [Thread-1 (]: 5 of 8 OK created sql table model dbt.fct_orders_items ......................... [[32mSUCCESS[0m in 33.87s]
[0m21:15:29.576106 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.fct_orders_items
[0m21:15:29.576410 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_part_suppliers
[0m21:15:29.576685 [info ] [Thread-1 (]: 6 of 8 START sql table model dbt.dim_part_suppliers ............................ [RUN]
[0m21:15:29.577562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.fct_orders_items, now model.dbt_trino_iceberg.dim_part_suppliers)
[0m21:15:29.577793 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_part_suppliers
[0m21:15:29.588510 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m21:15:29.588999 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (compile): 21:15:29.577915 => 21:15:29.588852
[0m21:15:29.589235 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_part_suppliers
[0m21:15:29.592095 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."dim_part_suppliers"
[0m21:15:29.592568 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m21:15:29.592771 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

    drop table if exists "lakehouse"."dbt"."dim_part_suppliers"
[0m21:15:29.593007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:31.095315 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m21:15:31.096416 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m21:15:31.101451 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m21:15:31.101732 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt"."dim_part_suppliers"
      
      
    as (
      with
     __dbt__cte__stg_tpch_supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from tpch.sf1.supplier
),  __dbt__cte__stg_tpch_part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from tpch.sf1.part
),  __dbt__cte__stg_tpch_nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from tpch.sf1.nation
),  __dbt__cte__stg_tpch_region as (

select regionkey as region_key, name as region_name, comment as region_comment
from tpch.sf1.region
), suppliers as (select * from __dbt__cte__stg_tpch_supplier),
    parts as (select * from __dbt__cte__stg_tpch_part),
    parts_suppliers as (select * from "lakehouse"."dbt"."int_parts_suppliers"),
    nations as (select * from __dbt__cte__stg_tpch_nation),
    regions as (select * from __dbt__cte__stg_tpch_region),
    final as (

        select
            ps.part_supplier_key,

            p.part_key,
            p.part_name,
            p.part_manufacturer_name,
            p.part_brand_name,
            p.part_type_name,
            p.part_size,
            p.part_container_desc,
            p.retail_price,

            s.supplier_key,
            s.supplier_name,
            supplier_address,
            s.supplier_phone_number,
            s.supplier_account_balance,
            n.nation_key as supplier_nation_key,
            n.nation_name as supplier_nation_name,
            r.region_key as supplier_region_key,
            r.region_name as supplier_region_name,

            ps.supplier_availabe_quantity,
            ps.supplier_cost_amount
        from parts p
        join parts_suppliers ps on p.part_key = ps.part_key
        join suppliers s on ps.supplier_key = s.supplier_key
        join nations n on s.nation_key = n.nation_key
        join regions r on n.region_key = r.region_key
    )
select *

from final f
order by f.part_key, f.supplier_key
    )
[0m21:15:43.006358 [debug] [Thread-1 (]: SQL status: SUCCESS in 12.0 seconds
[0m21:15:43.010265 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (execute): 21:15:29.589363 => 21:15:43.010005
[0m21:15:43.010718 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: ROLLBACK
[0m21:15:43.011108 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: Close
[0m21:15:43.013050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c9da2ec-015d-4d91-95c8-bd2849cd0cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9c912ad0>]}
[0m21:15:43.013537 [info ] [Thread-1 (]: 6 of 8 OK created sql table model dbt.dim_part_suppliers ....................... [[32mSUCCESS[0m in 13.44s]
[0m21:15:43.014106 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_part_suppliers
[0m21:15:43.014473 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m21:15:43.014795 [info ] [Thread-1 (]: 7 of 8 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m21:15:43.015694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_part_suppliers, now model.dbt_trino_iceberg.pricing_summary_report)
[0m21:15:43.015928 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m21:15:43.018715 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 21:15:43.016051 => 21:15:43.018566
[0m21:15:43.020660 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var ' highest_ship_date ' not found in config:
  Vars supplied to pricing_summary_report = {
      "dbt_trino_iceberg": {
          "highest_ship_date": "1998-12-01"
      },
      "highest_ship_date": "1998-12-01"
  }
[0m21:15:43.020928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c9da2ec-015d-4d91-95c8-bd2849cd0cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9ca66d50>]}
[0m21:15:43.021260 [error] [Thread-1 (]: 7 of 8 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.01s]
[0m21:15:43.021630 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m21:15:43.021921 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m21:15:43.022177 [info ] [Thread-1 (]: 8 of 8 START sql table model dbt.minimum_cost_suppliers ........................ [RUN]
[0m21:15:43.022630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.pricing_summary_report, now model.dbt_trino_iceberg.minimum_cost_suppliers)
[0m21:15:43.022873 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m21:15:43.024721 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m21:15:43.025396 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (compile): 21:15:43.023005 => 21:15:43.025206
[0m21:15:43.025668 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m21:15:43.028667 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."minimum_cost_suppliers"
[0m21:15:43.029265 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m21:15:43.029562 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.minimum_cost_suppliers"} */

    drop table if exists "lakehouse"."dbt"."minimum_cost_suppliers"
[0m21:15:43.029750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:44.306733 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:15:44.310388 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m21:15:44.313468 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m21:15:44.313719 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.minimum_cost_suppliers"} */

  
    

    create table "lakehouse"."dbt"."minimum_cost_suppliers"
      
      
    as (
      /*
2 Q2 - Minimum Cost Supplier Query
This query finds which supplier should be selected to place an order for a given part in a given region
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 30)
*/
with
    parts_suppliers as (

        select
            s.supplier_account_balance,
            s.supplier_name,
            s.supplier_nation_key,
            s.supplier_region_key,
            s.supplier_nation_name,
            s.supplier_region_name,
            s.part_key,
            s.part_manufacturer_name,
            s.part_size,
            s.part_type_name,
            s.supplier_cost_amount,
            s.supplier_address,
            s.supplier_phone_number,
            rank() over (
                partition by s.supplier_region_key, s.part_key
                order by s.supplier_cost_amount
            ) as supplier_cost_rank,
            row_number() over (
                partition by s.supplier_region_key, s.part_key, s.supplier_cost_amount
                order by s.supplier_account_balance desc
            ) as supplier_rank
        from "lakehouse"."dbt"."dim_part_suppliers" s
    )
select s.*
from parts_suppliers s
where s.supplier_cost_rank = 1 and s.supplier_rank <= 100
order by s.supplier_name, s.part_key
    )
[0m21:15:51.028753 [debug] [Thread-1 (]: SQL status: SUCCESS in 7.0 seconds
[0m21:15:51.032823 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (execute): 21:15:43.025806 => 21:15:51.032612
[0m21:15:51.033190 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: ROLLBACK
[0m21:15:51.033410 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: Close
[0m21:15:51.034841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c9da2ec-015d-4d91-95c8-bd2849cd0cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9ca34cd0>]}
[0m21:15:51.035229 [info ] [Thread-1 (]: 8 of 8 OK created sql table model dbt.minimum_cost_suppliers ................... [[32mSUCCESS[0m in 8.01s]
[0m21:15:51.035607 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m21:15:51.037476 [debug] [MainThread]: On master: COMMIT
[0m21:15:51.037893 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:15:51.038067 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.minimum_cost_suppliers' was properly closed.
[0m21:15:51.038277 [info ] [MainThread]: 
[0m21:15:51.038504 [info ] [MainThread]: Finished running 8 table models in 0 hours 1 minutes and 55.15 seconds (115.15s).
[0m21:15:51.039519 [debug] [MainThread]: Command end result
[0m21:15:51.053000 [info ] [MainThread]: 
[0m21:15:51.053409 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:15:51.053789 [info ] [MainThread]: 
[0m21:15:51.054082 [error] [MainThread]:   Compilation Error in model pricing_summary_report (models/mart/pricing_summary_report.sql)
  Required var ' highest_ship_date ' not found in config:
  Vars supplied to pricing_summary_report = {
      "dbt_trino_iceberg": {
          "highest_ship_date": "1998-12-01"
      },
      "highest_ship_date": "1998-12-01"
  }
[0m21:15:51.054463 [info ] [MainThread]: 
[0m21:15:51.054915 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m21:15:51.055929 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 116.36849, "process_user_time": 3.148403, "process_kernel_time": 0.228974, "process_mem_max_rss": "123224", "process_out_blocks": "3912", "command_success": false, "process_in_blocks": "0"}
[0m21:15:51.056318 [debug] [MainThread]: Command `dbt run` failed at 21:15:51.056233 after 116.37 seconds
[0m21:15:51.056582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9e146950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9e193c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9e1939d0>]}
[0m21:15:51.056808 [debug] [MainThread]: Flushing usage events
[0m21:18:03.337456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f133f6b27d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f133f6b3350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f133f6b3610>]}


============================== 21:18:03.339627 | 8e4233b7-9933-490d-aee6-02f97480d32e ==============================
[0m21:18:03.339627 [info ] [MainThread]: Running with dbt=1.7.3
[0m21:18:03.340090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s /home/vadim/models/mart/pricing_summary_report.sql', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:18:03.469944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e4233b7-9933-490d-aee6-02f97480d32e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f133f48d2d0>]}
[0m21:18:03.526858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e4233b7-9933-490d-aee6-02f97480d32e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f133f4fa7d0>]}
[0m21:18:03.527302 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m21:18:03.534700 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m21:18:03.556058 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:18:03.556568 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/mart/pricing_summary_report.sql
[0m21:18:03.655506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e4233b7-9933-490d-aee6-02f97480d32e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f133f4fa690>]}
[0m21:18:03.666415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e4233b7-9933-490d-aee6-02f97480d32e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f133f2f8090>]}
[0m21:18:03.666775 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 536 macros, 0 groups, 0 semantic models
[0m21:18:03.667081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e4233b7-9933-490d-aee6-02f97480d32e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f133f357b90>]}
[0m21:18:03.667598 [error] [MainThread]: Encountered an error:
Non-relative patterns are unsupported
[0m21:18:03.670002 [error] [MainThread]: Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 75, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 197, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 244, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 284, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/runnable.py", line 454, in run
    self._runtime_initialize()
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/compile.py", line 147, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/runnable.py", line 147, in _runtime_initialize
    self.job_queue = self.get_graph_queue()
                     ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/runnable.py", line 140, in get_graph_queue
    return selector.get_graph_queue(spec)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 318, in get_graph_queue
    selected_nodes = self.get_selected(spec)
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 309, in get_selected
    selected_nodes, indirect_only = self.select_nodes(spec)
                                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 158, in select_nodes
    direct_nodes, indirect_nodes = self.select_nodes_recursively(spec)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in select_nodes_recursively
    bundles = [self.select_nodes_recursively(component) for component in spec]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in <listcomp>
    bundles = [self.select_nodes_recursively(component) for component in spec]
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in select_nodes_recursively
    bundles = [self.select_nodes_recursively(component) for component in spec]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in <listcomp>
    bundles = [self.select_nodes_recursively(component) for component in spec]
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in select_nodes_recursively
    bundles = [self.select_nodes_recursively(component) for component in spec]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in <listcomp>
    bundles = [self.select_nodes_recursively(component) for component in spec]
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 128, in select_nodes_recursively
    direct_nodes, indirect_nodes = self.get_nodes_from_criteria(spec)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 82, in get_nodes_from_criteria
    collected = self.select_included(nodes, spec)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector.py", line 68, in select_included
    return set(method.search(included_nodes, spec.value))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector_methods.py", line 413, in search
    paths = set(p.relative_to(root) for p in root.glob(selector))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/graph/selector_methods.py", line 413, in <genexpr>
    paths = set(p.relative_to(root) for p in root.glob(selector))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/pathlib.py", line 949, in glob
    raise NotImplementedError("Non-relative patterns are unsupported")
NotImplementedError: Non-relative patterns are unsupported

[0m21:18:03.670797 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.35981008, "process_user_time": 1.269155, "process_kernel_time": 0.165541, "process_mem_max_rss": "108960", "process_out_blocks": "2408", "command_success": false, "process_in_blocks": "0"}
[0m21:18:03.671201 [debug] [MainThread]: Command `dbt run` failed at 21:18:03.671114 after 0.36 seconds
[0m21:18:03.671474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f133f5b8b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f133f50ae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1343d2d010>]}
[0m21:18:03.671722 [debug] [MainThread]: Flushing usage events
[0m21:18:20.126959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd09f0f4890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd09f0f41d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd09ef32550>]}


============================== 21:18:20.128746 | 9675dbfa-15e7-4d38-8e93-5f41a1002106 ==============================
[0m21:18:20.128746 [info ] [MainThread]: Running with dbt=1.7.3
[0m21:18:20.129114 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s pricing_summary_report.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:18:20.256105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9675dbfa-15e7-4d38-8e93-5f41a1002106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd09ef25c90>]}
[0m21:18:20.311458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9675dbfa-15e7-4d38-8e93-5f41a1002106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd09ed36510>]}
[0m21:18:20.311979 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m21:18:20.319464 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m21:18:20.336448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:18:20.336775 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:18:20.341642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9675dbfa-15e7-4d38-8e93-5f41a1002106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0a0aa0d10>]}
[0m21:18:20.350392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9675dbfa-15e7-4d38-8e93-5f41a1002106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd09efe7a90>]}
[0m21:18:20.350744 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 536 macros, 0 groups, 0 semantic models
[0m21:18:20.351020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9675dbfa-15e7-4d38-8e93-5f41a1002106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd09edb9450>]}
[0m21:18:20.352306 [info ] [MainThread]: 
[0m21:18:20.353449 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m21:18:20.354732 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m21:18:20.366098 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m21:18:20.366412 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m21:18:20.366606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:22.115916 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m21:18:22.119061 [debug] [ThreadPool]: On list_lakehouse: Close
[0m21:18:22.122824 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m21:18:22.128737 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m21:18:22.129175 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m21:18:22.129370 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:18:23.411921 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m21:18:23.415155 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m21:18:23.415656 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m21:18:23.420131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9675dbfa-15e7-4d38-8e93-5f41a1002106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd09edbafd0>]}
[0m21:18:23.420486 [debug] [MainThread]: On master: COMMIT
[0m21:18:23.420978 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:18:23.421258 [info ] [MainThread]: 
[0m21:18:23.424073 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m21:18:23.424457 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m21:18:23.425094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m21:18:23.425399 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m21:18:23.427778 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m21:18:23.428292 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 21:18:23.425563 => 21:18:23.428112
[0m21:18:23.428539 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.pricing_summary_report
[0m21:18:23.445407 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."pricing_summary_report"
[0m21:18:23.446799 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.pricing_summary_report"
[0m21:18:23.447068 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.pricing_summary_report"} */

    drop table if exists "lakehouse"."dbt"."pricing_summary_report"
[0m21:18:23.447271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:24.504140 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:18:24.514963 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m21:18:24.516845 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.pricing_summary_report"
[0m21:18:24.517107 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.pricing_summary_report"} */

  
    

    create table "lakehouse"."dbt"."pricing_summary_report"
      
      
    as (
      /*
1 Q1 - Pricing Summary Report Query
This query reports the amount of business that was billed, shipped, and returned. 
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 29)
*/
select
    f.return_status_code,
    f.order_line_status_code,
    sum(f.quantity) as quantity,
    sum(f.gross_item_sales_amount) as gross_item_sales_amount,
    sum(f.discounted_item_sales_amount) as discounted_item_sales_amount,
    sum(f.net_item_sales_amount) as net_item_sales_amount,

    avg(f.quantity) as avg_quantity,
    avg(f.base_price) as avg_base_price,
    avg(f.discount_percentage) as avg_discount_percentage,

    sum(f.order_item_count) as order_item_count

from "lakehouse"."dbt"."fct_orders_items" f
where
    f.ship_date
    <= date_add('day', -90, date_parse('1998-12-01', '%Y-%m-%d'))
group by 1, 2
    )
[0m21:18:27.177019 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.0 seconds
[0m21:18:27.190416 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (execute): 21:18:23.428669 => 21:18:27.190269
[0m21:18:27.190681 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: ROLLBACK
[0m21:18:27.190907 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: Close
[0m21:18:27.192067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9675dbfa-15e7-4d38-8e93-5f41a1002106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd09ec52ed0>]}
[0m21:18:27.192468 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt.pricing_summary_report ................... [[32mSUCCESS[0m in 3.77s]
[0m21:18:27.192873 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m21:18:27.194472 [debug] [MainThread]: On master: COMMIT
[0m21:18:27.194872 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:18:27.195044 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m21:18:27.195218 [info ] [MainThread]: 
[0m21:18:27.195429 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.84 seconds (6.84s).
[0m21:18:27.195946 [debug] [MainThread]: Command end result
[0m21:18:27.202416 [info ] [MainThread]: 
[0m21:18:27.202838 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:18:27.203215 [info ] [MainThread]: 
[0m21:18:27.203483 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:18:27.204116 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.103125, "process_user_time": 1.507772, "process_kernel_time": 0.027581, "process_mem_max_rss": "110604", "process_out_blocks": "2440", "process_in_blocks": "0"}
[0m21:18:27.204528 [debug] [MainThread]: Command `dbt run` succeeded at 21:18:27.204445 after 7.10 seconds
[0m21:18:27.204750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd09ef32a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0a371d390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0a37abb50>]}
[0m21:18:27.204960 [debug] [MainThread]: Flushing usage events
[0m21:18:34.471924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9c4b01ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9c4b01650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9c4b03150>]}


============================== 21:18:34.473709 | e9ecae19-8877-4948-b6f0-a35babe1ef6d ==============================
[0m21:18:34.473709 [info ] [MainThread]: Running with dbt=1.7.3
[0m21:18:34.474078 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:18:34.600340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9ecae19-8877-4948-b6f0-a35babe1ef6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9c4899650>]}
[0m21:18:34.656892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9ecae19-8877-4948-b6f0-a35babe1ef6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9c4776490>]}
[0m21:18:34.657346 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m21:18:34.664493 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m21:18:34.682299 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:18:34.682626 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:18:34.687837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9ecae19-8877-4948-b6f0-a35babe1ef6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9c4898490>]}
[0m21:18:34.690259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9ecae19-8877-4948-b6f0-a35babe1ef6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9c4577c90>]}
[0m21:18:34.690576 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 536 macros, 0 groups, 0 semantic models
[0m21:18:34.690846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9ecae19-8877-4948-b6f0-a35babe1ef6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9c4577850>]}
[0m21:18:34.692337 [info ] [MainThread]: 
[0m21:18:34.692983 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m21:18:34.694090 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_dbt'
[0m21:18:34.705917 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m21:18:34.706251 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m21:18:34.706451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:36.419530 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m21:18:36.422327 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m21:18:36.422512 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m21:18:36.425019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9ecae19-8877-4948-b6f0-a35babe1ef6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9c54ff450>]}
[0m21:18:36.425593 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:18:36.425866 [info ] [MainThread]: 
[0m21:18:36.428670 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_customers
[0m21:18:36.429137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.stg_tpch_customers)
[0m21:18:36.429360 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_customers
[0m21:18:36.431629 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_customers"
[0m21:18:36.432052 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_customers (compile): 21:18:36.429480 => 21:18:36.431902
[0m21:18:36.432612 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_customers
[0m21:18:36.432911 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m21:18:36.433349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_customers, now model.dbt_trino_iceberg.stg_tpch_line_item)
[0m21:18:36.433606 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_line_item
[0m21:18:36.435709 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_line_item"
[0m21:18:36.436256 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_line_item (compile): 21:18:36.433753 => 21:18:36.436101
[0m21:18:36.436758 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_line_item
[0m21:18:36.437008 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_nation
[0m21:18:36.437404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_line_item, now model.dbt_trino_iceberg.stg_tpch_nation)
[0m21:18:36.437624 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_nation
[0m21:18:36.439681 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_nation"
[0m21:18:36.440147 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_nation (compile): 21:18:36.437757 => 21:18:36.439991
[0m21:18:36.440664 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_nation
[0m21:18:36.440912 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_orders
[0m21:18:36.441288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_nation, now model.dbt_trino_iceberg.stg_tpch_orders)
[0m21:18:36.441645 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_orders
[0m21:18:36.443913 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_orders"
[0m21:18:36.444626 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_orders (compile): 21:18:36.441852 => 21:18:36.444414
[0m21:18:36.444919 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.stg_tpch_orders
[0m21:18:36.445195 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_orders (execute): 21:18:36.445065 => 21:18:36.445079
[0m21:18:36.445737 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_orders
[0m21:18:36.446002 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part
[0m21:18:36.446524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_orders, now model.dbt_trino_iceberg.stg_tpch_part)
[0m21:18:36.446761 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part
[0m21:18:36.448796 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part"
[0m21:18:36.449191 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part (compile): 21:18:36.446902 => 21:18:36.449051
[0m21:18:36.449744 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part
[0m21:18:36.450000 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m21:18:36.450407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part, now model.dbt_trino_iceberg.stg_tpch_part_suppliers)
[0m21:18:36.450631 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m21:18:36.452569 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_part_suppliers"
[0m21:18:36.452949 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_part_suppliers (compile): 21:18:36.450765 => 21:18:36.452809
[0m21:18:36.453503 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_part_suppliers
[0m21:18:36.453752 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_region
[0m21:18:36.454122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_part_suppliers, now model.dbt_trino_iceberg.stg_tpch_region)
[0m21:18:36.454360 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_region
[0m21:18:36.457099 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_region"
[0m21:18:36.457686 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_region (compile): 21:18:36.454497 => 21:18:36.457518
[0m21:18:36.458364 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_region
[0m21:18:36.458785 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m21:18:36.459424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_region, now model.dbt_trino_iceberg.stg_tpch_supplier)
[0m21:18:36.459708 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.stg_tpch_supplier
[0m21:18:36.461906 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.stg_tpch_supplier"
[0m21:18:36.462591 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.stg_tpch_supplier (compile): 21:18:36.459895 => 21:18:36.462428
[0m21:18:36.463393 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.stg_tpch_supplier
[0m21:18:36.463691 [debug] [Thread-1 (]: Began running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m21:18:36.464120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.stg_tpch_supplier, now snapshot.dbt_trino_iceberg.orders_snapshot)
[0m21:18:36.464370 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_trino_iceberg.orders_snapshot
[0m21:18:36.467026 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (compile): 21:18:36.464518 => 21:18:36.466833
[0m21:18:36.467387 [debug] [Thread-1 (]: Began executing node snapshot.dbt_trino_iceberg.orders_snapshot
[0m21:18:36.467831 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (execute): 21:18:36.467615 => 21:18:36.467625
[0m21:18:36.468696 [debug] [Thread-1 (]: Finished running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m21:18:36.469521 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.int_order_items
[0m21:18:36.470005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_trino_iceberg.orders_snapshot, now model.dbt_trino_iceberg.int_order_items)
[0m21:18:36.470223 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.int_order_items
[0m21:18:36.489374 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.int_order_items"
[0m21:18:36.489990 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_order_items (compile): 21:18:36.470337 => 21:18:36.489803
[0m21:18:36.490238 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.int_order_items
[0m21:18:36.490516 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_order_items (execute): 21:18:36.490399 => 21:18:36.490405
[0m21:18:36.491048 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.int_order_items
[0m21:18:36.491312 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_suppliers
[0m21:18:36.491707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.int_order_items, now model.dbt_trino_iceberg.dim_suppliers)
[0m21:18:36.491931 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_suppliers
[0m21:18:36.497377 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_suppliers"
[0m21:18:36.497847 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (compile): 21:18:36.492066 => 21:18:36.497665
[0m21:18:36.498409 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_suppliers
[0m21:18:36.498723 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (execute): 21:18:36.498595 => 21:18:36.498601
[0m21:18:36.499254 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_suppliers
[0m21:18:36.499542 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.int_parts_suppliers
[0m21:18:36.500006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_suppliers, now model.dbt_trino_iceberg.int_parts_suppliers)
[0m21:18:36.500250 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.int_parts_suppliers
[0m21:18:36.507935 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.int_parts_suppliers"
[0m21:18:36.508579 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_parts_suppliers (compile): 21:18:36.500404 => 21:18:36.508417
[0m21:18:36.508806 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.int_parts_suppliers
[0m21:18:36.509033 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.int_parts_suppliers (execute): 21:18:36.508922 => 21:18:36.508927
[0m21:18:36.509605 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.int_parts_suppliers
[0m21:18:36.509948 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.fct_orders_items
[0m21:18:36.510371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.int_parts_suppliers, now model.dbt_trino_iceberg.fct_orders_items)
[0m21:18:36.510612 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.fct_orders_items
[0m21:18:36.519472 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.fct_orders_items"
[0m21:18:36.519895 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (compile): 21:18:36.510744 => 21:18:36.519757
[0m21:18:36.520130 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.fct_orders_items
[0m21:18:36.520373 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (execute): 21:18:36.520257 => 21:18:36.520262
[0m21:18:36.520954 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.fct_orders_items
[0m21:18:36.521233 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_part_suppliers
[0m21:18:36.521622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.fct_orders_items, now model.dbt_trino_iceberg.dim_part_suppliers)
[0m21:18:36.521844 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_part_suppliers
[0m21:18:36.532073 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m21:18:36.532507 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (compile): 21:18:36.521978 => 21:18:36.532366
[0m21:18:36.532722 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_part_suppliers
[0m21:18:36.532958 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (execute): 21:18:36.532837 => 21:18:36.532844
[0m21:18:36.533526 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_part_suppliers
[0m21:18:36.533789 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m21:18:36.534194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_part_suppliers, now model.dbt_trino_iceberg.pricing_summary_report)
[0m21:18:36.534414 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m21:18:36.536374 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m21:18:36.536755 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 21:18:36.534548 => 21:18:36.536611
[0m21:18:36.537032 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.pricing_summary_report
[0m21:18:36.537297 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (execute): 21:18:36.537177 => 21:18:36.537182
[0m21:18:36.537811 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m21:18:36.538537 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m21:18:36.539490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.pricing_summary_report, now model.dbt_trino_iceberg.minimum_cost_suppliers)
[0m21:18:36.539714 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m21:18:36.541704 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m21:18:36.542090 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (compile): 21:18:36.539833 => 21:18:36.541957
[0m21:18:36.542289 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m21:18:36.542511 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (execute): 21:18:36.542401 => 21:18:36.542405
[0m21:18:36.542987 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m21:18:36.544225 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:18:36.544420 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.minimum_cost_suppliers' was properly closed.
[0m21:18:36.545272 [debug] [MainThread]: Command end result
[0m21:18:36.559774 [debug] [MainThread]: Acquiring new trino connection 'generate_catalog'
[0m21:18:36.560044 [info ] [MainThread]: Building catalog
[0m21:18:36.562209 [debug] [ThreadPool]: Acquiring new trino connection 'lakehouse.information_schema'
[0m21:18:36.587792 [debug] [ThreadPool]: Using trino connection "lakehouse.information_schema"
[0m21:18:36.588496 [debug] [ThreadPool]: On lakehouse.information_schema: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "lakehouse.information_schema"} */

    
        with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        table_type as "table_type",
        null as "table_owner"
    from "lakehouse".INFORMATION_SCHEMA.tables
            where
        table_schema != 'information_schema'
        and
        (
                    (
                        table_schema = 'dbt'
                        and table_name = 'orders_snapshot'
                    )
                 or 
                    (
                        table_schema = 'dbt'
                        and table_name = 'dim_part_suppliers'
                    )
                 or 
                    (
                        table_schema = 'dbt'
                        and table_name = 'fct_orders_items'
                    )
                 or 
                    (
                        table_schema = 'dbt'
                        and table_name = 'dim_suppliers'
                    )
                 or 
                    (
                        table_schema = 'dbt'
                        and table_name = 'int_parts_suppliers'
                    )
                 or 
                    (
                        table_schema = 'dbt'
                        and table_name = 'minimum_cost_suppliers'
                    )
                 or 
                    (
                        table_schema = 'dbt'
                        and table_name = 'stg_tpch_orders'
                    )
                 or 
                    (
                        table_schema = 'dbt'
                        and table_name = 'int_order_items'
                    )
                 or 
                    (
                        table_schema = 'dbt'
                        and table_name = 'pricing_summary_report'
                    )
                )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from "lakehouse".INFORMATION_SCHEMA.columns
            where
        table_schema != 'information_schema'
        and
        (
                    (
                        table_schema = 'dbt'
                        and table_name = 'orders_snapshot'
                    )
                 or 
                    (
                        table_schema = 'dbt'
                        and table_name = 'dim_part_suppliers'
                    )
                 or 
                    (
                        table_schema = 'dbt'
                        and table_name = 'fct_orders_items'
                    )
                 or 
                    (
                        table_schema = 'dbt'
                        and table_name = 'dim_suppliers'
                    )
                 or 
                    (
                        table_schema = 'dbt'
                        and table_name = 'int_parts_suppliers'
                    )
                 or 
                    (
                        table_schema = 'dbt'
                        and table_name = 'minimum_cost_suppliers'
                    )
                 or 
                    (
                        table_schema = 'dbt'
                        and table_name = 'stg_tpch_orders'
                    )
                 or 
                    (
                        table_schema = 'dbt'
                        and table_name = 'int_order_items'
                    )
                 or 
                    (
                        table_schema = 'dbt'
                        and table_name = 'pricing_summary_report'
                    )
                )
        ),
        table_comment as (
            
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'lakehouse'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'dbt'
                    and table_name = 'orders_snapshot'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'lakehouse'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'dbt'
                    and table_name = 'dim_part_suppliers'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'lakehouse'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'dbt'
                    and table_name = 'fct_orders_items'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'lakehouse'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'dbt'
                    and table_name = 'dim_suppliers'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'lakehouse'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'dbt'
                    and table_name = 'int_parts_suppliers'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'lakehouse'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'dbt'
                    and table_name = 'minimum_cost_suppliers'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'lakehouse'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'dbt'
                    and table_name = 'stg_tpch_orders'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'lakehouse'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'dbt'
                    and table_name = 'int_order_items'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'lakehouse'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'dbt'
                    and table_name = 'pricing_summary_report'
                )
            
        )
        select
            table_database,
            table_schema,
            table_name,
            table_type,
            table_owner,
            column_name,
            column_index,
            column_type,
            column_comment,
            table_comment
        from tables
        join columns using ("table_database", "table_schema", "table_name")
        join table_comment using ("table_database", "table_schema", "table_name")
        order by "column_index"
[0m21:18:36.588929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:37.991442 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m21:18:37.999519 [debug] [ThreadPool]: On lakehouse.information_schema: Close
[0m21:18:38.001037 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly lakehouse.information_schema, now tpch.information_schema)
[0m21:18:38.017057 [debug] [ThreadPool]: Using trino connection "tpch.information_schema"
[0m21:18:38.017514 [debug] [ThreadPool]: On tpch.information_schema: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "tpch.information_schema"} */

    
        with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        table_type as "table_type",
        null as "table_owner"
    from tpch.INFORMATION_SCHEMA.tables
            where
        table_schema != 'information_schema'
        and
        (
                    (
                        table_schema = 'sf1'
                        and table_name = 'part'
                    )
                 or 
                    (
                        table_schema = 'sf1'
                        and table_name = 'partsupp'
                    )
                 or 
                    (
                        table_schema = 'sf1'
                        and table_name = 'lineitem'
                    )
                 or 
                    (
                        table_schema = 'sf1'
                        and table_name = 'customer'
                    )
                 or 
                    (
                        table_schema = 'sf1'
                        and table_name = 'region'
                    )
                 or 
                    (
                        table_schema = 'sf1'
                        and table_name = 'supplier'
                    )
                 or 
                    (
                        table_schema = 'sf1'
                        and table_name = 'orders'
                    )
                 or 
                    (
                        table_schema = 'sf1'
                        and table_name = 'nation'
                    )
                )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from tpch.INFORMATION_SCHEMA.columns
            where
        table_schema != 'information_schema'
        and
        (
                    (
                        table_schema = 'sf1'
                        and table_name = 'part'
                    )
                 or 
                    (
                        table_schema = 'sf1'
                        and table_name = 'partsupp'
                    )
                 or 
                    (
                        table_schema = 'sf1'
                        and table_name = 'lineitem'
                    )
                 or 
                    (
                        table_schema = 'sf1'
                        and table_name = 'customer'
                    )
                 or 
                    (
                        table_schema = 'sf1'
                        and table_name = 'region'
                    )
                 or 
                    (
                        table_schema = 'sf1'
                        and table_name = 'supplier'
                    )
                 or 
                    (
                        table_schema = 'sf1'
                        and table_name = 'orders'
                    )
                 or 
                    (
                        table_schema = 'sf1'
                        and table_name = 'nation'
                    )
                )
        ),
        table_comment as (
            
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'tpch'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'sf1'
                    and table_name = 'part'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'tpch'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'sf1'
                    and table_name = 'partsupp'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'tpch'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'sf1'
                    and table_name = 'lineitem'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'tpch'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'sf1'
                    and table_name = 'customer'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'tpch'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'sf1'
                    and table_name = 'region'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'tpch'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'sf1'
                    and table_name = 'supplier'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'tpch'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'sf1'
                    and table_name = 'orders'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'tpch'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'sf1'
                    and table_name = 'nation'
                )
            
        )
        select
            table_database,
            table_schema,
            table_name,
            table_type,
            table_owner,
            column_name,
            column_index,
            column_type,
            column_comment,
            table_comment
        from tables
        join columns using ("table_database", "table_schema", "table_name")
        join table_comment using ("table_database", "table_schema", "table_name")
        order by "column_index"
[0m21:18:38.017898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:18:39.401143 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m21:18:39.408243 [debug] [ThreadPool]: On tpch.information_schema: Close
[0m21:18:39.422042 [info ] [MainThread]: Catalog written to /home/vadim/dbt_trino_iceberg/target/catalog.json
[0m21:18:39.423048 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 4.9774604, "process_user_time": 1.508719, "process_kernel_time": 0.111756, "process_mem_max_rss": "112696", "process_in_blocks": "2944", "process_out_blocks": "5712"}
[0m21:18:39.423486 [debug] [MainThread]: Command `dbt docs generate` succeeded at 21:18:39.423382 after 4.98 seconds
[0m21:18:39.423759 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m21:18:39.423961 [debug] [MainThread]: Connection 'tpch.information_schema' was properly closed.
[0m21:18:39.424146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9c4b0ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9c4959510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9c47c8210>]}
[0m21:18:39.424374 [debug] [MainThread]: Flushing usage events
[0m21:18:51.757286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0eacc5f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0eae7b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0eae7aed0>]}


============================== 21:18:51.759108 | 411aa274-cd22-4df7-bbc9-27bd492c3655 ==============================
[0m21:18:51.759108 [info ] [MainThread]: Running with dbt=1.7.3
[0m21:18:51.759480 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:18:51.883672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '411aa274-cd22-4df7-bbc9-27bd492c3655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0eae74610>]}
[0m21:18:51.940846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '411aa274-cd22-4df7-bbc9-27bd492c3655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0eaacb090>]}
[0m21:21:34.698631 [error] [MainThread]: Encountered an error:

[0m21:21:34.703659 [error] [MainThread]: Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 75, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 197, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 244, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m21:21:34.706056 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 162.97473, "process_user_time": 1.220273, "process_kernel_time": 0.266074, "process_mem_max_rss": "102860", "process_in_blocks": "16", "process_out_blocks": "2952", "command_success": false}
[0m21:21:34.706993 [debug] [MainThread]: Command `dbt docs serve` failed at 21:21:34.706845 after 162.98 seconds
[0m21:21:34.707495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0eacc6b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0eacc6a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0eacc6810>]}
[0m21:21:34.708021 [debug] [MainThread]: Flushing usage events
[0m18:23:00.042337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5512be590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5512dbb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5518a35d0>]}


============================== 18:23:00.047258 | 960703d6-34dc-4b1b-af0e-84d70f4aca4d ==============================
[0m18:23:00.047258 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:23:00.047659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:23:00.047972 [info ] [MainThread]: dbt version: 1.7.4
[0m18:23:00.048208 [info ] [MainThread]: python version: 3.11.6
[0m18:23:00.048453 [info ] [MainThread]: python path: /usr/sbin/python
[0m18:23:00.048695 [info ] [MainThread]: os info: Linux-5.15.133.1-microsoft-standard-WSL2-x86_64-with-glibc2.38
[0m18:23:00.137713 [info ] [MainThread]: Using profiles dir at /home/vadim/.dbt
[0m18:23:00.138160 [info ] [MainThread]: Using profiles.yml file at /home/vadim/.dbt/profiles.yml
[0m18:23:00.138412 [info ] [MainThread]: Using dbt_project.yml file at /home/vadim/dbt_trino_iceberg/dbt_project.yml
[0m18:23:00.138705 [info ] [MainThread]: adapter type: trino
[0m18:23:00.139068 [info ] [MainThread]: adapter version: 1.7.1
[0m18:23:00.187005 [info ] [MainThread]: Configuration:
[0m18:23:00.187472 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:23:00.187762 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:23:00.188031 [info ] [MainThread]: Required dependencies:
[0m18:23:00.188267 [debug] [MainThread]: Executing "git --help"
[0m18:23:00.207388 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:23:00.207837 [debug] [MainThread]: STDERR: "b''"
[0m18:23:00.208097 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:23:00.208368 [info ] [MainThread]: Connection:
[0m18:23:00.208596 [info ] [MainThread]:   host: 34.38.30.160
[0m18:23:00.208809 [info ] [MainThread]:   port: 8443
[0m18:23:00.208998 [info ] [MainThread]:   user: admin
[0m18:23:00.209204 [info ] [MainThread]:   database: lakehouse
[0m18:23:00.209393 [info ] [MainThread]:   schema: dbt
[0m18:23:00.209602 [info ] [MainThread]:   cert: None
[0m18:23:00.209840 [info ] [MainThread]:   prepared_statements_enabled: True
[0m18:23:00.210136 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m18:23:00.210801 [debug] [MainThread]: Acquiring new trino connection 'debug'
[0m18:23:00.213752 [debug] [MainThread]: Using trino connection "debug"
[0m18:23:00.213965 [debug] [MainThread]: On debug: select 1 as id
[0m18:23:00.214122 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:23:02.463327 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m18:23:02.464017 [debug] [MainThread]: On debug: Close
[0m18:23:02.465063 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:23:02.465343 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:23:02.474328 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.4624763, "process_user_time": 1.343694, "process_kernel_time": 0.177841, "process_mem_max_rss": "102208", "process_in_blocks": "110040", "process_out_blocks": "16"}
[0m18:23:02.474757 [debug] [MainThread]: Command `dbt debug` succeeded at 18:23:02.474679 after 2.46 seconds
[0m18:23:02.474947 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:23:02.475137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5514af710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe551303850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe555b19290>]}
[0m18:23:02.475355 [debug] [MainThread]: Flushing usage events
[0m19:17:45.344226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff73ac040d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff73ac067d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff73abeca50>]}


============================== 19:17:45.347197 | f42664df-6cf8-414e-8f31-e205fee36b97 ==============================
[0m19:17:45.347197 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:17:45.347614 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:17:45.518652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f42664df-6cf8-414e-8f31-e205fee36b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff73aa31e50>]}
[0m19:17:45.582802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f42664df-6cf8-414e-8f31-e205fee36b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff73ab1c290>]}
[0m19:17:45.583256 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m19:17:45.594974 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:17:45.606434 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:17:45.606809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f42664df-6cf8-414e-8f31-e205fee36b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff73aa33210>]}
[0m19:17:46.575375 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_trino_iceberg.silver_order_items' (models/silver/silver_order_items.sql) depends on a node named 'bronze_tpch_line__item' which was not found
[0m19:17:46.576487 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2620186, "process_user_time": 2.343239, "process_kernel_time": 0.295211, "process_mem_max_rss": "109264", "process_in_blocks": "3840", "process_out_blocks": "16", "command_success": false}
[0m19:17:46.576910 [debug] [MainThread]: Command `dbt run` failed at 19:17:46.576819 after 1.26 seconds
[0m19:17:46.577189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff73af72c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff73a58fa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff73a9eb7d0>]}
[0m19:17:46.577441 [debug] [MainThread]: Flushing usage events
[0m19:18:42.662573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad95964b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad964d0a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad959670d0>]}


============================== 19:18:42.664562 | a716b082-b70f-4b08-99a9-341f59e0786b ==============================
[0m19:18:42.664562 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:18:42.664928 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:18:42.799102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a716b082-b70f-4b08-99a9-341f59e0786b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad957f28d0>]}
[0m19:18:42.859772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a716b082-b70f-4b08-99a9-341f59e0786b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad9571c790>]}
[0m19:18:42.860223 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m19:18:42.867173 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:18:42.875672 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:18:42.876094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a716b082-b70f-4b08-99a9-341f59e0786b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad95880c90>]}
[0m19:18:43.741502 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_trino_iceberg.dim_part_suppliers' (models/gold/dim_part_suppliers.sql) depends on a node named 'siver_parts_suppliers' which was not found
[0m19:18:43.742395 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1062468, "process_user_time": 2.113741, "process_kernel_time": 0.091901, "process_mem_max_rss": "109400", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m19:18:43.742820 [debug] [MainThread]: Command `dbt run` failed at 19:18:43.742718 after 1.11 seconds
[0m19:18:43.743077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad95967fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad9596f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad958a7e10>]}
[0m19:18:43.743321 [debug] [MainThread]: Flushing usage events
[0m19:19:35.809900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c44250950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c440afc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c440afcd0>]}


============================== 19:19:35.811722 | 030b6f77-8a3e-42a2-a19a-010ab2f5d433 ==============================
[0m19:19:35.811722 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:19:35.812107 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:19:35.943823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '030b6f77-8a3e-42a2-a19a-010ab2f5d433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c440e4850>]}
[0m19:19:35.997981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '030b6f77-8a3e-42a2-a19a-010ab2f5d433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c4416cb10>]}
[0m19:19:35.998448 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m19:19:36.005450 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:19:36.013236 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:19:36.013617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '030b6f77-8a3e-42a2-a19a-010ab2f5d433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c43d030d0>]}
[0m19:19:36.904108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '030b6f77-8a3e-42a2-a19a-010ab2f5d433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c44163dd0>]}
[0m19:19:36.915888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '030b6f77-8a3e-42a2-a19a-010ab2f5d433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c428b87d0>]}
[0m19:19:36.916274 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 537 macros, 0 groups, 0 semantic models
[0m19:19:36.916640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '030b6f77-8a3e-42a2-a19a-010ab2f5d433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c43deba10>]}
[0m19:19:36.918258 [info ] [MainThread]: 
[0m19:19:36.919049 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m19:19:36.920515 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m19:19:36.933926 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m19:19:36.934301 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m19:19:36.934480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:38.729054 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m19:19:38.731874 [debug] [ThreadPool]: On list_lakehouse: Close
[0m19:19:38.736553 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m19:19:38.743575 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m19:19:38.743811 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m19:19:38.743996 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:19:40.652317 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m19:19:40.655167 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m19:19:40.655416 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m19:19:40.657969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '030b6f77-8a3e-42a2-a19a-010ab2f5d433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c43c9b590>]}
[0m19:19:40.658274 [debug] [MainThread]: On master: COMMIT
[0m19:19:40.658705 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:19:40.658965 [info ] [MainThread]: 
[0m19:19:40.671440 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.bronze_tpch__customers
[0m19:19:40.672234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.bronze_tpch__customers)
[0m19:19:40.672681 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.bronze_tpch__customers
[0m19:19:40.675606 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.bronze_tpch__customers"
[0m19:19:40.678503 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.bronze_tpch__customers (compile): 19:19:40.672890 => 19:19:40.678313
[0m19:19:40.679116 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.bronze_tpch__customers
[0m19:19:40.679404 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.bronze_tpch__line_item
[0m19:19:40.679852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.bronze_tpch__customers, now model.dbt_trino_iceberg.bronze_tpch__line_item)
[0m19:19:40.680084 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.bronze_tpch__line_item
[0m19:19:40.682160 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.bronze_tpch__line_item"
[0m19:19:40.682746 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.bronze_tpch__line_item (compile): 19:19:40.680224 => 19:19:40.682589
[0m19:19:40.683356 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.bronze_tpch__line_item
[0m19:19:40.683613 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.bronze_tpch__nation
[0m19:19:40.684023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.bronze_tpch__line_item, now model.dbt_trino_iceberg.bronze_tpch__nation)
[0m19:19:40.684247 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.bronze_tpch__nation
[0m19:19:40.686136 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.bronze_tpch__nation"
[0m19:19:40.686526 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.bronze_tpch__nation (compile): 19:19:40.684385 => 19:19:40.686392
[0m19:19:40.687052 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.bronze_tpch__nation
[0m19:19:40.687330 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.bronze_tpch__orders
[0m19:19:40.687598 [info ] [Thread-1 (]: 1 of 8 START sql table model dbt.bronze_tpch__orders ........................... [RUN]
[0m19:19:40.688120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.bronze_tpch__nation, now model.dbt_trino_iceberg.bronze_tpch__orders)
[0m19:19:40.688491 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.bronze_tpch__orders
[0m19:19:40.690961 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.bronze_tpch__orders"
[0m19:19:40.691632 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.bronze_tpch__orders (compile): 19:19:40.688641 => 19:19:40.691453
[0m19:19:40.691858 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.bronze_tpch__orders
[0m19:19:40.713039 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.bronze_tpch__orders"
[0m19:19:40.716351 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.bronze_tpch__orders"
[0m19:19:40.716625 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.bronze_tpch__orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.bronze_tpch__orders"} */

  
    

    create table "lakehouse"."dbt"."bronze_tpch__orders"
      
      
    as (
      
select
    orderkey as order_key,
    custkey as customer_key,
    orderstatus as order_status_code,
    totalprice as order_amount,
    orderdate as order_date,
    orderpriority as order_priority_code,
    clerk as order_clerk_name,
    shippriority as shipping_priority,
    comment as order_comment
from tpch.sf1.orders
    )
[0m19:19:40.716837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:20:05.304653 [debug] [Thread-1 (]: SQL status: SUCCESS in 25.0 seconds
[0m19:20:05.317503 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.bronze_tpch__orders (execute): 19:19:40.691977 => 19:20:05.317337
[0m19:20:05.317791 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.bronze_tpch__orders: ROLLBACK
[0m19:20:05.318000 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.bronze_tpch__orders: Close
[0m19:20:05.319580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '030b6f77-8a3e-42a2-a19a-010ab2f5d433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c42926190>]}
[0m19:20:05.320072 [info ] [Thread-1 (]: 1 of 8 OK created sql table model dbt.bronze_tpch__orders ...................... [[32mSUCCESS[0m in 24.63s]
[0m19:20:05.320475 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.bronze_tpch__orders
[0m19:20:05.320794 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.bronze_tpch__part
[0m19:20:05.321264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.bronze_tpch__orders, now model.dbt_trino_iceberg.bronze_tpch__part)
[0m19:20:05.321504 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.bronze_tpch__part
[0m19:20:05.323711 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.bronze_tpch__part"
[0m19:20:05.324550 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.bronze_tpch__part (compile): 19:20:05.321647 => 19:20:05.324389
[0m19:20:05.325105 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.bronze_tpch__part
[0m19:20:05.325366 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.bronze_tpch__part_suppliers
[0m19:20:05.325760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.bronze_tpch__part, now model.dbt_trino_iceberg.bronze_tpch__part_suppliers)
[0m19:20:05.325985 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.bronze_tpch__part_suppliers
[0m19:20:05.328170 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.bronze_tpch__part_suppliers"
[0m19:20:05.328687 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.bronze_tpch__part_suppliers (compile): 19:20:05.326119 => 19:20:05.328544
[0m19:20:05.329242 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.bronze_tpch__part_suppliers
[0m19:20:05.329562 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.bronze_tpch__region
[0m19:20:05.329955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.bronze_tpch__part_suppliers, now model.dbt_trino_iceberg.bronze_tpch__region)
[0m19:20:05.330176 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.bronze_tpch__region
[0m19:20:05.332418 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.bronze_tpch__region"
[0m19:20:05.333018 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.bronze_tpch__region (compile): 19:20:05.330311 => 19:20:05.332865
[0m19:20:05.333552 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.bronze_tpch__region
[0m19:20:05.333811 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.bronze_tpch__supplier
[0m19:20:05.334205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.bronze_tpch__region, now model.dbt_trino_iceberg.bronze_tpch__supplier)
[0m19:20:05.334425 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.bronze_tpch__supplier
[0m19:20:05.337620 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.bronze_tpch__supplier"
[0m19:20:05.338129 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.bronze_tpch__supplier (compile): 19:20:05.334557 => 19:20:05.337978
[0m19:20:05.338633 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.bronze_tpch__supplier
[0m19:20:05.338884 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.silver_order_items
[0m19:20:05.339187 [info ] [Thread-1 (]: 2 of 8 START sql table model dbt.silver_order_items ............................ [RUN]
[0m19:20:05.339781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.bronze_tpch__supplier, now model.dbt_trino_iceberg.silver_order_items)
[0m19:20:05.340027 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.silver_order_items
[0m19:20:05.352858 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.silver_order_items"
[0m19:20:05.361196 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.silver_order_items (compile): 19:20:05.340176 => 19:20:05.360913
[0m19:20:05.361503 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.silver_order_items
[0m19:20:05.364068 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.silver_order_items"
[0m19:20:05.368323 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.silver_order_items"
[0m19:20:05.368687 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.silver_order_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.silver_order_items"} */

  
    

    create table "lakehouse"."dbt"."silver_order_items"
      
      
    as (
      with
     __dbt__cte__bronze_tpch__line_item as (

select
    orderkey as order_key,
    partkey as part_key,
    suppkey as supplier_key,
    linenumber as order_line_number,
    quantity as quantity,
    extendedprice as extended_price,
    discount as discount_percentage,
    tax as tax_rate,
    returnflag as return_status_code,
    linestatus as order_line_status_code,
    shipdate as ship_date,
    commitdate as commit_date,
    receiptdate as receipt_date,
    shipinstruct as ship_instructions_desc,
    shipmode as ship_mode_name,
    comment as order_line_comment
from tpch.sf1.lineitem
), orders as (select * from "lakehouse"."dbt"."bronze_tpch__orders"),
    line_items as (select * from __dbt__cte__bronze_tpch__line_item)
select

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(o.order_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l.order_line_number as varchar), '_dbt_utils_surrogate_key_null_') as varchar)))))
    as order_item_key,

    o.order_key,
    o.order_date,
    o.customer_key,
    o.order_status_code,

    l.part_key,
    l.supplier_key,
    l.return_status_code,
    l.order_line_number,
    l.order_line_status_code,
    l.ship_date,
    l.commit_date,
    l.receipt_date,
    l.ship_mode_name,

    l.quantity,

    -- extended_price is actually the line item total,
    -- so we back out the extended price per item
    (l.extended_price / nullif(l.quantity, 0)) as base_price,
    l.discount_percentage,
    (
        (l.extended_price / nullif(l.quantity, 0)) * (1 - l.discount_percentage)
    ) as discounted_price,

    l.extended_price as gross_item_sales_amount,
    (l.extended_price * (1 - l.discount_percentage)) as discounted_item_sales_amount,
    -- We model discounts as negative amounts
    (-1 * l.extended_price * l.discount_percentage) as item_discount_amount,
    l.tax_rate,
    (
        (l.extended_price + (-1 * l.extended_price * l.discount_percentage))
        * l.tax_rate
    ) as item_tax_amount,
    (
        l.extended_price
        + (-1 * l.extended_price * l.discount_percentage)
        + (
            (l.extended_price + (-1 * l.extended_price * l.discount_percentage))
            * l.tax_rate
        )
    ) as net_item_sales_amount

from orders o
join line_items l on o.order_key = l.order_key
order by o.order_date
    )
[0m19:20:05.368940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:20:49.304252 [debug] [Thread-1 (]: SQL status: SUCCESS in 44.0 seconds
[0m19:20:49.307532 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.silver_order_items (execute): 19:20:05.361631 => 19:20:49.307364
[0m19:20:49.307758 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.silver_order_items: ROLLBACK
[0m19:20:49.307984 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.silver_order_items: Close
[0m19:20:49.309212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '030b6f77-8a3e-42a2-a19a-010ab2f5d433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c42980950>]}
[0m19:20:49.309658 [info ] [Thread-1 (]: 2 of 8 OK created sql table model dbt.silver_order_items ....................... [[32mSUCCESS[0m in 43.97s]
[0m19:20:49.310054 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.silver_order_items
[0m19:20:49.310377 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_suppliers
[0m19:20:49.310735 [info ] [Thread-1 (]: 3 of 8 START sql table model dbt.dim_suppliers ................................. [RUN]
[0m19:20:49.311531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.silver_order_items, now model.dbt_trino_iceberg.dim_suppliers)
[0m19:20:49.311788 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_suppliers
[0m19:20:49.317267 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_suppliers"
[0m19:20:49.317942 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (compile): 19:20:49.311951 => 19:20:49.317798
[0m19:20:49.318147 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_suppliers
[0m19:20:49.324686 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."dim_suppliers"
[0m19:20:49.326282 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m19:20:49.326554 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

    drop table if exists "lakehouse"."dbt"."dim_suppliers"
[0m19:20:49.326756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:20:50.952443 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m19:20:50.956087 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_suppliers"
[0m19:20:50.958903 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_suppliers"
[0m19:20:50.959151 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_suppliers"} */

  
    

    create table "lakehouse"."dbt"."dim_suppliers"
      
      
    as (
      with
     __dbt__cte__bronze_tpch__supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from tpch.sf1.supplier
),  __dbt__cte__bronze_tpch__nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from tpch.sf1.nation
),  __dbt__cte__bronze_tpch__region as (

select regionkey as region_key, name as region_name, comment as region_comment
from tpch.sf1.region
), suppliers as (select * from __dbt__cte__bronze_tpch__supplier),
    nations as (select * from __dbt__cte__bronze_tpch__nation),
    regions as (select * from __dbt__cte__bronze_tpch__region)
select
    s.supplier_key,
    s.supplier_name,
    s.supplier_address,
    n.nation_key as supplier_nation_key,
    n.nation_name as supplier_nation_name,
    r.region_key as supplier_region_key,
    r.region_name as supplier_region_name,
    s.supplier_phone_number,
    s.supplier_account_balance
from suppliers s
join nations n on s.nation_key = n.nation_key
join regions r on n.region_key = r.region_key
order by s.supplier_key
    )
[0m19:20:52.849789 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m19:20:52.854910 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_suppliers (execute): 19:20:49.318266 => 19:20:52.854773
[0m19:20:52.855188 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: ROLLBACK
[0m19:20:52.855396 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_suppliers: Close
[0m19:20:52.856490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '030b6f77-8a3e-42a2-a19a-010ab2f5d433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c46e346d0>]}
[0m19:20:52.856850 [info ] [Thread-1 (]: 3 of 8 OK created sql table model dbt.dim_suppliers ............................ [[32mSUCCESS[0m in 3.55s]
[0m19:20:52.857301 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_suppliers
[0m19:20:52.857633 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.silver_parts_suppliers
[0m19:20:52.857948 [info ] [Thread-1 (]: 4 of 8 START sql table model dbt.silver_parts_suppliers ........................ [RUN]
[0m19:20:52.858642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_suppliers, now model.dbt_trino_iceberg.silver_parts_suppliers)
[0m19:20:52.858874 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.silver_parts_suppliers
[0m19:20:52.867377 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.silver_parts_suppliers"
[0m19:20:52.867833 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.silver_parts_suppliers (compile): 19:20:52.859000 => 19:20:52.867688
[0m19:20:52.868043 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.silver_parts_suppliers
[0m19:20:52.871041 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.silver_parts_suppliers"
[0m19:20:52.874209 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.silver_parts_suppliers"
[0m19:20:52.874502 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.silver_parts_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.silver_parts_suppliers"} */

  
    

    create table "lakehouse"."dbt"."silver_parts_suppliers"
      
      
    as (
      with
     __dbt__cte__bronze_tpch__part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from tpch.sf1.part
),  __dbt__cte__bronze_tpch__supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from tpch.sf1.supplier
),  __dbt__cte__bronze_tpch__part_suppliers as (

select
    partkey as part_key,
    suppkey as supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from tpch.sf1.partsupp
), parts as (select * from __dbt__cte__bronze_tpch__part),
    suppliers as (select * from __dbt__cte__bronze_tpch__supplier),
    part_suppliers as (select * from __dbt__cte__bronze_tpch__part_suppliers)
select

    lower(to_hex(md5(to_utf8(cast(coalesce(cast(p.part_key as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(s.supplier_key as varchar), '_dbt_utils_surrogate_key_null_') as varchar)))))
    as part_supplier_key,
    -- p.part_supplier_key,
    p.part_key,
    p.part_name,
    p.part_manufacturer_name,
    p.part_brand_name,
    p.part_type_name,
    p.part_size,
    p.part_container_desc,
    p.retail_price,

    s.supplier_key,
    s.supplier_name,
    s.nation_key,

    ps.supplier_availabe_quantity,
    ps.supplier_cost_amount
from parts p
join part_suppliers ps on p.part_key = ps.part_key
join suppliers s on ps.supplier_key = s.supplier_key
order by p.part_key
    )
[0m19:20:52.874757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:21:02.298433 [debug] [Thread-1 (]: SQL status: SUCCESS in 9.0 seconds
[0m19:21:02.301384 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.silver_parts_suppliers (execute): 19:20:52.868160 => 19:21:02.301196
[0m19:21:02.301700 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.silver_parts_suppliers: ROLLBACK
[0m19:21:02.301980 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.silver_parts_suppliers: Close
[0m19:21:02.303198 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '030b6f77-8a3e-42a2-a19a-010ab2f5d433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c42721290>]}
[0m19:21:02.303565 [info ] [Thread-1 (]: 4 of 8 OK created sql table model dbt.silver_parts_suppliers ................... [[32mSUCCESS[0m in 9.44s]
[0m19:21:02.303953 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.silver_parts_suppliers
[0m19:21:02.304299 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.fct_orders_items
[0m19:21:02.304568 [info ] [Thread-1 (]: 5 of 8 START sql table model dbt.fct_orders_items .............................. [RUN]
[0m19:21:02.305102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.silver_parts_suppliers, now model.dbt_trino_iceberg.fct_orders_items)
[0m19:21:02.305337 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.fct_orders_items
[0m19:21:02.314406 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.fct_orders_items"
[0m19:21:02.314831 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (compile): 19:21:02.305474 => 19:21:02.314693
[0m19:21:02.315033 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.fct_orders_items
[0m19:21:02.317976 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."fct_orders_items"
[0m19:21:02.318447 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m19:21:02.318657 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

    drop table if exists "lakehouse"."dbt"."fct_orders_items"
[0m19:21:02.318839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:21:04.111456 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m19:21:04.114243 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.fct_orders_items"
[0m19:21:04.118783 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.fct_orders_items"
[0m19:21:04.119072 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.fct_orders_items"} */

  
    

    create table "lakehouse"."dbt"."fct_orders_items"
      
      
    as (
      with
     __dbt__cte__bronze_tpch__part_suppliers as (

select
    partkey as part_key,
    suppkey as supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from tpch.sf1.partsupp
), orders_items as (select * from "lakehouse"."dbt"."silver_order_items"),
    parts_suppliers as (select * from __dbt__cte__bronze_tpch__part_suppliers),
    final as (
        select

            o.order_item_key,
            o.order_key,
            o.order_date,
            o.customer_key,
            o.order_status_code,

            o.part_key,
            o.supplier_key,
            o.return_status_code,
            o.order_line_number,
            o.order_line_status_code,
            o.ship_date,
            o.commit_date,
            o.receipt_date,
            o.ship_mode_name,
            ps.supplier_cost_amount,
            
            o.base_price,
            o.discount_percentage,
            o.discounted_price,
            o.tax_rate,

            1 as order_item_count,
            o.quantity,

            o.gross_item_sales_amount,
            o.discounted_item_sales_amount,
            o.item_discount_amount,
            o.item_tax_amount,
            o.net_item_sales_amount

        from orders_items o
        join
            parts_suppliers ps
            on o.part_key = ps.part_key
            and o.supplier_key = ps.supplier_key
    )
select *

from final f
order by f.order_date
    )
[0m19:21:43.536710 [debug] [Thread-1 (]: SQL status: SUCCESS in 39.0 seconds
[0m19:21:43.540402 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.fct_orders_items (execute): 19:21:02.315148 => 19:21:43.540262
[0m19:21:43.540622 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: ROLLBACK
[0m19:21:43.540813 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.fct_orders_items: Close
[0m19:21:43.542016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '030b6f77-8a3e-42a2-a19a-010ab2f5d433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c42705d90>]}
[0m19:21:43.542503 [info ] [Thread-1 (]: 5 of 8 OK created sql table model dbt.fct_orders_items ......................... [[32mSUCCESS[0m in 41.24s]
[0m19:21:43.542976 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.fct_orders_items
[0m19:21:43.543312 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.dim_part_suppliers
[0m19:21:43.544027 [info ] [Thread-1 (]: 6 of 8 START sql table model dbt.dim_part_suppliers ............................ [RUN]
[0m19:21:43.544588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.fct_orders_items, now model.dbt_trino_iceberg.dim_part_suppliers)
[0m19:21:43.544825 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.dim_part_suppliers
[0m19:21:43.554175 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m19:21:43.554631 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (compile): 19:21:43.544968 => 19:21:43.554491
[0m19:21:43.554835 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.dim_part_suppliers
[0m19:21:43.558673 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."dim_part_suppliers"
[0m19:21:43.559274 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m19:21:43.559533 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

    drop table if exists "lakehouse"."dbt"."dim_part_suppliers"
[0m19:21:43.559833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:21:45.098143 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m19:21:45.101283 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.dim_part_suppliers"
[0m19:21:45.106276 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.dim_part_suppliers"
[0m19:21:45.106560 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt"."dim_part_suppliers"
      
      
    as (
      with
     __dbt__cte__bronze_tpch__supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from tpch.sf1.supplier
),  __dbt__cte__bronze_tpch__part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from tpch.sf1.part
),  __dbt__cte__bronze_tpch__nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from tpch.sf1.nation
),  __dbt__cte__bronze_tpch__region as (

select regionkey as region_key, name as region_name, comment as region_comment
from tpch.sf1.region
), suppliers as (select * from __dbt__cte__bronze_tpch__supplier),
    parts as (select * from __dbt__cte__bronze_tpch__part),
    parts_suppliers as (select * from "lakehouse"."dbt"."silver_parts_suppliers"),
    nations as (select * from __dbt__cte__bronze_tpch__nation),
    regions as (select * from __dbt__cte__bronze_tpch__region),
    final as (

        select
            ps.part_supplier_key,

            p.part_key,
            p.part_name,
            p.part_manufacturer_name,
            p.part_brand_name,
            p.part_type_name,
            p.part_size,
            p.part_container_desc,
            p.retail_price,

            s.supplier_key,
            s.supplier_name,
            supplier_address,
            s.supplier_phone_number,
            s.supplier_account_balance,
            n.nation_key as supplier_nation_key,
            n.nation_name as supplier_nation_name,
            r.region_key as supplier_region_key,
            r.region_name as supplier_region_name,

            ps.supplier_availabe_quantity,
            ps.supplier_cost_amount
        from parts p
        join parts_suppliers ps on p.part_key = ps.part_key
        join suppliers s on ps.supplier_key = s.supplier_key
        join nations n on s.nation_key = n.nation_key
        join regions r on n.region_key = r.region_key
    )
select *

from final f
order by f.part_key, f.supplier_key
    )
[0m19:21:56.886615 [debug] [Thread-1 (]: SQL status: SUCCESS in 12.0 seconds
[0m19:21:56.888669 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.dim_part_suppliers (execute): 19:21:43.554950 => 19:21:56.888511
[0m19:21:56.888970 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: ROLLBACK
[0m19:21:56.889205 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.dim_part_suppliers: Close
[0m19:21:56.890877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '030b6f77-8a3e-42a2-a19a-010ab2f5d433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c4297ed50>]}
[0m19:21:56.891370 [info ] [Thread-1 (]: 6 of 8 OK created sql table model dbt.dim_part_suppliers ....................... [[32mSUCCESS[0m in 13.35s]
[0m19:21:56.891985 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.dim_part_suppliers
[0m19:21:56.892338 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m19:21:56.892690 [info ] [Thread-1 (]: 7 of 8 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m19:21:56.893680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.dim_part_suppliers, now model.dbt_trino_iceberg.pricing_summary_report)
[0m19:21:56.894011 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m19:21:56.899075 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 19:21:56.894191 => 19:21:56.898817
[0m19:21:56.910361 [debug] [Thread-1 (]: Compilation Error in model pricing_summary_report (models/gold/pricing_summary_report.sql)
  Required var ' highest_ship_date ' not found in config:
  Vars supplied to pricing_summary_report = {
      "dbt_trino_iceberg": {
          "highest_ship_date": "1998-12-01"
      },
      "highest_ship_date": "1998-12-01"
  }
[0m19:21:56.910798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '030b6f77-8a3e-42a2-a19a-010ab2f5d433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c426c3890>]}
[0m19:21:56.911256 [error] [Thread-1 (]: 7 of 8 ERROR creating sql table model dbt.pricing_summary_report ............... [[31mERROR[0m in 0.02s]
[0m19:21:56.911769 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m19:21:56.912129 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m19:21:56.912814 [info ] [Thread-1 (]: 8 of 8 START sql table model dbt.minimum_cost_suppliers ........................ [RUN]
[0m19:21:56.913786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.pricing_summary_report, now model.dbt_trino_iceberg.minimum_cost_suppliers)
[0m19:21:56.914137 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m19:21:56.918302 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m19:21:56.919186 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (compile): 19:21:56.914351 => 19:21:56.918836
[0m19:21:56.919551 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m19:21:56.923485 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."minimum_cost_suppliers"
[0m19:21:56.924204 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m19:21:56.924483 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.minimum_cost_suppliers"} */

    drop table if exists "lakehouse"."dbt"."minimum_cost_suppliers"
[0m19:21:56.924695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:21:58.097958 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:21:58.099356 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m19:21:58.102096 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.minimum_cost_suppliers"
[0m19:21:58.102445 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.minimum_cost_suppliers"} */

  
    

    create table "lakehouse"."dbt"."minimum_cost_suppliers"
      
      
    as (
      /*
2 Q2 - Minimum Cost Supplier Query
This query finds which supplier should be selected to place an order for a given part in a given region
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 30)
*/
with
    parts_suppliers as (

        select
            s.supplier_account_balance,
            s.supplier_name,
            s.supplier_nation_key,
            s.supplier_region_key,
            s.supplier_nation_name,
            s.supplier_region_name,
            s.part_key,
            s.part_manufacturer_name,
            s.part_size,
            s.part_type_name,
            s.supplier_cost_amount,
            s.supplier_address,
            s.supplier_phone_number,
            rank() over (
                partition by s.supplier_region_key, s.part_key
                order by s.supplier_cost_amount
            ) as supplier_cost_rank,
            row_number() over (
                partition by s.supplier_region_key, s.part_key, s.supplier_cost_amount
                order by s.supplier_account_balance desc
            ) as supplier_rank
        from "lakehouse"."dbt"."dim_part_suppliers" s
    )
select s.*
from parts_suppliers s
where s.supplier_cost_rank = 1 and s.supplier_rank <= 100
order by s.supplier_name, s.part_key
    )
[0m19:22:06.742228 [debug] [Thread-1 (]: SQL status: SUCCESS in 9.0 seconds
[0m19:22:06.744645 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.minimum_cost_suppliers (execute): 19:21:56.919694 => 19:22:06.744434
[0m19:22:06.744957 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: ROLLBACK
[0m19:22:06.745196 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.minimum_cost_suppliers: Close
[0m19:22:06.746670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '030b6f77-8a3e-42a2-a19a-010ab2f5d433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c428bab10>]}
[0m19:22:06.747134 [info ] [Thread-1 (]: 8 of 8 OK created sql table model dbt.minimum_cost_suppliers ................... [[32mSUCCESS[0m in 9.83s]
[0m19:22:06.747519 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.minimum_cost_suppliers
[0m19:22:06.749479 [debug] [MainThread]: On master: COMMIT
[0m19:22:06.749875 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:22:06.750043 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.minimum_cost_suppliers' was properly closed.
[0m19:22:06.750243 [info ] [MainThread]: 
[0m19:22:06.750459 [info ] [MainThread]: Finished running 8 table models in 0 hours 2 minutes and 29.83 seconds (149.83s).
[0m19:22:06.751421 [debug] [MainThread]: Command end result
[0m19:22:06.763148 [info ] [MainThread]: 
[0m19:22:06.763562 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:22:06.763855 [info ] [MainThread]: 
[0m19:22:06.764210 [error] [MainThread]:   Compilation Error in model pricing_summary_report (models/gold/pricing_summary_report.sql)
  Required var ' highest_ship_date ' not found in config:
  Vars supplied to pricing_summary_report = {
      "dbt_trino_iceberg": {
          "highest_ship_date": "1998-12-01"
      },
      "highest_ship_date": "1998-12-01"
  }
[0m19:22:06.764470 [info ] [MainThread]: 
[0m19:22:06.764785 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m19:22:06.765723 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 150.98224, "process_user_time": 3.110631, "process_kernel_time": 0.223576, "process_mem_max_rss": "121676", "process_in_blocks": "592", "process_out_blocks": "3920", "command_success": false}
[0m19:22:06.766114 [debug] [MainThread]: Command `dbt run` failed at 19:22:06.766034 after 150.98 seconds
[0m19:22:06.766393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c4425a050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c44253d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c445cec10>]}
[0m19:22:06.766642 [debug] [MainThread]: Flushing usage events
[0m19:32:16.989828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd64d16950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd660df5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd64d00c50>]}


============================== 19:32:16.991901 | ad6ee436-d235-49aa-9cde-df8a1a8f9074 ==============================
[0m19:32:16.991901 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:32:16.992306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s pricing_summary_report', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:32:17.131483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad6ee436-d235-49aa-9cde-df8a1a8f9074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd64ab8490>]}
[0m19:32:17.187319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad6ee436-d235-49aa-9cde-df8a1a8f9074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd64b5d3d0>]}
[0m19:32:17.188026 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m19:32:17.195318 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:32:17.213950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:32:17.214449 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://models/gold/pricing_summary_report.sql
[0m19:32:17.310911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad6ee436-d235-49aa-9cde-df8a1a8f9074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd64725c50>]}
[0m19:32:17.320383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad6ee436-d235-49aa-9cde-df8a1a8f9074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd64724e90>]}
[0m19:32:17.320732 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 537 macros, 0 groups, 0 semantic models
[0m19:32:17.320998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad6ee436-d235-49aa-9cde-df8a1a8f9074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd64ab3a90>]}
[0m19:32:17.322065 [info ] [MainThread]: 
[0m19:32:17.322660 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m19:32:17.323525 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m19:32:17.334579 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m19:32:17.334842 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m19:32:17.335017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:32:19.364771 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m19:32:19.367753 [debug] [ThreadPool]: On list_lakehouse: Close
[0m19:32:19.370934 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m19:32:19.376616 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m19:32:19.376870 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m19:32:19.377084 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:32:20.890161 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m19:32:20.892007 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m19:32:20.892221 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m19:32:20.895888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad6ee436-d235-49aa-9cde-df8a1a8f9074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd64b06510>]}
[0m19:32:20.896291 [debug] [MainThread]: On master: COMMIT
[0m19:32:20.896941 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:32:20.897252 [info ] [MainThread]: 
[0m19:32:20.900051 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.pricing_summary_report
[0m19:32:20.900366 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.pricing_summary_report ........................ [RUN]
[0m19:32:20.901043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.pricing_summary_report)
[0m19:32:20.901265 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.pricing_summary_report
[0m19:32:20.903586 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m19:32:20.904052 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (compile): 19:32:20.901387 => 19:32:20.903905
[0m19:32:20.904284 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.pricing_summary_report
[0m19:32:20.920034 [debug] [Thread-1 (]: Applying DROP to: "lakehouse"."dbt"."pricing_summary_report"
[0m19:32:20.922135 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.pricing_summary_report"
[0m19:32:20.922431 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.pricing_summary_report"} */

    drop table if exists "lakehouse"."dbt"."pricing_summary_report"
[0m19:32:20.922634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:32:21.905527 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:32:21.916300 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.pricing_summary_report"
[0m19:32:21.918966 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.pricing_summary_report"
[0m19:32:21.919248 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.pricing_summary_report"} */

  
    

    create table "lakehouse"."dbt"."pricing_summary_report"
      
      
    as (
      /*
1 Q1 - Pricing Summary Report Query
This query reports the amount of business that was billed, shipped, and returned. 
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 29)
*/
select
    f.return_status_code,
    f.order_line_status_code,
    sum(f.quantity) as quantity,
    sum(f.gross_item_sales_amount) as gross_item_sales_amount,
    sum(f.discounted_item_sales_amount) as discounted_item_sales_amount,
    sum(f.net_item_sales_amount) as net_item_sales_amount,

    avg(f.quantity) as avg_quantity,
    avg(f.base_price) as avg_base_price,
    avg(f.discount_percentage) as avg_discount_percentage,

    sum(f.order_item_count) as order_item_count

from "lakehouse"."dbt"."fct_orders_items" f
where
    f.ship_date
    <= date_add('day', -90, date_parse('1998-12-01', '%Y-%m-%d'))
group by 1, 2
    )
[0m19:32:25.021512 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.0 seconds
[0m19:32:25.037196 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.pricing_summary_report (execute): 19:32:20.904410 => 19:32:25.036957
[0m19:32:25.037533 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: ROLLBACK
[0m19:32:25.037799 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.pricing_summary_report: Close
[0m19:32:25.039136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad6ee436-d235-49aa-9cde-df8a1a8f9074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd63648e50>]}
[0m19:32:25.039752 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt.pricing_summary_report ................... [[32mSUCCESS[0m in 4.14s]
[0m19:32:25.040230 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.pricing_summary_report
[0m19:32:25.042488 [debug] [MainThread]: On master: COMMIT
[0m19:32:25.042940 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:32:25.043117 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.pricing_summary_report' was properly closed.
[0m19:32:25.043336 [info ] [MainThread]: 
[0m19:32:25.043625 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.72 seconds (7.72s).
[0m19:32:25.044236 [debug] [MainThread]: Command end result
[0m19:32:25.051660 [info ] [MainThread]: 
[0m19:32:25.052108 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:32:25.052418 [info ] [MainThread]: 
[0m19:32:25.052759 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:32:25.053550 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.109432, "process_user_time": 1.628061, "process_kernel_time": 0.169393, "process_mem_max_rss": "113732", "process_out_blocks": "3608", "process_in_blocks": "0"}
[0m19:32:25.053923 [debug] [MainThread]: Command `dbt run` succeeded at 19:32:25.053843 after 8.11 seconds
[0m19:32:25.054206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd693d92d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd692eb410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd692eb550>]}
[0m19:32:25.054433 [debug] [MainThread]: Flushing usage events
[0m20:01:44.555478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ee5decd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ee5c53b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ee628a710>]}


============================== 20:01:44.557341 | 6b3325b8-68b9-429b-9135-c13eb52bb55d ==============================
[0m20:01:44.557341 [info ] [MainThread]: Running with dbt=1.7.4
[0m20:01:44.557713 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models gold.*', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:01:44.685952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b3325b8-68b9-429b-9135-c13eb52bb55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ee5bcb150>]}
[0m20:01:44.741837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b3325b8-68b9-429b-9135-c13eb52bb55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ee5b97990>]}
[0m20:01:44.742286 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m20:01:44.749561 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m20:01:44.768862 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 5 files added, 0 files changed.
[0m20:01:44.769328 [debug] [MainThread]: Partial parsing: added file: dbt_trino_iceberg://models/gold/gold_pricing_summary_report.sql
[0m20:01:44.769569 [debug] [MainThread]: Partial parsing: added file: dbt_trino_iceberg://models/gold/gold_fct_orders_items.sql
[0m20:01:44.769756 [debug] [MainThread]: Partial parsing: added file: dbt_trino_iceberg://models/gold/gold_dim_suppliers.sql
[0m20:01:44.769944 [debug] [MainThread]: Partial parsing: added file: dbt_trino_iceberg://models/gold/gold_minimum_cost_suppliers.sql
[0m20:01:44.770152 [debug] [MainThread]: Partial parsing: added file: dbt_trino_iceberg://models/gold/gold_dim_part_suppliers.sql
[0m20:01:44.770317 [debug] [MainThread]: Partial parsing: deleted file: dbt_trino_iceberg://models/gold/dim_part_suppliers.sql
[0m20:01:44.770468 [debug] [MainThread]: Partial parsing: deleted file: dbt_trino_iceberg://models/gold/pricing_summary_report.sql
[0m20:01:44.770619 [debug] [MainThread]: Partial parsing: deleted file: dbt_trino_iceberg://models/gold/minimum_cost_suppliers.sql
[0m20:01:44.770765 [debug] [MainThread]: Partial parsing: deleted file: dbt_trino_iceberg://models/gold/dim_suppliers.sql
[0m20:01:44.770910 [debug] [MainThread]: Partial parsing: deleted file: dbt_trino_iceberg://models/gold/fct_orders_items.sql
[0m20:01:44.873579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b3325b8-68b9-429b-9135-c13eb52bb55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ee4c346d0>]}
[0m20:01:44.882934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b3325b8-68b9-429b-9135-c13eb52bb55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ee58962d0>]}
[0m20:01:44.883352 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 537 macros, 0 groups, 0 semantic models
[0m20:01:44.883628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b3325b8-68b9-429b-9135-c13eb52bb55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ee57f17d0>]}
[0m20:01:44.884858 [info ] [MainThread]: 
[0m20:01:44.885439 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m20:01:44.886476 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m20:01:44.897088 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m20:01:44.897312 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m20:01:44.897483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:01:46.619461 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:01:46.621253 [debug] [ThreadPool]: On list_lakehouse: Close
[0m20:01:46.623604 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_dbt)
[0m20:01:46.630722 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m20:01:46.631008 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m20:01:46.631210 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:01:47.959874 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:01:47.962108 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m20:01:47.962293 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m20:01:47.965067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b3325b8-68b9-429b-9135-c13eb52bb55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ee5844cd0>]}
[0m20:01:47.965605 [debug] [MainThread]: On master: COMMIT
[0m20:01:47.966634 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:01:47.967158 [info ] [MainThread]: 
[0m20:01:47.970983 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.gold_dim_part_suppliers
[0m20:01:47.971311 [info ] [Thread-1 (]: 1 of 5 START sql table model dbt.gold_dim_part_suppliers ....................... [RUN]
[0m20:01:47.971787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.gold_dim_part_suppliers)
[0m20:01:47.972021 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.gold_dim_part_suppliers
[0m20:01:47.976150 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.gold_dim_part_suppliers"
[0m20:01:47.978204 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.gold_dim_part_suppliers"
[0m20:01:47.980825 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.gold_dim_part_suppliers"
[0m20:01:47.983181 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.gold_dim_part_suppliers"
[0m20:01:47.990549 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.gold_dim_part_suppliers"
[0m20:01:47.991037 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.gold_dim_part_suppliers (compile): 20:01:47.972145 => 20:01:47.990867
[0m20:01:47.991270 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.gold_dim_part_suppliers
[0m20:01:48.011383 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.gold_dim_part_suppliers"
[0m20:01:48.015539 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.gold_dim_part_suppliers"
[0m20:01:48.015869 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.gold_dim_part_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.gold_dim_part_suppliers"} */

  
    

    create table "lakehouse"."dbt"."gold_dim_part_suppliers"
      
      
    as (
      with
     __dbt__cte__bronze_tpch__supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from tpch.sf1.supplier
),  __dbt__cte__bronze_tpch__part as (

select
    partkey as part_key,
    name as part_name,
    mfgr as part_manufacturer_name,
    brand as part_brand_name,
    type as part_type_name,
    size as part_size,
    container as part_container_desc,
    retailprice as retail_price,
    comment as part_comment
from tpch.sf1.part
),  __dbt__cte__bronze_tpch__nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from tpch.sf1.nation
),  __dbt__cte__bronze_tpch__region as (

select regionkey as region_key, name as region_name, comment as region_comment
from tpch.sf1.region
), suppliers as (select * from __dbt__cte__bronze_tpch__supplier),
    parts as (select * from __dbt__cte__bronze_tpch__part),
    parts_suppliers as (select * from "lakehouse"."dbt"."silver_parts_suppliers"),
    nations as (select * from __dbt__cte__bronze_tpch__nation),
    regions as (select * from __dbt__cte__bronze_tpch__region),
    final as (

        select
            ps.part_supplier_key,

            p.part_key,
            p.part_name,
            p.part_manufacturer_name,
            p.part_brand_name,
            p.part_type_name,
            p.part_size,
            p.part_container_desc,
            p.retail_price,

            s.supplier_key,
            s.supplier_name,
            supplier_address,
            s.supplier_phone_number,
            s.supplier_account_balance,
            n.nation_key as supplier_nation_key,
            n.nation_name as supplier_nation_name,
            r.region_key as supplier_region_key,
            r.region_name as supplier_region_name,

            ps.supplier_availabe_quantity,
            ps.supplier_cost_amount
        from parts p
        join parts_suppliers ps on p.part_key = ps.part_key
        join suppliers s on ps.supplier_key = s.supplier_key
        join nations n on s.nation_key = n.nation_key
        join regions r on n.region_key = r.region_key
    )
select *

from final f
order by f.part_key, f.supplier_key
    )
[0m20:01:48.016139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:00.100098 [debug] [Thread-1 (]: SQL status: SUCCESS in 12.0 seconds
[0m20:02:00.111417 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.gold_dim_part_suppliers (execute): 20:01:47.991393 => 20:02:00.111263
[0m20:02:00.111711 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.gold_dim_part_suppliers: ROLLBACK
[0m20:02:00.111912 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.gold_dim_part_suppliers: Close
[0m20:02:00.113075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b3325b8-68b9-429b-9135-c13eb52bb55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ee5879410>]}
[0m20:02:00.113603 [info ] [Thread-1 (]: 1 of 5 OK created sql table model dbt.gold_dim_part_suppliers .................. [[32mSUCCESS[0m in 12.14s]
[0m20:02:00.114148 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.gold_dim_part_suppliers
[0m20:02:00.114477 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.gold_dim_suppliers
[0m20:02:00.114785 [info ] [Thread-1 (]: 2 of 5 START sql table model dbt.gold_dim_suppliers ............................ [RUN]
[0m20:02:00.115681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.gold_dim_part_suppliers, now model.dbt_trino_iceberg.gold_dim_suppliers)
[0m20:02:00.115969 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.gold_dim_suppliers
[0m20:02:00.121422 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.gold_dim_suppliers"
[0m20:02:00.121949 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.gold_dim_suppliers (compile): 20:02:00.116140 => 20:02:00.121788
[0m20:02:00.122170 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.gold_dim_suppliers
[0m20:02:00.124277 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.gold_dim_suppliers"
[0m20:02:00.126518 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.gold_dim_suppliers"
[0m20:02:00.126787 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.gold_dim_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.gold_dim_suppliers"} */

  
    

    create table "lakehouse"."dbt"."gold_dim_suppliers"
      
      
    as (
      with
     __dbt__cte__bronze_tpch__supplier as (

select
    suppkey as supplier_key,
    name as supplier_name,
    address as supplier_address,
    nationkey as nation_key,
    phone as supplier_phone_number,
    acctbal as supplier_account_balance,
    comment as supplier_comment
from tpch.sf1.supplier
),  __dbt__cte__bronze_tpch__nation as (

select
    nationkey as nation_key,
    name as nation_name,
    regionkey as region_key,
    comment as nation_comment
from tpch.sf1.nation
),  __dbt__cte__bronze_tpch__region as (

select regionkey as region_key, name as region_name, comment as region_comment
from tpch.sf1.region
), suppliers as (select * from __dbt__cte__bronze_tpch__supplier),
    nations as (select * from __dbt__cte__bronze_tpch__nation),
    regions as (select * from __dbt__cte__bronze_tpch__region)
select
    s.supplier_key,
    s.supplier_name,
    s.supplier_address,
    n.nation_key as supplier_nation_key,
    n.nation_name as supplier_nation_name,
    r.region_key as supplier_region_key,
    r.region_name as supplier_region_name,
    s.supplier_phone_number,
    s.supplier_account_balance
from suppliers s
join nations n on s.nation_key = n.nation_key
join regions r on n.region_key = r.region_key
order by s.supplier_key
    )
[0m20:02:00.127040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:01.729246 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m20:02:01.733198 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.gold_dim_suppliers (execute): 20:02:00.122289 => 20:02:01.733061
[0m20:02:01.733433 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.gold_dim_suppliers: ROLLBACK
[0m20:02:01.733623 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.gold_dim_suppliers: Close
[0m20:02:01.734715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b3325b8-68b9-429b-9135-c13eb52bb55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ee4c331d0>]}
[0m20:02:01.735098 [info ] [Thread-1 (]: 2 of 5 OK created sql table model dbt.gold_dim_suppliers ....................... [[32mSUCCESS[0m in 1.62s]
[0m20:02:01.735497 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.gold_dim_suppliers
[0m20:02:01.735826 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.gold_fct_orders_items
[0m20:02:01.736143 [info ] [Thread-1 (]: 3 of 5 START sql table model dbt.gold_fct_orders_items ......................... [RUN]
[0m20:02:01.736812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.gold_dim_suppliers, now model.dbt_trino_iceberg.gold_fct_orders_items)
[0m20:02:01.737076 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.gold_fct_orders_items
[0m20:02:01.741755 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.gold_fct_orders_items"
[0m20:02:01.750129 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.gold_fct_orders_items"
[0m20:02:01.750576 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.gold_fct_orders_items (compile): 20:02:01.737216 => 20:02:01.750411
[0m20:02:01.750873 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.gold_fct_orders_items
[0m20:02:01.752859 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.gold_fct_orders_items"
[0m20:02:01.755617 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.gold_fct_orders_items"
[0m20:02:01.755885 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.gold_fct_orders_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.gold_fct_orders_items"} */

  
    

    create table "lakehouse"."dbt"."gold_fct_orders_items"
      
      
    as (
      with
     __dbt__cte__bronze_tpch__part_suppliers as (

select
    partkey as part_key,
    suppkey as supplier_key,
    availqty as supplier_availabe_quantity,
    supplycost as supplier_cost_amount,
    comment as part_supplier_comment
from tpch.sf1.partsupp
), orders_items as (select * from "lakehouse"."dbt"."silver_order_items"),
    parts_suppliers as (select * from __dbt__cte__bronze_tpch__part_suppliers),
    final as (
        select

            o.order_item_key,
            o.order_key,
            o.order_date,
            o.customer_key,
            o.order_status_code,

            o.part_key,
            o.supplier_key,
            o.return_status_code,
            o.order_line_number,
            o.order_line_status_code,
            o.ship_date,
            o.commit_date,
            o.receipt_date,
            o.ship_mode_name,
            ps.supplier_cost_amount,
            
            o.base_price,
            o.discount_percentage,
            o.discounted_price,
            o.tax_rate,

            1 as order_item_count,
            o.quantity,

            o.gross_item_sales_amount,
            o.discounted_item_sales_amount,
            o.item_discount_amount,
            o.item_tax_amount,
            o.net_item_sales_amount

        from orders_items o
        join
            parts_suppliers ps
            on o.part_key = ps.part_key
            and o.supplier_key = ps.supplier_key
    )
select *

from final f
order by f.order_date
    )
[0m20:02:01.756125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:34.575615 [debug] [Thread-1 (]: SQL status: SUCCESS in 33.0 seconds
[0m20:02:34.577325 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.gold_fct_orders_items (execute): 20:02:01.751021 => 20:02:34.577154
[0m20:02:34.577614 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.gold_fct_orders_items: ROLLBACK
[0m20:02:34.577846 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.gold_fct_orders_items: Close
[0m20:02:34.579046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b3325b8-68b9-429b-9135-c13eb52bb55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ee4d0c4d0>]}
[0m20:02:34.579468 [info ] [Thread-1 (]: 3 of 5 OK created sql table model dbt.gold_fct_orders_items .................... [[32mSUCCESS[0m in 32.84s]
[0m20:02:34.579950 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.gold_fct_orders_items
[0m20:02:34.580346 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.gold_minimum_cost_suppliers
[0m20:02:34.580663 [info ] [Thread-1 (]: 4 of 5 START sql table model dbt.gold_minimum_cost_suppliers ................... [RUN]
[0m20:02:34.581499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.gold_fct_orders_items, now model.dbt_trino_iceberg.gold_minimum_cost_suppliers)
[0m20:02:34.581738 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.gold_minimum_cost_suppliers
[0m20:02:34.583823 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.gold_minimum_cost_suppliers"
[0m20:02:34.584294 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.gold_minimum_cost_suppliers (compile): 20:02:34.581863 => 20:02:34.584146
[0m20:02:34.584502 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.gold_minimum_cost_suppliers
[0m20:02:34.586464 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.gold_minimum_cost_suppliers"
[0m20:02:34.589971 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.gold_minimum_cost_suppliers"
[0m20:02:34.590379 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.gold_minimum_cost_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.gold_minimum_cost_suppliers"} */

  
    

    create table "lakehouse"."dbt"."gold_minimum_cost_suppliers"
      
      
    as (
      /*
2 Q2 - Minimum Cost Supplier Query
This query finds which supplier should be selected to place an order for a given part in a given region
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 30)
*/
with
    parts_suppliers as (

        select
            s.supplier_account_balance,
            s.supplier_name,
            s.supplier_nation_key,
            s.supplier_region_key,
            s.supplier_nation_name,
            s.supplier_region_name,
            s.part_key,
            s.part_manufacturer_name,
            s.part_size,
            s.part_type_name,
            s.supplier_cost_amount,
            s.supplier_address,
            s.supplier_phone_number,
            rank() over (
                partition by s.supplier_region_key, s.part_key
                order by s.supplier_cost_amount
            ) as supplier_cost_rank,
            row_number() over (
                partition by s.supplier_region_key, s.part_key, s.supplier_cost_amount
                order by s.supplier_account_balance desc
            ) as supplier_rank
        from "lakehouse"."dbt"."gold_dim_part_suppliers" s
    )
select s.*
from parts_suppliers s
where s.supplier_cost_rank = 1 and s.supplier_rank <= 100
order by s.supplier_name, s.part_key
    )
[0m20:02:34.590760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:41.749741 [debug] [Thread-1 (]: SQL status: SUCCESS in 7.0 seconds
[0m20:02:41.753426 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.gold_minimum_cost_suppliers (execute): 20:02:34.584621 => 20:02:41.753177
[0m20:02:41.753842 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.gold_minimum_cost_suppliers: ROLLBACK
[0m20:02:41.754202 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.gold_minimum_cost_suppliers: Close
[0m20:02:41.755690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b3325b8-68b9-429b-9135-c13eb52bb55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ee4d15010>]}
[0m20:02:41.756094 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dbt.gold_minimum_cost_suppliers .............. [[32mSUCCESS[0m in 7.17s]
[0m20:02:41.756509 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.gold_minimum_cost_suppliers
[0m20:02:41.756825 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.gold_pricing_summary_report
[0m20:02:41.757376 [info ] [Thread-1 (]: 5 of 5 START sql table model dbt.gold_pricing_summary_report ................... [RUN]
[0m20:02:41.757881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.gold_minimum_cost_suppliers, now model.dbt_trino_iceberg.gold_pricing_summary_report)
[0m20:02:41.758119 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.gold_pricing_summary_report
[0m20:02:41.760216 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.gold_pricing_summary_report"
[0m20:02:41.760665 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.gold_pricing_summary_report (compile): 20:02:41.758253 => 20:02:41.760525
[0m20:02:41.760869 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.gold_pricing_summary_report
[0m20:02:41.762633 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_iceberg.gold_pricing_summary_report"
[0m20:02:41.764054 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_iceberg.gold_pricing_summary_report"
[0m20:02:41.764293 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.gold_pricing_summary_report: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "node_id": "model.dbt_trino_iceberg.gold_pricing_summary_report"} */

  
    

    create table "lakehouse"."dbt"."gold_pricing_summary_report"
      
      
    as (
      /*
1 Q1 - Pricing Summary Report Query
This query reports the amount of business that was billed, shipped, and returned. 
Full description:https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf (Page 29)
*/
select
    f.return_status_code,
    f.order_line_status_code,
    sum(f.quantity) as quantity,
    sum(f.gross_item_sales_amount) as gross_item_sales_amount,
    sum(f.discounted_item_sales_amount) as discounted_item_sales_amount,
    sum(f.net_item_sales_amount) as net_item_sales_amount,

    avg(f.quantity) as avg_quantity,
    avg(f.base_price) as avg_base_price,
    avg(f.discount_percentage) as avg_discount_percentage,

    sum(f.order_item_count) as order_item_count

from "lakehouse"."dbt"."gold_fct_orders_items" f
where
    f.ship_date
    <= date_add('day', -90, date_parse('1998-12-01', '%Y-%m-%d'))
group by 1, 2
    )
[0m20:02:41.764503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:44.233723 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m20:02:44.238093 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.gold_pricing_summary_report (execute): 20:02:41.760983 => 20:02:44.237870
[0m20:02:44.238477 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.gold_pricing_summary_report: ROLLBACK
[0m20:02:44.238812 [debug] [Thread-1 (]: On model.dbt_trino_iceberg.gold_pricing_summary_report: Close
[0m20:02:44.240304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b3325b8-68b9-429b-9135-c13eb52bb55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ee4ccfb50>]}
[0m20:02:44.240713 [info ] [Thread-1 (]: 5 of 5 OK created sql table model dbt.gold_pricing_summary_report .............. [[32mSUCCESS[0m in 2.48s]
[0m20:02:44.241146 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.gold_pricing_summary_report
[0m20:02:44.242664 [debug] [MainThread]: On master: COMMIT
[0m20:02:44.243105 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:02:44.243274 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.gold_pricing_summary_report' was properly closed.
[0m20:02:44.243463 [info ] [MainThread]: 
[0m20:02:44.243677 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 59.36 seconds (59.36s).
[0m20:02:44.244445 [debug] [MainThread]: Command end result
[0m20:02:44.291795 [info ] [MainThread]: 
[0m20:02:44.292266 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:02:44.292586 [info ] [MainThread]: 
[0m20:02:44.292884 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m20:02:44.293470 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 59.76397, "process_user_time": 1.948828, "process_kernel_time": 0.087697, "process_mem_max_rss": "115488", "process_out_blocks": "3816", "process_in_blocks": "0"}
[0m20:02:44.293806 [debug] [MainThread]: Command `dbt run` succeeded at 20:02:44.293731 after 59.76 seconds
[0m20:02:44.294020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eea3a7590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eea495350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eea495150>]}
[0m20:02:44.294228 [debug] [MainThread]: Flushing usage events
[0m20:28:30.536804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf39bdd850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf3a07a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf3a07a7d0>]}


============================== 20:28:30.538834 | 498d8248-f353-4fd9-93e4-39e0e22ae3ef ==============================
[0m20:28:30.538834 [info ] [MainThread]: Running with dbt=1.7.4
[0m20:28:30.539505 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:28:30.668556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '498d8248-f353-4fd9-93e4-39e0e22ae3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf399b5690>]}
[0m20:28:30.723520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '498d8248-f353-4fd9-93e4-39e0e22ae3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf39846b10>]}
[0m20:28:30.724034 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m20:28:30.731375 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m20:28:30.750249 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:28:30.750545 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:28:30.754683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '498d8248-f353-4fd9-93e4-39e0e22ae3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf3962e5d0>]}
[0m20:28:30.756553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '498d8248-f353-4fd9-93e4-39e0e22ae3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf3966ee90>]}
[0m20:28:30.756830 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 537 macros, 0 groups, 0 semantic models
[0m20:28:30.757118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '498d8248-f353-4fd9-93e4-39e0e22ae3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf39bf6450>]}
[0m20:28:30.758585 [info ] [MainThread]: 
[0m20:28:30.759160 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m20:28:30.760328 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_dbt'
[0m20:28:30.772674 [debug] [ThreadPool]: Using trino connection "list_lakehouse_dbt"
[0m20:28:30.772980 [debug] [ThreadPool]: On list_lakehouse_dbt: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "list_lakehouse_dbt"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'dbt') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'dbt'
[0m20:28:30.773174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:32.125501 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:28:32.129394 [debug] [ThreadPool]: On list_lakehouse_dbt: ROLLBACK
[0m20:28:32.129939 [debug] [ThreadPool]: On list_lakehouse_dbt: Close
[0m20:28:32.134926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '498d8248-f353-4fd9-93e4-39e0e22ae3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf3a5e8bd0>]}
[0m20:28:32.135524 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:28:32.135833 [info ] [MainThread]: 
[0m20:28:32.139358 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.bronze_tpch__customers
[0m20:28:32.139794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_dbt, now model.dbt_trino_iceberg.bronze_tpch__customers)
[0m20:28:32.140013 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.bronze_tpch__customers
[0m20:28:32.142265 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.bronze_tpch__customers"
[0m20:28:32.142982 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.bronze_tpch__customers (compile): 20:28:32.140133 => 20:28:32.142826
[0m20:28:32.143558 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.bronze_tpch__customers
[0m20:28:32.143931 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.bronze_tpch__line_item
[0m20:28:32.144499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.bronze_tpch__customers, now model.dbt_trino_iceberg.bronze_tpch__line_item)
[0m20:28:32.145320 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.bronze_tpch__line_item
[0m20:28:32.147519 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.bronze_tpch__line_item"
[0m20:28:32.148159 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.bronze_tpch__line_item (compile): 20:28:32.145480 => 20:28:32.147983
[0m20:28:32.148686 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.bronze_tpch__line_item
[0m20:28:32.148961 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.bronze_tpch__nation
[0m20:28:32.149553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.bronze_tpch__line_item, now model.dbt_trino_iceberg.bronze_tpch__nation)
[0m20:28:32.149796 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.bronze_tpch__nation
[0m20:28:32.151908 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.bronze_tpch__nation"
[0m20:28:32.152409 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.bronze_tpch__nation (compile): 20:28:32.149970 => 20:28:32.152251
[0m20:28:32.152929 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.bronze_tpch__nation
[0m20:28:32.153181 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.bronze_tpch__orders
[0m20:28:32.153580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.bronze_tpch__nation, now model.dbt_trino_iceberg.bronze_tpch__orders)
[0m20:28:32.153800 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.bronze_tpch__orders
[0m20:28:32.155739 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.bronze_tpch__orders"
[0m20:28:32.156433 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.bronze_tpch__orders (compile): 20:28:32.153935 => 20:28:32.156280
[0m20:28:32.156644 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.bronze_tpch__orders
[0m20:28:32.156906 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.bronze_tpch__orders (execute): 20:28:32.156761 => 20:28:32.156768
[0m20:28:32.157508 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.bronze_tpch__orders
[0m20:28:32.157759 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.bronze_tpch__part
[0m20:28:32.158137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.bronze_tpch__orders, now model.dbt_trino_iceberg.bronze_tpch__part)
[0m20:28:32.158363 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.bronze_tpch__part
[0m20:28:32.161336 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.bronze_tpch__part"
[0m20:28:32.162400 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.bronze_tpch__part (compile): 20:28:32.158501 => 20:28:32.162226
[0m20:28:32.162983 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.bronze_tpch__part
[0m20:28:32.163322 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.bronze_tpch__part_suppliers
[0m20:28:32.163748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.bronze_tpch__part, now model.dbt_trino_iceberg.bronze_tpch__part_suppliers)
[0m20:28:32.164014 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.bronze_tpch__part_suppliers
[0m20:28:32.166159 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.bronze_tpch__part_suppliers"
[0m20:28:32.166838 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.bronze_tpch__part_suppliers (compile): 20:28:32.164179 => 20:28:32.166671
[0m20:28:32.167441 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.bronze_tpch__part_suppliers
[0m20:28:32.167697 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.bronze_tpch__region
[0m20:28:32.168081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.bronze_tpch__part_suppliers, now model.dbt_trino_iceberg.bronze_tpch__region)
[0m20:28:32.168317 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.bronze_tpch__region
[0m20:28:32.170487 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.bronze_tpch__region"
[0m20:28:32.171217 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.bronze_tpch__region (compile): 20:28:32.168475 => 20:28:32.171040
[0m20:28:32.171772 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.bronze_tpch__region
[0m20:28:32.172031 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.bronze_tpch__supplier
[0m20:28:32.172429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.bronze_tpch__region, now model.dbt_trino_iceberg.bronze_tpch__supplier)
[0m20:28:32.172653 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.bronze_tpch__supplier
[0m20:28:32.174604 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.bronze_tpch__supplier"
[0m20:28:32.175122 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.bronze_tpch__supplier (compile): 20:28:32.172792 => 20:28:32.174965
[0m20:28:32.175625 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.bronze_tpch__supplier
[0m20:28:32.175876 [debug] [Thread-1 (]: Began running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m20:28:32.176253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.bronze_tpch__supplier, now snapshot.dbt_trino_iceberg.orders_snapshot)
[0m20:28:32.176470 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_trino_iceberg.orders_snapshot
[0m20:28:32.179247 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (compile): 20:28:32.176602 => 20:28:32.179024
[0m20:28:32.179962 [debug] [Thread-1 (]: Began executing node snapshot.dbt_trino_iceberg.orders_snapshot
[0m20:28:32.180262 [debug] [Thread-1 (]: Timing info for snapshot.dbt_trino_iceberg.orders_snapshot (execute): 20:28:32.180129 => 20:28:32.180135
[0m20:28:32.180797 [debug] [Thread-1 (]: Finished running node snapshot.dbt_trino_iceberg.orders_snapshot
[0m20:28:32.181052 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.silver_order_items
[0m20:28:32.181445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_trino_iceberg.orders_snapshot, now model.dbt_trino_iceberg.silver_order_items)
[0m20:28:32.181665 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.silver_order_items
[0m20:28:32.201189 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.silver_order_items"
[0m20:28:32.201836 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.silver_order_items (compile): 20:28:32.181797 => 20:28:32.201660
[0m20:28:32.202069 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.silver_order_items
[0m20:28:32.202307 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.silver_order_items (execute): 20:28:32.202192 => 20:28:32.202198
[0m20:28:32.202852 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.silver_order_items
[0m20:28:32.203197 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.gold_dim_suppliers
[0m20:28:32.203672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.silver_order_items, now model.dbt_trino_iceberg.gold_dim_suppliers)
[0m20:28:32.203989 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.gold_dim_suppliers
[0m20:28:32.209521 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.gold_dim_suppliers"
[0m20:28:32.210540 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.gold_dim_suppliers (compile): 20:28:32.204163 => 20:28:32.210327
[0m20:28:32.210767 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.gold_dim_suppliers
[0m20:28:32.211000 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.gold_dim_suppliers (execute): 20:28:32.210885 => 20:28:32.210891
[0m20:28:32.211520 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.gold_dim_suppliers
[0m20:28:32.211775 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.silver_parts_suppliers
[0m20:28:32.212298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.gold_dim_suppliers, now model.dbt_trino_iceberg.silver_parts_suppliers)
[0m20:28:32.212538 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.silver_parts_suppliers
[0m20:28:32.220749 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.silver_parts_suppliers"
[0m20:28:32.221372 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.silver_parts_suppliers (compile): 20:28:32.212678 => 20:28:32.221200
[0m20:28:32.221606 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.silver_parts_suppliers
[0m20:28:32.221846 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.silver_parts_suppliers (execute): 20:28:32.221729 => 20:28:32.221734
[0m20:28:32.222379 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.silver_parts_suppliers
[0m20:28:32.222654 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.gold_fct_orders_items
[0m20:28:32.223064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.silver_parts_suppliers, now model.dbt_trino_iceberg.gold_fct_orders_items)
[0m20:28:32.223289 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.gold_fct_orders_items
[0m20:28:32.233477 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.gold_fct_orders_items"
[0m20:28:32.234180 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.gold_fct_orders_items (compile): 20:28:32.223422 => 20:28:32.234004
[0m20:28:32.234400 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.gold_fct_orders_items
[0m20:28:32.234628 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.gold_fct_orders_items (execute): 20:28:32.234516 => 20:28:32.234522
[0m20:28:32.235150 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.gold_fct_orders_items
[0m20:28:32.235399 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.gold_dim_part_suppliers
[0m20:28:32.235786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.gold_fct_orders_items, now model.dbt_trino_iceberg.gold_dim_part_suppliers)
[0m20:28:32.236003 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.gold_dim_part_suppliers
[0m20:28:32.245187 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.gold_dim_part_suppliers"
[0m20:28:32.245556 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.gold_dim_part_suppliers (compile): 20:28:32.236135 => 20:28:32.245424
[0m20:28:32.245752 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.gold_dim_part_suppliers
[0m20:28:32.245978 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.gold_dim_part_suppliers (execute): 20:28:32.245867 => 20:28:32.245872
[0m20:28:32.246482 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.gold_dim_part_suppliers
[0m20:28:32.246738 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.gold_pricing_summary_report
[0m20:28:32.247340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.gold_dim_part_suppliers, now model.dbt_trino_iceberg.gold_pricing_summary_report)
[0m20:28:32.247659 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.gold_pricing_summary_report
[0m20:28:32.249978 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.gold_pricing_summary_report"
[0m20:28:32.250779 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.gold_pricing_summary_report (compile): 20:28:32.247944 => 20:28:32.250511
[0m20:28:32.251053 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.gold_pricing_summary_report
[0m20:28:32.251276 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.gold_pricing_summary_report (execute): 20:28:32.251166 => 20:28:32.251171
[0m20:28:32.251763 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.gold_pricing_summary_report
[0m20:28:32.252007 [debug] [Thread-1 (]: Began running node model.dbt_trino_iceberg.gold_minimum_cost_suppliers
[0m20:28:32.252423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_iceberg.gold_pricing_summary_report, now model.dbt_trino_iceberg.gold_minimum_cost_suppliers)
[0m20:28:32.252643 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_iceberg.gold_minimum_cost_suppliers
[0m20:28:32.254411 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_iceberg.gold_minimum_cost_suppliers"
[0m20:28:32.254838 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.gold_minimum_cost_suppliers (compile): 20:28:32.252775 => 20:28:32.254692
[0m20:28:32.255100 [debug] [Thread-1 (]: Began executing node model.dbt_trino_iceberg.gold_minimum_cost_suppliers
[0m20:28:32.255354 [debug] [Thread-1 (]: Timing info for model.dbt_trino_iceberg.gold_minimum_cost_suppliers (execute): 20:28:32.255236 => 20:28:32.255240
[0m20:28:32.255860 [debug] [Thread-1 (]: Finished running node model.dbt_trino_iceberg.gold_minimum_cost_suppliers
[0m20:28:32.257213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:28:32.257416 [debug] [MainThread]: Connection 'model.dbt_trino_iceberg.gold_minimum_cost_suppliers' was properly closed.
[0m20:28:32.258259 [debug] [MainThread]: Command end result
[0m20:28:32.279605 [debug] [MainThread]: Acquiring new trino connection 'generate_catalog'
[0m20:28:32.279871 [info ] [MainThread]: Building catalog
[0m20:28:32.282324 [debug] [ThreadPool]: Acquiring new trino connection 'lakehouse.information_schema'
[0m20:28:32.308189 [debug] [ThreadPool]: Using trino connection "lakehouse.information_schema"
[0m20:28:32.308760 [debug] [ThreadPool]: On lakehouse.information_schema: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "lakehouse.information_schema"} */

    
        with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        table_type as "table_type",
        null as "table_owner"
    from "lakehouse".INFORMATION_SCHEMA.tables
            where
        table_schema != 'information_schema'
        and
        (
                    (
                        table_schema = 'dbt'
                        and table_name = 'gold_dim_part_suppliers'
                    )
                 or 
                    (
                        table_schema = 'dbt'
                        and table_name = 'gold_fct_orders_items'
                    )
                 or 
                    (
                        table_schema = 'dbt'
                        and table_name = 'bronze_tpch__orders'
                    )
                 or 
                    (
                        table_schema = 'dbt'
                        and table_name = 'silver_parts_suppliers'
                    )
                 or 
                    (
                        table_schema = 'dbt'
                        and table_name = 'orders_snapshot'
                    )
                 or 
                    (
                        table_schema = 'dbt'
                        and table_name = 'gold_dim_suppliers'
                    )
                 or 
                    (
                        table_schema = 'dbt'
                        and table_name = 'gold_minimum_cost_suppliers'
                    )
                 or 
                    (
                        table_schema = 'dbt'
                        and table_name = 'silver_order_items'
                    )
                 or 
                    (
                        table_schema = 'dbt'
                        and table_name = 'gold_pricing_summary_report'
                    )
                )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from "lakehouse".INFORMATION_SCHEMA.columns
            where
        table_schema != 'information_schema'
        and
        (
                    (
                        table_schema = 'dbt'
                        and table_name = 'gold_dim_part_suppliers'
                    )
                 or 
                    (
                        table_schema = 'dbt'
                        and table_name = 'gold_fct_orders_items'
                    )
                 or 
                    (
                        table_schema = 'dbt'
                        and table_name = 'bronze_tpch__orders'
                    )
                 or 
                    (
                        table_schema = 'dbt'
                        and table_name = 'silver_parts_suppliers'
                    )
                 or 
                    (
                        table_schema = 'dbt'
                        and table_name = 'orders_snapshot'
                    )
                 or 
                    (
                        table_schema = 'dbt'
                        and table_name = 'gold_dim_suppliers'
                    )
                 or 
                    (
                        table_schema = 'dbt'
                        and table_name = 'gold_minimum_cost_suppliers'
                    )
                 or 
                    (
                        table_schema = 'dbt'
                        and table_name = 'silver_order_items'
                    )
                 or 
                    (
                        table_schema = 'dbt'
                        and table_name = 'gold_pricing_summary_report'
                    )
                )
        ),
        table_comment as (
            
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'lakehouse'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'dbt'
                    and table_name = 'gold_dim_part_suppliers'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'lakehouse'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'dbt'
                    and table_name = 'gold_fct_orders_items'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'lakehouse'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'dbt'
                    and table_name = 'bronze_tpch__orders'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'lakehouse'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'dbt'
                    and table_name = 'silver_parts_suppliers'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'lakehouse'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'dbt'
                    and table_name = 'orders_snapshot'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'lakehouse'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'dbt'
                    and table_name = 'gold_dim_suppliers'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'lakehouse'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'dbt'
                    and table_name = 'gold_minimum_cost_suppliers'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'lakehouse'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'dbt'
                    and table_name = 'silver_order_items'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'lakehouse'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'dbt'
                    and table_name = 'gold_pricing_summary_report'
                )
            
        )
        select
            table_database,
            table_schema,
            table_name,
            table_type,
            table_owner,
            column_name,
            column_index,
            column_type,
            column_comment,
            table_comment
        from tables
        join columns using ("table_database", "table_schema", "table_name")
        join table_comment using ("table_database", "table_schema", "table_name")
        order by "column_index"
[0m20:28:32.309382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:33.932773 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:28:33.940182 [debug] [ThreadPool]: On lakehouse.information_schema: Close
[0m20:28:33.941820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly lakehouse.information_schema, now tpch.information_schema)
[0m20:28:33.956347 [debug] [ThreadPool]: Using trino connection "tpch.information_schema"
[0m20:28:33.956784 [debug] [ThreadPool]: On tpch.information_schema: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "tpch.information_schema"} */

    
        with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        table_type as "table_type",
        null as "table_owner"
    from tpch.INFORMATION_SCHEMA.tables
            where
        table_schema != 'information_schema'
        and
        (
                    (
                        table_schema = 'sf1'
                        and table_name = 'orders'
                    )
                 or 
                    (
                        table_schema = 'sf1'
                        and table_name = 'customer'
                    )
                 or 
                    (
                        table_schema = 'sf1'
                        and table_name = 'part'
                    )
                 or 
                    (
                        table_schema = 'sf1'
                        and table_name = 'region'
                    )
                 or 
                    (
                        table_schema = 'sf1'
                        and table_name = 'nation'
                    )
                 or 
                    (
                        table_schema = 'sf1'
                        and table_name = 'supplier'
                    )
                 or 
                    (
                        table_schema = 'sf1'
                        and table_name = 'partsupp'
                    )
                 or 
                    (
                        table_schema = 'sf1'
                        and table_name = 'lineitem'
                    )
                )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from tpch.INFORMATION_SCHEMA.columns
            where
        table_schema != 'information_schema'
        and
        (
                    (
                        table_schema = 'sf1'
                        and table_name = 'orders'
                    )
                 or 
                    (
                        table_schema = 'sf1'
                        and table_name = 'customer'
                    )
                 or 
                    (
                        table_schema = 'sf1'
                        and table_name = 'part'
                    )
                 or 
                    (
                        table_schema = 'sf1'
                        and table_name = 'region'
                    )
                 or 
                    (
                        table_schema = 'sf1'
                        and table_name = 'nation'
                    )
                 or 
                    (
                        table_schema = 'sf1'
                        and table_name = 'supplier'
                    )
                 or 
                    (
                        table_schema = 'sf1'
                        and table_name = 'partsupp'
                    )
                 or 
                    (
                        table_schema = 'sf1'
                        and table_name = 'lineitem'
                    )
                )
        ),
        table_comment as (
            
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'tpch'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'sf1'
                    and table_name = 'orders'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'tpch'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'sf1'
                    and table_name = 'customer'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'tpch'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'sf1'
                    and table_name = 'part'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'tpch'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'sf1'
                    and table_name = 'region'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'tpch'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'sf1'
                    and table_name = 'nation'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'tpch'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'sf1'
                    and table_name = 'supplier'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'tpch'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'sf1'
                    and table_name = 'partsupp'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'tpch'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'sf1'
                    and table_name = 'lineitem'
                )
            
        )
        select
            table_database,
            table_schema,
            table_name,
            table_type,
            table_owner,
            column_name,
            column_index,
            column_type,
            column_comment,
            table_comment
        from tables
        join columns using ("table_database", "table_schema", "table_name")
        join table_comment using ("table_database", "table_schema", "table_name")
        order by "column_index"
[0m20:28:33.957168 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:28:35.132371 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:28:35.135413 [debug] [ThreadPool]: On tpch.information_schema: Close
[0m20:28:35.149341 [info ] [MainThread]: Catalog written to /home/vadim/dbt_trino_iceberg/target/catalog.json
[0m20:28:35.150131 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 4.640026, "process_user_time": 1.473964, "process_kernel_time": 0.151175, "process_mem_max_rss": "113228", "process_in_blocks": "2944", "process_out_blocks": "5720"}
[0m20:28:35.150579 [debug] [MainThread]: Command `dbt docs generate` succeeded at 20:28:35.150496 after 4.64 seconds
[0m20:28:35.150777 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m20:28:35.150931 [debug] [MainThread]: Connection 'tpch.information_schema' was properly closed.
[0m20:28:35.151110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf39a5bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf397bf050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf39543510>]}
[0m20:28:35.151325 [debug] [MainThread]: Flushing usage events
[0m20:28:44.102261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74752cacd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74752cbcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74752c8290>]}


============================== 20:28:44.104019 | 121680f6-6d33-43e6-9320-775bb5a68679 ==============================
[0m20:28:44.104019 [info ] [MainThread]: Running with dbt=1.7.4
[0m20:28:44.104380 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:28:44.231861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '121680f6-6d33-43e6-9320-775bb5a68679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7475b577d0>]}
[0m20:28:44.295550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '121680f6-6d33-43e6-9320-775bb5a68679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7475123210>]}
[0m20:38:03.874309 [error] [MainThread]: Encountered an error:

[0m20:38:03.887828 [error] [MainThread]: Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 75, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 197, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 244, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m20:38:03.890163 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 559.8139, "process_user_time": 1.26435, "process_kernel_time": 0.276865, "process_mem_max_rss": "102828", "process_in_blocks": "80", "process_out_blocks": "2960", "command_success": false}
[0m20:38:03.891255 [debug] [MainThread]: Command `dbt docs serve` failed at 20:38:03.891041 after 559.82 seconds
[0m20:38:03.891851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74752ab090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7474deda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74798475d0>]}
[0m20:38:03.892412 [debug] [MainThread]: Flushing usage events
[0m23:28:42.771672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6387ddd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6387dca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6387cc950>]}


============================== 23:28:42.774823 | 5e0feb67-0ce8-4701-abd4-4940153e58dd ==============================
[0m23:28:42.774823 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:28:42.775229 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views', 'send_anonymous_usage_stats': 'True'}
[0m23:28:42.915680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e0feb67-0ce8-4701-abd4-4940153e58dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6385d0490>]}
[0m23:28:42.973135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e0feb67-0ce8-4701-abd4-4940153e58dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb638562310>]}
[0m23:28:42.973595 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m23:28:42.981263 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:28:43.012427 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:28:43.012911 [debug] [MainThread]: Partial parsing: added file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views.sql
[0m23:28:43.033978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e0feb67-0ce8-4701-abd4-4940153e58dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb638654a50>]}
[0m23:28:43.046779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e0feb67-0ce8-4701-abd4-4940153e58dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb638468b10>]}
[0m23:28:43.047244 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m23:28:43.047689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e0feb67-0ce8-4701-abd4-4940153e58dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6385e1590>]}
[0m23:28:43.048376 [debug] [MainThread]: Acquiring new trino connection 'macro_drop_orphaned_tables_and_views'
[0m23:28:43.048582 [debug] [MainThread]: On macro_drop_orphaned_tables_and_views: COMMIT
[0m23:28:43.055862 [debug] [MainThread]: {'LAKEHOUSE': {'DBT': ['SILVER_PARTS_SUPPLIERS', 'SILVER_ORDER_ITEMS', 'BRONZE_TPCH__REGION', 'BRONZE_TPCH__NATION', 'BRONZE_TPCH__CUSTOMERS', 'BRONZE_TPCH__PART', 'BRONZE_TPCH__LINE_ITEM', 'BRONZE_TPCH__SUPPLIER', 'BRONZE_TPCH__PART_SUPPLIERS', 'BRONZE_TPCH__ORDERS', 'ORDERS_SNAPSHOT', 'GOLD_PRICING_SUMMARY_REPORT', 'GOLD_FCT_ORDERS_ITEMS', 'GOLD_DIM_SUPPLIERS', 'GOLD_MINIMUM_COST_SUPPLIERS', 'GOLD_DIM_PART_SUPPLIERS']}}
[0m23:28:43.056367 [error] [MainThread]: Encountered an error while running operation: Compilation Error
  'dict object' has no attribute 'lakehouse'
[0m23:28:43.064488 [debug] [MainThread]: Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 82, in macro
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/sandbox.py", line 326, in getattr
    value = getattr(obj, attribute)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 859, in __getattr__
    return self._fail_with_undefined_error()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 852, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'dict object' has no attribute 'lakehouse'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 58, in run
    self._run_unsafe(package_name, macro_name)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 43, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 1112, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 255, in call_macro
    with self.exception_handler():
  File "/usr/lib/python3.11/contextlib.py", line 155, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise CaughtMacroErrorWithNodeError(exc=e, node=self.macro)
dbt.exceptions.CaughtMacroErrorWithNodeError: Compilation Error
  'dict object' has no attribute 'lakehouse'

[0m23:28:43.066671 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.32378528, "process_user_time": 1.302026, "process_kernel_time": 0.083701, "process_mem_max_rss": "106660", "process_in_blocks": "216", "process_out_blocks": "2432", "command_success": false}
[0m23:28:43.067412 [debug] [MainThread]: Command `dbt run-operation` failed at 23:28:43.067233 after 0.32 seconds
[0m23:28:43.067898 [debug] [MainThread]: Connection 'macro_drop_orphaned_tables_and_views' was properly closed.
[0m23:28:43.068124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63862f350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6387d4510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6387d4690>]}
[0m23:28:43.068383 [debug] [MainThread]: Flushing usage events
[0m23:31:23.599421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f890aa64e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f890aa646d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f890aa66a10>]}


============================== 23:31:23.601715 | 482fa391-0643-49aa-8010-310e3154d582 ==============================
[0m23:31:23.601715 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:31:23.602172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:31:23.759852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '482fa391-0643-49aa-8010-310e3154d582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f890a81c9d0>]}
[0m23:31:23.829300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '482fa391-0643-49aa-8010-310e3154d582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f890a813a10>]}
[0m23:31:23.829926 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m23:31:23.841595 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:31:23.864405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:31:23.864953 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views.sql
[0m23:31:23.886052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '482fa391-0643-49aa-8010-310e3154d582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f890a59b9d0>]}
[0m23:31:23.908786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '482fa391-0643-49aa-8010-310e3154d582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f890a66a190>]}
[0m23:31:23.909433 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m23:31:23.909938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '482fa391-0643-49aa-8010-310e3154d582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f890a8ec190>]}
[0m23:31:23.911949 [debug] [MainThread]: Acquiring new trino connection 'macro_drop_orphaned_tables_and_views'
[0m23:31:23.912575 [debug] [MainThread]: On macro_drop_orphaned_tables_and_views: COMMIT
[0m23:31:23.922839 [debug] [MainThread]: {'LAKEHOUSE': {'DBT': ['SILVER_PARTS_SUPPLIERS', 'SILVER_ORDER_ITEMS', 'BRONZE_TPCH__REGION', 'BRONZE_TPCH__NATION', 'BRONZE_TPCH__CUSTOMERS', 'BRONZE_TPCH__PART', 'BRONZE_TPCH__LINE_ITEM', 'BRONZE_TPCH__SUPPLIER', 'BRONZE_TPCH__PART_SUPPLIERS', 'BRONZE_TPCH__ORDERS', 'ORDERS_SNAPSHOT', 'GOLD_PRICING_SUMMARY_REPORT', 'GOLD_FCT_ORDERS_ITEMS', 'GOLD_DIM_SUPPLIERS', 'GOLD_MINIMUM_COST_SUPPLIERS', 'GOLD_DIM_PART_SUPPLIERS']}}
[0m23:31:23.939822 [debug] [MainThread]: Using trino connection "macro_drop_orphaned_tables_and_views"
[0m23:31:23.941698 [debug] [MainThread]: On macro_drop_orphaned_tables_and_views: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "macro_drop_orphaned_tables_and_views"} */

    WITH models_to_drop AS (
		
		  SELECT
		  
			CASE
			
			  WHEN table_type = 'BASE TABLE' THEN 'TABLE'
			  
			  WHEN table_type = 'VIEW' THEN 'VIEW'
			  
			  ELSE NULL
			END AS relation_type,
			table_catalog,
			table_schema,
			table_name,
			table_catalog || '.' || table_schema || '.' || table_name AS relation_name
		  FROM SYSTEM.METADATA.TABELLEN
		  WHERE
			LOWER(table_schema) IN ('lakehouse')
			AND NOT (
			  FOREACH (schema IN current_model_locations.lakehouse.keys()) :
				LOWER(table_schema) = LOWER('{'default__test_relationships': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b6d0>, 'default__test_not_null': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b950>, 'default__test_accepted_values': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b810>, 'default__test_unique': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66ba10>, 'last_day': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66ba90>, 'default_last_day': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66bad0>, 'default__last_day': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b710>, 'array_append': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b9d0>, 'default__array_append': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66bb50>, 'bool_or': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66bbd0>, 'default__bool_or': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66bc10>, 'intersect': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66bc90>, 'default__intersect': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66bcd0>, 'concat': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66bc50>, 'default__concat': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b910>, 'dateadd': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668050>, 'default__dateadd': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66be50>, 'get_powers_of_two': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66bdd0>, 'default__get_powers_of_two': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66be10>, 'generate_series': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66be90>, 'default__generate_series': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66bed0>, 'escape_single_quotes': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66bd50>, 'default__escape_single_quotes': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66bf50>, 'except': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66bfd0>, 'default__except': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66bd10>, 'listagg': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66bf10>, 'default__listagg': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668810>, 'cast_bool_to_text': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668410>, 'default__cast_bool_to_text': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668350>, 'date_trunc': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668150>, 'default__date_trunc': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6680d0>, 'array_concat': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668110>, 'default__array_concat': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669590>, 'position': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668190>, 'default__position': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6682d0>, 'safe_cast': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6681d0>, 'default__safe_cast': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6684d0>, 'array_construct': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668310>, 'default__array_construct': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668390>, 'string_literal': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668250>, 'default__string_literal': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6683d0>, 'right': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668510>, 'default__right': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668450>, 'split_part': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668850>, 'default__split_part': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6686d0>, '_split_part_negative': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668590>, 'replace': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668550>, 'default__replace': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668750>, 'get_intervals_between': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668210>, 'default__get_intervals_between': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668650>, 'date_spine': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668710>, 'default__date_spine': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6688d0>, 'datediff': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6685d0>, 'default__datediff': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6687d0>, 'any_value': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668950>, 'default__any_value': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669150>, 'hash': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668990>, 'default__hash': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668910>, 'length': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668790>, 'default__length': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6689d0>, 'type_string': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668b90>, 'default__type_string': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668610>, 'type_timestamp': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668a90>, 'default__type_timestamp': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669d90>, 'type_float': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668b50>, 'default__type_float': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668bd0>, 'type_numeric': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668c10>, 'default__type_numeric': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668c90>, 'type_bigint': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668d90>, 'default__type_bigint': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668b10>, 'type_int': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668dd0>, 'default__type_int': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668d50>, 'type_boolean': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669110>, 'default__type_boolean': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668fd0>, 'generate_alias_name': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668e10>, 'default__generate_alias_name': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668f50>, 'generate_schema_name': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668d10>, 'default__generate_schema_name': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668f90>, 'generate_schema_name_for_env': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668e90>, 'generate_database_name': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668a10>, 'default__generate_database_name': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669010>, 'resolve_model_name': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668c50>, 'default__resolve_model_name': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668f10>, 'build_ref_function': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669190>, 'build_source_function': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669a50>, 'build_config_dict': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669090>, 'py_script_postfix': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669510>, 'py_script_comment': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6691d0>, 'statement': <dbt.clients.jinja.MacroGenerator object at 0x7f890a668e50>, 'noop_statement': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669290>, 'run_query': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669390>, 'convert_datetime': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669310>, 'dates_in_range': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669210>, 'partition_range': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669350>, 'py_current_timestring': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669410>, 'copy_grants': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669050>, 'default__copy_grants': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669490>, 'support_multiple_grantees_per_dcl_statement': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669550>, 'default__support_multiple_grantees_per_dcl_statement': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669250>, 'should_revoke': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669610>, 'get_show_grant_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6693d0>, 'default__get_show_grant_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669a10>, 'get_grant_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669690>, 'default__get_grant_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669790>, 'get_revoke_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669710>, 'default__get_revoke_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669750>, 'get_dcl_statement_list': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6695d0>, 'default__get_dcl_statement_list': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669450>, 'call_dcl_statements': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669810>, 'default__call_dcl_statements': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6698d0>, 'apply_grants': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6699d0>, 'default__apply_grants': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669950>, 'make_intermediate_relation': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6697d0>, 'default__make_intermediate_relation': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669ad0>, 'make_temp_relation': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669e10>, 'default__make_temp_relation': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669650>, 'make_backup_relation': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669990>, 'default__make_backup_relation': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669b50>, 'truncate_relation': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669b90>, 'default__truncate_relation': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669c10>, 'get_or_create_relation': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669850>, 'default__get_or_create_relation': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669c50>, 'load_cached_relation': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669bd0>, 'load_relation': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669dd0>, 'get_columns_in_relation': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669d50>, 'default__get_columns_in_relation': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669e50>, 'sql_convert_columns_in_relation': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669cd0>, 'get_empty_subquery_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669e90>, 'default__get_empty_subquery_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a4b4b10>, 'get_empty_schema_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a4b4cd0>, 'default__get_empty_schema_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a4b4fd0>, 'get_column_schema_from_query': <dbt.clients.jinja.MacroGenerator object at 0x7f890a4b7a10>, 'get_columns_in_query': <dbt.clients.jinja.MacroGenerator object at 0x7f890a4b4250>, 'default__get_columns_in_query': <dbt.clients.jinja.MacroGenerator object at 0x7f890a4b4ed0>, 'alter_column_type': <dbt.clients.jinja.MacroGenerator object at 0x7f890a4b5190>, 'default__alter_column_type': <dbt.clients.jinja.MacroGenerator object at 0x7f890a4b5450>, 'alter_relation_add_remove_columns': <dbt.clients.jinja.MacroGenerator object at 0x7f890a507d90>, 'default__alter_relation_add_remove_columns': <dbt.clients.jinja.MacroGenerator object at 0x7f890a507e50>, 'get_catalog_relations': <dbt.clients.jinja.MacroGenerator object at 0x7f890a5042d0>, 'default__get_catalog_relations': <dbt.clients.jinja.MacroGenerator object at 0x7f890a507f90>, 'get_catalog': <dbt.clients.jinja.MacroGenerator object at 0x7f890a507790>, 'default__get_catalog': <dbt.clients.jinja.MacroGenerator object at 0x7f890a5079d0>, 'information_schema_name': <dbt.clients.jinja.MacroGenerator object at 0x7f890a507990>, 'default__information_schema_name': <dbt.clients.jinja.MacroGenerator object at 0x7f890a504890>, 'list_schemas': <dbt.clients.jinja.MacroGenerator object at 0x7f890a507fd0>, 'default__list_schemas': <dbt.clients.jinja.MacroGenerator object at 0x7f890a507e10>, 'check_schema_exists': <dbt.clients.jinja.MacroGenerator object at 0x7f890a507dd0>, 'default__check_schema_exists': <dbt.clients.jinja.MacroGenerator object at 0x7f890a507c90>, 'list_relations_without_caching': <dbt.clients.jinja.MacroGenerator object at 0x7f890a5044d0>, 'default__list_relations_without_caching': <dbt.clients.jinja.MacroGenerator object at 0x7f890a507e90>, 'get_relations': <dbt.clients.jinja.MacroGenerator object at 0x7f890a507b90>, 'default__get_relations': <dbt.clients.jinja.MacroGenerator object at 0x7f890a505d50>, 'get_relation_last_modified': <dbt.clients.jinja.MacroGenerator object at 0x7f890a504290>, 'default__get_relation_last_modified': <dbt.clients.jinja.MacroGenerator object at 0x7f890a504550>, 'get_show_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a504310>, 'get_limit_subquery_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a505890>, 'default__get_limit_subquery_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a505b50>, 'alter_column_comment': <dbt.clients.jinja.MacroGenerator object at 0x7f890a5060d0>, 'default__alter_column_comment': <dbt.clients.jinja.MacroGenerator object at 0x7f890a505250>, 'alter_relation_comment': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506050>, 'default__alter_relation_comment': <dbt.clients.jinja.MacroGenerator object at 0x7f890a505110>, 'persist_docs': <dbt.clients.jinja.MacroGenerator object at 0x7f890a504c90>, 'default__persist_docs': <dbt.clients.jinja.MacroGenerator object at 0x7f890a505750>, 'current_timestamp': <dbt.clients.jinja.MacroGenerator object at 0x7f890a505cd0>, 'default__current_timestamp': <dbt.clients.jinja.MacroGenerator object at 0x7f890a5046d0>, 'snapshot_get_time': <dbt.clients.jinja.MacroGenerator object at 0x7f890a504a90>, 'default__snapshot_get_time': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506290>, 'current_timestamp_backcompat': <dbt.clients.jinja.MacroGenerator object at 0x7f890a504c50>, 'default__current_timestamp_backcompat': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506350>, 'current_timestamp_in_utc_backcompat': <dbt.clients.jinja.MacroGenerator object at 0x7f890a505b10>, 'default__current_timestamp_in_utc_backcompat': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506490>, 'get_create_index_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a5058d0>, 'default__get_create_index_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506590>, 'create_indexes': <dbt.clients.jinja.MacroGenerator object at 0x7f890a505710>, 'default__create_indexes': <dbt.clients.jinja.MacroGenerator object at 0x7f890a5066d0>, 'get_drop_index_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a505a50>, 'default__get_drop_index_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a5068d0>, 'get_show_indexes_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a505c90>, 'default__get_show_indexes_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506510>, 'collect_freshness': <dbt.clients.jinja.MacroGenerator object at 0x7f890a505e50>, 'default__collect_freshness': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506b50>, 'create_schema': <dbt.clients.jinja.MacroGenerator object at 0x7f890a504a50>, 'default__create_schema': <dbt.clients.jinja.MacroGenerator object at 0x7f890a504d10>, 'drop_schema': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506bd0>, 'default__drop_schema': <dbt.clients.jinja.MacroGenerator object at 0x7f890a505a90>, 'validate_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506950>, 'default__validate_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a505290>, 'get_create_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506e10>, 'default__get_create_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a5056d0>, 'get_rename_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506fd0>, 'default__get_rename_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a505910>, 'rename_relation': <dbt.clients.jinja.MacroGenerator object at 0x7f890a505850>, 'default__rename_relation': <dbt.clients.jinja.MacroGenerator object at 0x7f890a5054d0>, 'get_create_backup_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a507110>, 'default__get_create_backup_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a507210>, 'get_create_intermediate_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506b90>, 'default__get_create_intermediate_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a507510>, 'get_drop_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a5071d0>, 'default__get_drop_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a507750>, 'drop_relation': <dbt.clients.jinja.MacroGenerator object at 0x7f890a507410>, 'default__drop_relation': <dbt.clients.jinja.MacroGenerator object at 0x7f890a507590>, 'drop_relation_if_exists': <dbt.clients.jinja.MacroGenerator object at 0x7f890a507c50>, 'get_rename_intermediate_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a505950>, 'default__get_rename_intermediate_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a505f10>, 'get_drop_backup_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a505c50>, 'default__get_drop_backup_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506190>, 'get_replace_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a505e90>, 'default__get_replace_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506390>, 'get_create_view_as_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506090>, 'default__get_create_view_as_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506690>, 'create_view_as': <dbt.clients.jinja.MacroGenerator object at 0x7f890a505ed0>, 'default__create_view_as': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506910>, 'get_rename_view_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506550>, 'default__get_rename_view_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506710>, 'drop_view': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506790>, 'default__drop_view': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506dd0>, 'get_replace_view_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506b10>, 'default__get_replace_view_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a507010>, 'create_or_replace_view': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66add0>, 'handle_existing_table': <dbt.clients.jinja.MacroGenerator object at 0x7f890a507310>, 'default__handle_existing_table': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506f90>, 'get_table_columns_and_constraints': <dbt.clients.jinja.MacroGenerator object at 0x7f890a507550>, 'default__get_table_columns_and_constraints': <dbt.clients.jinja.MacroGenerator object at 0x7f890a5075d0>, 'table_columns_and_constraints': <dbt.clients.jinja.MacroGenerator object at 0x7f890a507390>, 'get_assert_columns_equivalent': <dbt.clients.jinja.MacroGenerator object at 0x7f890a507810>, 'default__get_assert_columns_equivalent': <dbt.clients.jinja.MacroGenerator object at 0x7f890a507a10>, 'assert_columns_equivalent': <dbt.clients.jinja.MacroGenerator object at 0x7f890a507a50>, 'format_columns': <dbt.clients.jinja.MacroGenerator object at 0x7f890a505d10>, 'default__format_column': <dbt.clients.jinja.MacroGenerator object at 0x7f890a505ad0>, 'get_create_materialized_view_as_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a505f50>, 'default__get_create_materialized_view_as_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a5062d0>, 'get_rename_materialized_view_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506150>, 'default__get_rename_materialized_view_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506110>, 'drop_materialized_view': <dbt.clients.jinja.MacroGenerator object at 0x7f890a5064d0>, 'default__drop_materialized_view': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506750>, 'refresh_materialized_view': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506310>, 'default__refresh_materialized_view': <dbt.clients.jinja.MacroGenerator object at 0x7f890a5069d0>, 'get_replace_materialized_view_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506990>, 'default__get_replace_materialized_view_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506d10>, 'get_alter_materialized_view_as_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506c10>, 'default__get_alter_materialized_view_as_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506f50>, 'get_materialized_view_configuration_changes': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506f10>, 'default__get_materialized_view_configuration_changes': <dbt.clients.jinja.MacroGenerator object at 0x7f890a506d90>, 'get_create_table_as_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a507150>, 'default__get_create_table_as_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a505310>, 'create_table_as': <dbt.clients.jinja.MacroGenerator object at 0x7f890a687fd0>, 'default__create_table_as': <dbt.clients.jinja.MacroGenerator object at 0x7f890a687e50>, 'default__get_column_names': <dbt.clients.jinja.MacroGenerator object at 0x7f890a687dd0>, 'get_select_subquery': <dbt.clients.jinja.MacroGenerator object at 0x7f890a687cd0>, 'default__get_select_subquery': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6857d0>, 'get_rename_table_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685850>, 'default__get_rename_table_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6843d0>, 'drop_table': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6840d0>, 'default__drop_table': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684050>, 'get_replace_table_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6845d0>, 'default__get_replace_table_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684150>, 'set_sql_header': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684190>, 'should_full_refresh': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684210>, 'should_store_failures': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684250>, 'run_hooks': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6842d0>, 'make_hook_config': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6841d0>, 'before_begin': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684350>, 'in_transaction': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684390>, 'after_commit': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684410>, 'materialization_table_default': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684450>, 'materialization_materialized_view_default': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684090>, 'materialized_view_setup': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684e10>, 'materialized_view_teardown': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684610>, 'materialized_view_get_build_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684590>, 'materialized_view_execute_no_op': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684550>, 'materialized_view_execute_build_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684650>, 'materialization_view_default': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6844d0>, 'can_clone_table': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6847d0>, 'default__can_clone_table': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6846d0>, 'materialization_clone_default': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684790>, 'create_or_replace_clone': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684750>, 'default__create_or_replace_clone': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684810>, 'incremental_validate_on_schema_change': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684290>, 'check_for_schema_changes': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684490>, 'sync_column_schemas': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6848d0>, 'process_schema_changes': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6849d0>, 'get_incremental_append_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684990>, 'default__get_incremental_append_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684950>, 'get_incremental_delete_insert_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684b90>, 'default__get_incremental_delete_insert_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684850>, 'get_incremental_merge_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684a50>, 'default__get_incremental_merge_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684690>, 'get_incremental_insert_overwrite_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684ad0>, 'default__get_incremental_insert_overwrite_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684bd0>, 'get_incremental_default_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684b50>, 'default__get_incremental_default_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684a10>, 'get_insert_into_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684c10>, 'is_incremental': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684c50>, 'materialization_incremental_default': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684890>, 'get_quoted_csv': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684d10>, 'diff_columns': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6855d0>, 'diff_column_data_types': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684e90>, 'get_merge_update_columns': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684dd0>, 'default__get_merge_update_columns': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684e50>, 'get_merge_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684a90>, 'default__get_merge_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684f10>, 'get_delete_insert_merge_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684d90>, 'default__get_delete_insert_merge_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684f90>, 'get_insert_overwrite_merge_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685050>, 'default__get_insert_overwrite_merge_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684fd0>, 'create_csv_table': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685090>, 'default__create_csv_table': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684c90>, 'reset_csv_table': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685010>, 'default__reset_csv_table': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685250>, 'get_csv_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6851d0>, 'default__get_csv_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685290>, 'get_binding_char': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685210>, 'default__get_binding_char': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685610>, 'get_batch_size': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6852d0>, 'default__get_batch_size': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685150>, 'get_seed_column_quoted_csv': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685350>, 'load_csv_rows': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685450>, 'default__load_csv_rows': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6853d0>, 'materialization_seed_default': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685410>, 'get_where_subquery': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685490>, 'default__get_where_subquery': <dbt.clients.jinja.MacroGenerator object at 0x7f890a684ed0>, 'materialization_test_default': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6850d0>, 'get_test_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685550>, 'default__get_test_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685650>, 'strategy_dispatch': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685ed0>, 'snapshot_hash_arguments': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685310>, 'default__snapshot_hash_arguments': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6854d0>, 'snapshot_timestamp_strategy': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6856d0>, 'snapshot_string_as_time': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685750>, 'default__snapshot_string_as_time': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685510>, 'snapshot_check_all_get_existing_columns': <dbt.clients.jinja.MacroGenerator object at 0x7f890a6858d0>, 'snapshot_check_strategy': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685a90>, 'materialization_snapshot_default': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685810>, 'snapshot_merge_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685a50>, 'default__snapshot_merge_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685ad0>, 'create_columns': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685710>, 'default__create_columns': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685f10>, 'post_snapshot': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685b90>, 'default__post_snapshot': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685a10>, 'get_true_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685c50>, 'default__get_true_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685cd0>, 'snapshot_staging_table': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685d10>, 'default__snapshot_staging_table': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685e90>, 'build_snapshot_table': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685e10>, 'default__build_snapshot_table': <dbt.clients.jinja.MacroGenerator object at 0x7f890a686710>, 'build_snapshot_staging_table': <dbt.clients.jinja.MacroGenerator object at 0x7f890a685fd0>, 'test_unique': <dbt.clients.jinja.MacroGenerator object at 0x7f890a686050>, 'test_not_null': <dbt.clients.jinja.MacroGenerator object at 0x7f890a686250>, 'test_accepted_values': <dbt.clients.jinja.MacroGenerator object at 0x7f890a686290>, 'test_relationships': <dbt.clients.jinja.MacroGenerator object at 0x7f890a686150>, 'trino__get_show_grant_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66a650>, 'trino__copy_grants': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66a010>, 'trino__get_grant_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669fd0>, 'trino__support_multiple_grantees_per_dcl_statement': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66a310>, 'trino__call_dcl_statements': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66a850>, 'trino__get_catalog': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66a510>, 'trino__get_catalog_relations': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66a590>, 'trino__get_catalog_tables_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66aa90>, 'trino__get_catalog_columns_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66a8d0>, 'trino__get_catalog_table_comment_schemas_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a669f90>, 'trino__get_catalog_table_comment_relations_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66a190>, 'trino__get_catalog_results_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66a890>, 'trino__get_catalog_schemas_where_clause_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66a810>, 'trino__get_catalog_relations_where_clause_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66aa50>, 'trino__get_columns_in_relation': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66a9d0>, 'trino__list_relations_without_caching': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66a7d0>, 'trino__reset_csv_table': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66a490>, 'trino__create_csv_table': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66a090>, 'properties': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66a2d0>, 'comment': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b010>, 'trino__create_table_as': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66aa10>, 'trino__create_view_as': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66a4d0>, 'trino__get_drop_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b110>, 'trino__information_schema_name': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66ab90>, 'trino__drop_schema': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66ac10>, 'trino__rename_relation': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66a950>, 'trino__alter_relation_comment': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66a6d0>, 'trino__alter_column_comment': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66aad0>, 'trino__list_schemas': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66ac50>, 'trino__check_schema_exists': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66acd0>, 'trino__get_binding_char': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66ad10>, 'trino__alter_relation_add_remove_columns': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66ac90>, 'trino__alter_column_type': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66aed0>, 'trino__array_append': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66ae50>, 'trino__bool_or': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66ae90>, 'trino__dateadd': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66af10>, 'trino__listagg': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66a910>, 'trino__date_trunc': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66ab10>, 'trino__array_concat': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b890>, 'trino__safe_cast': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b150>, 'trino__array_construct': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b090>, 'trino__right': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b0d0>, 'trino__split_part': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66af50>, 'trino__current_timestamp': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66ad50>, 'trino__snapshot_string_as_time': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b210>, 'trino__date_spine': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b310>, 'trino__datediff': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b290>, 'trino__any_value': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b390>, 'trino__type_float': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b190>, 'trino__type_string': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b2d0>, 'trino__type_numeric': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b3d0>, 'trino__type_int': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b1d0>, 'trino__hash': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66af90>, 'materialization_snapshot_trino': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b490>, 'trino__snapshot_hash_arguments': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b590>, 'trino__post_snapshot': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b350>, 'trino__snapshot_merge_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b8d0>, 'materialization_table_trino': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b510>, 'trino__get_create_materialized_view_as_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b550>, 'trino__get_replace_materialized_view_as_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b610>, 'trino__get_materialized_view_configuration_changes': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b650>, 'trino__refresh_materialized_view': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b5d0>, 'get_incremental_tmp_relation_type': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b450>, 'materialization_incremental_trino': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b410>, 'trino__get_delete_insert_merge_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b750>, 'trino__get_merge_sql': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b850>, 'materialization_view_trino': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b7d0>, 'trino__get_batch_size': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66b690>, 'create_bindings': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66bb10>, 'trino__load_csv_rows': <dbt.clients.jinja.MacroGenerator object at 0x7f890a66ba50>}')
				  AND LOWER(table_name) IN ('')
			  END FOREACH
			)
		)
		-- Create the DROP statments to be executed in the database
		SELECT
		  'DROP ' || relation_type || ' IF EXISTS ' || table_catalog || '.' || table_schema || '.' || table_name || ';' AS drop_commands
		FROM models_to_drop
		WHERE relation_type IS NOT NULL
[0m23:31:23.943518 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:31:25.208849 [debug] [MainThread]: Trino adapter: Trino query id: 20240110_145542_00032_gb5ar
[0m23:31:25.210143 [debug] [MainThread]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 23:25: mismatched input 'current_model_locations'. Expecting: '('", query_id=20240110_145542_00032_gb5ar)
[0m23:31:25.211197 [debug] [MainThread]: On macro_drop_orphaned_tables_and_views: Close
[0m23:31:25.212545 [error] [MainThread]: Encountered an error while running operation: Database Error
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 23:25: mismatched input 'current_model_locations'. Expecting: '('", query_id=20240110_145542_00032_gb5ar)
[0m23:31:25.223825 [debug] [MainThread]: Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/trino/connections.py", line 430, in exception_handler
    yield
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/trino/connections.py", line 386, in execute
    result = self._cursor.execute(sql, params=bindings)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/trino/dbapi.py", line 592, in execute
    self._iterator = iter(self._query.execute())
                          ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/trino/client.py", line 810, in execute
    self._result.rows += self.fetch()
                         ^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/trino/client.py", line 830, in fetch
    status = self._request.process(response)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/trino/client.py", line 609, in process
    raise self._process_error(response["error"], response.get("id"))
trino.exceptions.TrinoUserError: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 23:25: mismatched input 'current_model_locations'. Expecting: '('", query_id=20240110_145542_00032_gb5ar)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 58, in run
    self._run_unsafe(package_name, macro_name)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 43, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 1112, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 94, in macro
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 33, in macro
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/sql/connections.py", line 138, in execute
    _, cursor = self.add_query(sql, auto_begin)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/trino/connections.py", line 528, in add_query
    connection, cursor = parent.add_query(
                         ^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/sql/connections.py", line 66, in add_query
    with self.exception_handler(sql):
  File "/usr/lib/python3.11/contextlib.py", line 155, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/trino/connections.py", line 441, in exception_handler
    raise DbtDatabaseError(msg)
dbt.exceptions.DbtDatabaseError: Database Error
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 23:25: mismatched input 'current_model_locations'. Expecting: '('", query_id=20240110_145542_00032_gb5ar)

[0m23:31:25.226260 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 1.657084, "process_user_time": 1.517326, "process_kernel_time": 0.092519, "process_mem_max_rss": "108656", "process_in_blocks": "208", "process_out_blocks": "2528", "command_success": false}
[0m23:31:25.226682 [debug] [MainThread]: Command `dbt run-operation` failed at 23:31:25.226590 after 1.66 seconds
[0m23:31:25.226898 [debug] [MainThread]: Connection 'macro_drop_orphaned_tables_and_views' was properly closed.
[0m23:31:25.227267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f890aa6eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f890aa67a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f890aa653d0>]}
[0m23:31:25.227683 [debug] [MainThread]: Flushing usage events
[0m23:39:30.699383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6a29a7950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6a29e7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6a29e7b10>]}


============================== 23:39:30.701369 | 9683da55-1ad5-429f-870d-c823e4530081 ==============================
[0m23:39:30.701369 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:39:30.701738 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:39:30.830359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9683da55-1ad5-429f-870d-c823e4530081', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6a273bd90>]}
[0m23:39:30.886203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9683da55-1ad5-429f-870d-c823e4530081', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6a273bd50>]}
[0m23:39:30.886727 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m23:39:30.893741 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:39:30.914340 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:39:30.914846 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views.sql
[0m23:39:30.929693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9683da55-1ad5-429f-870d-c823e4530081', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6a28acf10>]}
[0m23:39:30.939596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9683da55-1ad5-429f-870d-c823e4530081', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6a2578110>]}
[0m23:39:30.940025 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m23:39:30.940294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9683da55-1ad5-429f-870d-c823e4530081', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6a2794c10>]}
[0m23:39:30.940860 [debug] [MainThread]: Acquiring new trino connection 'macro_drop_orphaned_tables_and_views'
[0m23:39:30.941069 [debug] [MainThread]: On macro_drop_orphaned_tables_and_views: COMMIT
[0m23:39:30.948410 [debug] [MainThread]: {'LAKEHOUSE': {'DBT': ['SILVER_PARTS_SUPPLIERS', 'SILVER_ORDER_ITEMS', 'BRONZE_TPCH__REGION', 'BRONZE_TPCH__NATION', 'BRONZE_TPCH__CUSTOMERS', 'BRONZE_TPCH__PART', 'BRONZE_TPCH__LINE_ITEM', 'BRONZE_TPCH__SUPPLIER', 'BRONZE_TPCH__PART_SUPPLIERS', 'BRONZE_TPCH__ORDERS', 'ORDERS_SNAPSHOT', 'GOLD_PRICING_SUMMARY_REPORT', 'GOLD_FCT_ORDERS_ITEMS', 'GOLD_DIM_SUPPLIERS', 'GOLD_MINIMUM_COST_SUPPLIERS', 'GOLD_DIM_PART_SUPPLIERS']}}
[0m23:39:30.956615 [debug] [MainThread]: Using trino connection "macro_drop_orphaned_tables_and_views"
[0m23:39:30.956848 [debug] [MainThread]: On macro_drop_orphaned_tables_and_views: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "macro_drop_orphaned_tables_and_views"} */

    WITH models_to_drop AS (
		
		  SELECT
		  
			CASE
			
			  WHEN table_type = 'BASE TABLE' THEN 'TABLE'
			  
			  WHEN table_type = 'VIEW' THEN 'VIEW'
			  
			  ELSE NULL
			END AS relation_type,
			table_catalog,
			table_schema,
			table_name,
			table_catalog || '.' || table_schema || '.' || table_name AS relation_name
		  FROM SYSTEM.METADATA.TABELLEN
		  WHERE
			LOWER(table_schema) IN ('lakehouse')
			AND NOT (
			  FOREACH (schema IN current_model_locations.keys()) :
				LOWER(table_schema) = LOWER('dbt')
				  AND LOWER(table_name) IN ('')
			  END FOREACH
			)
		)
		-- Create the DROP statments to be executed in the database
		SELECT
		  'DROP ' || relation_type || ' IF EXISTS ' || table_catalog || '.' || table_schema || '.' || table_name || ';' AS drop_commands
		FROM models_to_drop
		WHERE relation_type IS NOT NULL
[0m23:39:30.957039 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:39:31.806222 [debug] [MainThread]: Trino adapter: Trino query id: 20240110_150311_00033_gb5ar
[0m23:39:31.807297 [debug] [MainThread]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 23:25: mismatched input 'current_model_locations'. Expecting: '('", query_id=20240110_150311_00033_gb5ar)
[0m23:39:31.808267 [debug] [MainThread]: On macro_drop_orphaned_tables_and_views: Close
[0m23:39:31.809841 [error] [MainThread]: Encountered an error while running operation: Database Error
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 23:25: mismatched input 'current_model_locations'. Expecting: '('", query_id=20240110_150311_00033_gb5ar)
[0m23:39:31.813798 [debug] [MainThread]: Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/trino/connections.py", line 430, in exception_handler
    yield
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/trino/connections.py", line 386, in execute
    result = self._cursor.execute(sql, params=bindings)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/trino/dbapi.py", line 592, in execute
    self._iterator = iter(self._query.execute())
                          ^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/trino/client.py", line 810, in execute
    self._result.rows += self.fetch()
                         ^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/trino/client.py", line 830, in fetch
    status = self._request.process(response)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/trino/client.py", line 609, in process
    raise self._process_error(response["error"], response.get("id"))
trino.exceptions.TrinoUserError: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 23:25: mismatched input 'current_model_locations'. Expecting: '('", query_id=20240110_150311_00033_gb5ar)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 58, in run
    self._run_unsafe(package_name, macro_name)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 43, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 1112, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 94, in macro
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 33, in macro
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/sql/connections.py", line 138, in execute
    _, cursor = self.add_query(sql, auto_begin)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/trino/connections.py", line 528, in add_query
    connection, cursor = parent.add_query(
                         ^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/sql/connections.py", line 66, in add_query
    with self.exception_handler(sql):
  File "/usr/lib/python3.11/contextlib.py", line 155, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/trino/connections.py", line 441, in exception_handler
    raise DbtDatabaseError(msg)
dbt.exceptions.DbtDatabaseError: Database Error
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 23:25: mismatched input 'current_model_locations'. Expecting: '('", query_id=20240110_150311_00033_gb5ar)

[0m23:39:31.816019 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 1.1432922, "process_user_time": 1.319299, "process_kernel_time": 0.129162, "process_mem_max_rss": "107800", "process_out_blocks": "2448", "command_success": false, "process_in_blocks": "0"}
[0m23:39:31.816470 [debug] [MainThread]: Command `dbt run-operation` failed at 23:39:31.816354 after 1.14 seconds
[0m23:39:31.816758 [debug] [MainThread]: Connection 'macro_drop_orphaned_tables_and_views' was properly closed.
[0m23:39:31.817216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6a2996d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6a2997f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6a2747b90>]}
[0m23:39:31.817827 [debug] [MainThread]: Flushing usage events
[0m23:42:05.815562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6afc60fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6afaabf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6afc50a50>]}


============================== 23:42:05.817600 | db69cd04-0a00-4f91-8227-0a4a15701f7a ==============================
[0m23:42:05.817600 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:42:05.818015 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:42:05.953056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db69cd04-0a00-4f91-8227-0a4a15701f7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6afab16d0>]}
[0m23:42:06.018872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db69cd04-0a00-4f91-8227-0a4a15701f7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6af9ffb90>]}
[0m23:42:06.019407 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m23:42:06.028444 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:42:06.051725 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:42:06.052242 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views.sql
[0m23:42:06.070730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db69cd04-0a00-4f91-8227-0a4a15701f7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6af9216d0>]}
[0m23:42:06.081386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db69cd04-0a00-4f91-8227-0a4a15701f7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6af7a9b50>]}
[0m23:42:06.081814 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m23:42:06.082183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db69cd04-0a00-4f91-8227-0a4a15701f7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6afc50f50>]}
[0m23:42:06.082918 [debug] [MainThread]: Acquiring new trino connection 'macro_drop_orphaned_tables_and_views'
[0m23:42:06.083161 [debug] [MainThread]: On macro_drop_orphaned_tables_and_views: COMMIT
[0m23:42:06.096105 [debug] [MainThread]: {'LAKEHOUSE': {'DBT': ['SILVER_PARTS_SUPPLIERS', 'SILVER_ORDER_ITEMS', 'BRONZE_TPCH__REGION', 'BRONZE_TPCH__NATION', 'BRONZE_TPCH__CUSTOMERS', 'BRONZE_TPCH__PART', 'BRONZE_TPCH__LINE_ITEM', 'BRONZE_TPCH__SUPPLIER', 'BRONZE_TPCH__PART_SUPPLIERS', 'BRONZE_TPCH__ORDERS', 'ORDERS_SNAPSHOT', 'GOLD_PRICING_SUMMARY_REPORT', 'GOLD_FCT_ORDERS_ITEMS', 'GOLD_DIM_SUPPLIERS', 'GOLD_MINIMUM_COST_SUPPLIERS', 'GOLD_DIM_PART_SUPPLIERS']}}
[0m23:42:06.097351 [error] [MainThread]: Encountered an error while running operation: Compilation Error
  'dict object' has no attribute 'lakehouse'
[0m23:42:06.099386 [debug] [MainThread]: Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 83, in macro
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/sandbox.py", line 326, in getattr
    value = getattr(obj, attribute)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 859, in __getattr__
    return self._fail_with_undefined_error()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 852, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'dict object' has no attribute 'lakehouse'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 58, in run
    self._run_unsafe(package_name, macro_name)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 43, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 1112, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 255, in call_macro
    with self.exception_handler():
  File "/usr/lib/python3.11/contextlib.py", line 155, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise CaughtMacroErrorWithNodeError(exc=e, node=self.macro)
dbt.exceptions.CaughtMacroErrorWithNodeError: Compilation Error
  'dict object' has no attribute 'lakehouse'

[0m23:42:06.100637 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.31608883, "process_user_time": 1.300598, "process_kernel_time": 0.110689, "process_mem_max_rss": "106576", "process_out_blocks": "2440", "command_success": false, "process_in_blocks": "0"}
[0m23:42:06.101103 [debug] [MainThread]: Command `dbt run-operation` failed at 23:42:06.100990 after 0.32 seconds
[0m23:42:06.101345 [debug] [MainThread]: Connection 'macro_drop_orphaned_tables_and_views' was properly closed.
[0m23:42:06.101595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6afaaae90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6af845a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6af5b7f90>]}
[0m23:42:06.101997 [debug] [MainThread]: Flushing usage events
[0m23:50:03.557668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac5f1dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac5d7f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac5f2dc90>]}


============================== 23:50:03.559521 | 791460a3-5056-4bfe-b417-84b8a4091988 ==============================
[0m23:50:03.559521 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:50:03.559990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:50:03.693447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '791460a3-5056-4bfe-b417-84b8a4091988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac5d71610>]}
[0m23:50:03.751905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '791460a3-5056-4bfe-b417-84b8a4091988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac5d64090>]}
[0m23:50:03.752368 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m23:50:03.760115 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:50:03.779789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:50:03.780236 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views.sql
[0m23:50:03.783871 [error] [MainThread]: Encountered an error:
Compilation Error
  expected token ':', got '}'
    line 37
      {% do current_model_locations.update({database_name: {'lakehouse'}}) -%}
[0m23:50:03.784675 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.25363085, "process_user_time": 1.306223, "process_kernel_time": 0.03732, "process_mem_max_rss": "103988", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m23:50:03.785067 [debug] [MainThread]: Command `dbt run-operation` failed at 23:50:03.784978 after 0.25 seconds
[0m23:50:03.785316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac5f2d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9aca4d74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac7541f90>]}
[0m23:50:03.785552 [debug] [MainThread]: Flushing usage events
[0m00:01:40.866077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facb7433ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facb84546d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facb7f76250>]}


============================== 00:01:40.868116 | f2f456d9-662d-4147-8e11-c08cf09fe5d9 ==============================
[0m00:01:40.868116 [info ] [MainThread]: Running with dbt=1.7.4
[0m00:01:40.868512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views', 'send_anonymous_usage_stats': 'True'}
[0m00:01:41.001044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2f456d9-662d-4147-8e11-c08cf09fe5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facb71bc890>]}
[0m00:01:41.056663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2f456d9-662d-4147-8e11-c08cf09fe5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facb7282910>]}
[0m00:01:41.057136 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m00:01:41.064274 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m00:01:41.083793 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:01:41.084263 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views.sql
[0m00:01:41.099649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2f456d9-662d-4147-8e11-c08cf09fe5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facb7418d10>]}
[0m00:01:41.108862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2f456d9-662d-4147-8e11-c08cf09fe5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facb711c390>]}
[0m00:01:41.109248 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m00:01:41.109520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2f456d9-662d-4147-8e11-c08cf09fe5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facb71e86d0>]}
[0m00:01:41.110114 [debug] [MainThread]: Acquiring new trino connection 'macro_drop_orphaned_tables_and_views'
[0m00:01:41.110326 [debug] [MainThread]: On macro_drop_orphaned_tables_and_views: COMMIT
[0m00:01:41.118409 [error] [MainThread]: Encountered an error while running operation: Compilation Error
  'lakehouse' is undefined
[0m00:01:41.119982 [debug] [MainThread]: Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 66, in macro
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/sandbox.py", line 326, in getattr
    value = getattr(obj, attribute)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 859, in __getattr__
    return self._fail_with_undefined_error()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 852, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'lakehouse' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 58, in run
    self._run_unsafe(package_name, macro_name)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 43, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 1112, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 255, in call_macro
    with self.exception_handler():
  File "/usr/lib/python3.11/contextlib.py", line 155, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise CaughtMacroErrorWithNodeError(exc=e, node=self.macro)
dbt.exceptions.CaughtMacroErrorWithNodeError: Compilation Error
  'lakehouse' is undefined

[0m00:01:41.121009 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.28293952, "process_user_time": 1.290615, "process_kernel_time": 0.110624, "process_mem_max_rss": "106908", "process_out_blocks": "2440", "command_success": false, "process_in_blocks": "0"}
[0m00:01:41.121348 [debug] [MainThread]: Command `dbt run-operation` failed at 00:01:41.121265 after 0.28 seconds
[0m00:01:41.121553 [debug] [MainThread]: Connection 'macro_drop_orphaned_tables_and_views' was properly closed.
[0m00:01:41.121749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facb7407ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facb71f3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facb7782c10>]}
[0m00:01:41.121969 [debug] [MainThread]: Flushing usage events
[0m00:03:57.110238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d88dba550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d88dbb150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d88dba990>]}


============================== 00:03:57.112027 | 2d144ce5-3b19-4e05-b68b-eaef88125201 ==============================
[0m00:03:57.112027 [info ] [MainThread]: Running with dbt=1.7.4
[0m00:03:57.112417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:03:57.241326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d144ce5-3b19-4e05-b68b-eaef88125201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d88bb0ed0>]}
[0m00:03:57.297740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d144ce5-3b19-4e05-b68b-eaef88125201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d8949b890>]}
[0m00:03:57.298202 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m00:03:57.305238 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m00:03:57.324071 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:03:57.325326 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views.sql
[0m00:03:57.339529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d144ce5-3b19-4e05-b68b-eaef88125201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d88b97a50>]}
[0m00:03:57.348320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d144ce5-3b19-4e05-b68b-eaef88125201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d889a9650>]}
[0m00:03:57.348664 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m00:03:57.348919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d144ce5-3b19-4e05-b68b-eaef88125201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d88be13d0>]}
[0m00:03:57.349570 [debug] [MainThread]: Acquiring new trino connection 'macro_drop_orphaned_tables_and_views'
[0m00:03:57.349784 [debug] [MainThread]: On macro_drop_orphaned_tables_and_views: COMMIT
[0m00:03:57.357704 [error] [MainThread]: Encountered an error while running operation: Compilation Error
  'str object' has no attribute 'update'
[0m00:03:57.359291 [debug] [MainThread]: Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 65, in macro
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/sandbox.py", line 391, in call
    if not __self.is_safe_callable(__obj):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/sandbox.py", line 275, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 859, in __getattr__
    return self._fail_with_undefined_error()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 852, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'str object' has no attribute 'update'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 58, in run
    self._run_unsafe(package_name, macro_name)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 43, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 1112, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 255, in call_macro
    with self.exception_handler():
  File "/usr/lib/python3.11/contextlib.py", line 155, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise CaughtMacroErrorWithNodeError(exc=e, node=self.macro)
dbt.exceptions.CaughtMacroErrorWithNodeError: Compilation Error
  'str object' has no attribute 'update'

[0m00:03:57.360217 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.2770492, "process_user_time": 1.299153, "process_kernel_time": 0.046398, "process_mem_max_rss": "106860", "process_out_blocks": "2432", "command_success": false, "process_in_blocks": "0"}
[0m00:03:57.360545 [debug] [MainThread]: Command `dbt run-operation` failed at 00:03:57.360465 after 0.28 seconds
[0m00:03:57.360757 [debug] [MainThread]: Connection 'macro_drop_orphaned_tables_and_views' was properly closed.
[0m00:03:57.360952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d889a8ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d889a9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d8d377610>]}
[0m00:03:57.361165 [debug] [MainThread]: Flushing usage events
[0m00:06:55.378914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0784cc7090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0784b175d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0785155b10>]}


============================== 00:06:55.380734 | 3ec7cffc-4aa7-437a-b56d-47cc8f378bec ==============================
[0m00:06:55.380734 [info ] [MainThread]: Running with dbt=1.7.4
[0m00:06:55.381110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:06:55.513217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ec7cffc-4aa7-437a-b56d-47cc8f378bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07848f7650>]}
[0m00:06:55.569316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ec7cffc-4aa7-437a-b56d-47cc8f378bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0784cb4f50>]}
[0m00:06:55.569756 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m00:06:55.577527 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m00:06:55.596292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:06:55.596753 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views.sql
[0m00:06:55.611506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ec7cffc-4aa7-437a-b56d-47cc8f378bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07850d7590>]}
[0m00:06:55.620377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ec7cffc-4aa7-437a-b56d-47cc8f378bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f078480b010>]}
[0m00:06:55.620736 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m00:06:55.621039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ec7cffc-4aa7-437a-b56d-47cc8f378bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0784a47750>]}
[0m00:06:55.621612 [debug] [MainThread]: Acquiring new trino connection 'macro_drop_orphaned_tables_and_views'
[0m00:06:55.621811 [debug] [MainThread]: On macro_drop_orphaned_tables_and_views: COMMIT
[0m00:06:55.629321 [error] [MainThread]: Encountered an error while running operation: Compilation Error
  'lakehouse' is undefined
[0m00:06:55.630751 [debug] [MainThread]: Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 66, in macro
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/sandbox.py", line 326, in getattr
    value = getattr(obj, attribute)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 859, in __getattr__
    return self._fail_with_undefined_error()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 852, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'lakehouse' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 58, in run
    self._run_unsafe(package_name, macro_name)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 43, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 1112, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 255, in call_macro
    with self.exception_handler():
  File "/usr/lib/python3.11/contextlib.py", line 155, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise CaughtMacroErrorWithNodeError(exc=e, node=self.macro)
dbt.exceptions.CaughtMacroErrorWithNodeError: Compilation Error
  'lakehouse' is undefined

[0m00:06:55.631691 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.27982447, "process_user_time": 1.344163, "process_kernel_time": 0.055239, "process_mem_max_rss": "106936", "process_out_blocks": "2432", "command_success": false, "process_in_blocks": "0"}
[0m00:06:55.632081 [debug] [MainThread]: Command `dbt run-operation` failed at 00:06:55.631984 after 0.28 seconds
[0m00:06:55.632289 [debug] [MainThread]: Connection 'macro_drop_orphaned_tables_and_views' was properly closed.
[0m00:06:55.632479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0784b09850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0784969a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0784cb7ed0>]}
[0m00:06:55.632687 [debug] [MainThread]: Flushing usage events
[0m00:07:17.839863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf98dc5f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf98dc4410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf98dc5f10>]}


============================== 00:07:17.841800 | aca8cb70-a473-411d-b35b-f8f33f13d0ad ==============================
[0m00:07:17.841800 [info ] [MainThread]: Running with dbt=1.7.4
[0m00:07:17.842192 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:07:17.972961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aca8cb70-a473-411d-b35b-f8f33f13d0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf98c070d0>]}
[0m00:07:18.030171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aca8cb70-a473-411d-b35b-f8f33f13d0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf98a207d0>]}
[0m00:07:18.030660 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m00:07:18.037922 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m00:07:18.057159 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:07:18.057635 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views.sql
[0m00:07:18.072504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aca8cb70-a473-411d-b35b-f8f33f13d0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf98ae0ed0>]}
[0m00:07:18.081423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aca8cb70-a473-411d-b35b-f8f33f13d0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf989a8350>]}
[0m00:07:18.081816 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m00:07:18.082101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aca8cb70-a473-411d-b35b-f8f33f13d0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf98b4b410>]}
[0m00:07:18.082660 [debug] [MainThread]: Acquiring new trino connection 'macro_drop_orphaned_tables_and_views'
[0m00:07:18.082861 [debug] [MainThread]: On macro_drop_orphaned_tables_and_views: COMMIT
[0m00:07:18.090692 [error] [MainThread]: Encountered an error while running operation: Compilation Error
  'lakehouse' is undefined
[0m00:07:18.092052 [debug] [MainThread]: Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 66, in macro
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/sandbox.py", line 326, in getattr
    value = getattr(obj, attribute)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 859, in __getattr__
    return self._fail_with_undefined_error()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 852, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'lakehouse' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 58, in run
    self._run_unsafe(package_name, macro_name)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 43, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 1112, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 255, in call_macro
    with self.exception_handler():
  File "/usr/lib/python3.11/contextlib.py", line 155, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise CaughtMacroErrorWithNodeError(exc=e, node=self.macro)
dbt.exceptions.CaughtMacroErrorWithNodeError: Compilation Error
  'lakehouse' is undefined

[0m00:07:18.093162 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.2810137, "process_user_time": 1.278875, "process_kernel_time": 0.046336, "process_mem_max_rss": "106864", "process_out_blocks": "2440", "command_success": false, "process_in_blocks": "0"}
[0m00:07:18.093569 [debug] [MainThread]: Command `dbt run-operation` failed at 00:07:18.093458 after 0.28 seconds
[0m00:07:18.093876 [debug] [MainThread]: Connection 'macro_drop_orphaned_tables_and_views' was properly closed.
[0m00:07:18.094096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf98db6c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf98dbc350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf98ac8550>]}
[0m00:07:18.094336 [debug] [MainThread]: Flushing usage events
[0m00:08:56.148104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72588f2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725f6b8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726aa7b10>]}


============================== 00:08:56.149903 | add8a370-4b4c-47de-a1de-63bb628a511d ==============================
[0m00:08:56.149903 [info ] [MainThread]: Running with dbt=1.7.4
[0m00:08:56.150297 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views', 'send_anonymous_usage_stats': 'True'}
[0m00:08:56.281040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'add8a370-4b4c-47de-a1de-63bb628a511d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7256a7550>]}
[0m00:08:56.339388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'add8a370-4b4c-47de-a1de-63bb628a511d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7254dc2d0>]}
[0m00:08:56.339869 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m00:08:56.347169 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m00:08:56.366290 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:08:56.366812 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views.sql
[0m00:08:56.370603 [error] [MainThread]: Encountered an error:
Compilation Error
  expected name or number
    line 103
      AND LOWER(table_name) IN ('{{ "' || '".join(current_model_locations[database].[schema])|lower }}')
[0m00:08:56.371275 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.24984981, "process_user_time": 1.239273, "process_kernel_time": 0.073986, "process_mem_max_rss": "104136", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m00:08:56.371636 [debug] [MainThread]: Command `dbt run-operation` failed at 00:08:56.371551 after 0.25 seconds
[0m00:08:56.371878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb729fc3910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7258cb6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb729f35190>]}
[0m00:08:56.372107 [debug] [MainThread]: Flushing usage events
[0m00:17:45.929457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8af043d890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8af08cda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8af04370d0>]}


============================== 00:17:45.931206 | c38975ca-a662-4a33-ae4f-6544e979ae9e ==============================
[0m00:17:45.931206 [info ] [MainThread]: Running with dbt=1.7.4
[0m00:17:45.931691 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:17:46.064013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c38975ca-a662-4a33-ae4f-6544e979ae9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8af021ba50>]}
[0m00:17:46.119357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c38975ca-a662-4a33-ae4f-6544e979ae9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8af08cde90>]}
[0m00:17:46.119904 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m00:17:46.127330 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m00:17:46.145603 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:17:46.146049 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views.sql
[0m00:17:46.160335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c38975ca-a662-4a33-ae4f-6544e979ae9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8af00df210>]}
[0m00:17:46.169011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c38975ca-a662-4a33-ae4f-6544e979ae9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8af0020290>]}
[0m00:17:46.169355 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m00:17:46.169617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c38975ca-a662-4a33-ae4f-6544e979ae9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aeff5ec90>]}
[0m00:17:46.170259 [debug] [MainThread]: Acquiring new trino connection 'macro_drop_orphaned_tables_and_views'
[0m00:17:46.170477 [debug] [MainThread]: On macro_drop_orphaned_tables_and_views: COMMIT
[0m00:17:46.178195 [error] [MainThread]: Encountered an error while running operation: Compilation Error
  'lakehouse' is undefined
[0m00:17:46.179710 [debug] [MainThread]: Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 66, in macro
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/sandbox.py", line 326, in getattr
    value = getattr(obj, attribute)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 859, in __getattr__
    return self._fail_with_undefined_error()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 852, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'lakehouse' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 58, in run
    self._run_unsafe(package_name, macro_name)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 43, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 1112, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 255, in call_macro
    with self.exception_handler():
  File "/usr/lib/python3.11/contextlib.py", line 155, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise CaughtMacroErrorWithNodeError(exc=e, node=self.macro)
dbt.exceptions.CaughtMacroErrorWithNodeError: Compilation Error
  'lakehouse' is undefined

[0m00:17:46.180668 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.2764494, "process_user_time": 1.320255, "process_kernel_time": 0.046162, "process_mem_max_rss": "106584", "process_out_blocks": "2440", "command_success": false, "process_in_blocks": "0"}
[0m00:17:46.180994 [debug] [MainThread]: Command `dbt run-operation` failed at 00:17:46.180914 after 0.28 seconds
[0m00:17:46.181194 [debug] [MainThread]: Connection 'macro_drop_orphaned_tables_and_views' was properly closed.
[0m00:17:46.181384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8af0020210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aefecbdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8af00200d0>]}
[0m00:17:46.181595 [debug] [MainThread]: Flushing usage events
[0m23:22:16.548040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd7186cb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd7186ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd7186f250>]}


============================== 23:22:16.549841 | cd716c4f-85c3-4ce7-8e72-8bc45e0bdb08 ==============================
[0m23:22:16.549841 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:22:16.550222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:22:16.676709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd716c4f-85c3-4ce7-8e72-8bc45e0bdb08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd71695ad0>]}
[0m23:22:16.731624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd716c4f-85c3-4ce7-8e72-8bc45e0bdb08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd71875890>]}
[0m23:22:16.732151 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m23:22:16.739167 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:22:16.757313 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:22:16.757605 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:22:16.761819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd716c4f-85c3-4ce7-8e72-8bc45e0bdb08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd714c46d0>]}
[0m23:22:16.771307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd716c4f-85c3-4ce7-8e72-8bc45e0bdb08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd713ef7d0>]}
[0m23:22:16.771689 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m23:22:16.772019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd716c4f-85c3-4ce7-8e72-8bc45e0bdb08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd718749d0>]}
[0m23:22:16.772627 [debug] [MainThread]: Acquiring new trino connection 'macro_drop_orphaned_tables_and_views'
[0m23:22:16.772832 [debug] [MainThread]: On macro_drop_orphaned_tables_and_views: COMMIT
[0m23:22:16.780505 [error] [MainThread]: Encountered an error while running operation: Compilation Error
  'lakehouse' is undefined
[0m23:22:16.781899 [debug] [MainThread]: Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 66, in macro
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/sandbox.py", line 326, in getattr
    value = getattr(obj, attribute)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 859, in __getattr__
    return self._fail_with_undefined_error()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 852, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'lakehouse' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 58, in run
    self._run_unsafe(package_name, macro_name)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 43, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 1112, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 255, in call_macro
    with self.exception_handler():
  File "/usr/lib/python3.11/contextlib.py", line 155, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise CaughtMacroErrorWithNodeError(exc=e, node=self.macro)
dbt.exceptions.CaughtMacroErrorWithNodeError: Compilation Error
  'lakehouse' is undefined

[0m23:22:16.782810 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.26006255, "process_user_time": 1.274004, "process_kernel_time": 0.046159, "process_mem_max_rss": "105804", "process_out_blocks": "1264", "command_success": false, "process_in_blocks": "0"}
[0m23:22:16.783149 [debug] [MainThread]: Command `dbt run-operation` failed at 23:22:16.783050 after 0.26 seconds
[0m23:22:16.783497 [debug] [MainThread]: Connection 'macro_drop_orphaned_tables_and_views' was properly closed.
[0m23:22:16.783771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd715106d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd715d7ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd737770d0>]}
[0m23:22:16.784033 [debug] [MainThread]: Flushing usage events
[0m23:22:43.387805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f2976bf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f2976acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f29ae2b10>]}


============================== 23:22:43.389538 | 3ba0c912-e445-4b9c-b9d1-b720ac51c0d1 ==============================
[0m23:22:43.389538 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:22:43.389922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:22:43.518402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ba0c912-e445-4b9c-b9d1-b720ac51c0d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f2951bcd0>]}
[0m23:22:43.573031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ba0c912-e445-4b9c-b9d1-b720ac51c0d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f29498390>]}
[0m23:22:43.573445 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m23:22:43.580392 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:22:43.598120 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:22:43.598415 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:22:43.603094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ba0c912-e445-4b9c-b9d1-b720ac51c0d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f291cc510>]}
[0m23:22:43.612279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ba0c912-e445-4b9c-b9d1-b720ac51c0d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f292f3d50>]}
[0m23:22:43.612634 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m23:22:43.612940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ba0c912-e445-4b9c-b9d1-b720ac51c0d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f2967d250>]}
[0m23:22:43.613635 [debug] [MainThread]: Acquiring new trino connection 'macro_drop_orphaned_tables_and_views'
[0m23:22:43.613886 [debug] [MainThread]: On macro_drop_orphaned_tables_and_views: COMMIT
[0m23:22:43.621366 [error] [MainThread]: Encountered an error while running operation: Compilation Error
  'lakehouse' is undefined
[0m23:22:43.622996 [debug] [MainThread]: Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 66, in macro
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/sandbox.py", line 326, in getattr
    value = getattr(obj, attribute)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 859, in __getattr__
    return self._fail_with_undefined_error()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 852, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'lakehouse' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 58, in run
    self._run_unsafe(package_name, macro_name)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 43, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 1112, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 255, in call_macro
    with self.exception_handler():
  File "/usr/lib/python3.11/contextlib.py", line 155, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise CaughtMacroErrorWithNodeError(exc=e, node=self.macro)
dbt.exceptions.CaughtMacroErrorWithNodeError: Compilation Error
  'lakehouse' is undefined

[0m23:22:43.624065 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.26208955, "process_user_time": 1.219757, "process_kernel_time": 0.065177, "process_mem_max_rss": "106488", "process_out_blocks": "1256", "command_success": false, "process_in_blocks": "0"}
[0m23:22:43.624436 [debug] [MainThread]: Command `dbt run-operation` failed at 23:22:43.624327 after 0.26 seconds
[0m23:22:43.624688 [debug] [MainThread]: Connection 'macro_drop_orphaned_tables_and_views' was properly closed.
[0m23:22:43.624978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f29b7f2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f292f3e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f292f3950>]}
[0m23:22:43.625206 [debug] [MainThread]: Flushing usage events
[0m23:24:26.973043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66f3cd5e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66f4166110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66f3cd3110>]}


============================== 23:24:26.974948 | a3ab22b5-86c9-4f76-9160-35cac164fe34 ==============================
[0m23:24:26.974948 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:24:26.975323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:24:27.102623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3ab22b5-86c9-4f76-9160-35cac164fe34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66f3a81790>]}
[0m23:24:27.156977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3ab22b5-86c9-4f76-9160-35cac164fe34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66f3924110>]}
[0m23:24:27.157407 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m23:24:27.164315 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:24:27.181987 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:24:27.182272 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:24:27.186433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3ab22b5-86c9-4f76-9160-35cac164fe34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66f377a8d0>]}
[0m23:24:27.195528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3ab22b5-86c9-4f76-9160-35cac164fe34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66f39b7c10>]}
[0m23:24:27.195933 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m23:24:27.196225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3ab22b5-86c9-4f76-9160-35cac164fe34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66f3af9490>]}
[0m23:24:27.196825 [debug] [MainThread]: Acquiring new trino connection 'macro_drop_orphaned_tables_and_views'
[0m23:24:27.197030 [debug] [MainThread]: On macro_drop_orphaned_tables_and_views: COMMIT
[0m23:24:27.204581 [error] [MainThread]: Encountered an error while running operation: Compilation Error
  'lakehouse' is undefined
[0m23:24:27.205886 [debug] [MainThread]: Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 66, in macro
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/sandbox.py", line 326, in getattr
    value = getattr(obj, attribute)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 859, in __getattr__
    return self._fail_with_undefined_error()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 852, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'lakehouse' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 58, in run
    self._run_unsafe(package_name, macro_name)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 43, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 1112, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 255, in call_macro
    with self.exception_handler():
  File "/usr/lib/python3.11/contextlib.py", line 155, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise CaughtMacroErrorWithNodeError(exc=e, node=self.macro)
dbt.exceptions.CaughtMacroErrorWithNodeError: Compilation Error
  'lakehouse' is undefined

[0m23:24:27.207130 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.2602663, "process_user_time": 1.26204, "process_kernel_time": 0.037118, "process_mem_max_rss": "106696", "process_out_blocks": "1272", "command_success": false, "process_in_blocks": "0"}
[0m23:24:27.207601 [debug] [MainThread]: Command `dbt run-operation` failed at 23:24:27.207458 after 0.26 seconds
[0m23:24:27.207841 [debug] [MainThread]: Connection 'macro_drop_orphaned_tables_and_views' was properly closed.
[0m23:24:27.208054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66f3cd01d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66f41667d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66f398cf10>]}
[0m23:24:27.208288 [debug] [MainThread]: Flushing usage events
[0m23:25:06.998629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1e933450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1a489210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1a9163d0>]}


============================== 23:25:07.000350 | 60d28006-24de-4330-a560-e7bd46001f32 ==============================
[0m23:25:07.000350 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:25:07.000719 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:25:07.129117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60d28006-24de-4330-a560-e7bd46001f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1a2cbf50>]}
[0m23:25:07.185273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60d28006-24de-4330-a560-e7bd46001f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1a1fdcd0>]}
[0m23:25:07.185717 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m23:25:07.192970 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:25:07.211080 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:25:07.211365 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:25:07.216003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60d28006-24de-4330-a560-e7bd46001f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde19f11150>]}
[0m23:25:07.224539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60d28006-24de-4330-a560-e7bd46001f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1a1a3a10>]}
[0m23:25:07.224892 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m23:25:07.225186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60d28006-24de-4330-a560-e7bd46001f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1a2f9f90>]}
[0m23:25:07.225811 [debug] [MainThread]: Acquiring new trino connection 'macro_drop_orphaned_tables_and_views'
[0m23:25:07.226010 [debug] [MainThread]: On macro_drop_orphaned_tables_and_views: COMMIT
[0m23:25:07.233829 [error] [MainThread]: Encountered an error while running operation: Compilation Error
  'lakehouse' is undefined
[0m23:25:07.235159 [debug] [MainThread]: Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 66, in macro
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/sandbox.py", line 326, in getattr
    value = getattr(obj, attribute)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 859, in __getattr__
    return self._fail_with_undefined_error()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 852, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'lakehouse' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 58, in run
    self._run_unsafe(package_name, macro_name)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 43, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 1112, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 255, in call_macro
    with self.exception_handler():
  File "/usr/lib/python3.11/contextlib.py", line 155, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise CaughtMacroErrorWithNodeError(exc=e, node=self.macro)
dbt.exceptions.CaughtMacroErrorWithNodeError: Compilation Error
  'lakehouse' is undefined

[0m23:25:07.236083 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.2624984, "process_user_time": 1.260672, "process_kernel_time": 0.027808, "process_mem_max_rss": "106592", "process_out_blocks": "1272", "command_success": false, "process_in_blocks": "0"}
[0m23:25:07.236408 [debug] [MainThread]: Command `dbt run-operation` failed at 23:25:07.236327 after 0.26 seconds
[0m23:25:07.236606 [debug] [MainThread]: Connection 'macro_drop_orphaned_tables_and_views' was properly closed.
[0m23:25:07.236791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1a473190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1a472810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1a14a890>]}
[0m23:25:07.236994 [debug] [MainThread]: Flushing usage events
[0m23:30:49.642130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96fda31d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96fda30ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96fe113ad0>]}


============================== 23:30:49.644266 | 68b80638-358a-4b3e-8ea6-7b20db0d1d5a ==============================
[0m23:30:49.644266 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:30:49.644675 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:30:49.776317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68b80638-358a-4b3e-8ea6-7b20db0d1d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96fd8a8d50>]}
[0m23:30:49.834082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68b80638-358a-4b3e-8ea6-7b20db0d1d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96fd7b5f10>]}
[0m23:30:49.834554 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m23:30:49.841645 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:30:49.860724 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:30:49.861029 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:30:49.865310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68b80638-358a-4b3e-8ea6-7b20db0d1d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96fd4c0d50>]}
[0m23:30:49.874406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68b80638-358a-4b3e-8ea6-7b20db0d1d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96fd6d1c10>]}
[0m23:30:49.874780 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m23:30:49.875061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68b80638-358a-4b3e-8ea6-7b20db0d1d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96fd74cf90>]}
[0m23:30:49.875672 [debug] [MainThread]: Acquiring new trino connection 'macro_drop_orphaned_tables_and_views'
[0m23:30:49.875878 [debug] [MainThread]: On macro_drop_orphaned_tables_and_views: COMMIT
[0m23:30:49.884282 [error] [MainThread]: Encountered an error while running operation: Compilation Error
  'lakehouse' is undefined
[0m23:30:49.885876 [debug] [MainThread]: Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 66, in macro
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/sandbox.py", line 326, in getattr
    value = getattr(obj, attribute)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 859, in __getattr__
    return self._fail_with_undefined_error()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 852, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'lakehouse' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 58, in run
    self._run_unsafe(package_name, macro_name)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 43, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 1112, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 255, in call_macro
    with self.exception_handler():
  File "/usr/lib/python3.11/contextlib.py", line 155, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise CaughtMacroErrorWithNodeError(exc=e, node=self.macro)
dbt.exceptions.CaughtMacroErrorWithNodeError: Compilation Error
  'lakehouse' is undefined

[0m23:30:49.887032 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.2735522, "process_user_time": 1.326064, "process_kernel_time": 0.092731, "process_mem_max_rss": "106572", "process_out_blocks": "1264", "command_success": false, "process_in_blocks": "0"}
[0m23:30:49.887482 [debug] [MainThread]: Command `dbt run-operation` failed at 23:30:49.887386 after 0.27 seconds
[0m23:30:49.887695 [debug] [MainThread]: Connection 'macro_drop_orphaned_tables_and_views' was properly closed.
[0m23:30:49.887899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96ffc5f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96fd880750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970216ed50>]}
[0m23:30:49.888118 [debug] [MainThread]: Flushing usage events
[0m23:42:24.221795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb0cca4fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb0d806310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb0caefe10>]}


============================== 23:42:24.223557 | 52d158e7-c249-4e46-8586-9cc4ce426395 ==============================
[0m23:42:24.223557 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:42:24.223938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views2', 'send_anonymous_usage_stats': 'True'}
[0m23:42:24.353512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52d158e7-c249-4e46-8586-9cc4ce426395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb0cad3990>]}
[0m23:42:24.407004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52d158e7-c249-4e46-8586-9cc4ce426395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb0ca29f90>]}
[0m23:42:24.407474 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m23:42:24.414191 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:42:24.431974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:42:24.432408 [debug] [MainThread]: Partial parsing: added file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views2.sql
[0m23:42:24.433384 [error] [MainThread]: Encountered an error:
Compilation Error
  Got an unexpected control flow end tag, got endif but never saw a preceeding if (@ 72:12)
[0m23:42:24.433996 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.23714012, "process_user_time": 1.241183, "process_kernel_time": 0.027787, "process_mem_max_rss": "104168", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m23:42:24.434335 [debug] [MainThread]: Command `dbt run-operation` failed at 23:42:24.434255 after 0.24 seconds
[0m23:42:24.434567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb0cadf410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb0c734510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb0d12e5d0>]}
[0m23:42:24.434789 [debug] [MainThread]: Flushing usage events
[0m23:42:59.566554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf0c4620d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf0c4605d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf0c2abb10>]}


============================== 23:42:59.568313 | 373c3271-ba88-4935-8b41-0b99f7a28458 ==============================
[0m23:42:59.568313 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:42:59.568688 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views2', 'send_anonymous_usage_stats': 'True'}
[0m23:42:59.694539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '373c3271-ba88-4935-8b41-0b99f7a28458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf0c0bd290>]}
[0m23:42:59.747773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '373c3271-ba88-4935-8b41-0b99f7a28458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf0c1fedd0>]}
[0m23:42:59.748197 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m23:42:59.754997 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:42:59.772573 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:42:59.773023 [debug] [MainThread]: Partial parsing: added file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views2.sql
[0m23:42:59.773992 [error] [MainThread]: Encountered an error:
Compilation Error
  Got an unexpected control flow end tag, got endif but never saw a preceeding if (@ 72:12)
[0m23:42:59.774577 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.23357558, "process_user_time": 1.162321, "process_kernel_time": 0.073798, "process_mem_max_rss": "104224", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m23:42:59.774914 [debug] [MainThread]: Command `dbt run-operation` failed at 23:42:59.774836 after 0.23 seconds
[0m23:42:59.775142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf0c29f410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf0c454cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf10a0f4d0>]}
[0m23:42:59.775362 [debug] [MainThread]: Flushing usage events
[0m23:44:22.976564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabda985e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabda984b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabda9866d0>]}


============================== 23:44:22.978477 | d82afecf-9438-4b15-8655-fc51699e3a5e ==============================
[0m23:44:22.978477 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:44:22.978852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:44:23.113068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd82afecf-9438-4b15-8655-fc51699e3a5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabda7d8f10>]}
[0m23:44:23.168419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd82afecf-9438-4b15-8655-fc51699e3a5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabda994cd0>]}
[0m23:44:23.169165 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m23:44:23.176562 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:44:23.197562 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m23:44:23.198015 [debug] [MainThread]: Partial parsing: added file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views2.sql
[0m23:44:23.198278 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views.sql
[0m23:44:23.199249 [error] [MainThread]: Encountered an error:
Compilation Error
  Got an unexpected control flow end tag, got endif but never saw a preceeding if (@ 72:12)
[0m23:44:23.199853 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.24953152, "process_user_time": 1.22716, "process_kernel_time": 0.073814, "process_mem_max_rss": "104248", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m23:44:23.200208 [debug] [MainThread]: Command `dbt run-operation` failed at 23:44:23.200130 after 0.25 seconds
[0m23:44:23.200440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabda995910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabda995290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabdb4feed0>]}
[0m23:44:23.200664 [debug] [MainThread]: Flushing usage events
[0m23:46:29.571613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40bf540890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40bf5934d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40bf540c50>]}


============================== 23:46:29.573506 | 3c864ddc-d3ab-49e0-8cd0-3101624062cc ==============================
[0m23:46:29.573506 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:46:29.573897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:46:29.710059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c864ddc-d3ab-49e0-8cd0-3101624062cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40bf33d890>]}
[0m23:46:29.771145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c864ddc-d3ab-49e0-8cd0-3101624062cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40bf54b590>]}
[0m23:46:29.771617 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m23:46:29.778966 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:46:29.799473 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m23:46:29.799907 [debug] [MainThread]: Partial parsing: added file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views2.sql
[0m23:46:29.800162 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views.sql
[0m23:46:29.801146 [error] [MainThread]: Encountered an error:
Compilation Error
  Got an unexpected control flow end tag, got endif but never saw a preceeding if (@ 72:12)
[0m23:46:29.801760 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.25770414, "process_user_time": 1.300998, "process_kernel_time": 0.036907, "process_mem_max_rss": "104316", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m23:46:29.802095 [debug] [MainThread]: Command `dbt run-operation` failed at 23:46:29.802013 after 0.26 seconds
[0m23:46:29.802326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40c3c19210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40bf1981d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40c144b0d0>]}
[0m23:46:29.802546 [debug] [MainThread]: Flushing usage events
[0m23:47:29.346091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff90d400fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff90d243c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff90d3eca90>]}


============================== 23:47:29.347954 | 90fa2f36-f479-4732-a5c1-8e865288db74 ==============================
[0m23:47:29.347954 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:47:29.348332 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:47:29.478525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90fa2f36-f479-4732-a5c1-8e865288db74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff90d197c10>]}
[0m23:47:29.535825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90fa2f36-f479-4732-a5c1-8e865288db74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff90d807450>]}
[0m23:47:29.536296 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m23:47:29.543487 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:47:29.562046 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m23:47:29.562480 [debug] [MainThread]: Partial parsing: added file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views2.sql
[0m23:47:29.562744 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views.sql
[0m23:47:29.563726 [error] [MainThread]: Encountered an error:
Compilation Error
  Got an unexpected control flow end tag, got endif but never saw a preceeding if (@ 72:12)
[0m23:47:29.564334 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.24502717, "process_user_time": 1.259182, "process_kernel_time": 0.027776, "process_mem_max_rss": "103952", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m23:47:29.564677 [debug] [MainThread]: Command `dbt run-operation` failed at 23:47:29.564596 after 0.25 seconds
[0m23:47:29.564910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9119a7410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9119a74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff90d3efed0>]}
[0m23:47:29.565140 [debug] [MainThread]: Flushing usage events
[0m23:49:15.379497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcca6f79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcca6f4350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcca6f5ed0>]}


============================== 23:49:15.381322 | 20640ed1-e971-44ac-92b3-e78c9d373244 ==============================
[0m23:49:15.381322 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:49:15.381696 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:49:15.514687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20640ed1-e971-44ac-92b3-e78c9d373244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcca5352d0>]}
[0m23:49:15.572148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20640ed1-e971-44ac-92b3-e78c9d373244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdccab89e10>]}
[0m23:49:15.572606 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m23:49:15.579911 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:49:15.598488 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m23:49:15.598923 [debug] [MainThread]: Partial parsing: added file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views2.sql
[0m23:49:15.599197 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views.sql
[0m23:49:15.600217 [error] [MainThread]: Encountered an error:
Compilation Error
  Got an unexpected control flow end tag, got endif but never saw a preceeding if (@ 72:12)
[0m23:49:15.600819 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.24856365, "process_user_time": 1.228791, "process_kernel_time": 0.09239, "process_mem_max_rss": "103956", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m23:49:15.601215 [debug] [MainThread]: Command `dbt run-operation` failed at 23:49:15.601129 after 0.25 seconds
[0m23:49:15.601489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcca737710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdccab89b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcceccf4d0>]}
[0m23:49:15.601803 [debug] [MainThread]: Flushing usage events
[0m23:50:39.397237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97b3f8e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97b899a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97b233f50>]}


============================== 23:50:39.399151 | 379f5932-2dbf-4dea-94a0-1b46076e8a87 ==============================
[0m23:50:39.399151 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:50:39.399530 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:50:39.535343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '379f5932-2dbf-4dea-94a0-1b46076e8a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97b03bf10>]}
[0m23:50:39.595182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '379f5932-2dbf-4dea-94a0-1b46076e8a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97b3140d0>]}
[0m23:50:39.595653 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m23:50:39.602885 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:50:39.622172 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m23:50:39.622726 [debug] [MainThread]: Partial parsing: added file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views2.sql
[0m23:50:39.622999 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views.sql
[0m23:50:39.624020 [error] [MainThread]: Encountered an error:
Compilation Error
  Got an unexpected control flow end tag, got endif but never saw a preceeding if (@ 72:12)
[0m23:50:39.624638 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.2547677, "process_user_time": 1.216421, "process_kernel_time": 0.101368, "process_mem_max_rss": "103996", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m23:50:39.624994 [debug] [MainThread]: Command `dbt run-operation` failed at 23:50:39.624911 after 0.26 seconds
[0m23:50:39.625240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97b3fbc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97b421510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97b899d50>]}
[0m23:50:39.625490 [debug] [MainThread]: Flushing usage events
[0m23:52:29.518890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39a4eff7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39a466bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39a4cae950>]}


============================== 23:52:29.520700 | fadf499e-735a-49eb-8557-27b0e277d386 ==============================
[0m23:52:29.520700 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:52:29.521081 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:52:29.654274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fadf499e-735a-49eb-8557-27b0e277d386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39a45c1210>]}
[0m23:52:29.709080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fadf499e-735a-49eb-8557-27b0e277d386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39a4cae890>]}
[0m23:52:29.709528 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m23:52:29.716748 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:52:29.735710 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m23:52:29.736182 [debug] [MainThread]: Partial parsing: added file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views2.sql
[0m23:52:29.736445 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views.sql
[0m23:52:29.737432 [error] [MainThread]: Encountered an error:
Compilation Error
  Got an unexpected control flow end tag, got endif but never saw a preceeding if (@ 72:12)
[0m23:52:29.738058 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.24527732, "process_user_time": 1.25675, "process_kernel_time": 0.05504, "process_mem_max_rss": "103964", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m23:52:29.738392 [debug] [MainThread]: Command `dbt run-operation` failed at 23:52:29.738312 after 0.25 seconds
[0m23:52:29.738624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39a480a250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39a4724990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39a480af90>]}
[0m23:52:29.738853 [debug] [MainThread]: Flushing usage events
[0m23:56:27.108314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc9b7b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc9b7b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc9b70c90>]}


============================== 23:56:27.110347 | cd0d478a-d8bd-4dcc-abc9-a41601462fcc ==============================
[0m23:56:27.110347 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:56:27.110735 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views', 'send_anonymous_usage_stats': 'True'}
[0m23:56:27.243186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd0d478a-d8bd-4dcc-abc9-a41601462fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc9920c10>]}
[0m23:56:27.300649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd0d478a-d8bd-4dcc-abc9-a41601462fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98fe110>]}
[0m23:56:27.301183 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m23:56:27.308815 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:56:27.329698 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m23:56:27.330219 [debug] [MainThread]: Partial parsing: added file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views2.sql
[0m23:56:27.330475 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views.sql
[0m23:56:27.331488 [error] [MainThread]: Encountered an error:
Compilation Error
  Got an unexpected control flow end tag, got endif but never saw a preceeding if (@ 72:12)
[0m23:56:27.332185 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.2533388, "process_user_time": 1.309262, "process_kernel_time": 0.05532, "process_mem_max_rss": "104360", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m23:56:27.332510 [debug] [MainThread]: Command `dbt run-operation` failed at 23:56:27.332433 after 0.25 seconds
[0m23:56:27.332740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fce249050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fce15b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fca016390>]}
[0m23:56:27.332958 [debug] [MainThread]: Flushing usage events
[0m23:57:58.945370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d0bfb2610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d0bfb0d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d0bff7b10>]}


============================== 23:57:58.947353 | 5e529279-afb4-4f3a-87c3-d40dd3a53493 ==============================
[0m23:57:58.947353 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:57:58.947749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:57:59.097661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e529279-afb4-4f3a-87c3-d40dd3a53493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d0bdcf8d0>]}
[0m23:57:59.154561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e529279-afb4-4f3a-87c3-d40dd3a53493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d0be28a10>]}
[0m23:57:59.155077 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m23:57:59.162417 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:57:59.180651 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m23:57:59.181137 [debug] [MainThread]: Partial parsing: added file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views2.sql
[0m23:57:59.181409 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views.sql
[0m23:57:59.182621 [error] [MainThread]: Encountered an error:
Compilation Error
  Got an unexpected control flow end tag, got endif but never saw a preceeding if (@ 72:12)
[0m23:57:59.183506 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.26529863, "process_user_time": 1.278135, "process_kernel_time": 0.055571, "process_mem_max_rss": "103960", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m23:57:59.183957 [debug] [MainThread]: Command `dbt run-operation` failed at 23:57:59.183847 after 0.27 seconds
[0m23:57:59.184329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d0bfa6210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d0bfa7f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d1070b990>]}
[0m23:57:59.184580 [debug] [MainThread]: Flushing usage events
[0m00:01:02.017936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7ddeefd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7e48f8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7dd99e10>]}


============================== 00:01:02.019639 | 51e242d0-03ef-4fa0-aa42-afa61f7845b8 ==============================
[0m00:01:02.019639 [info ] [MainThread]: Running with dbt=1.7.4
[0m00:01:02.019999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views', 'send_anonymous_usage_stats': 'True'}
[0m00:01:02.146466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51e242d0-03ef-4fa0-aa42-afa61f7845b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7db53b50>]}
[0m00:01:02.200401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51e242d0-03ef-4fa0-aa42-afa61f7845b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7e48f890>]}
[0m00:01:02.200838 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m00:01:02.207544 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m00:01:02.225529 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:01:02.225986 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views.sql
[0m00:01:02.240640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51e242d0-03ef-4fa0-aa42-afa61f7845b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7e11b110>]}
[0m00:01:02.249648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51e242d0-03ef-4fa0-aa42-afa61f7845b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7daea0d0>]}
[0m00:01:02.250051 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m00:01:02.250347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51e242d0-03ef-4fa0-aa42-afa61f7845b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a804078d0>]}
[0m00:01:02.250878 [debug] [MainThread]: Acquiring new trino connection 'macro_drop_orphaned_tables_and_views'
[0m00:01:02.251074 [debug] [MainThread]: On macro_drop_orphaned_tables_and_views: COMMIT
[0m00:01:02.258766 [error] [MainThread]: Encountered an error while running operation: Compilation Error
  'str object' has no attribute 'update'
[0m00:01:02.260293 [debug] [MainThread]: Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 71, in macro
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/sandbox.py", line 391, in call
    if not __self.is_safe_callable(__obj):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/sandbox.py", line 275, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 859, in __getattr__
    return self._fail_with_undefined_error()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 852, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'str object' has no attribute 'update'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 58, in run
    self._run_unsafe(package_name, macro_name)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 43, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 1112, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 255, in call_macro
    with self.exception_handler():
  File "/usr/lib/python3.11/contextlib.py", line 155, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise CaughtMacroErrorWithNodeError(exc=e, node=self.macro)
dbt.exceptions.CaughtMacroErrorWithNodeError: Compilation Error
  'str object' has no attribute 'update'

[0m00:01:02.261593 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.2685911, "process_user_time": 1.239589, "process_kernel_time": 0.046253, "process_mem_max_rss": "106752", "process_out_blocks": "2440", "command_success": false, "process_in_blocks": "0"}
[0m00:01:02.261960 [debug] [MainThread]: Command `dbt run-operation` failed at 00:01:02.261875 after 0.27 seconds
[0m00:01:02.262200 [debug] [MainThread]: Connection 'macro_drop_orphaned_tables_and_views' was properly closed.
[0m00:01:02.262408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7dda0210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7daea890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7daead90>]}
[0m00:01:02.262631 [debug] [MainThread]: Flushing usage events
[0m00:08:15.797853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf8d8f2fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf8d8f0650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf8d933390>]}


============================== 00:08:15.799674 | db0679f5-dffc-4d95-b3b7-07bac57d1807 ==============================
[0m00:08:15.799674 [info ] [MainThread]: Running with dbt=1.7.4
[0m00:08:15.800047 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views', 'send_anonymous_usage_stats': 'True'}
[0m00:08:15.931825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db0679f5-dffc-4d95-b3b7-07bac57d1807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf8d750990>]}
[0m00:08:15.989529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db0679f5-dffc-4d95-b3b7-07bac57d1807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf8d740690>]}
[0m00:08:15.990038 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m00:08:15.997869 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m00:08:16.016897 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:08:16.017426 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views.sql
[0m00:08:16.032632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db0679f5-dffc-4d95-b3b7-07bac57d1807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf8d66dbd0>]}
[0m00:08:16.042418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db0679f5-dffc-4d95-b3b7-07bac57d1807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf8d4c4210>]}
[0m00:08:16.042775 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m00:08:16.043042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db0679f5-dffc-4d95-b3b7-07bac57d1807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf8d6bde10>]}
[0m00:08:16.043699 [debug] [MainThread]: Acquiring new trino connection 'macro_drop_orphaned_tables_and_views'
[0m00:08:16.043906 [debug] [MainThread]: On macro_drop_orphaned_tables_and_views: COMMIT
[0m00:08:16.051845 [error] [MainThread]: Encountered an error while running operation: Compilation Error
  'dict object' has no attribute 'LAKEHOUSE'
[0m00:08:16.053270 [debug] [MainThread]: Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 65, in macro
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/sandbox.py", line 326, in getattr
    value = getattr(obj, attribute)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 859, in __getattr__
    return self._fail_with_undefined_error()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 852, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'dict object' has no attribute 'LAKEHOUSE'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 58, in run
    self._run_unsafe(package_name, macro_name)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 43, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 1112, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 255, in call_macro
    with self.exception_handler():
  File "/usr/lib/python3.11/contextlib.py", line 155, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise CaughtMacroErrorWithNodeError(exc=e, node=self.macro)
dbt.exceptions.CaughtMacroErrorWithNodeError: Compilation Error
  'dict object' has no attribute 'LAKEHOUSE'

[0m00:08:16.054229 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.28258806, "process_user_time": 1.240617, "process_kernel_time": 0.074623, "process_mem_max_rss": "107048", "process_out_blocks": "2440", "command_success": false, "process_in_blocks": "0"}
[0m00:08:16.054612 [debug] [MainThread]: Command `dbt run-operation` failed at 00:08:16.054527 after 0.28 seconds
[0m00:08:16.054822 [debug] [MainThread]: Connection 'macro_drop_orphaned_tables_and_views' was properly closed.
[0m00:08:16.055016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf8d8e3d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf8d8f0b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf8d7096d0>]}
[0m00:08:16.055229 [debug] [MainThread]: Flushing usage events
[0m00:09:57.005137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d46c7d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d46c7c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d46ac1350>]}


============================== 00:09:57.007008 | 83b71a84-1b6d-47fb-8d0b-0fa3574d2e05 ==============================
[0m00:09:57.007008 [info ] [MainThread]: Running with dbt=1.7.4
[0m00:09:57.007422 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views', 'send_anonymous_usage_stats': 'True'}
[0m00:09:57.136549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83b71a84-1b6d-47fb-8d0b-0fa3574d2e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d46a6e610>]}
[0m00:09:57.192732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83b71a84-1b6d-47fb-8d0b-0fa3574d2e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d46b98390>]}
[0m00:09:57.193239 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m00:09:57.200551 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m00:09:57.219947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:09:57.220447 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views.sql
[0m00:09:57.234970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83b71a84-1b6d-47fb-8d0b-0fa3574d2e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d46a37550>]}
[0m00:09:57.244251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83b71a84-1b6d-47fb-8d0b-0fa3574d2e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d469a8f90>]}
[0m00:09:57.244644 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m00:09:57.244909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83b71a84-1b6d-47fb-8d0b-0fa3574d2e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d46958dd0>]}
[0m00:09:57.245600 [debug] [MainThread]: Acquiring new trino connection 'macro_drop_orphaned_tables_and_views'
[0m00:09:57.245816 [debug] [MainThread]: On macro_drop_orphaned_tables_and_views: COMMIT
[0m00:09:57.255400 [debug] [MainThread]: {'LAKEHOUSE': {'DBT': ['SILVER_PARTS_SUPPLIERS', 'SILVER_ORDER_ITEMS', 'BRONZE_TPCH__REGION', 'BRONZE_TPCH__NATION', 'BRONZE_TPCH__CUSTOMERS', 'BRONZE_TPCH__PART', 'BRONZE_TPCH__LINE_ITEM', 'BRONZE_TPCH__SUPPLIER', 'BRONZE_TPCH__PART_SUPPLIERS', 'BRONZE_TPCH__ORDERS', 'ORDERS_SNAPSHOT', 'GOLD_PRICING_SUMMARY_REPORT', 'GOLD_FCT_ORDERS_ITEMS', 'GOLD_DIM_SUPPLIERS', 'GOLD_MINIMUM_COST_SUPPLIERS', 'GOLD_DIM_PART_SUPPLIERS']}}
[0m00:09:57.256017 [error] [MainThread]: Encountered an error while running operation: Compilation Error
  'dict object' has no attribute 'lakehouse'
[0m00:09:57.257472 [debug] [MainThread]: Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 90, in macro
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/sandbox.py", line 326, in getattr
    value = getattr(obj, attribute)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 859, in __getattr__
    return self._fail_with_undefined_error()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 852, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'dict object' has no attribute 'lakehouse'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 58, in run
    self._run_unsafe(package_name, macro_name)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 43, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 1112, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 255, in call_macro
    with self.exception_handler():
  File "/usr/lib/python3.11/contextlib.py", line 155, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise CaughtMacroErrorWithNodeError(exc=e, node=self.macro)
dbt.exceptions.CaughtMacroErrorWithNodeError: Compilation Error
  'dict object' has no attribute 'lakehouse'

[0m00:09:57.258405 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.27861762, "process_user_time": 1.281076, "process_kernel_time": 0.046081, "process_mem_max_rss": "106672", "process_out_blocks": "2432", "command_success": false, "process_in_blocks": "0"}
[0m00:09:57.258763 [debug] [MainThread]: Command `dbt run-operation` failed at 00:09:57.258673 after 0.28 seconds
[0m00:09:57.258985 [debug] [MainThread]: Connection 'macro_drop_orphaned_tables_and_views' was properly closed.
[0m00:09:57.259182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d46adfd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d46973a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d46ca4910>]}
[0m00:09:57.259404 [debug] [MainThread]: Flushing usage events
[0m01:11:52.697330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f088cda8a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f088cda8950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f088cda96d0>]}


============================== 01:11:52.700514 | 7defa7dc-919b-46f9-a749-b9f7b83a0942 ==============================
[0m01:11:52.700514 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:11:52.700899 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:11:52.853153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7defa7dc-919b-46f9-a749-b9f7b83a0942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f088ca03550>]}
[0m01:11:52.917312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7defa7dc-919b-46f9-a749-b9f7b83a0942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f088cc03f10>]}
[0m01:11:52.917761 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m01:11:52.925356 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m01:11:52.956756 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:11:52.957337 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views.sql
[0m01:11:52.975861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7defa7dc-919b-46f9-a749-b9f7b83a0942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f088cbadb90>]}
[0m01:11:52.988252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7defa7dc-919b-46f9-a749-b9f7b83a0942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f088c910b50>]}
[0m01:11:52.988606 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m01:11:52.988932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7defa7dc-919b-46f9-a749-b9f7b83a0942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f088cb63f50>]}
[0m01:11:52.989597 [debug] [MainThread]: Acquiring new trino connection 'macro_drop_orphaned_tables_and_views'
[0m01:11:52.989807 [debug] [MainThread]: On macro_drop_orphaned_tables_and_views: COMMIT
[0m01:11:52.997470 [error] [MainThread]: Encountered an error while running operation: Compilation Error
  'dict object' has no attribute 'table_name'
[0m01:11:52.999684 [debug] [MainThread]: Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 75, in macro
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/sandbox.py", line 326, in getattr
    value = getattr(obj, attribute)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 859, in __getattr__
    return self._fail_with_undefined_error()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 852, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'dict object' has no attribute 'table_name'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 58, in run
    self._run_unsafe(package_name, macro_name)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 43, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 1112, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 255, in call_macro
    with self.exception_handler():
  File "/usr/lib/python3.11/contextlib.py", line 155, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise CaughtMacroErrorWithNodeError(exc=e, node=self.macro)
dbt.exceptions.CaughtMacroErrorWithNodeError: Compilation Error
  'dict object' has no attribute 'table_name'

[0m01:11:53.000942 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.33565444, "process_user_time": 1.409457, "process_kernel_time": 0.510001, "process_mem_max_rss": "106764", "process_out_blocks": "2432", "command_success": false, "process_in_blocks": "0"}
[0m01:11:53.001298 [debug] [MainThread]: Command `dbt run-operation` failed at 01:11:53.001212 after 0.34 seconds
[0m01:11:53.001502 [debug] [MainThread]: Connection 'macro_drop_orphaned_tables_and_views' was properly closed.
[0m01:11:53.001691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f088ca5b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f088cc08a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08914cb890>]}
[0m01:11:53.001899 [debug] [MainThread]: Flushing usage events
[0m01:24:57.657241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cb2bf32d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cb2bf0850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cb2bf18d0>]}


============================== 01:24:57.659826 | 7814cbfe-0767-463d-bf06-484120ba7c9b ==============================
[0m01:24:57.659826 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:24:57.660203 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:24:57.805226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7814cbfe-0767-463d-bf06-484120ba7c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cb2a6cd50>]}
[0m01:24:57.863219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7814cbfe-0767-463d-bf06-484120ba7c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cb2971950>]}
[0m01:24:57.863854 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m01:24:57.871529 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m01:24:57.899784 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:24:57.900280 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views.sql
[0m01:24:57.916479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7814cbfe-0767-463d-bf06-484120ba7c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cb28cde10>]}
[0m01:24:57.926114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7814cbfe-0767-463d-bf06-484120ba7c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cb2650550>]}
[0m01:24:57.926583 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 538 macros, 0 groups, 0 semantic models
[0m01:24:57.926956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7814cbfe-0767-463d-bf06-484120ba7c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cb2b01210>]}
[0m01:24:57.927569 [debug] [MainThread]: Acquiring new trino connection 'macro_drop_orphaned_tables_and_views'
[0m01:24:57.927764 [debug] [MainThread]: On macro_drop_orphaned_tables_and_views: COMMIT
[0m01:24:57.935459 [debug] [MainThread]: {'LAKEHOUSE': {'DBT': ['SILVER_PARTS_SUPPLIERS', 'SILVER_ORDER_ITEMS', 'BRONZE_TPCH__REGION', 'BRONZE_TPCH__NATION', 'BRONZE_TPCH__CUSTOMERS', 'BRONZE_TPCH__PART', 'BRONZE_TPCH__LINE_ITEM', 'BRONZE_TPCH__SUPPLIER', 'BRONZE_TPCH__PART_SUPPLIERS', 'BRONZE_TPCH__ORDERS', 'ORDERS_SNAPSHOT', 'GOLD_PRICING_SUMMARY_REPORT', 'GOLD_FCT_ORDERS_ITEMS', 'GOLD_DIM_SUPPLIERS', 'GOLD_MINIMUM_COST_SUPPLIERS', 'GOLD_DIM_PART_SUPPLIERS']}}
[0m01:24:57.935969 [error] [MainThread]: Encountered an error while running operation: Compilation Error
  'dict object' has no attribute 'lakehouse'
[0m01:24:57.937793 [debug] [MainThread]: Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 90, in macro
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/sandbox.py", line 326, in getattr
    value = getattr(obj, attribute)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 859, in __getattr__
    return self._fail_with_undefined_error()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/jinja2/runtime.py", line 852, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'dict object' has no attribute 'lakehouse'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 58, in run
    self._run_unsafe(package_name, macro_name)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/task/run_operation.py", line 43, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 1112, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 255, in call_macro
    with self.exception_handler():
  File "/usr/lib/python3.11/contextlib.py", line 155, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/home/vadim/.local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise CaughtMacroErrorWithNodeError(exc=e, node=self.macro)
dbt.exceptions.CaughtMacroErrorWithNodeError: Compilation Error
  'dict object' has no attribute 'lakehouse'

[0m01:24:57.938846 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.311656, "process_user_time": 1.386971, "process_kernel_time": 0.128593, "process_mem_max_rss": "106872", "process_out_blocks": "2440", "command_success": false, "process_in_blocks": "0"}
[0m01:24:57.939215 [debug] [MainThread]: Command `dbt run-operation` failed at 01:24:57.939125 after 0.31 seconds
[0m01:24:57.939416 [debug] [MainThread]: Connection 'macro_drop_orphaned_tables_and_views' was properly closed.
[0m01:24:57.939606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cb72a5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cb72a5350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cb2bec990>]}
[0m01:24:57.939811 [debug] [MainThread]: Flushing usage events
[0m01:34:21.461191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59ecc49690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59ecc48490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59ecc34ad0>]}


============================== 01:34:21.463162 | 36e768e8-0dcc-4c15-a131-1eaed8ff1a65 ==============================
[0m01:34:21.463162 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:34:21.463565 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views2', 'send_anonymous_usage_stats': 'True'}
[0m01:34:21.595024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36e768e8-0dcc-4c15-a131-1eaed8ff1a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59eca3cd50>]}
[0m01:34:21.651637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36e768e8-0dcc-4c15-a131-1eaed8ff1a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59ec9e3ed0>]}
[0m01:34:21.652136 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m01:34:21.659419 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m01:34:21.679195 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m01:34:21.679668 [debug] [MainThread]: Partial parsing: added file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views2.sql
[0m01:34:21.682078 [error] [MainThread]: Encountered an error:
Compilation Error
  expected token 'end of statement block', got '='
    line 13
      {%- do lakehouse[node.database] = {} -%}
[0m01:34:21.682683 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.24925973, "process_user_time": 1.236994, "process_kernel_time": 0.092313, "process_mem_max_rss": "104140", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m01:34:21.683025 [debug] [MainThread]: Command `dbt run-operation` failed at 01:34:21.682941 after 0.25 seconds
[0m01:34:21.683261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59f1207610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59f1207650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59ecc37490>]}
[0m01:34:21.683507 [debug] [MainThread]: Flushing usage events
[0m01:35:01.937967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb3b5e4a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb3bcdb8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb3bcdb710>]}


============================== 01:35:01.939778 | 7ee67d2e-e3f0-4ad2-988d-77f33084ab17 ==============================
[0m01:35:01.939778 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:35:01.940175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views2', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:35:02.066995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ee67d2e-e3f0-4ad2-988d-77f33084ab17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb3b63b750>]}
[0m01:35:02.120302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ee67d2e-e3f0-4ad2-988d-77f33084ab17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb3b474dd0>]}
[0m01:35:02.120734 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m01:35:02.127967 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m01:35:02.145331 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m01:35:02.145767 [debug] [MainThread]: Partial parsing: added file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views2.sql
[0m01:35:02.147859 [error] [MainThread]: Encountered an error:
Compilation Error
  expected token 'end of statement block', got '='
    line 13
      {%- do lakehouse[node.database] = {} -%}
[0m01:35:02.148667 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.23666665, "process_user_time": 1.188563, "process_kernel_time": 0.074285, "process_mem_max_rss": "104132", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m01:35:02.149048 [debug] [MainThread]: Command `dbt run-operation` failed at 01:35:02.148959 after 0.24 seconds
[0m01:35:02.149314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb3fbb7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb3fca5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb3b5e7f90>]}
[0m01:35:02.149549 [debug] [MainThread]: Flushing usage events
[0m01:35:45.721803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d6dc0c810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d6e79b390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d6dc52dd0>]}


============================== 01:35:45.723572 | 1ea15ca6-4424-463b-b755-c03da4660201 ==============================
[0m01:35:45.723572 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:35:45.723937 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run-operation drop_orphaned_tables_and_views2', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:35:45.851348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ea15ca6-4424-463b-b755-c03da4660201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d6dc6b810>]}
[0m01:35:45.905823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ea15ca6-4424-463b-b755-c03da4660201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d6da86490>]}
[0m01:35:45.906353 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m01:35:45.913450 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m01:35:45.930586 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m01:35:45.931025 [debug] [MainThread]: Partial parsing: added file: dbt_trino_iceberg://macros/drop_orphaned_tables_and_views2.sql
[0m01:35:45.933223 [error] [MainThread]: Encountered an error:
Compilation Error
  expected token 'end of statement block', got '='
    line 13
      {%- do lakehouse[node.database] = {} -%}
[0m01:35:45.933940 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.2377106, "process_user_time": 1.19221, "process_kernel_time": 0.055451, "process_mem_max_rss": "103964", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m01:35:45.934359 [debug] [MainThread]: Command `dbt run-operation` failed at 01:35:45.934276 after 0.24 seconds
[0m01:35:45.934607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d721f7450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d6df92c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d6d83d1d0>]}
[0m01:35:45.934840 [debug] [MainThread]: Flushing usage events
[0m02:43:46.698556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41499dca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41488f1290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41488f08d0>]}


============================== 02:43:46.701972 | 3311c3b3-d2a1-4ac5-a8fa-078b7c3cdf32 ==============================
[0m02:43:46.701972 [info ] [MainThread]: Running with dbt=1.7.4
[0m02:43:46.702374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'profiles_dir': '/home/vadim/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:43:46.769161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3311c3b3-d2a1-4ac5-a8fa-078b7c3cdf32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41487accd0>]}
[0m02:43:46.777776 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-kyjpytal'
[0m02:43:46.778219 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m02:43:48.468646 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m02:43:48.471364 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/starburstdata/trino_utils.json
[0m02:43:48.642723 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/starburstdata/trino_utils.json 200
[0m02:43:48.647565 [info ] [MainThread]: Updating lock file in file path: /home/vadim/dbt_trino_iceberg/package-lock.yml
[0m02:43:48.694896 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-vno__ysm'
[0m02:43:48.695652 [info ] [MainThread]: Installing starburstdata/trino_utils
[0m02:43:50.360225 [info ] [MainThread]: Installed from version 0.6.0
[0m02:43:50.360558 [info ] [MainThread]: Up to date!
[0m02:43:50.360870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3311c3b3-d2a1-4ac5-a8fa-078b7c3cdf32', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414990d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41488d5690>]}
[0m02:43:50.361847 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 3.6963365, "process_user_time": 1.330045, "process_kernel_time": 0.508003, "process_mem_max_rss": "101164", "process_in_blocks": "232", "process_out_blocks": "544"}
[0m02:43:50.362185 [debug] [MainThread]: Command `dbt deps` succeeded at 02:43:50.362107 after 3.70 seconds
[0m02:43:50.362395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41487a0f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414cf5d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414990d810>]}
[0m02:43:50.362606 [debug] [MainThread]: Flushing usage events
[0m02:44:17.875789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb088ee0a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb088ee2090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb088ee2b90>]}


============================== 02:44:17.877636 | 87519e71-71e3-4add-8534-b2bec837bde4 ==============================
[0m02:44:17.877636 [info ] [MainThread]: Running with dbt=1.7.4
[0m02:44:17.878023 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run-operation trino__drop_old_relations --args {dry_run: true}', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:44:18.011319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87519e71-71e3-4add-8534-b2bec837bde4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb088c98190>]}
[0m02:44:18.068787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87519e71-71e3-4add-8534-b2bec837bde4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb088b4d010>]}
[0m02:44:18.069260 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m02:44:18.077229 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m02:44:18.091587 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m02:44:18.092020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '87519e71-71e3-4add-8534-b2bec837bde4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb08899ea50>]}
[0m02:44:18.890902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87519e71-71e3-4add-8534-b2bec837bde4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb083770850>]}
[0m02:44:18.902540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87519e71-71e3-4add-8534-b2bec837bde4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0837f0850>]}
[0m02:44:18.902930 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 435 macros, 0 groups, 0 semantic models
[0m02:44:18.903208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87519e71-71e3-4add-8534-b2bec837bde4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb088aee290>]}
[0m02:44:18.903776 [debug] [MainThread]: Acquiring new trino connection 'macro_trino__drop_old_relations'
[0m02:44:18.903982 [debug] [MainThread]: On macro_trino__drop_old_relations: COMMIT
[0m02:44:18.909929 [info ] [MainThread]: 
        with models_to_drop as (
            select
            case 
                when table_type = 'BASE TABLE' then 'TABLE'
                when table_type = 'VIEW' then 'VIEW'
            end as relation_type,
            CASE 
                WHEN table_type = 'VIEW' THEN concat_ws('.', table_schema, table_name) 
                    ELSE concat_ws('.', table_catalog, table_schema, table_name) 
                END as relation_name
            from
                "lakehouse".information_schema.tables -- Added quotes for any whitespace in target db
            where
                table_schema like 'dbt%'
                and table_name not in ('silver_parts_suppliers',
                        'silver_order_items',
                        'bronze_tpch__region',
                        'bronze_tpch__nation',
                        'bronze_tpch__customers',
                        'bronze_tpch__part',
                        'bronze_tpch__line_item',
                        'bronze_tpch__supplier',
                        'bronze_tpch__part_suppliers',
                        'bronze_tpch__orders',
                        'gold_fct_orders_items',
                        'gold_pricing_summary_report',
                        'gold_dim_part_suppliers',
                        'gold_minimum_cost_suppliers',
                        'gold_dim_suppliers',
                        'orders_snapshot')
                )
        select 
            CONCAT( 'drop ' , relation_type , ' ' , relation_name , ';' ) as drop_commands
        from 
            models_to_drop
        where
            CONCAT( 'drop ' , relation_type , ' ' , relation_name , ';' ) is not null
    
[0m02:44:18.920326 [debug] [MainThread]: Using trino connection "macro_trino__drop_old_relations"
[0m02:44:18.920844 [debug] [MainThread]: On macro_trino__drop_old_relations: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "macro_trino__drop_old_relations"} */

    
        with models_to_drop as (
            select
            case 
                when table_type = 'BASE TABLE' then 'TABLE'
                when table_type = 'VIEW' then 'VIEW'
            end as relation_type,
            CASE 
                WHEN table_type = 'VIEW' THEN concat_ws('.', table_schema, table_name) 
                    ELSE concat_ws('.', table_catalog, table_schema, table_name) 
                END as relation_name
            from
                "lakehouse".information_schema.tables -- Added quotes for any whitespace in target db
            where
                table_schema like 'dbt%'
                and table_name not in ('silver_parts_suppliers',
                        'silver_order_items',
                        'bronze_tpch__region',
                        'bronze_tpch__nation',
                        'bronze_tpch__customers',
                        'bronze_tpch__part',
                        'bronze_tpch__line_item',
                        'bronze_tpch__supplier',
                        'bronze_tpch__part_suppliers',
                        'bronze_tpch__orders',
                        'gold_fct_orders_items',
                        'gold_pricing_summary_report',
                        'gold_dim_part_suppliers',
                        'gold_minimum_cost_suppliers',
                        'gold_dim_suppliers',
                        'orders_snapshot')
                )
        select 
            CONCAT( 'drop ' , relation_type , ' ' , relation_name , ';' ) as drop_commands
        from 
            models_to_drop
        where
            CONCAT( 'drop ' , relation_type , ' ' , relation_name , ';' ) is not null
[0m02:44:18.921147 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:44:21.146806 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m02:44:21.149727 [info ] [MainThread]: dry_run: True
[0m02:44:21.149992 [info ] [MainThread]: drop TABLE lakehouse.dbt.stg_tpch_orders;
[0m02:44:21.150229 [info ] [MainThread]: drop TABLE lakehouse.dbt.int_order_items;
[0m02:44:21.150510 [info ] [MainThread]: drop TABLE lakehouse.dbt.int_parts_suppliers;
[0m02:44:21.150820 [info ] [MainThread]: drop TABLE lakehouse.dbt.dim_suppliers;
[0m02:44:21.151022 [info ] [MainThread]: drop TABLE lakehouse.dbt.fct_orders_items;
[0m02:44:21.151248 [info ] [MainThread]: drop TABLE lakehouse.dbt.dim_part_suppliers;
[0m02:44:21.151539 [info ] [MainThread]: drop TABLE lakehouse.dbt.minimum_cost_suppliers;
[0m02:44:21.151795 [info ] [MainThread]: drop TABLE lakehouse.dbt.pricing_summary_report;
[0m02:44:21.152026 [info ] [MainThread]: drop TABLE lakehouse.dbt.stg_tpch_order_items;
[0m02:44:21.152291 [debug] [MainThread]: On macro_trino__drop_old_relations: Close
[0m02:44:21.154454 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 3.3040378, "process_user_time": 2.236133, "process_kernel_time": 0.093562, "process_mem_max_rss": "115284", "process_out_blocks": "1976", "process_in_blocks": "0"}
[0m02:44:21.154785 [debug] [MainThread]: Command `dbt run-operation` succeeded at 02:44:21.154704 after 3.30 seconds
[0m02:44:21.154974 [debug] [MainThread]: Connection 'macro_trino__drop_old_relations' was properly closed.
[0m02:44:21.155163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb088ef2fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb088a48e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb088890810>]}
[0m02:44:21.155380 [debug] [MainThread]: Flushing usage events
[0m02:45:42.671064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f985aa9cfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f985aa9c650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f985aae3ad0>]}


============================== 02:45:42.673228 | d9420504-ed14-486d-ada4-b3bb1b38fd71 ==============================
[0m02:45:42.673228 [info ] [MainThread]: Running with dbt=1.7.4
[0m02:45:42.673633 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vadim/.dbt', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run-operation trino__drop_old_relations', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:45:42.808312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9420504-ed14-486d-ada4-b3bb1b38fd71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f985a83cf90>]}
[0m02:45:42.864404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9420504-ed14-486d-ada4-b3bb1b38fd71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f985a9c8050>]}
[0m02:45:42.864880 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m02:45:42.872087 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m02:45:42.891364 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:45:42.891692 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:45:42.895932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9420504-ed14-486d-ada4-b3bb1b38fd71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f985a69cb90>]}
[0m02:45:42.905041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9420504-ed14-486d-ada4-b3bb1b38fd71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f985a7b1650>]}
[0m02:45:42.905397 [info ] [MainThread]: Found 15 models, 1 snapshot, 8 sources, 0 exposures, 0 metrics, 435 macros, 0 groups, 0 semantic models
[0m02:45:42.905672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9420504-ed14-486d-ada4-b3bb1b38fd71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f985a78ce90>]}
[0m02:45:42.906208 [debug] [MainThread]: Acquiring new trino connection 'macro_trino__drop_old_relations'
[0m02:45:42.906408 [debug] [MainThread]: On macro_trino__drop_old_relations: COMMIT
[0m02:45:42.912247 [info ] [MainThread]: 
        with models_to_drop as (
            select
            case 
                when table_type = 'BASE TABLE' then 'TABLE'
                when table_type = 'VIEW' then 'VIEW'
            end as relation_type,
            CASE 
                WHEN table_type = 'VIEW' THEN concat_ws('.', table_schema, table_name) 
                    ELSE concat_ws('.', table_catalog, table_schema, table_name) 
                END as relation_name
            from
                "lakehouse".information_schema.tables -- Added quotes for any whitespace in target db
            where
                table_schema like 'dbt%'
                and table_name not in ('silver_parts_suppliers',
                        'silver_order_items',
                        'bronze_tpch__region',
                        'bronze_tpch__nation',
                        'bronze_tpch__customers',
                        'bronze_tpch__part',
                        'bronze_tpch__line_item',
                        'bronze_tpch__supplier',
                        'bronze_tpch__part_suppliers',
                        'bronze_tpch__orders',
                        'gold_fct_orders_items',
                        'gold_pricing_summary_report',
                        'gold_dim_part_suppliers',
                        'gold_minimum_cost_suppliers',
                        'gold_dim_suppliers',
                        'orders_snapshot')
                )
        select 
            CONCAT( 'drop ' , relation_type , ' ' , relation_name , ';' ) as drop_commands
        from 
            models_to_drop
        where
            CONCAT( 'drop ' , relation_type , ' ' , relation_name , ';' ) is not null
    
[0m02:45:42.921815 [debug] [MainThread]: Using trino connection "macro_trino__drop_old_relations"
[0m02:45:42.922079 [debug] [MainThread]: On macro_trino__drop_old_relations: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "macro_trino__drop_old_relations"} */

    
        with models_to_drop as (
            select
            case 
                when table_type = 'BASE TABLE' then 'TABLE'
                when table_type = 'VIEW' then 'VIEW'
            end as relation_type,
            CASE 
                WHEN table_type = 'VIEW' THEN concat_ws('.', table_schema, table_name) 
                    ELSE concat_ws('.', table_catalog, table_schema, table_name) 
                END as relation_name
            from
                "lakehouse".information_schema.tables -- Added quotes for any whitespace in target db
            where
                table_schema like 'dbt%'
                and table_name not in ('silver_parts_suppliers',
                        'silver_order_items',
                        'bronze_tpch__region',
                        'bronze_tpch__nation',
                        'bronze_tpch__customers',
                        'bronze_tpch__part',
                        'bronze_tpch__line_item',
                        'bronze_tpch__supplier',
                        'bronze_tpch__part_suppliers',
                        'bronze_tpch__orders',
                        'gold_fct_orders_items',
                        'gold_pricing_summary_report',
                        'gold_dim_part_suppliers',
                        'gold_minimum_cost_suppliers',
                        'gold_dim_suppliers',
                        'orders_snapshot')
                )
        select 
            CONCAT( 'drop ' , relation_type , ' ' , relation_name , ';' ) as drop_commands
        from 
            models_to_drop
        where
            CONCAT( 'drop ' , relation_type , ' ' , relation_name , ';' ) is not null
[0m02:45:42.922302 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:45:44.993794 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m02:45:44.996970 [info ] [MainThread]: dry_run: false
[0m02:45:44.997355 [info ] [MainThread]: drop TABLE lakehouse.dbt.stg_tpch_orders;
[0m02:45:44.998005 [debug] [MainThread]: Using trino connection "macro_trino__drop_old_relations"
[0m02:45:44.998202 [debug] [MainThread]: On macro_trino__drop_old_relations: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "macro_trino__drop_old_relations"} */

    drop TABLE lakehouse.dbt.stg_tpch_orders
[0m02:45:46.209316 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m02:45:46.211757 [info ] [MainThread]: drop TABLE lakehouse.dbt.int_order_items;
[0m02:45:46.213157 [debug] [MainThread]: Using trino connection "macro_trino__drop_old_relations"
[0m02:45:46.213540 [debug] [MainThread]: On macro_trino__drop_old_relations: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "macro_trino__drop_old_relations"} */

    drop TABLE lakehouse.dbt.int_order_items
[0m02:45:47.379571 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m02:45:47.382012 [info ] [MainThread]: drop TABLE lakehouse.dbt.int_parts_suppliers;
[0m02:45:47.382682 [debug] [MainThread]: Using trino connection "macro_trino__drop_old_relations"
[0m02:45:47.382898 [debug] [MainThread]: On macro_trino__drop_old_relations: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "macro_trino__drop_old_relations"} */

    drop TABLE lakehouse.dbt.int_parts_suppliers
[0m02:45:48.439423 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m02:45:48.442230 [info ] [MainThread]: drop TABLE lakehouse.dbt.dim_suppliers;
[0m02:45:48.443465 [debug] [MainThread]: Using trino connection "macro_trino__drop_old_relations"
[0m02:45:48.443664 [debug] [MainThread]: On macro_trino__drop_old_relations: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "macro_trino__drop_old_relations"} */

    drop TABLE lakehouse.dbt.dim_suppliers
[0m02:45:50.215003 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m02:45:50.217885 [info ] [MainThread]: drop TABLE lakehouse.dbt.fct_orders_items;
[0m02:45:50.219563 [debug] [MainThread]: Using trino connection "macro_trino__drop_old_relations"
[0m02:45:50.219753 [debug] [MainThread]: On macro_trino__drop_old_relations: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "macro_trino__drop_old_relations"} */

    drop TABLE lakehouse.dbt.fct_orders_items
[0m02:45:51.488043 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m02:45:51.490582 [info ] [MainThread]: drop TABLE lakehouse.dbt.dim_part_suppliers;
[0m02:45:51.492011 [debug] [MainThread]: Using trino connection "macro_trino__drop_old_relations"
[0m02:45:51.492202 [debug] [MainThread]: On macro_trino__drop_old_relations: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "macro_trino__drop_old_relations"} */

    drop TABLE lakehouse.dbt.dim_part_suppliers
[0m02:45:52.464505 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m02:45:52.467075 [info ] [MainThread]: drop TABLE lakehouse.dbt.minimum_cost_suppliers;
[0m02:45:52.468124 [debug] [MainThread]: Using trino connection "macro_trino__drop_old_relations"
[0m02:45:52.468347 [debug] [MainThread]: On macro_trino__drop_old_relations: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "macro_trino__drop_old_relations"} */

    drop TABLE lakehouse.dbt.minimum_cost_suppliers
[0m02:45:53.487892 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m02:45:53.490358 [info ] [MainThread]: drop TABLE lakehouse.dbt.pricing_summary_report;
[0m02:45:53.491789 [debug] [MainThread]: Using trino connection "macro_trino__drop_old_relations"
[0m02:45:53.492154 [debug] [MainThread]: On macro_trino__drop_old_relations: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "macro_trino__drop_old_relations"} */

    drop TABLE lakehouse.dbt.pricing_summary_report
[0m02:45:54.589968 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m02:45:54.592475 [info ] [MainThread]: drop TABLE lakehouse.dbt.stg_tpch_order_items;
[0m02:45:54.594177 [debug] [MainThread]: Using trino connection "macro_trino__drop_old_relations"
[0m02:45:54.594618 [debug] [MainThread]: On macro_trino__drop_old_relations: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_trino_iceberg", "target_name": "dev", "connection_name": "macro_trino__drop_old_relations"} */

    drop TABLE lakehouse.dbt.stg_tpch_order_items
[0m02:45:56.094790 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m02:45:56.097325 [debug] [MainThread]: On macro_trino__drop_old_relations: Close
[0m02:45:56.101060 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 13.45699, "process_user_time": 1.548168, "process_kernel_time": 0.114679, "process_mem_max_rss": "107612", "process_out_blocks": "1064", "process_in_blocks": "0"}
[0m02:45:56.101462 [debug] [MainThread]: Command `dbt run-operation` succeeded at 02:45:56.101364 after 13.46 seconds
[0m02:45:56.101692 [debug] [MainThread]: Connection 'macro_trino__drop_old_relations' was properly closed.
[0m02:45:56.101934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f985af319d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f985a877790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f985a6d4210>]}
[0m02:45:56.102234 [debug] [MainThread]: Flushing usage events
[0m11:29:30.072411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8a078ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8a068bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8a06b4d0>]}


============================== 11:29:30.076329 | 9a8b7c33-ebb9-4d79-b551-ede3b1878552 ==============================
[0m11:29:30.076329 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:29:30.076707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vadim/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vadim/dbt_trino_iceberg/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:29:30.143375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a8b7c33-ebb9-4d79-b551-ede3b1878552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8a0bffd0>]}
[0m11:29:30.152729 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.107783735, "process_user_time": 1.140225, "process_kernel_time": 0.216737, "process_mem_max_rss": "97880", "process_in_blocks": "94272", "process_out_blocks": "16"}
[0m11:29:30.153084 [debug] [MainThread]: Command `dbt clean` succeeded at 11:29:30.153001 after 0.11 seconds
[0m11:29:30.153330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8a079010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8a070190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8e63b690>]}
[0m11:29:30.153567 [debug] [MainThread]: Flushing usage events
